var Gl=Object.defineProperty;var ql=(t,e,r)=>e in t?Gl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Ve=(t,e,r)=>(ql(t,typeof e!="symbol"?e+"":e,r),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const _ of l.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&i(_)}).observe(document,{childList:!0,subtree:!0});function r(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(o){if(o.ep)return;o.ep=!0;const l=r(o);fetch(o.href,l)}})();function qs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var aa={exports:{}};(function(t){var e={};e.useBlobBuilder=function(){try{return new Blob([]),!1}catch{return!0}}(),e.useArrayBufferView=!e.useBlobBuilder&&function(){try{return new Blob([new Uint8Array([])]).size===0}catch{return!0}}(),t.exports.binaryFeatures=e;var r=t.exports.BlobBuilder;typeof window<"u"&&(r=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder);function i(){this._pieces=[],this._parts=[]}i.prototype.append=function(o){typeof o=="number"?this._pieces.push(o):(this.flush(),this._parts.push(o))},i.prototype.flush=function(){if(this._pieces.length>0){var o=new Uint8Array(this._pieces);e.useArrayBufferView||(o=o.buffer),this._parts.push(o),this._pieces=[]}},i.prototype.getBuffer=function(){if(this.flush(),e.useBlobBuilder){for(var o=new r,l=0,_=this._parts.length;l<_;l++)o.append(this._parts[l]);return o.getBlob()}else return new Blob(this._parts)},t.exports.BufferBuilder=i})(aa);var ca=aa.exports,Yl=ca.BufferBuilder,Nn=ca.binaryFeatures,Jl={unpack:function(t){var e=new me(t);return e.unpack()},pack:function(t){var e=new ve;e.pack(t);var r=e.getBuffer();return r}},Xl=Jl;function me(t){this.index=0,this.dataBuffer=t,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}me.prototype.unpack=function(){var t=this.unpack_uint8();if(t<128)return t;if((t^224)<32)return(t^224)-32;var e;if((e=t^160)<=15)return this.unpack_raw(e);if((e=t^176)<=15)return this.unpack_string(e);if((e=t^144)<=15)return this.unpack_array(e);if((e=t^128)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}};me.prototype.unpack_uint8=function(){var t=this.dataView[this.index]&255;return this.index++,t};me.prototype.unpack_uint16=function(){var t=this.read(2),e=(t[0]&255)*256+(t[1]&255);return this.index+=2,e};me.prototype.unpack_uint32=function(){var t=this.read(4),e=((t[0]*256+t[1])*256+t[2])*256+t[3];return this.index+=4,e};me.prototype.unpack_uint64=function(){var t=this.read(8),e=((((((t[0]*256+t[1])*256+t[2])*256+t[3])*256+t[4])*256+t[5])*256+t[6])*256+t[7];return this.index+=8,e};me.prototype.unpack_int8=function(){var t=this.unpack_uint8();return t<128?t:t-256};me.prototype.unpack_int16=function(){var t=this.unpack_uint16();return t<32768?t:t-65536};me.prototype.unpack_int32=function(){var t=this.unpack_uint32();return t<Math.pow(2,31)?t:t-Math.pow(2,32)};me.prototype.unpack_int64=function(){var t=this.unpack_uint64();return t<Math.pow(2,63)?t:t-Math.pow(2,64)};me.prototype.unpack_raw=function(t){if(this.length<this.index+t)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+t+" "+this.length);var e=this.dataBuffer.slice(this.index,this.index+t);return this.index+=t,e};me.prototype.unpack_string=function(t){for(var e=this.read(t),r=0,i="",o,l;r<t;)o=e[r],o<128?(i+=String.fromCharCode(o),r++):(o^192)<32?(l=(o^192)<<6|e[r+1]&63,i+=String.fromCharCode(l),r+=2):(l=(o&15)<<12|(e[r+1]&63)<<6|e[r+2]&63,i+=String.fromCharCode(l),r+=3);return this.index+=t,i};me.prototype.unpack_array=function(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=this.unpack();return e};me.prototype.unpack_map=function(t){for(var e={},r=0;r<t;r++){var i=this.unpack(),o=this.unpack();e[i]=o}return e};me.prototype.unpack_float=function(){var t=this.unpack_uint32(),e=t>>31,r=(t>>23&255)-127,i=t&8388607|8388608;return(e===0?1:-1)*i*Math.pow(2,r-23)};me.prototype.unpack_double=function(){var t=this.unpack_uint32(),e=this.unpack_uint32(),r=t>>31,i=(t>>20&2047)-1023,o=t&1048575|1048576,l=o*Math.pow(2,i-20)+e*Math.pow(2,i-52);return(r===0?1:-1)*l};me.prototype.read=function(t){var e=this.index;if(e+t<=this.length)return this.dataView.subarray(e,e+t);throw new Error("BinaryPackFailure: read index out of range")};function ve(){this.bufferBuilder=new Yl}ve.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()};ve.prototype.pack=function(t){var e=typeof t;if(e==="string")this.pack_string(t);else if(e==="number")Math.floor(t)===t?this.pack_integer(t):this.pack_double(t);else if(e==="boolean")t===!0?this.bufferBuilder.append(195):t===!1&&this.bufferBuilder.append(194);else if(e==="undefined")this.bufferBuilder.append(192);else if(e==="object")if(t===null)this.bufferBuilder.append(192);else{var r=t.constructor;if(r==Array)this.pack_array(t);else if(r==Blob||r==File||t instanceof Blob||t instanceof File)this.pack_bin(t);else if(r==ArrayBuffer)Nn.useArrayBufferView?this.pack_bin(new Uint8Array(t)):this.pack_bin(t);else if("BYTES_PER_ELEMENT"in t)Nn.useArrayBufferView?this.pack_bin(new Uint8Array(t.buffer)):this.pack_bin(t.buffer);else if(r==Object||r.toString().startsWith("class"))this.pack_object(t);else if(r==Date)this.pack_string(t.toString());else if(typeof t.toBinaryPack=="function")this.bufferBuilder.append(t.toBinaryPack());else throw new Error('Type "'+r.toString()+'" not yet supported')}else throw new Error('Type "'+e+'" not yet supported');this.bufferBuilder.flush()};ve.prototype.pack_bin=function(t){var e=t.length||t.byteLength||t.size;if(e<=15)this.pack_uint8(160+e);else if(e<=65535)this.bufferBuilder.append(218),this.pack_uint16(e);else if(e<=4294967295)this.bufferBuilder.append(219),this.pack_uint32(e);else throw new Error("Invalid length");this.bufferBuilder.append(t)};ve.prototype.pack_string=function(t){var e=Zl(t);if(e<=15)this.pack_uint8(176+e);else if(e<=65535)this.bufferBuilder.append(216),this.pack_uint16(e);else if(e<=4294967295)this.bufferBuilder.append(217),this.pack_uint32(e);else throw new Error("Invalid length");this.bufferBuilder.append(t)};ve.prototype.pack_array=function(t){var e=t.length;if(e<=15)this.pack_uint8(144+e);else if(e<=65535)this.bufferBuilder.append(220),this.pack_uint16(e);else if(e<=4294967295)this.bufferBuilder.append(221),this.pack_uint32(e);else throw new Error("Invalid length");for(var r=0;r<e;r++)this.pack(t[r])};ve.prototype.pack_integer=function(t){if(t>=-32&&t<=127)this.bufferBuilder.append(t&255);else if(t>=0&&t<=255)this.bufferBuilder.append(204),this.pack_uint8(t);else if(t>=-128&&t<=127)this.bufferBuilder.append(208),this.pack_int8(t);else if(t>=0&&t<=65535)this.bufferBuilder.append(205),this.pack_uint16(t);else if(t>=-32768&&t<=32767)this.bufferBuilder.append(209),this.pack_int16(t);else if(t>=0&&t<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(t);else if(t>=-2147483648&&t<=2147483647)this.bufferBuilder.append(210),this.pack_int32(t);else if(t>=-9223372036854776e3&&t<=9223372036854776e3)this.bufferBuilder.append(211),this.pack_int64(t);else if(t>=0&&t<=18446744073709552e3)this.bufferBuilder.append(207),this.pack_uint64(t);else throw new Error("Invalid integer")};ve.prototype.pack_double=function(t){var e=0;t<0&&(e=1,t=-t);var r=Math.floor(Math.log(t)/Math.LN2),i=t/Math.pow(2,r)-1,o=Math.floor(i*Math.pow(2,52)),l=Math.pow(2,32),_=e<<31|r+1023<<20|o/l&1048575,s=o%l;this.bufferBuilder.append(203),this.pack_int32(_),this.pack_int32(s)};ve.prototype.pack_object=function(t){var e=Object.keys(t),r=e.length;if(r<=15)this.pack_uint8(128+r);else if(r<=65535)this.bufferBuilder.append(222),this.pack_uint16(r);else if(r<=4294967295)this.bufferBuilder.append(223),this.pack_uint32(r);else throw new Error("Invalid length");for(var i in t)t.hasOwnProperty(i)&&(this.pack(i),this.pack(t[i]))};ve.prototype.pack_uint8=function(t){this.bufferBuilder.append(t)};ve.prototype.pack_uint16=function(t){this.bufferBuilder.append(t>>8),this.bufferBuilder.append(t&255)};ve.prototype.pack_uint32=function(t){var e=t&4294967295;this.bufferBuilder.append((e&4278190080)>>>24),this.bufferBuilder.append((e&16711680)>>>16),this.bufferBuilder.append((e&65280)>>>8),this.bufferBuilder.append(e&255)};ve.prototype.pack_uint64=function(t){var e=t/Math.pow(2,32),r=t%Math.pow(2,32);this.bufferBuilder.append((e&4278190080)>>>24),this.bufferBuilder.append((e&16711680)>>>16),this.bufferBuilder.append((e&65280)>>>8),this.bufferBuilder.append(e&255),this.bufferBuilder.append((r&4278190080)>>>24),this.bufferBuilder.append((r&16711680)>>>16),this.bufferBuilder.append((r&65280)>>>8),this.bufferBuilder.append(r&255)};ve.prototype.pack_int8=function(t){this.bufferBuilder.append(t&255)};ve.prototype.pack_int16=function(t){this.bufferBuilder.append((t&65280)>>8),this.bufferBuilder.append(t&255)};ve.prototype.pack_int32=function(t){this.bufferBuilder.append(t>>>24&255),this.bufferBuilder.append((t&16711680)>>>16),this.bufferBuilder.append((t&65280)>>>8),this.bufferBuilder.append(t&255)};ve.prototype.pack_int64=function(t){var e=Math.floor(t/Math.pow(2,32)),r=t%Math.pow(2,32);this.bufferBuilder.append((e&4278190080)>>>24),this.bufferBuilder.append((e&16711680)>>>16),this.bufferBuilder.append((e&65280)>>>8),this.bufferBuilder.append(e&255),this.bufferBuilder.append((r&4278190080)>>>24),this.bufferBuilder.append((r&16711680)>>>16),this.bufferBuilder.append((r&65280)>>>8),this.bufferBuilder.append(r&255)};function Ql(t){var e=t.charCodeAt(0);return e<=2047?"00":e<=65535?"000":e<=2097151?"0000":e<=67108863?"00000":"000000"}function Zl(t){return t.length>600?new Blob([t]).size:t.replace(/[^\u0000-\u007F]/g,Ql).length}const $n=qs(Xl);let la=!0,ha=!0;function ur(t,e,r){const i=t.match(e);return i&&i.length>=r&&parseInt(i[r],10)}function Xt(t,e,r){if(!t.RTCPeerConnection)return;const i=t.RTCPeerConnection.prototype,o=i.addEventListener;i.addEventListener=function(_,s){if(_!==e)return o.apply(this,arguments);const n=a=>{const h=r(a);h&&(s.handleEvent?s.handleEvent(h):s(h))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(s,n),o.apply(this,[_,n])};const l=i.removeEventListener;i.removeEventListener=function(_,s){if(_!==e||!this._eventMap||!this._eventMap[e])return l.apply(this,arguments);if(!this._eventMap[e].has(s))return l.apply(this,arguments);const n=this._eventMap[e].get(s);return this._eventMap[e].delete(s),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,l.apply(this,[_,n])},Object.defineProperty(i,"on"+e,{get(){return this["_on"+e]},set(_){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),_&&this.addEventListener(e,this["_on"+e]=_)},enumerable:!0,configurable:!0})}function eh(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(la=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function th(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(ha=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function Ys(){if(typeof window=="object"){if(la)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function mi(t,e){ha&&console.warn(t+" is deprecated, please use "+e+" instead.")}function rh(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator)return e.browser="Not a browser.",e;const{navigator:r}=t;if(r.mozGetUserMedia)e.browser="firefox",e.version=ur(r.userAgent,/Firefox\/(\d+)\./,1);else if(r.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection&&!t.RTCIceGatherer)e.browser="chrome",e.version=ur(r.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(r.mediaDevices&&r.userAgent.match(/Edge\/(\d+).(\d+)$/))e.browser="edge",e.version=ur(r.userAgent,/Edge\/(\d+).(\d+)$/,2);else if(t.RTCPeerConnection&&r.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=ur(r.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function Hn(t){return Object.prototype.toString.call(t)==="[object Object]"}function ua(t){return Hn(t)?Object.keys(t).reduce(function(e,r){const i=Hn(t[r]),o=i?ua(t[r]):t[r],l=i&&!Object.keys(o).length;return o===void 0||l?e:Object.assign(e,{[r]:o})},{}):t}function hs(t,e,r){!e||r.has(e.id)||(r.set(e.id,e),Object.keys(e).forEach(i=>{i.endsWith("Id")?hs(t,t.get(e[i]),r):i.endsWith("Ids")&&e[i].forEach(o=>{hs(t,t.get(o),r)})}))}function Fn(t,e,r){const i=r?"outbound-rtp":"inbound-rtp",o=new Map;if(e===null)return o;const l=[];return t.forEach(_=>{_.type==="track"&&_.trackIdentifier===e.id&&l.push(_)}),l.forEach(_=>{t.forEach(s=>{s.type===i&&s.trackId===_.id&&hs(t,s,o)})}),o}const jn=Ys;function da(t,e){const r=t&&t.navigator;if(!r.mediaDevices)return;const i=function(s){if(typeof s!="object"||s.mandatory||s.optional)return s;const n={};return Object.keys(s).forEach(a=>{if(a==="require"||a==="advanced"||a==="mediaSource")return;const h=typeof s[a]=="object"?s[a]:{ideal:s[a]};h.exact!==void 0&&typeof h.exact=="number"&&(h.min=h.max=h.exact);const u=function(g,C){return g?g+C.charAt(0).toUpperCase()+C.slice(1):C==="deviceId"?"sourceId":C};if(h.ideal!==void 0){n.optional=n.optional||[];let g={};typeof h.ideal=="number"?(g[u("min",a)]=h.ideal,n.optional.push(g),g={},g[u("max",a)]=h.ideal,n.optional.push(g)):(g[u("",a)]=h.ideal,n.optional.push(g))}h.exact!==void 0&&typeof h.exact!="number"?(n.mandatory=n.mandatory||{},n.mandatory[u("",a)]=h.exact):["min","max"].forEach(g=>{h[g]!==void 0&&(n.mandatory=n.mandatory||{},n.mandatory[u(g,a)]=h[g])})}),s.advanced&&(n.optional=(n.optional||[]).concat(s.advanced)),n},o=function(s,n){if(e.version>=61)return n(s);if(s=JSON.parse(JSON.stringify(s)),s&&typeof s.audio=="object"){const a=function(h,u,g){u in h&&!(g in h)&&(h[g]=h[u],delete h[u])};s=JSON.parse(JSON.stringify(s)),a(s.audio,"autoGainControl","googAutoGainControl"),a(s.audio,"noiseSuppression","googNoiseSuppression"),s.audio=i(s.audio)}if(s&&typeof s.video=="object"){let a=s.video.facingMode;a=a&&(typeof a=="object"?a:{ideal:a});const h=e.version<66;if(a&&(a.exact==="user"||a.exact==="environment"||a.ideal==="user"||a.ideal==="environment")&&!(r.mediaDevices.getSupportedConstraints&&r.mediaDevices.getSupportedConstraints().facingMode&&!h)){delete s.video.facingMode;let u;if(a.exact==="environment"||a.ideal==="environment"?u=["back","rear"]:(a.exact==="user"||a.ideal==="user")&&(u=["front"]),u)return r.mediaDevices.enumerateDevices().then(g=>{g=g.filter(b=>b.kind==="videoinput");let C=g.find(b=>u.some(m=>b.label.toLowerCase().includes(m)));return!C&&g.length&&u.includes("back")&&(C=g[g.length-1]),C&&(s.video.deviceId=a.exact?{exact:C.deviceId}:{ideal:C.deviceId}),s.video=i(s.video),jn("chrome: "+JSON.stringify(s)),n(s)})}s.video=i(s.video)}return jn("chrome: "+JSON.stringify(s)),n(s)},l=function(s){return e.version>=64?s:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[s.name]||s.name,message:s.message,constraint:s.constraint||s.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},_=function(s,n,a){o(s,h=>{r.webkitGetUserMedia(h,n,u=>{a&&a(l(u))})})};if(r.getUserMedia=_.bind(r),r.mediaDevices.getUserMedia){const s=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(n){return o(n,a=>s(a).then(h=>{if(a.audio&&!h.getAudioTracks().length||a.video&&!h.getVideoTracks().length)throw h.getTracks().forEach(u=>{u.stop()}),new DOMException("","NotFoundError");return h},h=>Promise.reject(l(h))))}}}function ih(t,e){if(!(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices)&&t.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}t.navigator.mediaDevices.getDisplayMedia=function(i){return e(i).then(o=>{const l=i.video&&i.video.width,_=i.video&&i.video.height,s=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:o,maxFrameRate:s||3}},l&&(i.video.mandatory.maxWidth=l),_&&(i.video.mandatory.maxHeight=_),t.navigator.mediaDevices.getUserMedia(i)})}}}function fa(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function pa(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(r){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=r)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=i=>{i.stream.addEventListener("addtrack",o=>{let l;t.RTCPeerConnection.prototype.getReceivers?l=this.getReceivers().find(s=>s.track&&s.track.id===o.track.id):l={track:o.track};const _=new Event("track");_.track=o.track,_.receiver=l,_.transceiver={receiver:l},_.streams=[i.stream],this.dispatchEvent(_)}),i.stream.getTracks().forEach(o=>{let l;t.RTCPeerConnection.prototype.getReceivers?l=this.getReceivers().find(s=>s.track&&s.track.id===o.id):l={track:o};const _=new Event("track");_.track=o,_.receiver=l,_.transceiver={receiver:l},_.streams=[i.stream],this.dispatchEvent(_)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Xt(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function _a(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(o,l){return{track:l,get dtmf(){return this._dtmf===void 0&&(l.kind==="audio"?this._dtmf=o.createDTMFSender(l):this._dtmf=null),this._dtmf},_pc:o}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const o=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(s,n){let a=o.apply(this,arguments);return a||(a=e(this,s),this._senders.push(a)),a};const l=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(s){l.apply(this,arguments);const n=this._senders.indexOf(s);n!==-1&&this._senders.splice(n,1)}}const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(l){this._senders=this._senders||[],r.apply(this,[l]),l.getTracks().forEach(_=>{this._senders.push(e(this,_))})};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(l){this._senders=this._senders||[],i.apply(this,[l]),l.getTracks().forEach(_=>{const s=this._senders.find(n=>n.track===_);s&&this._senders.splice(this._senders.indexOf(s),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(o=>o._pc=this),i},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function ga(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[i,o,l]=arguments;if(arguments.length>0&&typeof i=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof i!="function"))return e.apply(this,[]);const _=function(n){const a={};return n.result().forEach(u=>{const g={id:u.id,timestamp:u.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[u.type]||u.type};u.names().forEach(C=>{g[C]=u.stat(C)}),a[g.id]=g}),a},s=function(n){return new Map(Object.keys(n).map(a=>[a,n[a]]))};if(arguments.length>=2){const n=function(a){o(s(_(a)))};return e.apply(this,[n,i])}return new Promise((n,a)=>{e.apply(this,[function(h){n(s(_(h)))},a])}).then(o,l)}}function ma(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const r=t.RTCPeerConnection.prototype.getSenders;r&&(t.RTCPeerConnection.prototype.getSenders=function(){const l=r.apply(this,[]);return l.forEach(_=>_._pc=this),l});const i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function(){const l=i.apply(this,arguments);return l._pc=this,l}),t.RTCRtpSender.prototype.getStats=function(){const l=this;return this._pc.getStats().then(_=>Fn(_,l.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const r=t.RTCPeerConnection.prototype.getReceivers;r&&(t.RTCPeerConnection.prototype.getReceivers=function(){const o=r.apply(this,[]);return o.forEach(l=>l._pc=this),o}),Xt(t,"track",i=>(i.receiver._pc=i.srcElement,i)),t.RTCRtpReceiver.prototype.getStats=function(){const o=this;return this._pc.getStats().then(l=>Fn(l,o.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const i=arguments[0];let o,l,_;return this.getSenders().forEach(s=>{s.track===i&&(o?_=!0:o=s)}),this.getReceivers().forEach(s=>(s.track===i&&(l?_=!0:l=s),s.track===i)),_||o&&l?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):o?o.getStats():l?l.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function va(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(_=>this._shimmedLocalStreams[_][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(_,s){if(!s)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const n=e.apply(this,arguments);return this._shimmedLocalStreams[s.id]?this._shimmedLocalStreams[s.id].indexOf(n)===-1&&this._shimmedLocalStreams[s.id].push(n):this._shimmedLocalStreams[s.id]=[s,n],n};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(_){this._shimmedLocalStreams=this._shimmedLocalStreams||{},_.getTracks().forEach(a=>{if(this.getSenders().find(u=>u.track===a))throw new DOMException("Track already exists.","InvalidAccessError")});const s=this.getSenders();r.apply(this,arguments);const n=this.getSenders().filter(a=>s.indexOf(a)===-1);this._shimmedLocalStreams[_.id]=[_].concat(n)};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(_){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[_.id],i.apply(this,arguments)};const o=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(_){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},_&&Object.keys(this._shimmedLocalStreams).forEach(s=>{const n=this._shimmedLocalStreams[s].indexOf(_);n!==-1&&this._shimmedLocalStreams[s].splice(n,1),this._shimmedLocalStreams[s].length===1&&delete this._shimmedLocalStreams[s]}),o.apply(this,arguments)}}function ya(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return va(t);const r=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const h=r.apply(this);return this._reverseStreams=this._reverseStreams||{},h.map(u=>this._reverseStreams[u.id])};const i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(h){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},h.getTracks().forEach(u=>{if(this.getSenders().find(C=>C.track===u))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[h.id]){const u=new t.MediaStream(h.getTracks());this._streams[h.id]=u,this._reverseStreams[u.id]=h,h=u}i.apply(this,[h])};const o=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(h){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[h.id]||h]),delete this._reverseStreams[this._streams[h.id]?this._streams[h.id].id:h.id],delete this._streams[h.id]},t.RTCPeerConnection.prototype.addTrack=function(h,u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const g=[].slice.call(arguments,1);if(g.length!==1||!g[0].getTracks().find(m=>m===h))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(m=>m.track===h))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const b=this._streams[u.id];if(b)b.addTrack(h),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const m=new t.MediaStream([h]);this._streams[u.id]=m,this._reverseStreams[m.id]=u,this.addStream(m)}return this.getSenders().find(m=>m.track===h)};function l(a,h){let u=h.sdp;return Object.keys(a._reverseStreams||[]).forEach(g=>{const C=a._reverseStreams[g],b=a._streams[C.id];u=u.replace(new RegExp(b.id,"g"),C.id)}),new RTCSessionDescription({type:h.type,sdp:u})}function _(a,h){let u=h.sdp;return Object.keys(a._reverseStreams||[]).forEach(g=>{const C=a._reverseStreams[g],b=a._streams[C.id];u=u.replace(new RegExp(C.id,"g"),b.id)}),new RTCSessionDescription({type:h.type,sdp:u})}["createOffer","createAnswer"].forEach(function(a){const h=t.RTCPeerConnection.prototype[a],u={[a](){const g=arguments;return arguments.length&&typeof arguments[0]=="function"?h.apply(this,[b=>{const m=l(this,b);g[0].apply(null,[m])},b=>{g[1]&&g[1].apply(null,b)},arguments[2]]):h.apply(this,arguments).then(b=>l(this,b))}};t.RTCPeerConnection.prototype[a]=u[a]});const s=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?s.apply(this,arguments):(arguments[0]=_(this,arguments[0]),s.apply(this,arguments))};const n=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const a=n.get.apply(this);return a.type===""?a:l(this,a)}}),t.RTCPeerConnection.prototype.removeTrack=function(h){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!h._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(h._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let g;Object.keys(this._streams).forEach(C=>{this._streams[C].getTracks().find(m=>h.track===m)&&(g=this._streams[C])}),g&&(g.getTracks().length===1?this.removeStream(this._reverseStreams[g.id]):g.removeTrack(h.track),this.dispatchEvent(new Event("negotiationneeded")))}}function us(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const i=t.RTCPeerConnection.prototype[r],o={[r](){return arguments[0]=new(r==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};t.RTCPeerConnection.prototype[r]=o[r]})}function Sa(t,e){Xt(t,"negotiationneeded",r=>{const i=r.target;if(!((e.version<72||i.getConfiguration&&i.getConfiguration().sdpSemantics==="plan-b")&&i.signalingState!=="stable"))return r})}const Un=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:Sa,shimAddTrackRemoveTrack:ya,shimAddTrackRemoveTrackWithNative:va,shimGetDisplayMedia:ih,shimGetSendersWithDtmf:_a,shimGetStats:ga,shimGetUserMedia:da,shimMediaStream:fa,shimOnTrack:pa,shimPeerConnection:us,shimSenderReceiverGetStats:ma},Symbol.toStringTag,{value:"Module"}));function sh(t,e){let r=!1;return t=JSON.parse(JSON.stringify(t)),t.filter(i=>{if(i&&(i.urls||i.url)){let o=i.urls||i.url;i.url&&!i.urls&&mi("RTCIceServer.url","RTCIceServer.urls");const l=typeof o=="string";return l&&(o=[o]),o=o.filter(_=>{if(_.indexOf("stun:")===0)return!1;const s=_.startsWith("turn")&&!_.startsWith("turn:[")&&_.includes("transport=udp");return s&&!r?(r=!0,!0):s&&!r}),delete i.url,i.urls=l?o[0]:o,!!o.length}})}var ba={exports:{}};(function(t){var e={};e.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},e.localCName=e.generateIdentifier(),e.splitLines=function(r){return r.trim().split(`
`).map(function(i){return i.trim()})},e.splitSections=function(r){var i=r.split(`
m=`);return i.map(function(o,l){return(l>0?"m="+o:o).trim()+`\r
`})},e.getDescription=function(r){var i=e.splitSections(r);return i&&i[0]},e.getMediaSections=function(r){var i=e.splitSections(r);return i.shift(),i},e.matchPrefix=function(r,i){return e.splitLines(r).filter(function(o){return o.indexOf(i)===0})},e.parseCandidate=function(r){var i;r.indexOf("a=candidate:")===0?i=r.substring(12).split(" "):i=r.substring(10).split(" ");for(var o={foundation:i[0],component:parseInt(i[1],10),protocol:i[2].toLowerCase(),priority:parseInt(i[3],10),ip:i[4],address:i[4],port:parseInt(i[5],10),type:i[7]},l=8;l<i.length;l+=2)switch(i[l]){case"raddr":o.relatedAddress=i[l+1];break;case"rport":o.relatedPort=parseInt(i[l+1],10);break;case"tcptype":o.tcpType=i[l+1];break;case"ufrag":o.ufrag=i[l+1],o.usernameFragment=i[l+1];break;default:o[i[l]]=i[l+1];break}return o},e.writeCandidate=function(r){var i=[];i.push(r.foundation),i.push(r.component),i.push(r.protocol.toUpperCase()),i.push(r.priority),i.push(r.address||r.ip),i.push(r.port);var o=r.type;return i.push("typ"),i.push(o),o!=="host"&&r.relatedAddress&&r.relatedPort&&(i.push("raddr"),i.push(r.relatedAddress),i.push("rport"),i.push(r.relatedPort)),r.tcpType&&r.protocol.toLowerCase()==="tcp"&&(i.push("tcptype"),i.push(r.tcpType)),(r.usernameFragment||r.ufrag)&&(i.push("ufrag"),i.push(r.usernameFragment||r.ufrag)),"candidate:"+i.join(" ")},e.parseIceOptions=function(r){return r.substr(14).split(" ")},e.parseRtpMap=function(r){var i=r.substr(9).split(" "),o={payloadType:parseInt(i.shift(),10)};return i=i[0].split("/"),o.name=i[0],o.clockRate=parseInt(i[1],10),o.channels=i.length===3?parseInt(i[2],10):1,o.numChannels=o.channels,o},e.writeRtpMap=function(r){var i=r.payloadType;r.preferredPayloadType!==void 0&&(i=r.preferredPayloadType);var o=r.channels||r.numChannels||1;return"a=rtpmap:"+i+" "+r.name+"/"+r.clockRate+(o!==1?"/"+o:"")+`\r
`},e.parseExtmap=function(r){var i=r.substr(9).split(" ");return{id:parseInt(i[0],10),direction:i[0].indexOf("/")>0?i[0].split("/")[1]:"sendrecv",uri:i[1]}},e.writeExtmap=function(r){return"a=extmap:"+(r.id||r.preferredId)+(r.direction&&r.direction!=="sendrecv"?"/"+r.direction:"")+" "+r.uri+`\r
`},e.parseFmtp=function(r){for(var i={},o,l=r.substr(r.indexOf(" ")+1).split(";"),_=0;_<l.length;_++)o=l[_].trim().split("="),i[o[0].trim()]=o[1];return i},e.writeFmtp=function(r){var i="",o=r.payloadType;if(r.preferredPayloadType!==void 0&&(o=r.preferredPayloadType),r.parameters&&Object.keys(r.parameters).length){var l=[];Object.keys(r.parameters).forEach(function(_){r.parameters[_]?l.push(_+"="+r.parameters[_]):l.push(_)}),i+="a=fmtp:"+o+" "+l.join(";")+`\r
`}return i},e.parseRtcpFb=function(r){var i=r.substr(r.indexOf(" ")+1).split(" ");return{type:i.shift(),parameter:i.join(" ")}},e.writeRtcpFb=function(r){var i="",o=r.payloadType;return r.preferredPayloadType!==void 0&&(o=r.preferredPayloadType),r.rtcpFeedback&&r.rtcpFeedback.length&&r.rtcpFeedback.forEach(function(l){i+="a=rtcp-fb:"+o+" "+l.type+(l.parameter&&l.parameter.length?" "+l.parameter:"")+`\r
`}),i},e.parseSsrcMedia=function(r){var i=r.indexOf(" "),o={ssrc:parseInt(r.substr(7,i-7),10)},l=r.indexOf(":",i);return l>-1?(o.attribute=r.substr(i+1,l-i-1),o.value=r.substr(l+1)):o.attribute=r.substr(i+1),o},e.parseSsrcGroup=function(r){var i=r.substr(13).split(" ");return{semantics:i.shift(),ssrcs:i.map(function(o){return parseInt(o,10)})}},e.getMid=function(r){var i=e.matchPrefix(r,"a=mid:")[0];if(i)return i.substr(6)},e.parseFingerprint=function(r){var i=r.substr(14).split(" ");return{algorithm:i[0].toLowerCase(),value:i[1]}},e.getDtlsParameters=function(r,i){var o=e.matchPrefix(r+i,"a=fingerprint:");return{role:"auto",fingerprints:o.map(e.parseFingerprint)}},e.writeDtlsParameters=function(r,i){var o="a=setup:"+i+`\r
`;return r.fingerprints.forEach(function(l){o+="a=fingerprint:"+l.algorithm+" "+l.value+`\r
`}),o},e.parseCryptoLine=function(r){var i=r.substr(9).split(" ");return{tag:parseInt(i[0],10),cryptoSuite:i[1],keyParams:i[2],sessionParams:i.slice(3)}},e.writeCryptoLine=function(r){return"a=crypto:"+r.tag+" "+r.cryptoSuite+" "+(typeof r.keyParams=="object"?e.writeCryptoKeyParams(r.keyParams):r.keyParams)+(r.sessionParams?" "+r.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(r){if(r.indexOf("inline:")!==0)return null;var i=r.substr(7).split("|");return{keyMethod:"inline",keySalt:i[0],lifeTime:i[1],mkiValue:i[2]?i[2].split(":")[0]:void 0,mkiLength:i[2]?i[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(r){return r.keyMethod+":"+r.keySalt+(r.lifeTime?"|"+r.lifeTime:"")+(r.mkiValue&&r.mkiLength?"|"+r.mkiValue+":"+r.mkiLength:"")},e.getCryptoParameters=function(r,i){var o=e.matchPrefix(r+i,"a=crypto:");return o.map(e.parseCryptoLine)},e.getIceParameters=function(r,i){var o=e.matchPrefix(r+i,"a=ice-ufrag:")[0],l=e.matchPrefix(r+i,"a=ice-pwd:")[0];return o&&l?{usernameFragment:o.substr(12),password:l.substr(10)}:null},e.writeIceParameters=function(r){return"a=ice-ufrag:"+r.usernameFragment+`\r
a=ice-pwd:`+r.password+`\r
`},e.parseRtpParameters=function(r){for(var i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=e.splitLines(r),l=o[0].split(" "),_=3;_<l.length;_++){var s=l[_],n=e.matchPrefix(r,"a=rtpmap:"+s+" ")[0];if(n){var a=e.parseRtpMap(n),h=e.matchPrefix(r,"a=fmtp:"+s+" ");switch(a.parameters=h.length?e.parseFmtp(h[0]):{},a.rtcpFeedback=e.matchPrefix(r,"a=rtcp-fb:"+s+" ").map(e.parseRtcpFb),i.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(a.name.toUpperCase());break}}}return e.matchPrefix(r,"a=extmap:").forEach(function(u){i.headerExtensions.push(e.parseExtmap(u))}),i},e.writeRtpDescription=function(r,i){var o="";o+="m="+r+" ",o+=i.codecs.length>0?"9":"0",o+=" UDP/TLS/RTP/SAVPF ",o+=i.codecs.map(function(_){return _.preferredPayloadType!==void 0?_.preferredPayloadType:_.payloadType}).join(" ")+`\r
`,o+=`c=IN IP4 0.0.0.0\r
`,o+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,i.codecs.forEach(function(_){o+=e.writeRtpMap(_),o+=e.writeFmtp(_),o+=e.writeRtcpFb(_)});var l=0;return i.codecs.forEach(function(_){_.maxptime>l&&(l=_.maxptime)}),l>0&&(o+="a=maxptime:"+l+`\r
`),o+=`a=rtcp-mux\r
`,i.headerExtensions&&i.headerExtensions.forEach(function(_){o+=e.writeExtmap(_)}),o},e.parseRtpEncodingParameters=function(r){var i=[],o=e.parseRtpParameters(r),l=o.fecMechanisms.indexOf("RED")!==-1,_=o.fecMechanisms.indexOf("ULPFEC")!==-1,s=e.matchPrefix(r,"a=ssrc:").map(function(g){return e.parseSsrcMedia(g)}).filter(function(g){return g.attribute==="cname"}),n=s.length>0&&s[0].ssrc,a,h=e.matchPrefix(r,"a=ssrc-group:FID").map(function(g){var C=g.substr(17).split(" ");return C.map(function(b){return parseInt(b,10)})});h.length>0&&h[0].length>1&&h[0][0]===n&&(a=h[0][1]),o.codecs.forEach(function(g){if(g.name.toUpperCase()==="RTX"&&g.parameters.apt){var C={ssrc:n,codecPayloadType:parseInt(g.parameters.apt,10)};n&&a&&(C.rtx={ssrc:a}),i.push(C),l&&(C=JSON.parse(JSON.stringify(C)),C.fec={ssrc:n,mechanism:_?"red+ulpfec":"red"},i.push(C))}}),i.length===0&&n&&i.push({ssrc:n});var u=e.matchPrefix(r,"b=");return u.length&&(u[0].indexOf("b=TIAS:")===0?u=parseInt(u[0].substr(7),10):u[0].indexOf("b=AS:")===0?u=parseInt(u[0].substr(5),10)*1e3*.95-50*40*8:u=void 0,i.forEach(function(g){g.maxBitrate=u})),i},e.parseRtcpParameters=function(r){var i={},o=e.matchPrefix(r,"a=ssrc:").map(function(s){return e.parseSsrcMedia(s)}).filter(function(s){return s.attribute==="cname"})[0];o&&(i.cname=o.value,i.ssrc=o.ssrc);var l=e.matchPrefix(r,"a=rtcp-rsize");i.reducedSize=l.length>0,i.compound=l.length===0;var _=e.matchPrefix(r,"a=rtcp-mux");return i.mux=_.length>0,i},e.parseMsid=function(r){var i,o=e.matchPrefix(r,"a=msid:");if(o.length===1)return i=o[0].substr(7).split(" "),{stream:i[0],track:i[1]};var l=e.matchPrefix(r,"a=ssrc:").map(function(_){return e.parseSsrcMedia(_)}).filter(function(_){return _.attribute==="msid"});if(l.length>0)return i=l[0].value.split(" "),{stream:i[0],track:i[1]}},e.parseSctpDescription=function(r){var i=e.parseMLine(r),o=e.matchPrefix(r,"a=max-message-size:"),l;o.length>0&&(l=parseInt(o[0].substr(19),10)),isNaN(l)&&(l=65536);var _=e.matchPrefix(r,"a=sctp-port:");if(_.length>0)return{port:parseInt(_[0].substr(12),10),protocol:i.fmt,maxMessageSize:l};var s=e.matchPrefix(r,"a=sctpmap:");if(s.length>0){var n=e.matchPrefix(r,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(n[0],10),protocol:n[1],maxMessageSize:l}}},e.writeSctpDescription=function(r,i){var o=[];return r.protocol!=="DTLS/SCTP"?o=["m="+r.kind+" 9 "+r.protocol+" "+i.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+i.port+`\r
`]:o=["m="+r.kind+" 9 "+r.protocol+" "+i.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+i.port+" "+i.protocol+` 65535\r
`],i.maxMessageSize!==void 0&&o.push("a=max-message-size:"+i.maxMessageSize+`\r
`),o.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,21)},e.writeSessionBoilerplate=function(r,i,o){var l,_=i!==void 0?i:2;r?l=r:l=e.generateSessionId();var s=o||"thisisadapterortc";return`v=0\r
o=`+s+" "+l+" "+_+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.writeMediaSection=function(r,i,o,l){var _=e.writeRtpDescription(r.kind,i);if(_+=e.writeIceParameters(r.iceGatherer.getLocalParameters()),_+=e.writeDtlsParameters(r.dtlsTransport.getLocalParameters(),o==="offer"?"actpass":"active"),_+="a=mid:"+r.mid+`\r
`,r.direction?_+="a="+r.direction+`\r
`:r.rtpSender&&r.rtpReceiver?_+=`a=sendrecv\r
`:r.rtpSender?_+=`a=sendonly\r
`:r.rtpReceiver?_+=`a=recvonly\r
`:_+=`a=inactive\r
`,r.rtpSender){var s="msid:"+l.id+" "+r.rtpSender.track.id+`\r
`;_+="a="+s,_+="a=ssrc:"+r.sendEncodingParameters[0].ssrc+" "+s,r.sendEncodingParameters[0].rtx&&(_+="a=ssrc:"+r.sendEncodingParameters[0].rtx.ssrc+" "+s,_+="a=ssrc-group:FID "+r.sendEncodingParameters[0].ssrc+" "+r.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return _+="a=ssrc:"+r.sendEncodingParameters[0].ssrc+" cname:"+e.localCName+`\r
`,r.rtpSender&&r.sendEncodingParameters[0].rtx&&(_+="a=ssrc:"+r.sendEncodingParameters[0].rtx.ssrc+" cname:"+e.localCName+`\r
`),_},e.getDirection=function(r,i){for(var o=e.splitLines(r),l=0;l<o.length;l++)switch(o[l]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return o[l].substr(2)}return i?e.getDirection(i):"sendrecv"},e.getKind=function(r){var i=e.splitLines(r),o=i[0].split(" ");return o[0].substr(2)},e.isRejected=function(r){return r.split(" ",2)[1]==="0"},e.parseMLine=function(r){var i=e.splitLines(r),o=i[0].substr(2).split(" ");return{kind:o[0],port:parseInt(o[1],10),protocol:o[2],fmt:o.slice(3).join(" ")}},e.parseOLine=function(r){var i=e.matchPrefix(r,"o=")[0],o=i.substr(2).split(" ");return{username:o[0],sessionId:o[1],sessionVersion:parseInt(o[2],10),netType:o[3],addressType:o[4],address:o[5]}},e.isValidSDP=function(r){if(typeof r!="string"||r.length===0)return!1;for(var i=e.splitLines(r),o=0;o<i.length;o++)if(i[o].length<2||i[o].charAt(1)!=="=")return!1;return!0},t.exports=e})(ba);var Ca=ba.exports;const qr=qs(Ca);var re=Ca;function nh(t){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type}function Wn(t,e,r,i,o){var l=re.writeRtpDescription(t.kind,e);if(l+=re.writeIceParameters(t.iceGatherer.getLocalParameters()),l+=re.writeDtlsParameters(t.dtlsTransport.getLocalParameters(),r==="offer"?"actpass":o||"active"),l+="a=mid:"+t.mid+`\r
`,t.rtpSender&&t.rtpReceiver?l+=`a=sendrecv\r
`:t.rtpSender?l+=`a=sendonly\r
`:t.rtpReceiver?l+=`a=recvonly\r
`:l+=`a=inactive\r
`,t.rtpSender){var _=t.rtpSender._initialTrackId||t.rtpSender.track.id;t.rtpSender._initialTrackId=_;var s="msid:"+(i?i.id:"-")+" "+_+`\r
`;l+="a="+s,l+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" "+s,t.sendEncodingParameters[0].rtx&&(l+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" "+s,l+="a=ssrc-group:FID "+t.sendEncodingParameters[0].ssrc+" "+t.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return l+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" cname:"+re.localCName+`\r
`,t.rtpSender&&t.sendEncodingParameters[0].rtx&&(l+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" cname:"+re.localCName+`\r
`),l}function oh(t,e){var r=!1;return t=JSON.parse(JSON.stringify(t)),t.filter(function(i){if(i&&(i.urls||i.url)){var o=i.urls||i.url;i.url&&!i.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var l=typeof o=="string";return l&&(o=[o]),o=o.filter(function(_){var s=_.indexOf("turn:")===0&&_.indexOf("transport=udp")!==-1&&_.indexOf("turn:[")===-1&&!r;return s?(r=!0,!0):_.indexOf("stun:")===0&&e>=14393&&_.indexOf("?transport=udp")===-1}),delete i.url,i.urls=l?o[0]:o,!!o.length}})}function Ir(t,e){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},i=function(l,_){l=parseInt(l,10);for(var s=0;s<_.length;s++)if(_[s].payloadType===l||_[s].preferredPayloadType===l)return _[s]},o=function(l,_,s,n){var a=i(l.parameters.apt,s),h=i(_.parameters.apt,n);return a&&h&&a.name.toLowerCase()===h.name.toLowerCase()};return t.codecs.forEach(function(l){for(var _=0;_<e.codecs.length;_++){var s=e.codecs[_];if(l.name.toLowerCase()===s.name.toLowerCase()&&l.clockRate===s.clockRate){if(l.name.toLowerCase()==="rtx"&&l.parameters&&s.parameters.apt&&!o(l,s,t.codecs,e.codecs))continue;s=JSON.parse(JSON.stringify(s)),s.numChannels=Math.min(l.numChannels,s.numChannels),r.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter(function(n){for(var a=0;a<l.rtcpFeedback.length;a++)if(l.rtcpFeedback[a].type===n.type&&l.rtcpFeedback[a].parameter===n.parameter)return!0;return!1});break}}}),t.headerExtensions.forEach(function(l){for(var _=0;_<e.headerExtensions.length;_++){var s=e.headerExtensions[_];if(l.uri===s.uri){r.headerExtensions.push(s);break}}}),r}function zn(t,e,r){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[e][t].indexOf(r)!==-1}function Ni(t,e){var r=t.getRemoteCandidates().find(function(i){return e.foundation===i.foundation&&e.ip===i.ip&&e.port===i.port&&e.priority===i.priority&&e.protocol===i.protocol&&e.type===i.type});return r||t.addRemoteCandidate(e),!r}function ye(t,e){var r=new Error(e);return r.name=t,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[t],r}var ah=function(t,e){function r(n,a){a.addTrack(n),a.dispatchEvent(new t.MediaStreamTrackEvent("addtrack",{track:n}))}function i(n,a){a.removeTrack(n),a.dispatchEvent(new t.MediaStreamTrackEvent("removetrack",{track:n}))}function o(n,a,h,u){var g=new Event("track");g.track=a,g.receiver=h,g.transceiver={receiver:h},g.streams=u,t.setTimeout(function(){n._dispatchEvent("track",g)})}var l=function(n){var a=this,h=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(g){a[g]=h[g].bind(h)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle=n.bundlePolicy==="max-bundle",n.rtcpMuxPolicy==="negotiate")throw ye("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all";break}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced";break}if(n.iceServers=oh(n.iceServers||[],e),this._iceGatherers=[],n.iceCandidatePoolSize)for(var u=n.iceCandidatePoolSize;u>0;u--)this._iceGatherers.push(new t.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=re.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(n,a){this._isClosed||(this.dispatchEvent(a),typeof this["on"+n]=="function"&&this["on"+n](a))},l.prototype._emitGatheringStateChange=function(){var n=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",n)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(n,a){var h=this.transceivers.length>0,u={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:n,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&h)u.iceTransport=this.transceivers[0].iceTransport,u.dtlsTransport=this.transceivers[0].dtlsTransport;else{var g=this._createIceAndDtlsTransports();u.iceTransport=g.iceTransport,u.dtlsTransport=g.dtlsTransport}return a||this.transceivers.push(u),u},l.prototype.addTrack=function(n,a){if(this._isClosed)throw ye("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var h=this.transceivers.find(function(C){return C.track===n});if(h)throw ye("InvalidAccessError","Track already exists.");for(var u,g=0;g<this.transceivers.length;g++)!this.transceivers[g].track&&this.transceivers[g].kind===n.kind&&(u=this.transceivers[g]);return u||(u=this._createTransceiver(n.kind)),this._maybeFireNegotiationNeeded(),this.localStreams.indexOf(a)===-1&&this.localStreams.push(a),u.track=n,u.stream=a,u.rtpSender=new t.RTCRtpSender(n,u.dtlsTransport),u.rtpSender},l.prototype.addStream=function(n){var a=this;if(e>=15025)n.getTracks().forEach(function(u){a.addTrack(u,n)});else{var h=n.clone();n.getTracks().forEach(function(u,g){var C=h.getTracks()[g];u.addEventListener("enabled",function(b){C.enabled=b.enabled})}),h.getTracks().forEach(function(u){a.addTrack(u,h)})}},l.prototype.removeTrack=function(n){if(this._isClosed)throw ye("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(n instanceof t.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var a=this.transceivers.find(function(g){return g.rtpSender===n});if(!a)throw ye("InvalidAccessError","Sender was not created by this connection.");var h=a.stream;a.rtpSender.stop(),a.rtpSender=null,a.track=null,a.stream=null;var u=this.transceivers.map(function(g){return g.stream});u.indexOf(h)===-1&&this.localStreams.indexOf(h)>-1&&this.localStreams.splice(this.localStreams.indexOf(h),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(n){var a=this;n.getTracks().forEach(function(h){var u=a.getSenders().find(function(g){return g.track===h});u&&a.removeTrack(u)})},l.prototype.getSenders=function(){return this.transceivers.filter(function(n){return!!n.rtpSender}).map(function(n){return n.rtpSender})},l.prototype.getReceivers=function(){return this.transceivers.filter(function(n){return!!n.rtpReceiver}).map(function(n){return n.rtpReceiver})},l.prototype._createIceGatherer=function(n,a){var h=this;if(a&&n>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var u=new t.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(u,"state",{value:"new",writable:!0}),this.transceivers[n].bufferedCandidateEvents=[],this.transceivers[n].bufferCandidates=function(g){var C=!g.candidate||Object.keys(g.candidate).length===0;u.state=C?"completed":"gathering",h.transceivers[n].bufferedCandidateEvents!==null&&h.transceivers[n].bufferedCandidateEvents.push(g)},u.addEventListener("localcandidate",this.transceivers[n].bufferCandidates),u},l.prototype._gather=function(n,a){var h=this,u=this.transceivers[a].iceGatherer;if(!u.onlocalcandidate){var g=this.transceivers[a].bufferedCandidateEvents;this.transceivers[a].bufferedCandidateEvents=null,u.removeEventListener("localcandidate",this.transceivers[a].bufferCandidates),u.onlocalcandidate=function(C){if(!(h.usingBundle&&a>0)){var b=new Event("icecandidate");b.candidate={sdpMid:n,sdpMLineIndex:a};var m=C.candidate,c=!m||Object.keys(m).length===0;if(c)(u.state==="new"||u.state==="gathering")&&(u.state="completed");else{u.state==="new"&&(u.state="gathering"),m.component=1,m.ufrag=u.getLocalParameters().usernameFragment;var p=re.writeCandidate(m);b.candidate=Object.assign(b.candidate,re.parseCandidate(p)),b.candidate.candidate=p,b.candidate.toJSON=function(){return{candidate:b.candidate.candidate,sdpMid:b.candidate.sdpMid,sdpMLineIndex:b.candidate.sdpMLineIndex,usernameFragment:b.candidate.usernameFragment}}}var f=re.getMediaSections(h._localDescription.sdp);c?f[b.candidate.sdpMLineIndex]+=`a=end-of-candidates\r
`:f[b.candidate.sdpMLineIndex]+="a="+b.candidate.candidate+`\r
`,h._localDescription.sdp=re.getDescription(h._localDescription.sdp)+f.join("");var d=h.transceivers.every(function(v){return v.iceGatherer&&v.iceGatherer.state==="completed"});h.iceGatheringState!=="gathering"&&(h.iceGatheringState="gathering",h._emitGatheringStateChange()),c||h._dispatchEvent("icecandidate",b),d&&(h._dispatchEvent("icecandidate",new Event("icecandidate")),h.iceGatheringState="complete",h._emitGatheringStateChange())}},t.setTimeout(function(){g.forEach(function(C){u.onlocalcandidate(C)})},0)}},l.prototype._createIceAndDtlsTransports=function(){var n=this,a=new t.RTCIceTransport(null);a.onicestatechange=function(){n._updateIceConnectionState(),n._updateConnectionState()};var h=new t.RTCDtlsTransport(a);return h.ondtlsstatechange=function(){n._updateConnectionState()},h.onerror=function(){Object.defineProperty(h,"state",{value:"failed",writable:!0}),n._updateConnectionState()},{iceTransport:a,dtlsTransport:h}},l.prototype._disposeIceAndDtlsTransports=function(n){var a=this.transceivers[n].iceGatherer;a&&(delete a.onlocalcandidate,delete this.transceivers[n].iceGatherer);var h=this.transceivers[n].iceTransport;h&&(delete h.onicestatechange,delete this.transceivers[n].iceTransport);var u=this.transceivers[n].dtlsTransport;u&&(delete u.ondtlsstatechange,delete u.onerror,delete this.transceivers[n].dtlsTransport)},l.prototype._transceive=function(n,a,h){var u=Ir(n.localCapabilities,n.remoteCapabilities);a&&n.rtpSender&&(u.encodings=n.sendEncodingParameters,u.rtcp={cname:re.localCName,compound:n.rtcpParameters.compound},n.recvEncodingParameters.length&&(u.rtcp.ssrc=n.recvEncodingParameters[0].ssrc),n.rtpSender.send(u)),h&&n.rtpReceiver&&u.codecs.length>0&&(n.kind==="video"&&n.recvEncodingParameters&&e<15019&&n.recvEncodingParameters.forEach(function(g){delete g.rtx}),n.recvEncodingParameters.length?u.encodings=n.recvEncodingParameters:u.encodings=[{}],u.rtcp={compound:n.rtcpParameters.compound},n.rtcpParameters.cname&&(u.rtcp.cname=n.rtcpParameters.cname),n.sendEncodingParameters.length&&(u.rtcp.ssrc=n.sendEncodingParameters[0].ssrc),n.rtpReceiver.receive(u))},l.prototype.setLocalDescription=function(n){var a=this;if(["offer","answer"].indexOf(n.type)===-1)return Promise.reject(ye("TypeError",'Unsupported type "'+n.type+'"'));if(!zn("setLocalDescription",n.type,a.signalingState)||a._isClosed)return Promise.reject(ye("InvalidStateError","Can not set local "+n.type+" in state "+a.signalingState));var h,u;if(n.type==="offer")h=re.splitSections(n.sdp),u=h.shift(),h.forEach(function(C,b){var m=re.parseRtpParameters(C);a.transceivers[b].localCapabilities=m}),a.transceivers.forEach(function(C,b){a._gather(C.mid,b)});else if(n.type==="answer"){h=re.splitSections(a._remoteDescription.sdp),u=h.shift();var g=re.matchPrefix(u,"a=ice-lite").length>0;h.forEach(function(C,b){var m=a.transceivers[b],c=m.iceGatherer,p=m.iceTransport,f=m.dtlsTransport,d=m.localCapabilities,v=m.remoteCapabilities,y=re.isRejected(C)&&re.matchPrefix(C,"a=bundle-only").length===0;if(!y&&!m.rejected){var E=re.getIceParameters(C,u),T=re.getDtlsParameters(C,u);g&&(T.role="server"),(!a.usingBundle||b===0)&&(a._gather(m.mid,b),p.state==="new"&&p.start(c,E,g?"controlling":"controlled"),f.state==="new"&&f.start(T));var S=Ir(d,v);a._transceive(m,S.codecs.length>0,!1)}})}return a._localDescription={type:n.type,sdp:n.sdp},n.type==="offer"?a._updateSignalingState("have-local-offer"):a._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(n){var a=this;if(["offer","answer"].indexOf(n.type)===-1)return Promise.reject(ye("TypeError",'Unsupported type "'+n.type+'"'));if(!zn("setRemoteDescription",n.type,a.signalingState)||a._isClosed)return Promise.reject(ye("InvalidStateError","Can not set remote "+n.type+" in state "+a.signalingState));var h={};a.remoteStreams.forEach(function(p){h[p.id]=p});var u=[],g=re.splitSections(n.sdp),C=g.shift(),b=re.matchPrefix(C,"a=ice-lite").length>0,m=re.matchPrefix(C,"a=group:BUNDLE ").length>0;a.usingBundle=m;var c=re.matchPrefix(C,"a=ice-options:")[0];return c?a.canTrickleIceCandidates=c.substr(14).split(" ").indexOf("trickle")>=0:a.canTrickleIceCandidates=!1,g.forEach(function(p,f){var d=re.splitLines(p),v=re.getKind(p),y=re.isRejected(p)&&re.matchPrefix(p,"a=bundle-only").length===0,E=d[0].substr(2).split(" ")[2],T=re.getDirection(p,C),S=re.parseMsid(p),w=re.getMid(p)||re.generateIdentifier();if(y||v==="application"&&(E==="DTLS/SCTP"||E==="UDP/DTLS/SCTP")){a.transceivers[f]={mid:w,kind:v,protocol:E,rejected:!0};return}!y&&a.transceivers[f]&&a.transceivers[f].rejected&&(a.transceivers[f]=a._createTransceiver(v,!0));var A,D,R,x,F,G,U,k,L,O=re.parseRtpParameters(p),I,H;y||(I=re.getIceParameters(p,C),H=re.getDtlsParameters(p,C),H.role="client"),U=re.parseRtpEncodingParameters(p);var X=re.parseRtcpParameters(p),Q=re.matchPrefix(p,"a=end-of-candidates",C).length>0,W=re.matchPrefix(p,"a=candidate:").map(function(j){return re.parseCandidate(j)}).filter(function(j){return j.component===1});if((n.type==="offer"||n.type==="answer")&&!y&&m&&f>0&&a.transceivers[f]&&(a._disposeIceAndDtlsTransports(f),a.transceivers[f].iceGatherer=a.transceivers[0].iceGatherer,a.transceivers[f].iceTransport=a.transceivers[0].iceTransport,a.transceivers[f].dtlsTransport=a.transceivers[0].dtlsTransport,a.transceivers[f].rtpSender&&a.transceivers[f].rtpSender.setTransport(a.transceivers[0].dtlsTransport),a.transceivers[f].rtpReceiver&&a.transceivers[f].rtpReceiver.setTransport(a.transceivers[0].dtlsTransport)),n.type==="offer"&&!y){A=a.transceivers[f]||a._createTransceiver(v),A.mid=w,A.iceGatherer||(A.iceGatherer=a._createIceGatherer(f,m)),W.length&&A.iceTransport.state==="new"&&(Q&&(!m||f===0)?A.iceTransport.setRemoteCandidates(W):W.forEach(function(j){Ni(A.iceTransport,j)})),k=t.RTCRtpReceiver.getCapabilities(v),e<15019&&(k.codecs=k.codecs.filter(function(j){return j.name!=="rtx"})),G=A.sendEncodingParameters||[{ssrc:(2*f+2)*1001}];var q=!1;if(T==="sendrecv"||T==="sendonly"){if(q=!A.rtpReceiver,F=A.rtpReceiver||new t.RTCRtpReceiver(A.dtlsTransport,v),q){var M;L=F.track,S&&S.stream==="-"||(S?(h[S.stream]||(h[S.stream]=new t.MediaStream,Object.defineProperty(h[S.stream],"id",{get:function(){return S.stream}})),Object.defineProperty(L,"id",{get:function(){return S.track}}),M=h[S.stream]):(h.default||(h.default=new t.MediaStream),M=h.default)),M&&(r(L,M),A.associatedRemoteMediaStreams.push(M)),u.push([L,F,M])}}else A.rtpReceiver&&A.rtpReceiver.track&&(A.associatedRemoteMediaStreams.forEach(function(j){var K=j.getTracks().find(function(se){return se.id===A.rtpReceiver.track.id});K&&i(K,j)}),A.associatedRemoteMediaStreams=[]);A.localCapabilities=k,A.remoteCapabilities=O,A.rtpReceiver=F,A.rtcpParameters=X,A.sendEncodingParameters=G,A.recvEncodingParameters=U,a._transceive(a.transceivers[f],!1,q)}else if(n.type==="answer"&&!y){A=a.transceivers[f],D=A.iceGatherer,R=A.iceTransport,x=A.dtlsTransport,F=A.rtpReceiver,G=A.sendEncodingParameters,k=A.localCapabilities,a.transceivers[f].recvEncodingParameters=U,a.transceivers[f].remoteCapabilities=O,a.transceivers[f].rtcpParameters=X,W.length&&R.state==="new"&&((b||Q)&&(!m||f===0)?R.setRemoteCandidates(W):W.forEach(function(j){Ni(A.iceTransport,j)})),(!m||f===0)&&(R.state==="new"&&R.start(D,I,"controlling"),x.state==="new"&&x.start(H));var P=Ir(A.localCapabilities,A.remoteCapabilities),N=P.codecs.filter(function(j){return j.name.toLowerCase()==="rtx"}).length;!N&&A.sendEncodingParameters[0].rtx&&delete A.sendEncodingParameters[0].rtx,a._transceive(A,T==="sendrecv"||T==="recvonly",T==="sendrecv"||T==="sendonly"),F&&(T==="sendrecv"||T==="sendonly")?(L=F.track,S?(h[S.stream]||(h[S.stream]=new t.MediaStream),r(L,h[S.stream]),u.push([L,F,h[S.stream]])):(h.default||(h.default=new t.MediaStream),r(L,h.default),u.push([L,F,h.default]))):delete A.rtpReceiver}}),a._dtlsRole===void 0&&(a._dtlsRole=n.type==="offer"?"active":"passive"),a._remoteDescription={type:n.type,sdp:n.sdp},n.type==="offer"?a._updateSignalingState("have-remote-offer"):a._updateSignalingState("stable"),Object.keys(h).forEach(function(p){var f=h[p];if(f.getTracks().length){if(a.remoteStreams.indexOf(f)===-1){a.remoteStreams.push(f);var d=new Event("addstream");d.stream=f,t.setTimeout(function(){a._dispatchEvent("addstream",d)})}u.forEach(function(v){var y=v[0],E=v[1];f.id===v[2].id&&o(a,y,E,[f])})}}),u.forEach(function(p){p[2]||o(a,p[0],p[1],[])}),t.setTimeout(function(){a&&a.transceivers&&a.transceivers.forEach(function(p){p.iceTransport&&p.iceTransport.state==="new"&&p.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),p.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach(function(n){n.iceTransport&&n.iceTransport.stop(),n.dtlsTransport&&n.dtlsTransport.stop(),n.rtpSender&&n.rtpSender.stop(),n.rtpReceiver&&n.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(n){this.signalingState=n;var a=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",a)},l.prototype._maybeFireNegotiationNeeded=function(){var n=this;this.signalingState!=="stable"||this.needNegotiation===!0||(this.needNegotiation=!0,t.setTimeout(function(){if(n.needNegotiation){n.needNegotiation=!1;var a=new Event("negotiationneeded");n._dispatchEvent("negotiationneeded",a)}},0))},l.prototype._updateIceConnectionState=function(){var n,a={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(u){u.iceTransport&&!u.rejected&&a[u.iceTransport.state]++}),n="new",a.failed>0?n="failed":a.checking>0?n="checking":a.disconnected>0?n="disconnected":a.new>0?n="new":a.connected>0?n="connected":a.completed>0&&(n="completed"),n!==this.iceConnectionState){this.iceConnectionState=n;var h=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",h)}},l.prototype._updateConnectionState=function(){var n,a={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(u){u.iceTransport&&u.dtlsTransport&&!u.rejected&&(a[u.iceTransport.state]++,a[u.dtlsTransport.state]++)}),a.connected+=a.completed,n="new",a.failed>0?n="failed":a.connecting>0?n="connecting":a.disconnected>0?n="disconnected":a.new>0?n="new":a.connected>0&&(n="connected"),n!==this.connectionState){this.connectionState=n;var h=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",h)}},l.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(ye("InvalidStateError","Can not call createOffer after close"));var a=n.transceivers.filter(function(b){return b.kind==="audio"}).length,h=n.transceivers.filter(function(b){return b.kind==="video"}).length,u=arguments[0];if(u){if(u.mandatory||u.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");u.offerToReceiveAudio!==void 0&&(u.offerToReceiveAudio===!0?a=1:u.offerToReceiveAudio===!1?a=0:a=u.offerToReceiveAudio),u.offerToReceiveVideo!==void 0&&(u.offerToReceiveVideo===!0?h=1:u.offerToReceiveVideo===!1?h=0:h=u.offerToReceiveVideo)}for(n.transceivers.forEach(function(b){b.kind==="audio"?(a--,a<0&&(b.wantReceive=!1)):b.kind==="video"&&(h--,h<0&&(b.wantReceive=!1))});a>0||h>0;)a>0&&(n._createTransceiver("audio"),a--),h>0&&(n._createTransceiver("video"),h--);var g=re.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach(function(b,m){var c=b.track,p=b.kind,f=b.mid||re.generateIdentifier();b.mid=f,b.iceGatherer||(b.iceGatherer=n._createIceGatherer(m,n.usingBundle));var d=t.RTCRtpSender.getCapabilities(p);e<15019&&(d.codecs=d.codecs.filter(function(y){return y.name!=="rtx"})),d.codecs.forEach(function(y){y.name==="H264"&&y.parameters["level-asymmetry-allowed"]===void 0&&(y.parameters["level-asymmetry-allowed"]="1"),b.remoteCapabilities&&b.remoteCapabilities.codecs&&b.remoteCapabilities.codecs.forEach(function(E){y.name.toLowerCase()===E.name.toLowerCase()&&y.clockRate===E.clockRate&&(y.preferredPayloadType=E.payloadType)})}),d.headerExtensions.forEach(function(y){var E=b.remoteCapabilities&&b.remoteCapabilities.headerExtensions||[];E.forEach(function(T){y.uri===T.uri&&(y.id=T.id)})});var v=b.sendEncodingParameters||[{ssrc:(2*m+1)*1001}];c&&e>=15019&&p==="video"&&!v[0].rtx&&(v[0].rtx={ssrc:v[0].ssrc+1}),b.wantReceive&&(b.rtpReceiver=new t.RTCRtpReceiver(b.dtlsTransport,p)),b.localCapabilities=d,b.sendEncodingParameters=v}),n._config.bundlePolicy!=="max-compat"&&(g+="a=group:BUNDLE "+n.transceivers.map(function(b){return b.mid}).join(" ")+`\r
`),g+=`a=ice-options:trickle\r
`,n.transceivers.forEach(function(b,m){g+=Wn(b,b.localCapabilities,"offer",b.stream,n._dtlsRole),g+=`a=rtcp-rsize\r
`,b.iceGatherer&&n.iceGatheringState!=="new"&&(m===0||!n.usingBundle)&&(b.iceGatherer.getLocalCandidates().forEach(function(c){c.component=1,g+="a="+re.writeCandidate(c)+`\r
`}),b.iceGatherer.state==="completed"&&(g+=`a=end-of-candidates\r
`))});var C=new t.RTCSessionDescription({type:"offer",sdp:g});return Promise.resolve(C)},l.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(ye("InvalidStateError","Can not call createAnswer after close"));if(!(n.signalingState==="have-remote-offer"||n.signalingState==="have-local-pranswer"))return Promise.reject(ye("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var a=re.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(a+="a=group:BUNDLE "+n.transceivers.map(function(g){return g.mid}).join(" ")+`\r
`),a+=`a=ice-options:trickle\r
`;var h=re.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach(function(g,C){if(!(C+1>h)){if(g.rejected){g.kind==="application"?g.protocol==="DTLS/SCTP"?a+=`m=application 0 DTLS/SCTP 5000\r
`:a+="m=application 0 "+g.protocol+` webrtc-datachannel\r
`:g.kind==="audio"?a+=`m=audio 0 UDP/TLS/RTP/SAVPF 0\r
a=rtpmap:0 PCMU/8000\r
`:g.kind==="video"&&(a+=`m=video 0 UDP/TLS/RTP/SAVPF 120\r
a=rtpmap:120 VP8/90000\r
`),a+=`c=IN IP4 0.0.0.0\r
a=inactive\r
a=mid:`+g.mid+`\r
`;return}if(g.stream){var b;g.kind==="audio"?b=g.stream.getAudioTracks()[0]:g.kind==="video"&&(b=g.stream.getVideoTracks()[0]),b&&e>=15019&&g.kind==="video"&&!g.sendEncodingParameters[0].rtx&&(g.sendEncodingParameters[0].rtx={ssrc:g.sendEncodingParameters[0].ssrc+1})}var m=Ir(g.localCapabilities,g.remoteCapabilities),c=m.codecs.filter(function(p){return p.name.toLowerCase()==="rtx"}).length;!c&&g.sendEncodingParameters[0].rtx&&delete g.sendEncodingParameters[0].rtx,a+=Wn(g,m,"answer",g.stream,n._dtlsRole),g.rtcpParameters&&g.rtcpParameters.reducedSize&&(a+=`a=rtcp-rsize\r
`)}});var u=new t.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(u)},l.prototype.addIceCandidate=function(n){var a=this,h;return n&&!(n.sdpMLineIndex!==void 0||n.sdpMid)?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(u,g){if(a._remoteDescription)if(!n||n.candidate==="")for(var C=0;C<a.transceivers.length&&!(!a.transceivers[C].rejected&&(a.transceivers[C].iceTransport.addRemoteCandidate({}),h=re.getMediaSections(a._remoteDescription.sdp),h[C]+=`a=end-of-candidates\r
`,a._remoteDescription.sdp=re.getDescription(a._remoteDescription.sdp)+h.join(""),a.usingBundle));C++);else{var b=n.sdpMLineIndex;if(n.sdpMid){for(var m=0;m<a.transceivers.length;m++)if(a.transceivers[m].mid===n.sdpMid){b=m;break}}var c=a.transceivers[b];if(c){if(c.rejected)return u();var p=Object.keys(n.candidate).length>0?re.parseCandidate(n.candidate):{};if(p.protocol==="tcp"&&(p.port===0||p.port===9)||p.component&&p.component!==1)return u();if((b===0||b>0&&c.iceTransport!==a.transceivers[0].iceTransport)&&!Ni(c.iceTransport,p))return g(ye("OperationError","Can not add ICE candidate"));var f=n.candidate.trim();f.indexOf("a=")===0&&(f=f.substr(2)),h=re.getMediaSections(a._remoteDescription.sdp),h[b]+="a="+(p.type?f:"end-of-candidates")+`\r
`,a._remoteDescription.sdp=re.getDescription(a._remoteDescription.sdp)+h.join("")}else return g(ye("OperationError","Can not add ICE candidate"))}else return g(ye("InvalidStateError","Can not add ICE candidate without a remote description"));u()})},l.prototype.getStats=function(n){if(n&&n instanceof t.MediaStreamTrack){var a=null;if(this.transceivers.forEach(function(u){u.rtpSender&&u.rtpSender.track===n?a=u.rtpSender:u.rtpReceiver&&u.rtpReceiver.track===n&&(a=u.rtpReceiver)}),!a)throw ye("InvalidAccessError","Invalid selector.");return a.getStats()}var h=[];return this.transceivers.forEach(function(u){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(g){u[g]&&h.push(u[g].getStats())})}),Promise.all(h).then(function(u){var g=new Map;return u.forEach(function(C){C.forEach(function(b){g.set(b.id,b)})}),g})};var _=["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"];_.forEach(function(n){var a=t[n];if(a&&a.prototype&&a.prototype.getStats){var h=a.prototype.getStats;a.prototype.getStats=function(){return h.apply(this).then(function(u){var g=new Map;return Object.keys(u).forEach(function(C){u[C].type=nh(u[C]),g.set(C,u[C])}),g})}}});var s=["createOffer","createAnswer"];return s.forEach(function(n){var a=l.prototype[n];l.prototype[n]=function(){var h=arguments;return typeof h[0]=="function"||typeof h[1]=="function"?a.apply(this,[arguments[2]]).then(function(u){typeof h[0]=="function"&&h[0].apply(null,[u])},function(u){typeof h[1]=="function"&&h[1].apply(null,[u])}):a.apply(this,arguments)}}),s=["setLocalDescription","setRemoteDescription","addIceCandidate"],s.forEach(function(n){var a=l.prototype[n];l.prototype[n]=function(){var h=arguments;return typeof h[1]=="function"||typeof h[2]=="function"?a.apply(this,arguments).then(function(){typeof h[1]=="function"&&h[1].apply(null)},function(u){typeof h[2]=="function"&&h[2].apply(null,[u])}):a.apply(this,arguments)}}),["getStats"].forEach(function(n){var a=l.prototype[n];l.prototype[n]=function(){var h=arguments;return typeof h[1]=="function"?a.apply(this,arguments).then(function(){typeof h[1]=="function"&&h[1].apply(null)}):a.apply(this,arguments)}}),l};const ch=qs(ah);function Ea(t){const e=t&&t.navigator,r=function(o){return{name:{PermissionDeniedError:"NotAllowedError"}[o.name]||o.name,message:o.message,constraint:o.constraint,toString(){return this.name}}},i=e.mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(o){return i(o).catch(l=>Promise.reject(r(l)))}}function Ta(t){"getDisplayMedia"in t.navigator&&t.navigator.mediaDevices&&(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||(t.navigator.mediaDevices.getDisplayMedia=t.navigator.getDisplayMedia.bind(t.navigator)))}function ds(t,e){if(t.RTCIceGatherer&&(t.RTCIceCandidate||(t.RTCIceCandidate=function(o){return o}),t.RTCSessionDescription||(t.RTCSessionDescription=function(o){return o}),e.version<15025)){const i=Object.getOwnPropertyDescriptor(t.MediaStreamTrack.prototype,"enabled");Object.defineProperty(t.MediaStreamTrack.prototype,"enabled",{set(o){i.set.call(this,o);const l=new Event("enabled");l.enabled=o,this.dispatchEvent(l)}})}t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)&&Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=new t.RTCDtmfSender(this):this.track.kind==="video"&&(this._dtmf=null)),this._dtmf}}),t.RTCDtmfSender&&!t.RTCDTMFSender&&(t.RTCDTMFSender=t.RTCDtmfSender);const r=ch(t,e.version);t.RTCPeerConnection=function(o){return o&&o.iceServers&&(o.iceServers=sh(o.iceServers,e.version),Ys("ICE servers after filtering:",o.iceServers)),new r(o)},t.RTCPeerConnection.prototype=r.prototype}function wa(t){t.RTCRtpSender&&!("replaceTrack"in t.RTCRtpSender.prototype)&&(t.RTCRtpSender.prototype.replaceTrack=t.RTCRtpSender.prototype.setTrack)}const Vn=Object.freeze(Object.defineProperty({__proto__:null,shimGetDisplayMedia:Ta,shimGetUserMedia:Ea,shimPeerConnection:ds,shimReplaceTrack:wa},Symbol.toStringTag,{value:"Module"}));function ka(t,e){const r=t&&t.navigator,i=t&&t.MediaStreamTrack;if(r.getUserMedia=function(o,l,_){mi("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(o).then(l,_)},!(e.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){const o=function(_,s,n){s in _&&!(n in _)&&(_[n]=_[s],delete _[s])},l=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(_){return typeof _=="object"&&typeof _.audio=="object"&&(_=JSON.parse(JSON.stringify(_)),o(_.audio,"autoGainControl","mozAutoGainControl"),o(_.audio,"noiseSuppression","mozNoiseSuppression")),l(_)},i&&i.prototype.getSettings){const _=i.prototype.getSettings;i.prototype.getSettings=function(){const s=_.apply(this,arguments);return o(s,"mozAutoGainControl","autoGainControl"),o(s,"mozNoiseSuppression","noiseSuppression"),s}}if(i&&i.prototype.applyConstraints){const _=i.prototype.applyConstraints;i.prototype.applyConstraints=function(s){return this.kind==="audio"&&typeof s=="object"&&(s=JSON.parse(JSON.stringify(s)),o(s,"autoGainControl","mozAutoGainControl"),o(s,"noiseSuppression","mozNoiseSuppression")),_.apply(this,[s])}}}}function lh(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(i){if(!(i&&i.video)){const o=new DOMException("getDisplayMedia without video constraints is undefined");return o.name="NotFoundError",o.code=8,Promise.reject(o)}return i.video===!0?i.video={mediaSource:e}:i.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(i)})}function Aa(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function fs(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(o){const l=t.RTCPeerConnection.prototype[o],_={[o](){return arguments[0]=new(o==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),l.apply(this,arguments)}};t.RTCPeerConnection.prototype[o]=_[o]});const r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[l,_,s]=arguments;return i.apply(this,[l||null]).then(n=>{if(e.version<53&&!_)try{n.forEach(a=>{a.type=r[a.type]||a.type})}catch(a){if(a.name!=="TypeError")throw a;n.forEach((h,u)=>{n.set(u,Object.assign({},h,{type:r[h.type]||h.type}))})}return n}).then(_,s)}}function Ra(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const o=e.apply(this,[]);return o.forEach(l=>l._pc=this),o});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const o=r.apply(this,arguments);return o._pc=this,o}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Da(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=e.apply(this,[]);return i.forEach(o=>o._pc=this),i}),Xt(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function La(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(r){mi("removeStream","removeTrack"),this.getSenders().forEach(i=>{i.track&&r.getTracks().includes(i.track)&&this.removeTrack(i)})})}function Oa(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function xa(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const i=arguments[1],o=i&&"sendEncodings"in i;o&&i.sendEncodings.forEach(_=>{if("rid"in _&&!/^[a-z0-9]{0,16}$/i.test(_.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in _&&!(parseFloat(_.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in _&&!(parseFloat(_.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const l=e.apply(this,arguments);if(o){const{sender:_}=l,s=_.getParameters();(!("encodings"in s)||s.encodings.length===1&&Object.keys(s.encodings[0]).length===0)&&(s.encodings=i.sendEncodings,_.sendEncodings=i.sendEncodings,this.setParametersPromises.push(_.setParameters(s).then(()=>{delete _.sendEncodings}).catch(()=>{delete _.sendEncodings})))}return l})}function Pa(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const i=e.apply(this,arguments);return"encodings"in i||(i.encodings=[].concat(this.sendEncodings||[{}])),i})}function Ma(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function Ia(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const Kn=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:xa,shimCreateAnswer:Ia,shimCreateOffer:Ma,shimGetDisplayMedia:lh,shimGetParameters:Pa,shimGetUserMedia:ka,shimOnTrack:Aa,shimPeerConnection:fs,shimRTCDataChannel:Oa,shimReceiverGetStats:Da,shimRemoveStream:La,shimSenderGetStats:Ra},Symbol.toStringTag,{value:"Module"}));function Ba(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(i){this._localStreams||(this._localStreams=[]),this._localStreams.includes(i)||this._localStreams.push(i),i.getAudioTracks().forEach(o=>e.call(this,o,i)),i.getVideoTracks().forEach(o=>e.call(this,o,i))},t.RTCPeerConnection.prototype.addTrack=function(i,...o){return o&&o.forEach(l=>{this._localStreams?this._localStreams.includes(l)||this._localStreams.push(l):this._localStreams=[l]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(r){this._localStreams||(this._localStreams=[]);const i=this._localStreams.indexOf(r);if(i===-1)return;this._localStreams.splice(i,1);const o=r.getTracks();this.getSenders().forEach(l=>{o.includes(l.track)&&this.removeTrack(l)})})}}function Na(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(r){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=r),this.addEventListener("track",this._onaddstreampoly=i=>{i.streams.forEach(o=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(o))return;this._remoteStreams.push(o);const l=new Event("addstream");l.stream=o,this.dispatchEvent(l)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const i=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(o){o.streams.forEach(l=>{if(i._remoteStreams||(i._remoteStreams=[]),i._remoteStreams.indexOf(l)>=0)return;i._remoteStreams.push(l);const _=new Event("addstream");_.stream=l,i.dispatchEvent(_)})}),e.apply(i,arguments)}}}function $a(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,r=e.createOffer,i=e.createAnswer,o=e.setLocalDescription,l=e.setRemoteDescription,_=e.addIceCandidate;e.createOffer=function(a,h){const u=arguments.length>=2?arguments[2]:arguments[0],g=r.apply(this,[u]);return h?(g.then(a,h),Promise.resolve()):g},e.createAnswer=function(a,h){const u=arguments.length>=2?arguments[2]:arguments[0],g=i.apply(this,[u]);return h?(g.then(a,h),Promise.resolve()):g};let s=function(n,a,h){const u=o.apply(this,[n]);return h?(u.then(a,h),Promise.resolve()):u};e.setLocalDescription=s,s=function(n,a,h){const u=l.apply(this,[n]);return h?(u.then(a,h),Promise.resolve()):u},e.setRemoteDescription=s,s=function(n,a,h){const u=_.apply(this,[n]);return h?(u.then(a,h),Promise.resolve()):u},e.addIceCandidate=s}function Ha(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const r=e.mediaDevices,i=r.getUserMedia.bind(r);e.mediaDevices.getUserMedia=o=>i(Fa(o))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(i,o,l){e.mediaDevices.getUserMedia(i).then(o,l)}).bind(e))}function Fa(t){return t&&t.video!==void 0?Object.assign({},t,{video:ua(t.video)}):t}function ja(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(i,o){if(i&&i.iceServers){const l=[];for(let _=0;_<i.iceServers.length;_++){let s=i.iceServers[_];!s.hasOwnProperty("urls")&&s.hasOwnProperty("url")?(mi("RTCIceServer.url","RTCIceServer.urls"),s=JSON.parse(JSON.stringify(s)),s.urls=s.url,delete s.url,l.push(s)):l.push(i.iceServers[_])}i.iceServers=l}return new e(i,o)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function Ua(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Wa(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(i){if(i){typeof i.offerToReceiveAudio<"u"&&(i.offerToReceiveAudio=!!i.offerToReceiveAudio);const o=this.getTransceivers().find(_=>_.receiver.track.kind==="audio");i.offerToReceiveAudio===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):i.offerToReceiveAudio===!0&&!o&&this.addTransceiver("audio"),typeof i.offerToReceiveVideo<"u"&&(i.offerToReceiveVideo=!!i.offerToReceiveVideo);const l=this.getTransceivers().find(_=>_.receiver.track.kind==="video");i.offerToReceiveVideo===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):i.offerToReceiveVideo===!0&&!l&&this.addTransceiver("video")}return e.apply(this,arguments)}}function za(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}const Gn=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:za,shimCallbacksAPI:$a,shimConstraints:Fa,shimCreateOfferLegacy:Wa,shimGetUserMedia:Ha,shimLocalStreamsAPI:Ba,shimRTCIceServerUrls:ja,shimRemoteStreamsAPI:Na,shimTrackEventTransceiver:Ua},Symbol.toStringTag,{value:"Module"}));function Yr(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(i){if(typeof i=="object"&&i.candidate&&i.candidate.indexOf("a=")===0&&(i=JSON.parse(JSON.stringify(i)),i.candidate=i.candidate.substr(2)),i.candidate&&i.candidate.length){const o=new e(i),l=qr.parseCandidate(i.candidate),_=Object.assign(o,l);return _.toJSON=function(){return{candidate:_.candidate,sdpMid:_.sdpMid,sdpMLineIndex:_.sdpMLineIndex,usernameFragment:_.usernameFragment}},_}return new e(i)},t.RTCIceCandidate.prototype=e.prototype,Xt(t,"icecandidate",r=>(r.candidate&&Object.defineProperty(r,"candidate",{value:new t.RTCIceCandidate(r.candidate),writable:"false"}),r))}function dr(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const r=function(s){if(!s||!s.sdp)return!1;const n=qr.splitSections(s.sdp);return n.shift(),n.some(a=>{const h=qr.parseMLine(a);return h&&h.kind==="application"&&h.protocol.indexOf("SCTP")!==-1})},i=function(s){const n=s.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(n===null||n.length<2)return-1;const a=parseInt(n[1],10);return a!==a?-1:a},o=function(s){let n=65536;return e.browser==="firefox"&&(e.version<57?s===-1?n=16384:n=2147483637:e.version<60?n=e.version===57?65535:65536:n=2147483637),n},l=function(s,n){let a=65536;e.browser==="firefox"&&e.version===57&&(a=65535);const h=qr.matchPrefix(s.sdp,"a=max-message-size:");return h.length>0?a=parseInt(h[0].substr(19),10):e.browser==="firefox"&&n!==-1&&(a=2147483637),a},_=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:n}=this.getConfiguration();n==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(r(arguments[0])){const n=i(arguments[0]),a=o(n),h=l(arguments[0],n);let u;a===0&&h===0?u=Number.POSITIVE_INFINITY:a===0||h===0?u=Math.max(a,h):u=Math.min(a,h);const g={};Object.defineProperty(g,"maxMessageSize",{get(){return u}}),this._sctp=g}return _.apply(this,arguments)}}function fr(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(i,o){const l=i.send;i.send=function(){const s=arguments[0],n=s.length||s.size||s.byteLength;if(i.readyState==="open"&&o.sctp&&n>o.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+o.sctp.maxMessageSize+" bytes)");return l.apply(i,arguments)}}const r=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const o=r.apply(this,arguments);return e(o,this),o},Xt(t,"datachannel",i=>(e(i.channel,i.target),i))}function ps(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(r){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),r&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=r)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(r=>{const i=e[r];e[r]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=o=>{const l=o.target;if(l._lastConnectionState!==l.connectionState){l._lastConnectionState=l.connectionState;const _=new Event("connectionstatechange",o);l.dispatchEvent(_)}return o},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}})}function _s(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(o){if(o&&o.sdp&&o.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const l=o.sdp.split(`
`).filter(_=>_.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&o instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:o.type,sdp:l}):o.sdp=l}return r.apply(this,arguments)}}function Jr(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const r=t.RTCPeerConnection.prototype.addIceCandidate;!r||r.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}const hh=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:_s,shimAddIceCandidateNullOrEmpty:Jr,shimConnectionState:ps,shimMaxMessageSize:dr,shimRTCIceCandidate:Yr,shimSendThrowTypeError:fr},Symbol.toStringTag,{value:"Module"}));function uh({window:t}={},e={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const r=Ys,i=rh(t),o={browserDetails:i,commonShim:hh,extractVersion:ur,disableLog:eh,disableWarnings:th};switch(i.browser){case"chrome":if(!Un||!us||!e.shimChrome)return r("Chrome shim is not included in this adapter release."),o;if(i.version===null)return r("Chrome shim can not determine version, not shimming."),o;r("adapter.js shimming chrome."),o.browserShim=Un,Jr(t,i),da(t,i),fa(t),us(t,i),pa(t),ya(t,i),_a(t),ga(t),ma(t),Sa(t,i),Yr(t),ps(t),dr(t,i),fr(t),_s(t,i);break;case"firefox":if(!Kn||!fs||!e.shimFirefox)return r("Firefox shim is not included in this adapter release."),o;r("adapter.js shimming firefox."),o.browserShim=Kn,Jr(t,i),ka(t,i),fs(t,i),Aa(t),La(t),Ra(t),Da(t),Oa(t),xa(t),Pa(t),Ma(t),Ia(t),Yr(t),ps(t),dr(t,i),fr(t);break;case"edge":if(!Vn||!ds||!e.shimEdge)return r("MS edge shim is not included in this adapter release."),o;r("adapter.js shimming edge."),o.browserShim=Vn,Ea(t),Ta(t),ds(t,i),wa(t),dr(t,i),fr(t);break;case"safari":if(!Gn||!e.shimSafari)return r("Safari shim is not included in this adapter release."),o;r("adapter.js shimming safari."),o.browserShim=Gn,Jr(t,i),ja(t),Wa(t),$a(t),Ba(t),Na(t),Ua(t),Ha(t),za(t),Yr(t),dr(t,i),fr(t),_s(t,i);break;default:r("Unsupported browser!");break}return o}const qn=uh({window:typeof window>"u"?void 0:window});function Je(t,e,r,i){Object.defineProperty(t,e,{get:r,set:i,enumerable:!0,configurable:!0})}var $i=qn.default||qn,sr=new(function(){function t(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}return t.prototype.isWebRTCSupported=function(){return typeof RTCPeerConnection<"u"},t.prototype.isBrowserSupported=function(){var e=this.getBrowser(),r=this.getVersion(),i=this.supportedBrowsers.includes(e);return i?e==="chrome"?r>=this.minChromeVersion:e==="firefox"?r>=this.minFirefoxVersion:e==="safari"?!this.isIOS&&r>=this.minSafariVersion:!1:!1},t.prototype.getBrowser=function(){return $i.browserDetails.browser},t.prototype.getVersion=function(){return $i.browserDetails.version||0},t.prototype.isUnifiedPlanSupported=function(){var e=this.getBrowser(),r=$i.browserDetails.version||0;if(e==="chrome"&&r<this.minChromeVersion)return!1;if(e==="firefox"&&r>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var i,o=!1;try{i=new RTCPeerConnection,i.addTransceiver("audio"),o=!0}catch{}finally{i&&i.close()}return o},t.prototype.toString=function(){return`Supports:
    browser:`.concat(this.getBrowser(),`
    version:`).concat(this.getVersion(),`
    isIOS:`).concat(this.isIOS,`
    isWebRTCSupported:`).concat(this.isWebRTCSupported(),`
    isBrowserSupported:`).concat(this.isBrowserSupported(),`
    isUnifiedPlanSupported:`).concat(this.isUnifiedPlanSupported())},t}()),Yn={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"},dh=function(){function t(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=Yn,this.browser=sr.getBrowser(),this.browserVersion=sr.getVersion(),this.supports=function(){var e={browser:sr.isBrowserSupported(),webRTC:sr.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!e.webRTC)return e;var r;try{r=new RTCPeerConnection(Yn),e.audioVideo=!0;var i=void 0;try{i=r.createDataChannel("_PEERJSTEST",{ordered:!0}),e.data=!0,e.reliable=!!i.ordered;try{i.binaryType="blob",e.binaryBlob=!sr.isIOS}catch{}}catch{}finally{i&&i.close()}}catch{}finally{r&&r.close()}return e}(),this.pack=$n.pack,this.unpack=$n.unpack,this._dataCount=1}return t.prototype.noop=function(){},t.prototype.validateId=function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(e)},t.prototype.chunk=function(e){for(var r=[],i=e.size,o=Math.ceil(i/oe.chunkedMTU),l=0,_=0;_<i;){var s=Math.min(i,_+oe.chunkedMTU),n=e.slice(_,s),a={__peerData:this._dataCount,n:l,data:n,total:o};r.push(a),_=s,l++}return this._dataCount++,r},t.prototype.blobToArrayBuffer=function(e,r){var i=new FileReader;return i.onload=function(o){o.target&&r(o.target.result)},i.readAsArrayBuffer(e),i},t.prototype.binaryStringToArrayBuffer=function(e){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i)&255;return r.buffer},t.prototype.randomToken=function(){return Math.random().toString(36).slice(2)},t.prototype.isSecure=function(){return location.protocol==="https:"},t}(),oe=new dh,Va={};Je(Va,"Peer",()=>si,t=>si=t);var Er={},fh=Object.prototype.hasOwnProperty,Ee="~";function yr(){}Object.create&&(yr.prototype=Object.create(null),new yr().__proto__||(Ee=!1));function ph(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function Ka(t,e,r,i,o){if(typeof r!="function")throw new TypeError("The listener must be a function");var l=new ph(r,i||t,o),_=Ee?Ee+e:e;return t._events[_]?t._events[_].fn?t._events[_]=[t._events[_],l]:t._events[_].push(l):(t._events[_]=l,t._eventsCount++),t}function Xr(t,e){--t._eventsCount===0?t._events=new yr:delete t._events[e]}function Se(){this._events=new yr,this._eventsCount=0}Se.prototype.eventNames=function(){var e=[],r,i;if(this._eventsCount===0)return e;for(i in r=this._events)fh.call(r,i)&&e.push(Ee?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e};Se.prototype.listeners=function(e){var r=Ee?Ee+e:e,i=this._events[r];if(!i)return[];if(i.fn)return[i.fn];for(var o=0,l=i.length,_=new Array(l);o<l;o++)_[o]=i[o].fn;return _};Se.prototype.listenerCount=function(e){var r=Ee?Ee+e:e,i=this._events[r];return i?i.fn?1:i.length:0};Se.prototype.emit=function(e,r,i,o,l,_){var s=Ee?Ee+e:e;if(!this._events[s])return!1;var n=this._events[s],a=arguments.length,h,u;if(n.fn){switch(n.once&&this.removeListener(e,n.fn,void 0,!0),a){case 1:return n.fn.call(n.context),!0;case 2:return n.fn.call(n.context,r),!0;case 3:return n.fn.call(n.context,r,i),!0;case 4:return n.fn.call(n.context,r,i,o),!0;case 5:return n.fn.call(n.context,r,i,o,l),!0;case 6:return n.fn.call(n.context,r,i,o,l,_),!0}for(u=1,h=new Array(a-1);u<a;u++)h[u-1]=arguments[u];n.fn.apply(n.context,h)}else{var g=n.length,C;for(u=0;u<g;u++)switch(n[u].once&&this.removeListener(e,n[u].fn,void 0,!0),a){case 1:n[u].fn.call(n[u].context);break;case 2:n[u].fn.call(n[u].context,r);break;case 3:n[u].fn.call(n[u].context,r,i);break;case 4:n[u].fn.call(n[u].context,r,i,o);break;default:if(!h)for(C=1,h=new Array(a-1);C<a;C++)h[C-1]=arguments[C];n[u].fn.apply(n[u].context,h)}}return!0};Se.prototype.on=function(e,r,i){return Ka(this,e,r,i,!1)};Se.prototype.once=function(e,r,i){return Ka(this,e,r,i,!0)};Se.prototype.removeListener=function(e,r,i,o){var l=Ee?Ee+e:e;if(!this._events[l])return this;if(!r)return Xr(this,l),this;var _=this._events[l];if(_.fn)_.fn===r&&(!o||_.once)&&(!i||_.context===i)&&Xr(this,l);else{for(var s=0,n=[],a=_.length;s<a;s++)(_[s].fn!==r||o&&!_[s].once||i&&_[s].context!==i)&&n.push(_[s]);n.length?this._events[l]=n.length===1?n[0]:n:Xr(this,l)}return this};Se.prototype.removeAllListeners=function(e){var r;return e?(r=Ee?Ee+e:e,this._events[r]&&Xr(this,r)):(this._events=new yr,this._eventsCount=0),this};Se.prototype.off=Se.prototype.removeListener;Se.prototype.addListener=Se.prototype.on;Se.prefixed=Ee;Se.EventEmitter=Se;Er=Se;var Z={};Je(Z,"LogLevel",()=>we,t=>we=t);Je(Z,"default",()=>Jn,t=>Jn=t);var St=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),o,l=[],_;try{for(;(e===void 0||e-- >0)&&!(o=i.next()).done;)l.push(o.value)}catch(s){_={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(_)throw _.error}}return l},bt=function(t,e,r){if(r||arguments.length===2)for(var i=0,o=e.length,l;i<o;i++)(l||!(i in e))&&(l||(l=Array.prototype.slice.call(e,0,i)),l[i]=e[i]);return t.concat(l||Array.prototype.slice.call(e))},_h="PeerJS: ",we;(function(t){t[t.Disabled=0]="Disabled",t[t.Errors=1]="Errors",t[t.Warnings=2]="Warnings",t[t.All=3]="All"})(we||(we={}));var gh=function(){function t(){this._logLevel=we.Disabled}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!1,configurable:!0}),t.prototype.log=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._logLevel>=we.All&&this._print.apply(this,bt([we.All],St(e),!1))},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._logLevel>=we.Warnings&&this._print.apply(this,bt([we.Warnings],St(e),!1))},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._logLevel>=we.Errors&&this._print.apply(this,bt([we.Errors],St(e),!1))},t.prototype.setLogFunction=function(e){this._print=e},t.prototype._print=function(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=bt([_h],St(r),!1);for(var l in o)o[l]instanceof Error&&(o[l]="("+o[l].name+") "+o[l].message);e>=we.All?console.log.apply(console,bt([],St(o),!1)):e>=we.Warnings?console.warn.apply(console,bt(["WARNING"],St(o),!1)):e>=we.Errors&&console.error.apply(console,bt(["ERROR"],St(o),!1))},t}(),Jn=new gh,Ga={};Je(Ga,"Socket",()=>Xn,t=>Xn=t);var Fe;(function(t){t.Data="data",t.Media="media"})(Fe||(Fe={}));var de;(function(t){t.BrowserIncompatible="browser-incompatible",t.Disconnected="disconnected",t.InvalidID="invalid-id",t.InvalidKey="invalid-key",t.Network="network",t.PeerUnavailable="peer-unavailable",t.SslUnavailable="ssl-unavailable",t.ServerError="server-error",t.SocketError="socket-error",t.SocketClosed="socket-closed",t.UnavailableID="unavailable-id",t.WebRTC="webrtc"})(de||(de={}));var tt;(function(t){t.Binary="binary",t.BinaryUTF8="binary-utf8",t.JSON="json"})(tt||(tt={}));var it;(function(t){t.Message="message",t.Disconnected="disconnected",t.Error="error",t.Close="close"})(it||(it={}));var ge;(function(t){t.Heartbeat="HEARTBEAT",t.Candidate="CANDIDATE",t.Offer="OFFER",t.Answer="ANSWER",t.Open="OPEN",t.Error="ERROR",t.IdTaken="ID-TAKEN",t.InvalidKey="INVALID-KEY",t.Leave="LEAVE",t.Expire="EXPIRE"})(ge||(ge={}));var Js={};Js=JSON.parse('{"name":"peerjs","version":"1.4.7","keywords":["peerjs","webrtc","p2p","rtc"],"description":"PeerJS client","homepage":"https://peerjs.com","bugs":{"url":"https://github.com/peers/peerjs/issues"},"repository":{"type":"git","url":"https://github.com/peers/peerjs"},"license":"MIT","contributors":["Michelle Bu <michelle@michellebu.com>","afrokick <devbyru@gmail.com>","ericz <really.ez@gmail.com>","Jairo <kidandcat@gmail.com>","Jonas Gloning <34194370+jonasgloning@users.noreply.github.com>","Jairo Caro-Accino Viciana <jairo@galax.be>","Carlos Caballero <carlos.caballero.gonzalez@gmail.com>","hc <hheennrryy@gmail.com>","Muhammad Asif <capripio@gmail.com>","PrashoonB <prashoonbhattacharjee@gmail.com>","Harsh Bardhan Mishra <47351025+HarshCasper@users.noreply.github.com>","akotynski <aleksanderkotbury@gmail.com>","lmb <i@lmb.io>","Jairooo <jairocaro@msn.com>","Moritz Stckler <moritz.stueckler@gmail.com>","Simon <crydotsnakegithub@gmail.com>","Denis Lukov <denismassters@gmail.com>","Philipp Hancke <fippo@andyet.net>","Hans Oksendahl <hansoksendahl@gmail.com>","Jess <jessachandler@gmail.com>","khankuan <khankuan@gmail.com>","DUODVK <kurmanov.work@gmail.com>","XiZhao <kwang1imsa@gmail.com>","Matthias Lohr <matthias@lohr.me>","=frank tree <=frnktrb@googlemail.com>","Andre Eckardt <aeckardt@outlook.com>","Chris Cowan <agentme49@gmail.com>","Alex Chuev <alex@chuev.com>","alxnull <alxnull@e.mail.de>","Yemel Jardi <angel.jardi@gmail.com>","Ben Parnell <benjaminparnell.94@gmail.com>","Benny Lichtner <bennlich@gmail.com>","fresheneesz <bitetrudpublic@gmail.com>","bob.barstead@exaptive.com <bob.barstead@exaptive.com>","chandika <chandika@gmail.com>","emersion <contact@emersion.fr>","Christopher Van <cvan@users.noreply.github.com>","eddieherm <edhermoso@gmail.com>","Eduardo Pinho <enet4mikeenet@gmail.com>","Evandro Zanatta <ezanatta@tray.net.br>","Gardner Bickford <gardner@users.noreply.github.com>","Gian Luca <gianluca.cecchi@cynny.com>","PatrickJS <github@gdi2290.com>","jonnyf <github@jonathanfoss.co.uk>","Hizkia Felix <hizkifw@gmail.com>","Hristo Oskov <hristo.oskov@gmail.com>","Isaac Madwed <i.madwed@gmail.com>","Ilya Konanykhin <ilya.konanykhin@gmail.com>","jasonbarry <jasbarry@me.com>","Jonathan Burke <jonathan.burke.1311@googlemail.com>","Josh Hamit <josh.hamit@gmail.com>","Jordan Austin <jrax86@gmail.com>","Joel Wetzell <jwetzell@yahoo.com>","xizhao <kevin.wang@cloudera.com>","Alberto Torres <kungfoobar@gmail.com>","Jonathan Mayol <mayoljonathan@gmail.com>","Jefferson Felix <me@jsfelix.dev>","Rolf Erik Lekang <me@rolflekang.com>","Kevin Mai-Husan Chia <mhchia@users.noreply.github.com>","Pepijn de Vos <pepijndevos@gmail.com>","JooYoung <qkdlql@naver.com>","Tobias Speicher <rootcommander@gmail.com>","Steve Blaurock <sblaurock@gmail.com>","Kyrylo Shegeda <shegeda@ualberta.ca>","Diwank Singh Tomer <singh@diwank.name>","Soren Balko <Soeren.Balko@gmail.com>","Arpit Solanki <solankiarpit1997@gmail.com>","Yuki Ito <yuki@gnnk.net>","Artur Zayats <zag2art@gmail.com>"],"funding":{"type":"opencollective","url":"https://opencollective.com/peer"},"collective":{"type":"opencollective","url":"https://opencollective.com/peer"},"files":["dist/*"],"sideEffects":["lib/global.ts","lib/supports.ts"],"main":"dist/bundler.cjs","module":"dist/bundler.mjs","browser-minified":"dist/peerjs.min.js","browser-unminified":"dist/peerjs.js","types":"dist/types.d.ts","engines":{"node":">= 10"},"targets":{"types":{"source":"lib/exports.ts"},"main":{"source":"lib/exports.ts","sourceMap":{"inlineSources":true}},"module":{"source":"lib/exports.ts","includeNodeModules":["eventemitter3"],"sourceMap":{"inlineSources":true}},"browser-minified":{"context":"browser","outputFormat":"global","optimize":true,"engines":{"browsers":"cover 99%, not dead"},"source":"lib/global.ts"},"browser-unminified":{"context":"browser","outputFormat":"global","optimize":false,"engines":{"browsers":"cover 99%, not dead"},"source":"lib/global.ts"}},"scripts":{"contributors":"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\"chore(contributors): update and sort contributors list\\"","check":"tsc --noEmit","watch":"parcel watch","build":"rm -rf dist && parcel build","prepublishOnly":"npm run build","test":"mocha -r ts-node/register -r jsdom-global/register test/**/*.ts","format":"prettier --write .","semantic-release":"semantic-release"},"devDependencies":{"@parcel/config-default":"^2.5.0","@parcel/packager-ts":"^2.5.0","@parcel/transformer-typescript-tsc":"^2.5.0","@parcel/transformer-typescript-types":"^2.5.0","@semantic-release/changelog":"^6.0.1","@semantic-release/git":"^10.0.1","@types/chai":"^4.3.0","@types/mocha":"^9.1.0","@types/node":"^17.0.18","chai":"^4.3.6","git-authors-cli":"^1.0.40","jsdom":"^19.0.0","jsdom-global":"^3.0.2","mocha":"^9.2.0","mock-socket":"8.0.5","parcel":"^2.5.0","parcel-transformer-tsc-sourcemaps":"^1.0.2","prettier":"^2.6.2","semantic-release":"^19.0.2","standard":"^16.0.4","ts-node":"^10.5.0","typescript":"^4.5.5"},"dependencies":{"@swc/helpers":"^0.3.13","eventemitter3":"^4.0.7","peerjs-js-binarypack":"1.0.1","webrtc-adapter":"^7.7.1"}}');var mh=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(i[l]=o[l])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}(),vh=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),o,l=[],_;try{for(;(e===void 0||e-- >0)&&!(o=i.next()).done;)l.push(o.value)}catch(s){_={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(_)throw _.error}}return l},yh=function(t,e,r){if(r||arguments.length===2)for(var i=0,o=e.length,l;i<o;i++)(l||!(i in e))&&(l||(l=Array.prototype.slice.call(e,0,i)),l[i]=e[i]);return t.concat(l||Array.prototype.slice.call(e))},Sh=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Xn=function(t){mh(e,t);function e(r,i,o,l,_,s){s===void 0&&(s=5e3);var n=t.call(this)||this;n.pingInterval=s,n._disconnected=!0,n._messagesQueue=[];var a=r?"wss://":"ws://";return n._baseUrl=a+i+":"+o+l+"peerjs?key="+_,n}return e.prototype.start=function(r,i){var o=this;this._id=r;var l="".concat(this._baseUrl,"&id=").concat(r,"&token=").concat(i);this._socket||!this._disconnected||(this._socket=new WebSocket(l+"&version="+Js.version),this._disconnected=!1,this._socket.onmessage=function(_){var s;try{s=JSON.parse(_.data),Z.default.log("Server message received:",s)}catch{Z.default.log("Invalid server message",_.data);return}o.emit(it.Message,s)},this._socket.onclose=function(_){o._disconnected||(Z.default.log("Socket closed.",_),o._cleanup(),o._disconnected=!0,o.emit(it.Disconnected))},this._socket.onopen=function(){o._disconnected||(o._sendQueuedMessages(),Z.default.log("Socket open"),o._scheduleHeartbeat())})},e.prototype._scheduleHeartbeat=function(){var r=this;this._wsPingTimer=setTimeout(function(){r._sendHeartbeat()},this.pingInterval)},e.prototype._sendHeartbeat=function(){if(!this._wsOpen()){Z.default.log("Cannot send heartbeat, because socket closed");return}var r=JSON.stringify({type:ge.Heartbeat});this._socket.send(r),this._scheduleHeartbeat()},e.prototype._wsOpen=function(){return!!this._socket&&this._socket.readyState===1},e.prototype._sendQueuedMessages=function(){var r,i,o=yh([],vh(this._messagesQueue),!1);this._messagesQueue=[];try{for(var l=Sh(o),_=l.next();!_.done;_=l.next()){var s=_.value;this.send(s)}}catch(n){r={error:n}}finally{try{_&&!_.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}},e.prototype.send=function(r){if(!this._disconnected){if(!this._id){this._messagesQueue.push(r);return}if(!r.type){this.emit(it.Error,"Invalid message");return}if(this._wsOpen()){var i=JSON.stringify(r);this._socket.send(i)}}},e.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},e.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},e}(Er.EventEmitter),gs={};Je(gs,"MediaConnection",()=>eo,t=>eo=t);var Xs={};Je(Xs,"Negotiator",()=>Qn,t=>Qn=t);var ri=function(){return ri=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},ri.apply(this,arguments)},Br=function(t,e,r,i){function o(l){return l instanceof r?l:new r(function(_){_(l)})}return new(r||(r=Promise))(function(l,_){function s(h){try{a(i.next(h))}catch(u){_(u)}}function n(h){try{a(i.throw(h))}catch(u){_(u)}}function a(h){h.done?l(h.value):o(h.value).then(s,n)}a((i=i.apply(t,e||[])).next())})},Nr=function(t,e){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,o,l,_;return _={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(_[Symbol.iterator]=function(){return this}),_;function s(a){return function(h){return n([a,h])}}function n(a){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,o&&(l=a[0]&2?o.return:a[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,a[1])).done)return l;switch(o=0,l&&(a=[a[0]&2,l.value]),a[0]){case 0:case 1:l=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!l||a[1]>l[0]&&a[1]<l[3])){r.label=a[1];break}if(a[0]===6&&r.label<l[1]){r.label=l[1],l=a;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(a);break}l[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(h){a=[6,h],o=0}finally{i=l=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Qn=function(){function t(e){this.connection=e}return t.prototype.startConnection=function(e){var r=this._startPeerConnection();if(this.connection.peerConnection=r,this.connection.type===Fe.Media&&e._stream&&this._addTracksToConnection(e._stream,r),e.originator){if(this.connection.type===Fe.Data){var i=this.connection,o={ordered:!!e.reliable},l=r.createDataChannel(i.label,o);i.initialize(l)}this._makeOffer()}else this.handleSDP("OFFER",e.sdp)},t.prototype._startPeerConnection=function(){Z.default.log("Creating RTCPeerConnection.");var e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e},t.prototype._setupListeners=function(e){var r=this,i=this.connection.peer,o=this.connection.connectionId,l=this.connection.type,_=this.connection.provider;Z.default.log("Listening for ICE candidates."),e.onicecandidate=function(s){!s.candidate||!s.candidate.candidate||(Z.default.log("Received ICE candidates for ".concat(i,":"),s.candidate),_.socket.send({type:ge.Candidate,payload:{candidate:s.candidate,type:l,connectionId:o},dst:i}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"failed":Z.default.log("iceConnectionState is failed, closing connections to "+i),r.connection.emit("error",new Error("Negotiation of connection to "+i+" failed.")),r.connection.close();break;case"closed":Z.default.log("iceConnectionState is closed, closing connections to "+i),r.connection.emit("error",new Error("Connection to "+i+" closed.")),r.connection.close();break;case"disconnected":Z.default.log("iceConnectionState changed to disconnected on the connection with "+i);break;case"completed":e.onicecandidate=oe.noop;break}r.connection.emit("iceStateChanged",e.iceConnectionState)},Z.default.log("Listening for data channel"),e.ondatachannel=function(s){Z.default.log("Received data channel");var n=s.channel,a=_.getConnection(i,o);a.initialize(n)},Z.default.log("Listening for remote stream"),e.ontrack=function(s){Z.default.log("Received remote stream");var n=s.streams[0],a=_.getConnection(i,o);if(a.type===Fe.Media){var h=a;r._addStreamToMediaConnection(n,h)}}},t.prototype.cleanup=function(){Z.default.log("Cleaning up PeerConnection to "+this.connection.peer);var e=this.connection.peerConnection;if(e){this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=function(){};var r=e.signalingState!=="closed",i=!1;if(this.connection.type===Fe.Data){var o=this.connection,l=o.dataChannel;l&&(i=!!l.readyState&&l.readyState!=="closed")}(r||i)&&e.close()}},t.prototype._makeOffer=function(){return Br(this,void 0,Promise,function(){var e,r,i,o,l,_,s;return Nr(this,function(n){switch(n.label){case 0:e=this.connection.peerConnection,r=this.connection.provider,n.label=1;case 1:return n.trys.push([1,7,,8]),[4,e.createOffer(this.connection.options.constraints)];case 2:i=n.sent(),Z.default.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(i.sdp=this.connection.options.sdpTransform(i.sdp)||i.sdp),n.label=3;case 3:return n.trys.push([3,5,,6]),[4,e.setLocalDescription(i)];case 4:return n.sent(),Z.default.log("Set localDescription:",i,"for:".concat(this.connection.peer)),o={sdp:i,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:oe.browser},this.connection.type===Fe.Data&&(l=this.connection,o=ri(ri({},o),{label:l.label,reliable:l.reliable,serialization:l.serialization})),r.socket.send({type:ge.Offer,payload:o,dst:this.connection.peer}),[3,6];case 5:return _=n.sent(),_!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(r.emitError(de.WebRTC,_),Z.default.log("Failed to setLocalDescription, ",_)),[3,6];case 6:return[3,8];case 7:return s=n.sent(),r.emitError(de.WebRTC,s),Z.default.log("Failed to createOffer, ",s),[3,8];case 8:return[2]}})})},t.prototype._makeAnswer=function(){return Br(this,void 0,Promise,function(){var e,r,i,o,l;return Nr(this,function(_){switch(_.label){case 0:e=this.connection.peerConnection,r=this.connection.provider,_.label=1;case 1:return _.trys.push([1,7,,8]),[4,e.createAnswer()];case 2:i=_.sent(),Z.default.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(i.sdp=this.connection.options.sdpTransform(i.sdp)||i.sdp),_.label=3;case 3:return _.trys.push([3,5,,6]),[4,e.setLocalDescription(i)];case 4:return _.sent(),Z.default.log("Set localDescription:",i,"for:".concat(this.connection.peer)),r.socket.send({type:ge.Answer,payload:{sdp:i,type:this.connection.type,connectionId:this.connection.connectionId,browser:oe.browser},dst:this.connection.peer}),[3,6];case 5:return o=_.sent(),r.emitError(de.WebRTC,o),Z.default.log("Failed to setLocalDescription, ",o),[3,6];case 6:return[3,8];case 7:return l=_.sent(),r.emitError(de.WebRTC,l),Z.default.log("Failed to create answer, ",l),[3,8];case 8:return[2]}})})},t.prototype.handleSDP=function(e,r){return Br(this,void 0,Promise,function(){var i,o,l,_;return Nr(this,function(s){switch(s.label){case 0:r=new RTCSessionDescription(r),i=this.connection.peerConnection,o=this.connection.provider,Z.default.log("Setting remote description",r),l=this,s.label=1;case 1:return s.trys.push([1,5,,6]),[4,i.setRemoteDescription(r)];case 2:return s.sent(),Z.default.log("Set remoteDescription:".concat(e," for:").concat(this.connection.peer)),e!=="OFFER"?[3,4]:[4,l._makeAnswer()];case 3:s.sent(),s.label=4;case 4:return[3,6];case 5:return _=s.sent(),o.emitError(de.WebRTC,_),Z.default.log("Failed to setRemoteDescription, ",_),[3,6];case 6:return[2]}})})},t.prototype.handleCandidate=function(e){return Br(this,void 0,Promise,function(){var r,i,o,l,_,s;return Nr(this,function(n){switch(n.label){case 0:Z.default.log("handleCandidate:",e),r=e.candidate,i=e.sdpMLineIndex,o=e.sdpMid,l=this.connection.peerConnection,_=this.connection.provider,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,l.addIceCandidate(new RTCIceCandidate({sdpMid:o,sdpMLineIndex:i,candidate:r}))];case 2:return n.sent(),Z.default.log("Added ICE candidate for:".concat(this.connection.peer)),[3,4];case 3:return s=n.sent(),_.emitError(de.WebRTC,s),Z.default.log("Failed to handleCandidate, ",s),[3,4];case 4:return[2]}})})},t.prototype._addTracksToConnection=function(e,r){if(Z.default.log("add tracks from stream ".concat(e.id," to peer connection")),!r.addTrack)return Z.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(function(i){r.addTrack(i,e)})},t.prototype._addStreamToMediaConnection=function(e,r){Z.default.log("add stream ".concat(e.id," to media connection ").concat(r.connectionId)),r.addStream(e)},t}(),Qs={};Je(Qs,"BaseConnection",()=>Zn,t=>Zn=t);var bh=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(i[l]=o[l])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}(),Zn=function(t){bh(e,t);function e(r,i,o){var l=t.call(this)||this;return l.peer=r,l.provider=i,l.options=o,l._open=!1,l.metadata=o.metadata,l}return Object.defineProperty(e.prototype,"open",{get:function(){return this._open},enumerable:!1,configurable:!0}),e}(Er.EventEmitter),Ch=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(i[l]=o[l])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}(),ii=function(){return ii=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},ii.apply(this,arguments)},Eh=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},eo=function(t){Ch(e,t);function e(r,i,o){var l=t.call(this,r,i,o)||this;return l._localStream=l.options._stream,l.connectionId=l.options.connectionId||e.ID_PREFIX+oe.randomToken(),l._negotiator=new Xs.Negotiator(l),l._localStream&&l._negotiator.startConnection({_stream:l._localStream,originator:!0}),l}return Object.defineProperty(e.prototype,"type",{get:function(){return Fe.Media},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localStream",{get:function(){return this._localStream},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!1,configurable:!0}),e.prototype.addStream=function(r){Z.default.log("Receiving stream",r),this._remoteStream=r,t.prototype.emit.call(this,"stream",r)},e.prototype.handleMessage=function(r){var i=r.type,o=r.payload;switch(r.type){case ge.Answer:this._negotiator.handleSDP(i,o.sdp),this._open=!0;break;case ge.Candidate:this._negotiator.handleCandidate(o.candidate);break;default:Z.default.warn("Unrecognized message type:".concat(i," from peer:").concat(this.peer));break}},e.prototype.answer=function(r,i){var o,l;if(i===void 0&&(i={}),this._localStream){Z.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=r,i&&i.sdpTransform&&(this.options.sdpTransform=i.sdpTransform),this._negotiator.startConnection(ii(ii({},this.options._payload),{_stream:r}));var _=this.provider._getMessages(this.connectionId);try{for(var s=Eh(_),n=s.next();!n.done;n=s.next()){var a=n.value;this.handleMessage(a)}}catch(h){o={error:h}}finally{try{n&&!n.done&&(l=s.return)&&l.call(s)}finally{if(o)throw o.error}}this._open=!0},e.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,t.prototype.emit.call(this,"close"))},e.ID_PREFIX="mc_",e}(Qs.BaseConnection),ms={};Je(ms,"DataConnection",()=>ro,t=>ro=t);var qa={};Je(qa,"EncodingQueue",()=>to,t=>to=t);var Th=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(i[l]=o[l])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}(),to=function(t){Th(e,t);function e(){var r=t.call(this)||this;return r.fileReader=new FileReader,r._queue=[],r._processing=!1,r.fileReader.onload=function(i){r._processing=!1,i.target&&r.emit("done",i.target.result),r.doNextTask()},r.fileReader.onerror=function(i){Z.default.error("EncodingQueue error:",i),r._processing=!1,r.destroy(),r.emit("error",i)},r}return Object.defineProperty(e.prototype,"queue",{get:function(){return this._queue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.queue.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"processing",{get:function(){return this._processing},enumerable:!1,configurable:!0}),e.prototype.enque=function(r){this.queue.push(r),!this.processing&&this.doNextTask()},e.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},e.prototype.doNextTask=function(){this.size!==0&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},e}(Er.EventEmitter),wh=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(i[l]=o[l])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}(),kh=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ro=function(t){wh(e,t);function e(r,i,o){var l=t.call(this,r,i,o)||this;return l.stringify=JSON.stringify,l.parse=JSON.parse,l._buffer=[],l._bufferSize=0,l._buffering=!1,l._chunkedData={},l._encodingQueue=new qa.EncodingQueue,l.connectionId=l.options.connectionId||e.ID_PREFIX+oe.randomToken(),l.label=l.options.label||l.connectionId,l.serialization=l.options.serialization||tt.Binary,l.reliable=!!l.options.reliable,l._encodingQueue.on("done",function(_){l._bufferedSend(_)}),l._encodingQueue.on("error",function(){Z.default.error("DC#".concat(l.connectionId,": Error occured in encoding from blob to arraybuffer, close DC")),l.close()}),l._negotiator=new Xs.Negotiator(l),l._negotiator.startConnection(l.options._payload||{originator:!0}),l}return Object.defineProperty(e.prototype,"type",{get:function(){return Fe.Data},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!1,configurable:!0}),e.prototype.initialize=function(r){this._dc=r,this._configureDataChannel()},e.prototype._configureDataChannel=function(){var r=this;(!oe.supports.binaryBlob||oe.supports.reliable)&&(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){Z.default.log("DC#".concat(r.connectionId," dc connection success")),r._open=!0,r.emit("open")},this.dataChannel.onmessage=function(i){Z.default.log("DC#".concat(r.connectionId," dc onmessage:"),i.data),r._handleDataMessage(i)},this.dataChannel.onclose=function(){Z.default.log("DC#".concat(r.connectionId," dc closed for:"),r.peer),r.close()}},e.prototype._handleDataMessage=function(r){var i=this,o=r.data,l=o.constructor,_=this.serialization===tt.Binary||this.serialization===tt.BinaryUTF8,s=o;if(_){if(l===Blob){oe.blobToArrayBuffer(o,function(a){var h=oe.unpack(a);i.emit("data",h)});return}else if(l===ArrayBuffer)s=oe.unpack(o);else if(l===String){var n=oe.binaryStringToArrayBuffer(o);s=oe.unpack(n)}}else this.serialization===tt.JSON&&(s=this.parse(o));if(s.__peerData){this._handleChunk(s);return}t.prototype.emit.call(this,"data",s)},e.prototype._handleChunk=function(r){var i=r.__peerData,o=this._chunkedData[i]||{data:[],count:0,total:r.total};if(o.data[r.n]=r.data,o.count++,this._chunkedData[i]=o,o.total===o.count){delete this._chunkedData[i];var l=new Blob(o.data);this._handleDataMessage({data:l})}},e.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,t.prototype.emit.call(this,"close"))},e.prototype.send=function(r,i){if(!this.open){t.prototype.emit.call(this,"error",new Error("Connection is not open. You should listen for the `open` event before sending messages."));return}if(this.serialization===tt.JSON)this._bufferedSend(this.stringify(r));else if(this.serialization===tt.Binary||this.serialization===tt.BinaryUTF8){var o=oe.pack(r);if(!i&&o.size>oe.chunkedMTU){this._sendChunks(o);return}oe.supports.binaryBlob?this._bufferedSend(o):this._encodingQueue.enque(o)}else this._bufferedSend(r)},e.prototype._bufferedSend=function(r){(this._buffering||!this._trySend(r))&&(this._buffer.push(r),this._bufferSize=this._buffer.length)},e.prototype._trySend=function(r){var i=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>e.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(function(){i._buffering=!1,i._tryBuffer()},50),!1;try{this.dataChannel.send(r)}catch(o){return Z.default.error("DC#:".concat(this.connectionId," Error when sending:"),o),this._buffering=!0,this.close(),!1}return!0},e.prototype._tryBuffer=function(){if(this.open&&this._buffer.length!==0){var r=this._buffer[0];this._trySend(r)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}},e.prototype._sendChunks=function(r){var i,o,l=oe.chunk(r);Z.default.log("DC#".concat(this.connectionId," Try to send ").concat(l.length," chunks..."));try{for(var _=kh(l),s=_.next();!s.done;s=_.next()){var n=s.value;this.send(n,!0)}}catch(a){i={error:a}}finally{try{s&&!s.done&&(o=_.return)&&o.call(_)}finally{if(i)throw i.error}}},e.prototype.handleMessage=function(r){var i=r.payload;switch(r.type){case ge.Answer:this._negotiator.handleSDP(r.type,i.sdp);break;case ge.Candidate:this._negotiator.handleCandidate(i.candidate);break;default:Z.default.warn("Unrecognized message type:",r.type,"from peer:",this.peer);break}},e.ID_PREFIX="dc_",e.MAX_BUFFERED_AMOUNT=8388608,e}(Qs.BaseConnection),Ya={};Je(Ya,"API",()=>no,t=>no=t);var io=function(t,e,r,i){function o(l){return l instanceof r?l:new r(function(_){_(l)})}return new(r||(r=Promise))(function(l,_){function s(h){try{a(i.next(h))}catch(u){_(u)}}function n(h){try{a(i.throw(h))}catch(u){_(u)}}function a(h){h.done?l(h.value):o(h.value).then(s,n)}a((i=i.apply(t,e||[])).next())})},so=function(t,e){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,o,l,_;return _={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(_[Symbol.iterator]=function(){return this}),_;function s(a){return function(h){return n([a,h])}}function n(a){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,o&&(l=a[0]&2?o.return:a[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,a[1])).done)return l;switch(o=0,l&&(a=[a[0]&2,l.value]),a[0]){case 0:case 1:l=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!l||a[1]>l[0]&&a[1]<l[3])){r.label=a[1];break}if(a[0]===6&&r.label<l[1]){r.label=l[1],l=a;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(a);break}l[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(h){a=[6,h],o=0}finally{i=l=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},no=function(){function t(e){this._options=e}return t.prototype._buildRequest=function(e){var r=this._options.secure?"https":"http",i=this._options,o=i.host,l=i.port,_=i.path,s=i.key,n=new URL("".concat(r,"://").concat(o,":").concat(l).concat(_).concat(s,"/").concat(e));return n.searchParams.set("ts","".concat(Date.now()).concat(Math.random())),n.searchParams.set("version",Js.version),fetch(n.href,{referrerPolicy:this._options.referrerPolicy})},t.prototype.retrieveId=function(){return io(this,void 0,Promise,function(){var e,r,i;return so(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this._buildRequest("id")];case 1:if(e=o.sent(),e.status!==200)throw new Error("Error. Status:".concat(e.status));return[2,e.text()];case 2:throw r=o.sent(),Z.default.error("Error retrieving ID",r),i="",this._options.path==="/"&&this._options.host!==oe.CLOUD_HOST&&(i=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+i);case 3:return[2]}})})},t.prototype.listAllPeers=function(){return io(this,void 0,Promise,function(){var e,r,i;return so(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this._buildRequest("peers")];case 1:if(e=o.sent(),e.status!==200)throw e.status===401?(r="",this._options.host===oe.CLOUD_HOST?r="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":r="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+r)):new Error("Error. Status:".concat(e.status));return[2,e.json()];case 2:throw i=o.sent(),Z.default.error("Error retrieving list peers",i),new Error("Could not get list peers from the server."+i);case 3:return[2]}})})},t}(),Ah=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(i[l]=o[l])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}(),_r=function(){return _r=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},_r.apply(this,arguments)},nr=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Rh=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),o,l=[],_;try{for(;(e===void 0||e-- >0)&&!(o=i.next()).done;)l.push(o.value)}catch(s){_={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(_)throw _.error}}return l},si=function(t){Ah(e,t);function e(r,i){var o=t.call(this)||this;o._id=null,o._lastServerId=null,o._destroyed=!1,o._disconnected=!1,o._open=!1,o._connections=new Map,o._lostMessages=new Map;var l;return r&&r.constructor==Object?i=r:r&&(l=r.toString()),i=_r({debug:0,host:oe.CLOUD_HOST,port:oe.CLOUD_PORT,path:"/",key:e.DEFAULT_KEY,token:oe.randomToken(),config:oe.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin"},i),o._options=i,o._options.host==="/"&&(o._options.host=window.location.hostname),o._options.path&&(o._options.path[0]!=="/"&&(o._options.path="/"+o._options.path),o._options.path[o._options.path.length-1]!=="/"&&(o._options.path+="/")),o._options.secure===void 0&&o._options.host!==oe.CLOUD_HOST?o._options.secure=oe.isSecure():o._options.host==oe.CLOUD_HOST&&(o._options.secure=!0),o._options.logFunction&&Z.default.setLogFunction(o._options.logFunction),Z.default.logLevel=o._options.debug||0,o._api=new Ya.API(i),o._socket=o._createServerConnection(),!oe.supports.audioVideo&&!oe.supports.data?(o._delayedAbort(de.BrowserIncompatible,"The current browser does not support WebRTC"),o):l&&!oe.validateId(l)?(o._delayedAbort(de.InvalidID,'ID "'.concat(l,'" is invalid')),o):(l?o._initialize(l):o._api.retrieveId().then(function(_){return o._initialize(_)}).catch(function(_){return o._abort(de.ServerError,_)}),o)}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"open",{get:function(){return this._open},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"socket",{get:function(){return this._socket},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connections",{get:function(){var r,i,o=Object.create(null);try{for(var l=nr(this._connections),_=l.next();!_.done;_=l.next()){var s=Rh(_.value,2),n=s[0],a=s[1];o[n]=a}}catch(h){r={error:h}}finally{try{_&&!_.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return o},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!1,configurable:!0}),e.prototype._createServerConnection=function(){var r=this,i=new Ga.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return i.on(it.Message,function(o){r._handleMessage(o)}),i.on(it.Error,function(o){r._abort(de.SocketError,o)}),i.on(it.Disconnected,function(){r.disconnected||(r.emitError(de.Network,"Lost connection to server."),r.disconnect())}),i.on(it.Close,function(){r.disconnected||r._abort(de.SocketClosed,"Underlying socket is already closed.")}),i},e.prototype._initialize=function(r){this._id=r,this.socket.start(r,this._options.token)},e.prototype._handleMessage=function(r){var i,o,l=r.type,_=r.payload,s=r.src;switch(l){case ge.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case ge.Error:this._abort(de.ServerError,_.msg);break;case ge.IdTaken:this._abort(de.UnavailableID,'ID "'.concat(this.id,'" is taken'));break;case ge.InvalidKey:this._abort(de.InvalidKey,'API KEY "'.concat(this._options.key,'" is invalid'));break;case ge.Leave:Z.default.log("Received leave message from ".concat(s)),this._cleanupPeer(s),this._connections.delete(s);break;case ge.Expire:this.emitError(de.PeerUnavailable,"Could not connect to peer ".concat(s));break;case ge.Offer:var b=_.connectionId,m=this.getConnection(s,b);if(m&&(m.close(),Z.default.warn("Offer received for existing Connection ID:".concat(b))),_.type===Fe.Media){var n=new gs.MediaConnection(s,this,{connectionId:b,_payload:_,metadata:_.metadata});m=n,this._addConnection(s,m),this.emit("call",n)}else if(_.type===Fe.Data){var a=new ms.DataConnection(s,this,{connectionId:b,_payload:_,metadata:_.metadata,label:_.label,serialization:_.serialization,reliable:_.reliable});m=a,this._addConnection(s,m),this.emit("connection",a)}else{Z.default.warn("Received malformed connection type:".concat(_.type));return}var h=this._getMessages(b);try{for(var u=nr(h),g=u.next();!g.done;g=u.next()){var C=g.value;m.handleMessage(C)}}catch(c){i={error:c}}finally{try{g&&!g.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}break;default:if(!_){Z.default.warn("You received a malformed message from ".concat(s," of type ").concat(l));return}var b=_.connectionId,m=this.getConnection(s,b);m&&m.peerConnection?m.handleMessage(r):b?this._storeMessage(b,r):Z.default.warn("You received an unrecognized message:",r);break}},e.prototype._storeMessage=function(r,i){this._lostMessages.has(r)||this._lostMessages.set(r,[]),this._lostMessages.get(r).push(i)},e.prototype._getMessages=function(r){var i=this._lostMessages.get(r);return i?(this._lostMessages.delete(r),i):[]},e.prototype.connect=function(r,i){if(i===void 0&&(i={}),this.disconnected){Z.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(de.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}var o=new ms.DataConnection(r,this,i);return this._addConnection(r,o),o},e.prototype.call=function(r,i,o){if(o===void 0&&(o={}),this.disconnected){Z.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(de.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!i){Z.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}var l=new gs.MediaConnection(r,this,_r(_r({},o),{_stream:i}));return this._addConnection(r,l),l},e.prototype._addConnection=function(r,i){Z.default.log("add connection ".concat(i.type,":").concat(i.connectionId," to peerId:").concat(r)),this._connections.has(r)||this._connections.set(r,[]),this._connections.get(r).push(i)},e.prototype._removeConnection=function(r){var i=this._connections.get(r.peer);if(i){var o=i.indexOf(r);o!==-1&&i.splice(o,1)}this._lostMessages.delete(r.connectionId)},e.prototype.getConnection=function(r,i){var o,l,_=this._connections.get(r);if(!_)return null;try{for(var s=nr(_),n=s.next();!n.done;n=s.next()){var a=n.value;if(a.connectionId===i)return a}}catch(h){o={error:h}}finally{try{n&&!n.done&&(l=s.return)&&l.call(s)}finally{if(o)throw o.error}}return null},e.prototype._delayedAbort=function(r,i){var o=this;setTimeout(function(){o._abort(r,i)},0)},e.prototype._abort=function(r,i){Z.default.error("Aborting!"),this.emitError(r,i),this._lastServerId?this.disconnect():this.destroy()},e.prototype.emitError=function(r,i){Z.default.error("Error:",i);var o;typeof i=="string"?o=new Error(i):o=i,o.type=r,this.emit("error",o)},e.prototype.destroy=function(){this.destroyed||(Z.default.log("Destroy peer with ID:".concat(this.id)),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))},e.prototype._cleanup=function(){var r,i;try{for(var o=nr(this._connections.keys()),l=o.next();!l.done;l=o.next()){var _=l.value;this._cleanupPeer(_),this._connections.delete(_)}}catch(s){r={error:s}}finally{try{l&&!l.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}this.socket.removeAllListeners()},e.prototype._cleanupPeer=function(r){var i,o,l=this._connections.get(r);if(l)try{for(var _=nr(l),s=_.next();!s.done;s=_.next()){var n=s.value;n.close()}}catch(a){i={error:a}}finally{try{s&&!s.done&&(o=_.return)&&o.call(_)}finally{if(i)throw i.error}}},e.prototype.disconnect=function(){if(!this.disconnected){var r=this.id;Z.default.log("Disconnect peer with ID:".concat(r)),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=r,this._id=null,this.emit("disconnected",r)}},e.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)Z.default.log("Attempting reconnection to server with ID ".concat(this._lastServerId)),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)Z.default.error("In a hurry? We're still trying to make the initial connection!");else throw new Error("Peer ".concat(this.id," cannot reconnect because it is not disconnected from the server!"))}},e.prototype.listAllPeers=function(r){var i=this;r===void 0&&(r=function(o){}),this._api.listAllPeers().then(function(o){return r(o)}).catch(function(o){return i._abort(de.ServerError,o)})},e.DEFAULT_KEY="peerjs",e}(Er.EventEmitter);Va.Peer;const Dh=(t,e=document)=>e.querySelector(t),vs=(t,e=document)=>[...e.querySelectorAll(t)],Ja=(t,e=document)=>{const i=new XPathEvaluator().createExpression(t).evaluate(e,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE),o=[];for(let l=0,{snapshotLength:_}=i;l<_;l++)o.push(i.snapshotItem(l));return o},Xa=-1,vi=0,ni=1,oi=2,Zs=3,en=4,tn=5,rn=6,Qa=7,Za=8,oo=typeof self=="object"?self:globalThis,Lh=(t,e)=>{const r=(o,l)=>(t.set(l,o),o),i=o=>{if(t.has(o))return t.get(o);const[l,_]=e[o];switch(l){case vi:case Xa:return r(_,o);case ni:{const s=r([],o);for(const n of _)s.push(i(n));return s}case oi:{const s=r({},o);for(const[n,a]of _)s[i(n)]=i(a);return s}case Zs:return r(new Date(_),o);case en:{const{source:s,flags:n}=_;return r(new RegExp(s,n),o)}case tn:{const s=r(new Map,o);for(const[n,a]of _)s.set(i(n),i(a));return s}case rn:{const s=r(new Set,o);for(const n of _)s.add(i(n));return s}case Qa:{const{name:s,message:n}=_;return r(new oo[s](n),o)}case Za:return r(BigInt(_),o);case"BigInt":return r(Object(BigInt(_)),o)}return r(new oo[l](_),o)};return i},Oh=t=>Lh(new Map,t)(0),Mt="",{toString:xh}={},{keys:Ph}=Object,or=t=>{const e=typeof t;if(e!=="object"||!t)return[vi,e];const r=xh.call(t).slice(8,-1);switch(r){case"Array":return[ni,Mt];case"Object":return[oi,Mt];case"Date":return[Zs,Mt];case"RegExp":return[en,Mt];case"Map":return[tn,Mt];case"Set":return[rn,Mt]}return r.includes("Array")?[ni,r]:r.includes("Error")?[Qa,r]:[oi,r]},$r=([t,e])=>t===vi&&(e==="function"||e==="symbol"),Mh=(t,e,r,i)=>{const o=(_,s)=>{const n=i.push(_)-1;return r.set(s,n),n},l=_=>{if(r.has(_))return r.get(_);let[s,n]=or(_);switch(s){case vi:{let h=_;switch(n){case"bigint":s=Za,h=_.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+n);h=null;break;case"undefined":return o([Xa],_)}return o([s,h],_)}case ni:{if(n)return o([n,[..._]],_);const h=[],u=o([s,h],_);for(const g of _)h.push(l(g));return u}case oi:{if(n)switch(n){case"BigInt":return o([n,_.toString()],_);case"Boolean":case"Number":case"String":return o([n,_.valueOf()],_)}if(e&&"toJSON"in _)return l(_.toJSON());const h=[],u=o([s,h],_);for(const g of Ph(_))(t||!$r(or(_[g])))&&h.push([l(g),l(_[g])]);return u}case Zs:return o([s,_.toISOString()],_);case en:{const{source:h,flags:u}=_;return o([s,{source:h,flags:u}],_)}case tn:{const h=[],u=o([s,h],_);for(const[g,C]of _)(t||!($r(or(g))||$r(or(C))))&&h.push([l(g),l(C)]);return u}case rn:{const h=[],u=o([s,h],_);for(const g of _)(t||!$r(or(g)))&&h.push(l(g));return u}}const{message:a}=_;return o([s,{name:n,message:a}],_)};return l},Ih=(t,{json:e,lossy:r}={})=>{const i=[];return Mh(!(e||r),!!e,new Map,i)(t),i};/*! (c) Andrea Giammarchi - ISC */const{parse:Bh,stringify:Nh}=JSON,$h={json:!0,lossy:!0},Hh=t=>Oh(Bh(t)),Fh=t=>Nh(Ih(t,$h)),jh=Object.freeze(Object.defineProperty({__proto__:null,parse:Hh,stringify:Fh},Symbol.toStringTag,{value:"Module"})),ai="0811fd41-1b6b-49f1-8344-96210ac283f1",Uh="M"+ai,Wh="T"+ai,zh=t=>({value:new Promise(e=>{let r=new Worker("data:application/javascript,onmessage%3D(%7Bdata%3Ab%7D)%3D%3E(Atomics.wait(b%2C0)%2CpostMessage(0))");r.onmessage=e,r.postMessage(t)})});/*! (c) Andrea Giammarchi - ISC */const{Int32Array:ys,Map:ao,SharedArrayBuffer:co,Uint16Array:Ss}=globalThis,{BYTES_PER_ELEMENT:lo}=ys,{BYTES_PER_ELEMENT:Vh}=Ss,{isArray:Kh}=Array,{notify:Gh,wait:qh,waitAsync:Yh}=Atomics,{fromCharCode:Jh}=String,ho=(t,e)=>t?(Yh||zh)(e,0):(qh(e,0),{value:{then:r=>r()}}),bs=new WeakSet,Hi=new WeakMap;let Xh=0;const sn=(t,{parse:e,stringify:r,transform:i}=JSON)=>{if(!Hi.has(t)){const o=(l,..._)=>t.postMessage({[ai]:_},{transfer:l});Hi.set(t,new Proxy(new ao,{has:(l,_)=>typeof _=="string"&&!_.startsWith("_"),get:(l,_)=>_==="then"?null:(...s)=>{const n=Xh++;let a=new ys(new co(lo)),h=[];bs.has(s.at(-1)||h)&&bs.delete(h=s.pop()),o(h,n,a,_,i?s.map(i):s);const u=t!==globalThis;return ho(u,a).value.then(()=>{const g=a[0];if(!g)return;const C=Vh*g;return a=new ys(new co(C+C%lo)),o([],n,a),ho(u,a).value.then(()=>e(Jh(...new Ss(a.buffer).slice(0,g))))})},set(l,_,s){if(!l.size){const n=new ao;t.addEventListener("message",async a=>{var u;const h=(u=a.data)==null?void 0:u[ai];if(Kh(h)){a.stopImmediatePropagation();const[g,C,...b]=h;if(b.length){const[m,c]=b;if(l.has(m)){const p=await l.get(m)(...c);if(p!==void 0){const f=r(p);n.set(g,f),C[0]=f.length}}else throw new Error(`Unsupported action: ${m}`)}else{const m=n.get(g);n.delete(g);for(let c=new Ss(C.buffer),p=0;p<m.length;p++)c[p]=m.charCodeAt(p)}Gh(C,0)}})}return!!l.set(_,s)}}))}return Hi.get(t)};sn.transfer=(...t)=>(bs.add(t),t);const ht="object",Ke="function",Qh="boolean",nn="number",ci="string",ec="undefined",Zh="bigint",yi="symbol",eu="null",{defineProperty:Cs,getOwnPropertyDescriptor:tu,getPrototypeOf:tc,isExtensible:ru,ownKeys:rc,preventExtensions:iu,set:su,setPrototypeOf:nu}=Reflect,{assign:ou,create:au}=Object,ic=tc(Int8Array),Fi="isArray",sc=(t,e)=>{const{get:r,set:i,value:o}=t;return r&&(t.get=e(r)),i&&(t.set=e(i)),o&&(t.value=e(o)),t},xe=(t,e)=>[t,e],nc=t=>e=>{const r=typeof e;switch(r){case ht:if(e==null)return xe(eu,e);if(e===globalThis)return xe(ht,null);case Ke:return t(r,e);case Qh:case nn:case ci:case ec:case Zh:return xe(r,e);case yi:if(Es.has(e))return xe(r,Es.get(e))}throw new Error(`Unable to handle this ${r} type`)},Es=new Map(rc(Symbol).filter(t=>typeof Symbol[t]===yi).map(t=>[Symbol[t],t])),oc=t=>{for(const[e,r]of Es)if(r===t)return e};function cu(){return this}const Ut="apply",li="construct",hi="defineProperty",Ts="deleteProperty",ws="get",ks="getOwnPropertyDescriptor",As="getPrototypeOf",Rs="has",Ds="isExtensible",Ls="ownKeys",Os="preventExtensions",xs="set",Ps="setPrototypeOf",ui="delete",lu=(t,e)=>{const r=e&&new WeakMap;if(e){const{addEventListener:o}=EventTarget.prototype;Cs(EventTarget.prototype,"addEventListener",{value(l,_,...s){var n;return(n=s.at(0))!=null&&n.invoke&&(r.has(this)||r.set(this,new Map),r.get(this).set(l,[].concat(s[0].invoke)),delete s[0].invoke),o.call(this,l,_,...s)}})}const i=e&&(o=>{var n;const{currentTarget:l,target:_,type:s}=o;for(const a of((n=r.get(l||_))==null?void 0:n.get(s))||[])o[a]()});return(o,l,_,...s)=>{let n=0;const a=new Map,h=new Map,{[_]:u}=o,g=s.length?ou(au(globalThis),...s):globalThis,C=nc((p,f)=>{if(!a.has(f)){let d;for(;h.has(d=n++););a.set(f,d),h.set(d,f)}return xe(p,a.get(f))}),b=new FinalizationRegistry(p=>{u(ui,xe(ci,p))}),m=([p,f])=>{switch(p){case ht:if(f==null)return g;if(typeof f===nn)return h.get(f);if(!(f instanceof ic))for(const d in f)f[d]=m(f[d]);return f;case Ke:if(typeof f===ci){if(!h.has(f)){const d=function(...y){return e&&y.at(0)instanceof Event&&i(...y),u(Ut,xe(Ke,f),C(this),y.map(C))},v=new WeakRef(d);h.set(f,v),b.register(d,f,v)}return h.get(f).deref()}return h.get(f);case yi:return oc(f)}return f},c={[Ut]:(p,f,d)=>C(p.apply(f,d)),[li]:(p,f)=>C(new p(...f)),[hi]:(p,f,d)=>C(Cs(p,f,d)),[Ts]:(p,f)=>C(delete p[f]),[As]:p=>C(tc(p)),[ws]:(p,f)=>C(p[f]),[ks]:(p,f)=>{const d=tu(p,f);return d?xe(ht,sc(d,C)):xe(ec,d)},[Rs]:(p,f)=>C(f in p),[Ds]:p=>C(ru(p)),[Ls]:p=>xe(ht,rc(p).map(C)),[Os]:p=>C(iu(p)),[xs]:(p,f,d)=>C(su(p,f,d)),[Ps]:(p,f)=>C(nu(p,f)),[ui](p){a.delete(h.get(p)),h.delete(p)}};return o[l]=(p,f,...d)=>{switch(p){case Ut:d[0]=m(d[0]),d[1]=d[1].map(m);break;case li:d[0]=d[0].map(m);break;case hi:{const[v,y]=d;d[0]=m(v);const{get:E,set:T,value:S}=y;E&&(y.get=m(E)),T&&(y.set=m(T)),S&&(y.value=m(S));break}default:d=d.map(m);break}return c[p](m(f),...d)},{proxy:o,[t.toLowerCase()]:g,[`is${t}Proxy`]:()=>!1}}},hu=lu("Window",!0),uu=t=>{let e=0;const r=new Map,i=new Map,o=Symbol(),l=a=>typeof a===Ke?a():a,_=a=>typeof a===ht&&!!a&&o in a,s=Array[Fi],n=nc((a,h)=>{if(o in h)return l(h[o]);if(a===Ke){if(!i.has(h)){let u;for(;i.has(u=String(e++)););r.set(h,u),i.set(u,h)}return xe(a,r.get(h))}if(!(h instanceof ic))for(const u in h)h[u]=n(h[u]);return xe(a,h)});return(a,h,u)=>{const{[h]:g}=a,C=new Map,b=new FinalizationRegistry(y=>{C.delete(y),g(ui,n(y))}),m=y=>{const[E,T]=y;if(!C.has(T)){const S=E===Ke?cu.bind(y):y,w=new Proxy(S,f),A=new WeakRef(w);C.set(T,A),b.register(w,T,A)}return C.get(T).deref()},c=y=>{const[E,T]=y;switch(E){case ht:return T===null?globalThis:typeof T===nn?m(y):T;case Ke:return typeof T===ci?i.get(T):m(y);case yi:return oc(T)}return T},p=(y,E,...T)=>c(g(y,l(E),...T)),f={[Ut]:(y,E,T)=>p(Ut,y,n(E),T.map(n)),[li]:(y,E)=>p(li,y,E.map(n)),[hi]:(y,E,T)=>{const{get:S,set:w,value:A}=T;return typeof S===Ke&&(T.get=n(S)),typeof w===Ke&&(T.set=n(w)),typeof A===Ke&&(T.value=n(A)),p(hi,y,n(E),T)},[Ts]:(y,E)=>p(Ts,y,n(E)),[As]:y=>p(As,y),[ws]:(y,E)=>E===o?y:p(ws,y,n(E)),[ks]:(y,E)=>{const T=p(ks,y,n(E));return T&&sc(T,c)},[Rs]:(y,E)=>E===o||p(Rs,y,n(E)),[Ds]:y=>p(Ds,y),[Ls]:y=>p(Ls,y).map(c),[Os]:y=>p(Os,y),[xs]:(y,E,T)=>p(xs,y,n(E),n(T)),[Ps]:(y,E)=>p(Ps,y,n(E))};a[u]=(y,E,T,S)=>{switch(y){case Ut:return c(E).apply(c(T),S.map(c));case ui:{const w=c(E);r.delete(i.get(w)),i.delete(w)}}};const d=new Proxy([ht,null],f),v=d.Array[Fi];return Cs(Array,Fi,{value:y=>_(y)?v(y):s(y)}),{[t.toLowerCase()]:d,[`is${t}Proxy`]:_,proxy:a}}},du=uu("Window"),ji=new WeakMap,ac=(t,...e)=>{const r=sn(t,...e);if(!ji.has(r)){const i=t instanceof Worker?hu:du;ji.set(r,i(r,Uh,Wh))}return ji.get(r)};ac.transfer=sn.transfer;const fu=()=>new Worker(URL.createObjectURL(new Blob(['const e="object"==typeof self?self:globalThis,t=t=>((t,r)=>{const n=(e,r)=>(t.set(r,e),e),s=o=>{if(t.has(o))return t.get(o);const[a,i]=r[o];switch(a){case 0:case-1:return n(i,o);case 1:{const e=n([],o);for(const t of i)e.push(s(t));return e}case 2:{const e=n({},o);for(const[t,r]of i)e[s(t)]=s(r);return e}case 3:return n(new Date(i),o);case 4:{const{source:e,flags:t}=i;return n(new RegExp(e,t),o)}case 5:{const e=n(new Map,o);for(const[t,r]of i)e.set(s(t),s(r));return e}case 6:{const e=n(new Set,o);for(const t of i)e.add(s(t));return e}case 7:{const{name:t,message:r}=i;return n(new e[t](r),o)}case 8:return n(BigInt(i),o);case"BigInt":return n(Object(BigInt(i)),o)}return n(new e[a](i),o)};return s})(new Map,t)(0),r="",{toString:n}={},{keys:s}=Object,o=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const s=n.call(e).slice(8,-1);switch(s){case"Array":return[1,r];case"Object":return[2,r];case"Date":return[3,r];case"RegExp":return[4,r];case"Map":return[5,r];case"Set":return[6,r]}return s.includes("Array")?[1,s]:s.includes("Error")?[7,s]:[2,s]},a=([e,t])=>0===e&&("function"===t||"symbol"===t),i=(e,{json:t,lossy:r}={})=>{const n=[];return((e,t,r,n)=>{const i=(e,t)=>{const s=n.push(e)-1;return r.set(t,s),s},c=n=>{if(r.has(n))return r.get(n);let[l,u]=o(n);switch(l){case 0:{let t=n;switch(u){case"bigint":l=8,t=n.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);t=null;break;case"undefined":return i([-1],n)}return i([l,t],n)}case 1:{if(u)return i([u,[...n]],n);const e=[],t=i([l,e],n);for(const t of n)e.push(c(t));return t}case 2:{if(u)switch(u){case"BigInt":return i([u,n.toString()],n);case"Boolean":case"Number":case"String":return i([u,n.valueOf()],n)}if(t&&"toJSON"in n)return c(n.toJSON());const r=[],f=i([l,r],n);for(const t of s(n))!e&&a(o(n[t]))||r.push([c(t),c(n[t])]);return f}case 3:return i([l,n.toISOString()],n);case 4:{const{source:e,flags:t}=n;return i([l,{source:e,flags:t}],n)}case 5:{const t=[],r=i([l,t],n);for(const[r,s]of n)(e||!a(o(r))&&!a(o(s)))&&t.push([c(r),c(s)]);return r}case 6:{const t=[],r=i([l,t],n);for(const r of n)!e&&a(o(r))||t.push(c(r));return r}}const{message:f}=n;return i([l,{name:u,message:f}],n)};return c})(!(t||r),!!t,new Map,n)(e),n},{parse:c,stringify:l}=JSON,u={json:!0,lossy:!0};var f=Object.freeze({__proto__:null,parse:e=>t(c(e)),stringify:e=>l(i(e,u))});const p="0811fd41-1b6b-49f1-8344-96210ac283f1",d="M"+p,g="T"+p;var y=e=>({value:new Promise((t=>{let r=new Worker("data:application/javascript,onmessage%3D(%7Bdata%3Ab%7D)%3D%3E(Atomics.wait(b%2C0)%2CpostMessage(0))");r.onmessage=t,r.postMessage(e)}))})\n/*! (c) Andrea Giammarchi - ISC */;const{Int32Array:w,Map:h,SharedArrayBuffer:m,Uint16Array:b}=globalThis,{BYTES_PER_ELEMENT:v}=w,{BYTES_PER_ELEMENT:S}=b,{isArray:P}=Array,{notify:A,wait:E,waitAsync:M}=Atomics,{fromCharCode:j}=String,$=(e,t)=>e?(M||y)(t,0):(E(t,0),{value:{then:e=>e()}}),_=new WeakSet,x=new WeakMap;let k=0;const T=(e,{parse:t,stringify:r,transform:n}=JSON)=>{if(!x.has(e)){const s=(t,...r)=>e.postMessage({[p]:r},{transfer:t});x.set(e,new Proxy(new h,{has:(e,t)=>"string"==typeof t&&!t.startsWith("_"),get:(r,o)=>"then"===o?null:(...r)=>{const a=k++;let i=new w(new m(v)),c=[];_.has(r.at(-1)||c)&&_.delete(c=r.pop()),s(c,a,i,o,n?r.map(n):r);const l=e!==globalThis;return $(l,i).value.then((()=>{const e=i[0];if(!e)return;const r=S*e;return i=new w(new m(r+r%v)),s([],a,i),$(l,i).value.then((()=>t(j(...new b(i.buffer).slice(0,e)))))}))},set(t,n,s){if(!t.size){const n=new h;e.addEventListener("message",(async e=>{const s=e.data?.[p];if(P(s)){e.stopImmediatePropagation();const[o,a,...i]=s;if(i.length){const[e,s]=i;if(!t.has(e))throw new Error(`Unsupported action: ${e}`);{const i=await t.get(e)(...s);if(void 0!==i){const e=r(i);n.set(o,e),a[0]=e.length}}}else{const e=n.get(o);n.delete(o);for(let t=new b(a.buffer),r=0;r<e.length;r++)t[r]=e.charCodeAt(r)}A(a,0)}}))}return!!t.set(n,s)}}))}return x.get(e)};T.transfer=(...e)=>(_.add(e),e);const O="object",F="function",W="number",R="string",B="undefined",J="symbol",{defineProperty:L,getOwnPropertyDescriptor:I,getPrototypeOf:H,isExtensible:C,ownKeys:D,preventExtensions:N,set:U,setPrototypeOf:z}=Reflect,{assign:q,create:K}=Object,Y=H(Int8Array),G="isArray",V=(e,t)=>{const{get:r,set:n,value:s}=e;return r&&(e.get=t(r)),n&&(e.set=t(n)),s&&(e.value=t(s)),e},Q=(e,t)=>[e,t],X=e=>t=>{const r=typeof t;switch(r){case O:if(null==t)return Q("null",t);if(t===globalThis)return Q(O,null);case F:return e(r,t);case"boolean":case W:case R:case B:case"bigint":return Q(r,t);case J:if(Z.has(t))return Q(r,Z.get(t))}throw new Error(`Unable to handle this ${r} type`)},Z=new Map(D(Symbol).filter((e=>typeof Symbol[e]===J)).map((e=>[Symbol[e],e]))),ee=e=>{for(const[t,r]of Z)if(r===e)return t};function te(){return this}const re="apply",ne="construct",se="defineProperty",oe="deleteProperty",ae="get",ie="getOwnPropertyDescriptor",ce="getPrototypeOf",le="has",ue="isExtensible",fe="ownKeys",pe="preventExtensions",de="set",ge="setPrototypeOf",ye="delete";var we=((e,t)=>{const r=t&&new WeakMap;if(t){const{addEventListener:e}=EventTarget.prototype;L(EventTarget.prototype,"addEventListener",{value(t,n,...s){return s.at(0)?.invoke&&(r.has(this)||r.set(this,new Map),r.get(this).set(t,[].concat(s[0].invoke)),delete s[0].invoke),e.call(this,t,n,...s)}})}const n=t&&(e=>{const{currentTarget:t,target:n,type:s}=e;for(const o of r.get(t||n)?.get(s)||[])e[o]()});return(r,s,o,...a)=>{let i=0;const c=new Map,l=new Map,{[o]:u}=r,f=a.length?q(K(globalThis),...a):globalThis,p=X(((e,t)=>{if(!c.has(t)){let e;for(;l.has(e=i++););c.set(t,e),l.set(e,t)}return Q(e,c.get(t))})),d=new FinalizationRegistry((e=>{u(ye,Q(R,e))})),g=([e,r])=>{switch(e){case O:if(null==r)return f;if(typeof r===W)return l.get(r);if(!(r instanceof Y))for(const e in r)r[e]=g(r[e]);return r;case F:if(typeof r===R){if(!l.has(r)){const e=function(...e){return t&&e.at(0)instanceof Event&&n(...e),u(re,Q(F,r),p(this),e.map(p))},s=new WeakRef(e);l.set(r,s),d.register(e,r,s)}return l.get(r).deref()}return l.get(r);case J:return ee(r)}return r},y={[re]:(e,t,r)=>p(e.apply(t,r)),[ne]:(e,t)=>p(new e(...t)),[se]:(e,t,r)=>p(L(e,t,r)),[oe]:(e,t)=>p(delete e[t]),[ce]:e=>p(H(e)),[ae]:(e,t)=>p(e[t]),[ie]:(e,t)=>{const r=I(e,t);return r?Q(O,V(r,p)):Q(B,r)},[le]:(e,t)=>p(t in e),[ue]:e=>p(C(e)),[fe]:e=>Q(O,D(e).map(p)),[pe]:e=>p(N(e)),[de]:(e,t,r)=>p(U(e,t,r)),[ge]:(e,t)=>p(z(e,t)),[ye](e){c.delete(l.get(e)),l.delete(e)}};return r[s]=(e,t,...r)=>{switch(e){case re:r[0]=g(r[0]),r[1]=r[1].map(g);break;case ne:r[0]=r[0].map(g);break;case se:{const[e,t]=r;r[0]=g(e);const{get:n,set:s,value:o}=t;n&&(t.get=g(n)),s&&(t.set=g(s)),o&&(t.value=g(o));break}default:r=r.map(g)}return y[e](g(t),...r)},{proxy:r,[e.toLowerCase()]:f,[`is${e}Proxy`]:()=>!1}}})("Window",!0),he=(e=>{let t=0;const r=new Map,n=new Map,s=Symbol(),o=e=>typeof e===F?e():e,a=e=>typeof e===O&&!!e&&s in e,i=Array[G],c=X(((e,a)=>{if(s in a)return o(a[s]);if(e===F){if(!n.has(a)){let e;for(;n.has(e=String(t++)););r.set(a,e),n.set(e,a)}return Q(e,r.get(a))}if(!(a instanceof Y))for(const e in a)a[e]=c(a[e]);return Q(e,a)}));return(t,l,u)=>{const{[l]:f}=t,p=new Map,d=new FinalizationRegistry((e=>{p.delete(e),f(ye,c(e))})),g=e=>{const[t,r]=e;if(!p.has(r)){const n=t===F?te.bind(e):e,s=new Proxy(n,h),o=new WeakRef(s);p.set(r,o),d.register(s,r,o)}return p.get(r).deref()},y=e=>{const[t,r]=e;switch(t){case O:return null===r?globalThis:typeof r===W?g(e):r;case F:return typeof r===R?n.get(r):g(e);case J:return ee(r)}return r},w=(e,t,...r)=>y(f(e,o(t),...r)),h={[re]:(e,t,r)=>w(re,e,c(t),r.map(c)),[ne]:(e,t)=>w(ne,e,t.map(c)),[se]:(e,t,r)=>{const{get:n,set:s,value:o}=r;return typeof n===F&&(r.get=c(n)),typeof s===F&&(r.set=c(s)),typeof o===F&&(r.value=c(o)),w(se,e,c(t),r)},[oe]:(e,t)=>w(oe,e,c(t)),[ce]:e=>w(ce,e),[ae]:(e,t)=>t===s?e:w(ae,e,c(t)),[ie]:(e,t)=>{const r=w(ie,e,c(t));return r&&V(r,y)},[le]:(e,t)=>t===s||w(le,e,c(t)),[ue]:e=>w(ue,e),[fe]:e=>w(fe,e).map(y),[pe]:e=>w(pe,e),[de]:(e,t,r)=>w(de,e,c(t),c(r)),[ge]:(e,t)=>w(ge,e,c(t))};t[u]=(e,t,s,o)=>{switch(e){case re:return y(t).apply(y(s),o.map(y));case ye:{const e=y(t);r.delete(n.get(e)),n.delete(e)}}};const m=new Proxy([O,null],h),b=m.Array[G];return L(Array,G,{value:e=>a(e)?b(e):i(e)}),{[e.toLowerCase()]:m,[`is${e}Proxy`]:a,proxy:t}}})("Window");const me=new WeakMap,be=(e,...t)=>{const r=T(e,...t);if(!me.has(r)){const t=e instanceof Worker?we:he;me.set(r,t(r,d,g))}return me.get(r)};be.transfer=T.transfer;const{isArray:ve}=Array,{assign:Se,create:Pe,defineProperties:Ae,defineProperty:Ee,entries:Me}=Object,{all:je,resolve:$e}=new Proxy(Promise,{get:(e,t)=>e[t].bind(e)}),_e=(e,t=location.href)=>new URL(e,t).href;Promise.withResolvers||(Promise.withResolvers=function(){var e,t,r=new this((function(r,n){e=r,t=n}));return{resolve:e,reject:t,promise:r}});const xe=e=>e.arrayBuffer(),ke=e=>e.json(),Te=e=>e.text(),Oe=e=>e.replace(/^[^\\r\\n]+$/,(e=>e.trim())),Fe=new WeakMap,We=e=>{const t=e||console,r={stderr:(t.stderr||console.error).bind(t),stdout:(t.stdout||console.log).bind(t)};return{stderr:(...e)=>r.stderr(...e),stdout:(...e)=>r.stdout(...e),async get(e){const t=await e;return Fe.set(t,r),t}}},Re=({FS:e,PATH:t,PATH_FS:r},n,s)=>{const o=r.resolve(n);return e.mkdirTree(t.dirname(o)),e.writeFile(o,new Uint8Array(s),{canOwn:!0})},Be=e=>{const t=e.split("/");return t.pop(),t.join("/")},Je=(e,t)=>{const r=[];for(const n of t.split("/"))"."!==n&&(r.push(n),n&&e.mkdir(r.join("/")))},Le=(e,t)=>{const r=[];for(const e of t.split("/"))switch(e){case"":case".":break;case"..":r.pop();break;default:r.push(e)}return[e.cwd()].concat(r).join("/").replace(/^\\/+/,"/")},Ie=e=>{const t=e.map((e=>e.trim().replace(/(^[/]*|[/]*$)/g,""))).filter((e=>""!==e&&"."!==e)).join("/");return e[0].startsWith("/")?`/${t}`:t},He=new WeakMap,Ce=(e,t,r)=>je((e=>{for(const{files:t,to_file:r,from:n=""}of e){if(void 0!==t&&void 0!==r)throw new Error("Cannot use \'to_file\' and \'files\' parameters together!");if(void 0===t&&void 0===r&&n.endsWith("/"))throw new Error(`Couldn\'t determine the filename from the path ${n}, please supply \'to_file\' parameter.`)}return e.flatMap((({from:e="",to_folder:t=".",to_file:r,files:n})=>{if(ve(n))return n.map((r=>({url:Ie([e,r]),path:Ie([t,r])})));const s=r||e.slice(1+e.lastIndexOf("/"));return[{url:e,path:Ie([t,s])}]}))})(r).map((({url:n,path:s})=>((e,t)=>fetch(_e(t,He.get(e))))(r,n).then(xe).then((r=>e.writeFile(t,s,r)))))),De=(e,t,r)=>{e.registerJsModule(t,r)},Ne=(e,t)=>e.runPython(Oe(t)),Ue=(e,t)=>e.runPythonAsync(Oe(t)),ze=async(e,t,r)=>{const[n,...s]=t.split(".");let o,a=e.globals.get(n);for(const e of s)[o,a]=[a,a[e]];await a.call(o,r)};var qe={type:"micropython",module:(e="1.20.0-297")=>`https://cdn.jsdelivr.net/npm/@micropython/micropython-webassembly-pyscript@${e}/micropython.mjs`,async engine({loadMicroPython:e},t,r){const{stderr:n,stdout:s,get:o}=We();r=r.replace(/\\.m?js$/,".wasm");const a=await o(e({stderr:n,stdout:s,url:r}));return t.fetch&&await Ce(this,a,t.fetch),a},registerJSModule:De,run:Ne,runAsync:Ue,runEvent:ze,transform:(e,t)=>t,writeFile:({FS:e,_module:{PATH:t,PATH_FS:r}},n,s)=>Re({FS:e,PATH:t,PATH_FS:r},n,s)};const Ke={dict_converter:Object.fromEntries};var Ye={type:"pyodide",module:(e="0.23.4")=>`https://cdn.jsdelivr.net/pyodide/v${e}/full/pyodide.mjs`,async engine({loadPyodide:e},t,r){const{stderr:n,stdout:s,get:o}=We(),a=r.slice(0,r.lastIndexOf("/")),i=await o(e({stderr:n,stdout:s,indexURL:a}));if(t.fetch&&await Ce(this,i,t.fetch),t.packages){await i.loadPackage("micropip");const e=await i.pyimport("micropip");await e.install(t.packages),e.destroy()}return i},registerJSModule:De,run:Ne,runAsync:Ue,runEvent:ze,transform:(e,t)=>t instanceof e.ffi.PyProxy?t.toJs(Ke):t,writeFile:({FS:e,PATH:t,_module:{PATH_FS:r}},n,s)=>Re({FS:e,PATH:t,PATH_FS:r},n,s)};const Ge="ruby-wasm-wasi",Ve=Ge.replace(/\\W+/g,"_");var Qe={type:Ge,experimental:!0,module:(e="2.0.0")=>`https://cdn.jsdelivr.net/npm/ruby-3_2-wasm-wasi@${e}/dist/browser.esm.js`,async engine({DefaultRubyVM:e},t,r){const n=await fetch(`${r.slice(0,r.lastIndexOf("/"))}/ruby.wasm`),s=await WebAssembly.compile(await n.arrayBuffer()),{vm:o}=await e(s);return t.fetch&&await Ce(this,o,t.fetch),o},registerJSModule(e,t,r){const n=[\'require "js"\'];for(const[e,t]of Me(r)){const r=`__module_${Ve}_${e}`;globalThis[r]=t,n.push(`$${e}=JS.global[:${r}]`)}this.run(e,n.join(";"))},run:(e,t)=>e.eval(Oe(t)),runAsync:(e,t)=>e.evalAsync(Oe(t)),async runEvent(e,t,r){if(/^xworker\\.(on\\w+)$/.test(t)){const{$1:t}=RegExp,n=`__module_${Ve}_event`;globalThis[n]=r,this.run(e,`require "js";$xworker.call("${t}",JS.global[:${n}])`),delete globalThis[n]}else{const n=this.run(e,`method(:${t})`);await n.call(t,e.wrap(r))}},transform:(e,t)=>t,writeFile:()=>{throw new Error(`writeFile is not supported in ${Ge}`)}};var Xe={type:"wasmoon",module:(e="1.15.0")=>`https://cdn.jsdelivr.net/npm/wasmoon@${e}/+esm`,async engine({LuaFactory:e,LuaLibraries:t},r){const{stderr:n,stdout:s,get:o}=We(),a=await o((new e).createEngine());return a.global.getTable(t.Base,(e=>{a.global.setField(e,"print",s),a.global.setField(e,"printErr",n)})),r.fetch&&await Ce(this,a,r.fetch),a},registerJSModule:(e,t,r)=>{for(const[t,n]of Me(r))e.global.set(t,n)},run:(e,t)=>e.doStringSync(Oe(t)),runAsync:(e,t)=>e.doString(Oe(t)),runEvent:async(e,t,r)=>{const[n,...s]=t.split(".");let o,a=e.global.get(n);for(const e of s)[o,a]=[a,a[e]];await a.call(o,r)},transform:(e,t)=>t,writeFile:({cmodule:{module:{FS:e}}},t,r)=>((e,t,r)=>(Je(e,Be(t)),t=Le(e,t),e.writeFile(t,new Uint8Array(r),{canOwn:!0})))(e,t,r)};const Ze=new Map,et=new Map,tt=new Proxy(new Map,{get(e,t){if(!e.has(t)){const[r,...n]=t.split("@"),s=Ze.get(r),o=/^https?:\\/\\//i.test(n)?n.join("@"):s.module(...n);e.set(t,{url:o,module:import(o),engine:s.engine.bind(s)})}const{url:r,module:n,engine:s}=e.get(t);return(e,o)=>n.then((n=>{et.set(t,e);const a=e?.fetch;return a&&He.set(a,o),s(n,e,r)}))}}),rt=e=>{for(const t of[].concat(e.type))Ze.set(t,e)};for(const e of[qe,Ye,Qe,Xe])rt(e);const nt=async e=>(await import("https://cdn.jsdelivr.net/npm/basic-toml@0.3.1/es.js")).parse(e);try{new SharedArrayBuffer(4)}catch(e){throw new Error(["Unable to use SharedArrayBuffer due insecure environment.","Please read requirements in MDN: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer#security_requirements"].join("\\n"))}let st,ot,at;const it=(e,t)=>{addEventListener(e,t||(async t=>{try{await st,ot(`xworker.on${e}`,t)}catch(e){postMessage(e)}}),!!t&&{once:!0})},{parse:ct,stringify:lt}=f,{proxy:ut,window:ft,isWindowProxy:pt}=be(self,{parse:ct,stringify:lt,transform:e=>at?at(e):e}),dt={sync:ut,window:ft,isWindowProxy:pt,onmessage:console.info,onerror:console.error,onmessageerror:console.warn,postMessage:postMessage.bind(self)};it("message",(({data:{options:e,config:t,code:r,hooks:n}})=>{st=(async()=>{try{const{type:s,version:o,config:a,async:i}=e,c=await((e,t,r={})=>{if(t)if(t.endsWith(".json"))r=fetch(t).then(ke),t=_e(t);else if(t.endsWith(".toml"))r=fetch(t).then(Te).then(nt),t=_e(t);else if(!t.endsWith(".txt")){try{r=JSON.parse(t)}catch(e){r=nt(t)}t=_e("./config.txt")}return $e(r).then((r=>tt[e](r,t)))})(((e,t="")=>`${e}@${t}`.replace(/@$/,""))(s,o),t,a),l=Pe(Ze.get(s)),u="run"+(i?"Async":"");if(n){const{beforeRun:e,beforeRunAsync:t,afterRun:r,afterRunAsync:s}=n,o=r||s,a=e||t;if(o){const e=l[u].bind(l);l[u]=(t,r)=>e(t,`${r}\\n${o}`)}if(a){const e=l[u].bind(l);l[u]=(t,r)=>e(t,`${a}\\n${r}`)}}return l.registerJSModule(c,"polyscript",{xworker:dt}),ot=l.runEvent.bind(l,c),at=l.transform.bind(l,c),await l[u](c,r),c}catch(e){postMessage(e)}})(),it("error"),it("message"),it("messageerror")}));\n'],{type:"application/javascript"})),{type:"module"}),{isArray:pu}=Array,{assign:cc,create:lc,defineProperties:_u,defineProperty:hc,entries:uc}=Object,{all:on,resolve:dc}=new Proxy(Promise,{get:(t,e)=>t[e].bind(t)}),gr=(t,e=location.href)=>new URL(t,e).href,gu=t=>t.arrayBuffer(),mu=t=>t.json(),an=t=>t.text(),uo=[["beforeRun","codeBeforeRunWorker"],["beforeRunAsync","codeBeforeRunWorkerAsync"],["afterRun","codeAfterRunWorker"],["afterRunAsync","codeAfterRunWorkerAsync"]];class fc{constructor(e,r){var i;this.interpreter=e,this.onWorkerReady=r.onWorkerReady;for(const[o,l]of uo)this[o]=(i=r[l])==null?void 0:i.call(r)}get stringHooks(){const e={};for(const[r]of uo)this[r]&&(e[r]=this[r]);return e}}const pc=(...t)=>function(r,i){var a;const o=fu(),{postMessage:l}=o,_=this instanceof fc;if(t.length){const[h,u]=t;i=cc({},i||{type:h,version:u}),i.type||(i.type=h)}const s=gr(typeof i.config=="string"?i.config:"./config.txt"),n=fetch(r).then(an).then(h=>{const u=_?this.stringHooks:void 0;l.call(o,{options:i,config:s,code:h,hooks:u})});return _u(o,{postMessage:{value:(h,...u)=>n.then(()=>l.call(o,h,...u))},sync:{value:ac(o,jh).proxy},onerror:{writable:!0,configurable:!0,value:console.error}}),_&&((a=this.onWorkerReady)==null||a.call(this,this.interpreter,o)),o.addEventListener("message",h=>{const{data:u}=h;u instanceof Error&&(h.stopImmediatePropagation(),o.onerror(Object.create(h,{type:{value:"error"},error:{value:u}})))}),o},vu="modulepreload",yu=function(t){return"/mpyc/"+t},fo={},_c=function(e,r,i){if(!r||r.length===0)return e();const o=document.getElementsByTagName("link");return Promise.all(r.map(l=>{if(l=yu(l),l in fo)return;fo[l]=!0;const _=l.endsWith(".css"),s=_?'[rel="stylesheet"]':"";if(!!i)for(let h=o.length-1;h>=0;h--){const u=o[h];if(u.href===l&&(!_||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${s}`))return;const a=document.createElement("link");if(a.rel=_?"stylesheet":vu,_||(a.as="script",a.crossOrigin=""),a.href=l,document.head.appendChild(a),_)return new Promise((h,u)=>{a.addEventListener("load",h),a.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${l}`)))})})).then(()=>e()).catch(l=>{const _=new Event("vite:preloadError",{cancelable:!0});if(_.payload=l,window.dispatchEvent(_),!_.defaultPrevented)throw l})};Promise.withResolvers||(Promise.withResolvers=function(){var e,r,i=new this(function(o,l){e=o,r=l});return{resolve:e,reject:r,promise:i}});const Wt=t=>t.replace(/^[^\r\n]+$/,e=>e.trim()),gc=new WeakMap,cn=t=>{const e=t||console,r={stderr:(e.stderr||console.error).bind(e),stdout:(e.stdout||console.log).bind(e)};return{stderr:(...i)=>r.stderr(...i),stdout:(...i)=>r.stdout(...i),async get(i){const o=await i;return gc.set(o,r),o}}},mc=({FS:t,PATH:e,PATH_FS:r},i,o)=>{const l=r.resolve(i);return t.mkdirTree(e.dirname(l)),t.writeFile(l,new Uint8Array(o),{canOwn:!0})},Su=(t,e,r)=>(Cu(t,bu(e)),e=Eu(t,e),t.writeFile(e,new Uint8Array(r),{canOwn:!0})),bu=t=>{const e=t.split("/");return e.pop(),e.join("/")},Cu=(t,e)=>{const r=[];for(const i of e.split("/"))i!=="."&&(r.push(i),i&&t.mkdir(r.join("/")))},Eu=(t,e)=>{const r=[];for(const i of e.split("/"))switch(i){case"":break;case".":break;case"..":r.pop();break;default:r.push(i)}return[t.cwd()].concat(r).join("/").replace(/^\/+/,"/")},Tu=t=>{for(const{files:e,to_file:r,from:i=""}of t){if(e!==void 0&&r!==void 0)throw new Error("Cannot use 'to_file' and 'files' parameters together!");if(e===void 0&&r===void 0&&i.endsWith("/"))throw new Error(`Couldn't determine the filename from the path ${i}, please supply 'to_file' parameter.`)}return t.flatMap(({from:e="",to_folder:r=".",to_file:i,files:o})=>{if(pu(o))return o.map(_=>({url:Ui([e,_]),path:Ui([r,_])}));const l=i||e.slice(1+e.lastIndexOf("/"));return[{url:e,path:Ui([r,l])}]})},Ui=t=>{const e=t.map(r=>r.trim().replace(/(^[/]*|[/]*$)/g,"")).filter(r=>r!==""&&r!==".").join("/");return t[0].startsWith("/")?`/${e}`:e},wu=(t,e)=>fetch(gr(e,vc.get(t))),vc=new WeakMap,Si=(t,e,r)=>on(Tu(r).map(({url:i,path:o})=>wu(r,i).then(gu).then(l=>t.writeFile(e,o,l)))),yc=(t,e,r)=>{t.registerJsModule(e,r)},Sc=(t,e)=>t.runPython(Wt(e)),bc=(t,e)=>t.runPythonAsync(Wt(e)),Cc=async(t,e,r)=>{const[i,...o]=e.split(".");let l=t.globals.get(i),_;for(const s of o)[_,l]=[l,l[s]];await l.call(_,r)},ku="micropython",Au={type:ku,module:(t="1.20.0-297")=>`https://cdn.jsdelivr.net/npm/@micropython/micropython-webassembly-pyscript@${t}/micropython.mjs`,async engine({loadMicroPython:t},e,r){const{stderr:i,stdout:o,get:l}=cn();r=r.replace(/\.m?js$/,".wasm");const _=await l(t({stderr:i,stdout:o,url:r}));return e.fetch&&await Si(this,_,e.fetch),_},registerJSModule:yc,run:Sc,runAsync:bc,runEvent:Cc,transform:(t,e)=>e,writeFile:({FS:t,_module:{PATH:e,PATH_FS:r}},i,o)=>mc({FS:t,PATH:e,PATH_FS:r},i,o)},Ru="pyodide",Du={dict_converter:Object.fromEntries},Lu={type:Ru,module:(t="0.23.4")=>`https://cdn.jsdelivr.net/pyodide/v${t}/full/pyodide.mjs`,async engine({loadPyodide:t},e,r){const{stderr:i,stdout:o,get:l}=cn(),_=r.slice(0,r.lastIndexOf("/")),s=await l(t({stderr:i,stdout:o,indexURL:_}));if(e.fetch&&await Si(this,s,e.fetch),e.packages){await s.loadPackage("micropip");const n=await s.pyimport("micropip");await n.install(e.packages),n.destroy()}return s},registerJSModule:yc,run:Sc,runAsync:bc,runEvent:Cc,transform:(t,e)=>e instanceof t.ffi.PyProxy?e.toJs(Du):e,writeFile:({FS:t,PATH:e,_module:{PATH_FS:r}},i,o)=>mc({FS:t,PATH:e,PATH_FS:r},i,o)},Ms="ruby-wasm-wasi",po=Ms.replace(/\W+/g,"_"),Ou={type:Ms,experimental:!0,module:(t="2.0.0")=>`https://cdn.jsdelivr.net/npm/ruby-3_2-wasm-wasi@${t}/dist/browser.esm.js`,async engine({DefaultRubyVM:t},e,r){const i=await fetch(`${r.slice(0,r.lastIndexOf("/"))}/ruby.wasm`),o=await WebAssembly.compile(await i.arrayBuffer()),{vm:l}=await t(o);return e.fetch&&await Si(this,l,e.fetch),l},registerJSModule(t,e,r){const i=['require "js"'];for(const[o,l]of uc(r)){const _=`__module_${po}_${o}`;globalThis[_]=l,i.push(`$${o}=JS.global[:${_}]`)}this.run(t,i.join(";"))},run:(t,e)=>t.eval(Wt(e)),runAsync:(t,e)=>t.evalAsync(Wt(e)),async runEvent(t,e,r){if(/^xworker\.(on\w+)$/.test(e)){const{$1:i}=RegExp,o=`__module_${po}_event`;globalThis[o]=r,this.run(t,`require "js";$xworker.call("${i}",JS.global[:${o}])`),delete globalThis[o]}else await this.run(t,`method(:${e})`).call(e,t.wrap(r))},transform:(t,e)=>e,writeFile:()=>{throw new Error(`writeFile is not supported in ${Ms}`)}},xu="wasmoon",Pu={type:xu,module:(t="1.15.0")=>`https://cdn.jsdelivr.net/npm/wasmoon@${t}/+esm`,async engine({LuaFactory:t,LuaLibraries:e},r){const{stderr:i,stdout:o,get:l}=cn(),_=await l(new t().createEngine());return _.global.getTable(e.Base,s=>{_.global.setField(s,"print",o),_.global.setField(s,"printErr",i)}),r.fetch&&await Si(this,_,r.fetch),_},registerJSModule:(t,e,r)=>{for(const[i,o]of uc(r))t.global.set(i,o)},run:(t,e)=>t.doStringSync(Wt(e)),runAsync:(t,e)=>t.doString(Wt(e)),runEvent:async(t,e,r)=>{const[i,...o]=e.split(".");let l=t.global.get(i),_;for(const s of o)[_,l]=[l,l[s]];await l.call(_,r)},transform:(t,e)=>e,writeFile:({cmodule:{module:{FS:t}}},e,r)=>Su(t,e,r)},Tr=new Map,Ec=new Map,Tc=[],bi=[],Mu=new Proxy(new Map,{get(t,e){if(!t.has(e)){const[l,..._]=e.split("@"),s=Tr.get(l),n=/^https?:\/\//i.test(_)?_.join("@"):s.module(..._);t.set(e,{url:n,module:_c(()=>import(n),[]),engine:s.engine.bind(s)})}const{url:r,module:i,engine:o}=t.get(e);return(l,_)=>i.then(s=>{Ec.set(e,l);const n=l==null?void 0:l.fetch;return n&&vc.set(n,_),o(s,l,r)})}}),Iu=t=>{for(const e of[].concat(t.type))Tr.set(e,t),Tc.push(`script[type="${e}"]`),bi.push(`${e}-`)};for(const t of[Au,Lu,Ou,Pu])Iu(t);const Bu="https://cdn.jsdelivr.net/npm/basic-toml@0.3.1/es.js",_o=async t=>(await _c(()=>import(Bu),[])).parse(t),Nu=(t,e,r={})=>{if(e){if(e.endsWith(".json"))r=fetch(e).then(mu),e=gr(e);else if(e.endsWith(".toml"))r=fetch(e).then(an).then(_o),e=gr(e);else if(!e.endsWith(".txt")){try{r=JSON.parse(e)}catch{r=_o(e)}e=gr("./config.txt")}}return dc(r).then(i=>Mu[t](i,e))},wc=(t,e="")=>`${t}@${e}`.replace(/@$/,""),$u=t=>{let e=t;for(;e.parentNode;)e=e.parentNode;return e},kc=(t,e)=>{const r=$u(t);return r.getElementById(e)||Dh(e,r)},pr=new WeakMap,Hu={get(){let t=pr.get(this);return t||(t=document.createElement(`${this.type}-script`),pr.set(this,t),Sr(this)),t},set(t){typeof t=="string"?pr.set(this,kc(this,t)):(pr.set(this,t),Sr(this))}},Is=new WeakMap,rt=new Map,Fu=async(t,e,r,i)=>{const o=Tr.get(t.type);o.experimental&&console.warn(`The ${t.type} interpreter is experimental`);const[l,_]=await on([Is.get(t).interpreter,e]);try{return hc(document,"currentScript",{configurable:!0,get:()=>t}),o.registerJSModule(l,"polyscript",{XWorker:r}),o[i?"runAsync":"run"](l,_)}finally{delete document.currentScript}},Wi=(t,e)=>{const r=t==null?void 0:t.value;return r?e+r:""},Ac=(t,e,r,i,o)=>{if(!rt.has(e)){const l={interpreter:Nu(r,o),queue:dc(),XWorker:pc(t,i)};rt.set(e,l),rt.has(t)||rt.set(t,l)}return rt.get(e)},Sr=async t=>{if(Is.has(t)){const{target:e}=t;e&&(t.closest("head")?document.body.append(e):t.after(e))}else{const{attributes:{async:e,config:r,env:i,target:o,version:l},src:_,type:s}=t,n=l==null?void 0:l.value,a=wc(s,n),h=Wi(o,"");let u=Wi(r,"|");const g=Wi(i,"")||`${a}${u}`;u=u.slice(1);const C=Ac(s,g,a,n,u);Is.set(hc(t,"target",Hu),C),h&&pr.set(t,kc(t,h));const b=_?fetch(_).then(an):t.textContent;C.queue=C.queue.then(()=>Fu(t,b,C.XWorker,!!e))}};new Proxy(lc(null),{get:(t,e)=>Rc(e)});const Rc=async t=>{if(rt.has(t)){const{interpreter:r,queue:i}=rt.get(t);return(await on([r,i]))[0]}const e=rt.size?`Available interpreters are: ${[...rt.keys()].map(r=>`"${r}"`).join(", ")}.`:"There are no interpreters in this page.";throw new Error(`The interpreter "${t}" was not found. ${e}`)},Dc=async t=>{const{type:e,currentTarget:r}=t;for(let{name:i,value:o,ownerElement:l}of Ja(`./@*[${bi.map(_=>`name()="${_}${e}"`).join(" or ")}]`,r)){i=i.slice(0,-(e.length+1));const _=await Rc(l.getAttribute(`${i}-env`)||i);Tr.get(i).runEvent(_,o,t)}},Lc=t=>{for(let{name:e,ownerElement:r}of Ja(`.//@*[${bi.map(i=>`starts-with(name(),"${i}")`).join(" or ")}]`,t))e=e.slice(e.lastIndexOf("-")+1),e!=="env"&&r.addEventListener(e,Dc)},Bs=[],ju=new Map,Uu=new Map,go=t=>{for(const e of Bs)if(t.matches(e)){const r=ju.get(e),{resolve:i}=Uu.get(r),{options:o,known:l}=Wu.get(r);if(!l.has(t)){l.add(t);const{interpreter:_,version:s,config:n,env:a,onInterpreterReady:h}=o,u=wc(_,s),g=a||`${u}${n?`|${n}`:""}`,{interpreter:C,XWorker:b}=Ac(_,g,u,s,n);C.then(m=>{const c=lc(Tr.get(_)),{onBeforeRun:p,onBeforeRunAsync:f,onAfterRun:d,onAfterRunAsync:v}=o,y=new fc(m,o),E=function(...w){return b.apply(y,w)};for(const[S,[w,A]]of[["run",[p,d]]]){const D=c[S];c[S]=function(R,x){w&&w.call(this,T,t);const F=D.call(this,R,x);return A&&A.call(this,T,t),F}}for(const[S,[w,A]]of[["runAsync",[f,v]]]){const D=c[S];c[S]=async function(R,x){w&&await w.call(this,T,t);const F=await D.call(this,R,x);return A&&await A.call(this,T,t),F}}c.registerJSModule(m,"polyscript",{XWorker:E});const T={type:r,interpreter:m,XWorker:E,io:gc.get(m),config:structuredClone(Ec.get(u)),run:c.run.bind(c,m),runAsync:c.runAsync.bind(c,m),runEvent:c.runEvent.bind(c,m)};i(T),h==null||h(T,t)})}}},Wu=new Map,zu=pc(),Ns=Tc.join(","),Vu=new MutationObserver(t=>{for(const{type:e,target:r,attributeName:i,addedNodes:o}of t){if(e==="attributes"){const l=i.lastIndexOf("-")+1;if(l){const _=i.slice(0,l);for(const s of bi)if(_===s){const n=i.slice(l);if(n!=="env"){const a=r.hasAttribute(i)?"add":"remove";r[`${a}EventListener`](n,Dc)}break}}continue}for(const l of o)if(l.nodeType===1)if(Lc(l),l.matches(Ns))Sr(l);else{if(vs(Ns,l).forEach(Sr),!Bs.length)continue;go(l),vs(Bs.join(","),l).forEach(go)}}}),Oc=t=>(Vu.observe(t,{childList:!0,subtree:!0,attributes:!0}),t),{attachShadow:Ku}=Element.prototype;cc(Element.prototype,{attachShadow(t){return Oc(Ku.call(this,t))}});Lc(Oc(document));vs(Ns,document).forEach(Sr);class Gu{constructor(e,r){Ve(this,"peer");Ve(this,"conns",new Map);Ve(this,"worker");Ve(this,"onPeerConnectedHook",()=>{});Ve(this,"onPeerDisconnectedHook",()=>{});Ve(this,"onPeerJSUserDataReceivedHook",()=>{});Ve(this,"onPeerIDReadyHook",()=>{});Ve(this,"onPyScriptDisplayHook",()=>{});Ve(this,"onRuntimeReadyHook",()=>{});this.peer=this.newPeerJS(e),this.worker=this.newWorker(this.conns,r)}getPeers(e=!1){let r=Array.from(this.conns,([i,o])=>o.peer);return e&&r.push(this.peer.id),r.sort()}broadcastMessage(e){this.conns.forEach(r=>{r.send(e)})}connectToPeer(e){let r=this.peer.connect(e,{reliable:!0});r.on("open",()=>{this.sendKnownPeers(r),this.conns.set(r.peer,r),this.onPeerConnectedHook(r.peer,this.getPeers(!0))}),this.ready(r)}runMPyCDemo(e=!1){let r=this.getPeers(!0),i=r.findIndex(o=>o===this.peer.id);console.log("peers:",r),console.log("my id:",this.peer.id),console.log("my pid:",i),this.postWorkerMessage({init:{pid:i,parties:r,is_async:e,no_async:!e}})}close(){this.peer.destroy(),this.worker.terminate()}newPeerJS(e){var r;return e?r=new si(e):r=new si,this.addPeerEvents(r),r}newWorker(e,r){let i=new zu("./py/worker.py",{async:!0,type:"pyodide",config:r});return i.sync.myFunc=function(o){console.log("myFunc",o)},i.onmessage=o=>{var _;console.log("(mpyc.js:worker:onmessage): --------------- data",o.data);let l=JSON.parse(o.data);l.display&&this.onPyScriptDisplayHook(l.display),l.peerJS&&(console.log("++++++++++++++ peerJS data"),(_=e.get(l.peerJS.peerID))==null||_.send({mpycMessage:l.peerJS.message}))},i}addPeerEvents(e){e.on("open",r=>{this.onPeerIDReadyHook(r)}),e.on("connection",r=>{r.on("open",()=>{this.sendKnownPeers(r)}),this.conns.set(r.peer,r),this.onPeerConnectedHook(r.peer,this.getPeers(!0)),this.ready(r)})}sendKnownPeers(e){e.send({knownPeers:this.getPeers()})}ready(e){e.on("data",r=>{console.log("Data received"),console.log(r),this.processNewPeers(r==null?void 0:r.knownPeers),this.processMPyCMessage(e.peer,r==null?void 0:r.mpycMessage),this.onPeerJSUserDataReceivedHook(e.peer,r)}),e.on("close",()=>{this.conns.delete(e.peer),this.onPeerDisconnectedHook(e.peer,this.getPeers(!0))})}processNewPeers(e){e&&e.forEach(r=>{!this.conns.get(r)&&r!=this.peer.id&&this.connectToPeer(r)})}processMPyCMessage(e,r){r&&this.postWorkerMessage({peerJS:{peerID:e,message:r}})}postWorkerMessage(e){this.worker.postMessage(this.workMessage(e))}workMessage(e){return e={init:null,peerJS:null,...e},e.peerJS&&(e.peerJS.message={runtime_message:null,ready_message:null,...e.peerJS.message}),e}}var xc={exports:{}};(function(t,e){(function(r,i){t.exports=i()})(self,()=>(()=>{var r={4567:function(_,s,n){var a=this&&this.__decorate||function(d,v,y,E){var T,S=arguments.length,w=S<3?v:E===null?E=Object.getOwnPropertyDescriptor(v,y):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(d,v,y,E);else for(var A=d.length-1;A>=0;A--)(T=d[A])&&(w=(S<3?T(w):S>3?T(v,y,w):T(v,y))||w);return S>3&&w&&Object.defineProperty(v,y,w),w},h=this&&this.__param||function(d,v){return function(y,E){v(y,E,d)}};Object.defineProperty(s,"__esModule",{value:!0}),s.AccessibilityManager=void 0;const u=n(9042),g=n(6114),C=n(9924),b=n(844),m=n(5596),c=n(4725),p=n(3656);let f=class extends b.Disposable{constructor(d,v){super(),this._terminal=d,this._renderService=v,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let y=0;y<this._terminal.rows;y++)this._rowElements[y]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[y]);if(this._topBoundaryFocusListener=y=>this._handleBoundaryFocus(y,0),this._bottomBoundaryFocusListener=y=>this._handleBoundaryFocus(y,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new C.TimeBasedDebouncer(this._announceCharacters.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._liveRegionDebouncer),this.register(this._terminal.onResize(y=>this._handleResize(y.rows))),this.register(this._terminal.onRender(y=>this._refreshRows(y.start,y.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(y=>this._handleChar(y))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(y=>this._handleTab(y))),this.register(this._terminal.onKey(y=>this._handleKey(y.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new m.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,p.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,b.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(d){for(let v=0;v<d;v++)this._handleChar(" ")}_handleChar(d){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==d&&(this._charsToAnnounce+=d):this._charsToAnnounce+=d,d===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=u.tooMuchOutput)),g.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,g.isMac&&this._liveRegion.remove()}_handleKey(d){this._clearLiveRegion(),/\p{Control}/u.test(d)||this._charsToConsume.push(d)}_refreshRows(d,v){this._liveRegionDebouncer.refresh(d,v,this._terminal.rows)}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(d,v){const y=d.target,E=this._rowElements[v===0?1:this._rowElements.length-2];if(y.getAttribute("aria-posinset")===(v===0?"1":`${this._terminal.buffer.lines.length}`)||d.relatedTarget!==E)return;let T,S;if(v===0?(T=y,S=this._rowElements.pop(),this._rowContainer.removeChild(S)):(T=this._rowElements.shift(),S=y,this._rowContainer.removeChild(T)),T.removeEventListener("focus",this._topBoundaryFocusListener),S.removeEventListener("focus",this._bottomBoundaryFocusListener),v===0){const w=this._createAccessibilityTreeNode();this._rowElements.unshift(w),this._rowContainer.insertAdjacentElement("afterbegin",w)}else{const w=this._createAccessibilityTreeNode();this._rowElements.push(w),this._rowContainer.appendChild(w)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(v===0?-1:1),this._rowElements[v===0?1:this._rowElements.length-2].focus(),d.preventDefault(),d.stopImmediatePropagation()}_handleResize(d){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let v=this._rowContainer.children.length;v<this._terminal.rows;v++)this._rowElements[v]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[v]);for(;this._rowElements.length>d;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const d=document.createElement("div");return d.setAttribute("role","listitem"),d.tabIndex=-1,this._refreshRowDimensions(d),d}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let d=0;d<this._terminal.rows;d++)this._refreshRowDimensions(this._rowElements[d])}}_refreshRowDimensions(d){d.style.height=`${this._renderService.dimensions.css.cell.height}px`}};f=a([h(1,c.IRenderService)],f),s.AccessibilityManager=f},3614:(_,s)=>{function n(g){return g.replace(/\r?\n/g,"\r")}function a(g,C){return C?"\x1B[200~"+g+"\x1B[201~":g}function h(g,C,b){g=a(g=n(g),b.decPrivateModes.bracketedPasteMode),b.triggerDataEvent(g,!0),C.value=""}function u(g,C,b){const m=b.getBoundingClientRect(),c=g.clientX-m.left-10,p=g.clientY-m.top-10;C.style.width="20px",C.style.height="20px",C.style.left=`${c}px`,C.style.top=`${p}px`,C.style.zIndex="1000",C.focus()}Object.defineProperty(s,"__esModule",{value:!0}),s.rightClickHandler=s.moveTextAreaUnderMouseCursor=s.paste=s.handlePasteEvent=s.copyHandler=s.bracketTextForPaste=s.prepareTextForTerminal=void 0,s.prepareTextForTerminal=n,s.bracketTextForPaste=a,s.copyHandler=function(g,C){g.clipboardData&&g.clipboardData.setData("text/plain",C.selectionText),g.preventDefault()},s.handlePasteEvent=function(g,C,b){g.stopPropagation(),g.clipboardData&&h(g.clipboardData.getData("text/plain"),C,b)},s.paste=h,s.moveTextAreaUnderMouseCursor=u,s.rightClickHandler=function(g,C,b,m,c){u(g,C,b),c&&m.rightClickSelect(g),C.value=m.selectionText,C.select()}},7239:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ColorContrastCache=void 0;const a=n(1505);s.ColorContrastCache=class{constructor(){this._color=new a.TwoKeyMap,this._css=new a.TwoKeyMap}setCss(h,u,g){this._css.set(h,u,g)}getCss(h,u){return this._css.get(h,u)}setColor(h,u,g){this._color.set(h,u,g)}getColor(h,u){return this._color.get(h,u)}clear(){this._color.clear(),this._css.clear()}}},3656:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.addDisposableDomListener=void 0,s.addDisposableDomListener=function(n,a,h,u){n.addEventListener(a,h,u);let g=!1;return{dispose:()=>{g||(g=!0,n.removeEventListener(a,h,u))}}}},6465:function(_,s,n){var a=this&&this.__decorate||function(c,p,f,d){var v,y=arguments.length,E=y<3?p:d===null?d=Object.getOwnPropertyDescriptor(p,f):d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(c,p,f,d);else for(var T=c.length-1;T>=0;T--)(v=c[T])&&(E=(y<3?v(E):y>3?v(p,f,E):v(p,f))||E);return y>3&&E&&Object.defineProperty(p,f,E),E},h=this&&this.__param||function(c,p){return function(f,d){p(f,d,c)}};Object.defineProperty(s,"__esModule",{value:!0}),s.Linkifier2=void 0;const u=n(2585),g=n(8460),C=n(844),b=n(3656);let m=class extends C.Disposable{constructor(c){super(),this._bufferService=c,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new g.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new g.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,C.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,C.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}get currentLink(){return this._currentLink}registerLinkProvider(c){return this._linkProviders.push(c),{dispose:()=>{const p=this._linkProviders.indexOf(c);p!==-1&&this._linkProviders.splice(p,1)}}}attachToDom(c,p,f){this._element=c,this._mouseService=p,this._renderService=f,this.register((0,b.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,b.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,b.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,b.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(c){if(this._lastMouseEvent=c,!this._element||!this._mouseService)return;const p=this._positionFromMouseEvent(c,this._element,this._mouseService);if(!p)return;this._isMouseOut=!1;const f=c.composedPath();for(let d=0;d<f.length;d++){const v=f[d];if(v.classList.contains("xterm"))break;if(v.classList.contains("xterm-hover"))return}this._lastBufferCell&&p.x===this._lastBufferCell.x&&p.y===this._lastBufferCell.y||(this._handleHover(p),this._lastBufferCell=p)}_handleHover(c){if(this._activeLine!==c.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(c,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,c)||(this._clearCurrentLink(),this._askForLink(c,!0))}_askForLink(c,p){var f,d;this._activeProviderReplies&&p||((f=this._activeProviderReplies)===null||f===void 0||f.forEach(y=>{y==null||y.forEach(E=>{E.link.dispose&&E.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=c.y);let v=!1;for(const[y,E]of this._linkProviders.entries())p?!((d=this._activeProviderReplies)===null||d===void 0)&&d.get(y)&&(v=this._checkLinkProviderResult(y,c,v)):E.provideLinks(c.y,T=>{var S,w;if(this._isMouseOut)return;const A=T==null?void 0:T.map(D=>({link:D}));(S=this._activeProviderReplies)===null||S===void 0||S.set(y,A),v=this._checkLinkProviderResult(y,c,v),((w=this._activeProviderReplies)===null||w===void 0?void 0:w.size)===this._linkProviders.length&&this._removeIntersectingLinks(c.y,this._activeProviderReplies)})}_removeIntersectingLinks(c,p){const f=new Set;for(let d=0;d<p.size;d++){const v=p.get(d);if(v)for(let y=0;y<v.length;y++){const E=v[y],T=E.link.range.start.y<c?0:E.link.range.start.x,S=E.link.range.end.y>c?this._bufferService.cols:E.link.range.end.x;for(let w=T;w<=S;w++){if(f.has(w)){v.splice(y--,1);break}f.add(w)}}}}_checkLinkProviderResult(c,p,f){var d;if(!this._activeProviderReplies)return f;const v=this._activeProviderReplies.get(c);let y=!1;for(let E=0;E<c;E++)this._activeProviderReplies.has(E)&&!this._activeProviderReplies.get(E)||(y=!0);if(!y&&v){const E=v.find(T=>this._linkAtPosition(T.link,p));E&&(f=!0,this._handleNewLink(E))}if(this._activeProviderReplies.size===this._linkProviders.length&&!f)for(let E=0;E<this._activeProviderReplies.size;E++){const T=(d=this._activeProviderReplies.get(E))===null||d===void 0?void 0:d.find(S=>this._linkAtPosition(S.link,p));if(T){f=!0,this._handleNewLink(T);break}}return f}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(c){if(!this._element||!this._mouseService||!this._currentLink)return;const p=this._positionFromMouseEvent(c,this._element,this._mouseService);p&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,p)&&this._currentLink.link.activate(c,this._currentLink.link.text)}_clearCurrentLink(c,p){this._element&&this._currentLink&&this._lastMouseEvent&&(!c||!p||this._currentLink.link.range.start.y>=c&&this._currentLink.link.range.end.y<=p)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,C.disposeArray)(this._linkCacheDisposables))}_handleNewLink(c){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const p=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);p&&this._linkAtPosition(c.link,p)&&(this._currentLink=c,this._currentLink.state={decorations:{underline:c.link.decorations===void 0||c.link.decorations.underline,pointerCursor:c.link.decorations===void 0||c.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,c.link,this._lastMouseEvent),c.link.decorations={},Object.defineProperties(c.link.decorations,{pointerCursor:{get:()=>{var f,d;return(d=(f=this._currentLink)===null||f===void 0?void 0:f.state)===null||d===void 0?void 0:d.decorations.pointerCursor},set:f=>{var d,v;!((d=this._currentLink)===null||d===void 0)&&d.state&&this._currentLink.state.decorations.pointerCursor!==f&&(this._currentLink.state.decorations.pointerCursor=f,this._currentLink.state.isHovered&&((v=this._element)===null||v===void 0||v.classList.toggle("xterm-cursor-pointer",f)))}},underline:{get:()=>{var f,d;return(d=(f=this._currentLink)===null||f===void 0?void 0:f.state)===null||d===void 0?void 0:d.decorations.underline},set:f=>{var d,v,y;!((d=this._currentLink)===null||d===void 0)&&d.state&&((y=(v=this._currentLink)===null||v===void 0?void 0:v.state)===null||y===void 0?void 0:y.decorations.underline)!==f&&(this._currentLink.state.decorations.underline=f,this._currentLink.state.isHovered&&this._fireUnderlineEvent(c.link,f))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(f=>{if(!this._currentLink)return;const d=f.start===0?0:f.start+1+this._bufferService.buffer.ydisp,v=this._bufferService.buffer.ydisp+1+f.end;if(this._currentLink.link.range.start.y>=d&&this._currentLink.link.range.end.y<=v&&(this._clearCurrentLink(d,v),this._lastMouseEvent&&this._element)){const y=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);y&&this._askForLink(y,!1)}})))}_linkHover(c,p,f){var d;!((d=this._currentLink)===null||d===void 0)&&d.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(p,!0),this._currentLink.state.decorations.pointerCursor&&c.classList.add("xterm-cursor-pointer")),p.hover&&p.hover(f,p.text)}_fireUnderlineEvent(c,p){const f=c.range,d=this._bufferService.buffer.ydisp,v=this._createLinkUnderlineEvent(f.start.x-1,f.start.y-d-1,f.end.x,f.end.y-d-1,void 0);(p?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(v)}_linkLeave(c,p,f){var d;!((d=this._currentLink)===null||d===void 0)&&d.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(p,!1),this._currentLink.state.decorations.pointerCursor&&c.classList.remove("xterm-cursor-pointer")),p.leave&&p.leave(f,p.text)}_linkAtPosition(c,p){const f=c.range.start.y*this._bufferService.cols+c.range.start.x,d=c.range.end.y*this._bufferService.cols+c.range.end.x,v=p.y*this._bufferService.cols+p.x;return f<=v&&v<=d}_positionFromMouseEvent(c,p,f){const d=f.getCoords(c,p,this._bufferService.cols,this._bufferService.rows);if(d)return{x:d[0],y:d[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(c,p,f,d,v){return{x1:c,y1:p,x2:f,y2:d,cols:this._bufferService.cols,fg:v}}};m=a([h(0,u.IBufferService)],m),s.Linkifier2=m},9042:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.tooMuchOutput=s.promptLabel=void 0,s.promptLabel="Terminal input",s.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(_,s,n){var a=this&&this.__decorate||function(m,c,p,f){var d,v=arguments.length,y=v<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,p):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(m,c,p,f);else for(var E=m.length-1;E>=0;E--)(d=m[E])&&(y=(v<3?d(y):v>3?d(c,p,y):d(c,p))||y);return v>3&&y&&Object.defineProperty(c,p,y),y},h=this&&this.__param||function(m,c){return function(p,f){c(p,f,m)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OscLinkProvider=void 0;const u=n(511),g=n(2585);let C=class{constructor(m,c,p){this._bufferService=m,this._optionsService=c,this._oscLinkService=p}provideLinks(m,c){var p;const f=this._bufferService.buffer.lines.get(m-1);if(!f)return void c(void 0);const d=[],v=this._optionsService.rawOptions.linkHandler,y=new u.CellData,E=f.getTrimmedLength();let T=-1,S=-1,w=!1;for(let A=0;A<E;A++)if(S!==-1||f.hasContent(A)){if(f.loadCell(A,y),y.hasExtendedAttrs()&&y.extended.urlId){if(S===-1){S=A,T=y.extended.urlId;continue}w=y.extended.urlId!==T}else S!==-1&&(w=!0);if(w||S!==-1&&A===E-1){const D=(p=this._oscLinkService.getLinkData(T))===null||p===void 0?void 0:p.uri;if(D){const R={start:{x:S+1,y:m},end:{x:A+(w||A!==E-1?0:1),y:m}};let x=!1;if(!(v!=null&&v.allowNonHttpProtocols))try{const F=new URL(D);["http:","https:"].includes(F.protocol)||(x=!0)}catch{x=!0}x||d.push({text:D,range:R,activate:(F,G)=>v?v.activate(F,G,R):b(0,G),hover:(F,G)=>{var U;return(U=v==null?void 0:v.hover)===null||U===void 0?void 0:U.call(v,F,G,R)},leave:(F,G)=>{var U;return(U=v==null?void 0:v.leave)===null||U===void 0?void 0:U.call(v,F,G,R)}})}w=!1,y.hasExtendedAttrs()&&y.extended.urlId?(S=A,T=y.extended.urlId):(S=-1,T=-1)}}c(d)}};function b(m,c){if(confirm(`Do you want to navigate to ${c}?

WARNING: This link could potentially be dangerous`)){const p=window.open();if(p){try{p.opener=null}catch{}p.location.href=c}else console.warn("Opening link blocked as opener could not be cleared")}}C=a([h(0,g.IBufferService),h(1,g.IOptionsService),h(2,g.IOscLinkService)],C),s.OscLinkProvider=C},6193:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.RenderDebouncer=void 0,s.RenderDebouncer=class{constructor(n,a){this._parentWindow=n,this._renderCallback=a,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(n){return this._refreshCallbacks.push(n),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(n,a,h){this._rowCount=h,n=n!==void 0?n:0,a=a!==void 0?a:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,n):n,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,a):a,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const n=Math.max(this._rowStart,0),a=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(n,a),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const n of this._refreshCallbacks)n(0);this._refreshCallbacks=[]}}},5596:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ScreenDprMonitor=void 0;const a=n(844);class h extends a.Disposable{constructor(g){super(),this._parentWindow=g,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,a.toDisposable)(()=>{this.clearListener()}))}setListener(g){this._listener&&this.clearListener(),this._listener=g,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var g;this._outerListener&&((g=this._resolutionMediaMatchList)===null||g===void 0||g.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}s.ScreenDprMonitor=h},3236:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Terminal=void 0;const a=n(2950),h=n(1680),u=n(3614),g=n(2584),C=n(5435),b=n(9312),m=n(6114),c=n(3656),p=n(9042),f=n(4567),d=n(1296),v=n(7399),y=n(8460),E=n(8437),T=n(3230),S=n(4725),w=n(428),A=n(8934),D=n(6465),R=n(5114),x=n(8969),F=n(8055),G=n(4269),U=n(5941),k=n(3107),L=n(5744),O=n(9074),I=n(2585),H=n(3730),X=n(844),Q=n(6731),W=typeof window<"u"?window.document:null;class q extends x.CoreTerminal{constructor(P={}){super(P),this.browser=m,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._onCursorMove=this.register(new y.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new y.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new y.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new y.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new y.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new y.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new y.EventEmitter),this._onBlur=this.register(new y.EventEmitter),this._onA11yCharEmitter=this.register(new y.EventEmitter),this._onA11yTabEmitter=this.register(new y.EventEmitter),this._onWillOpen=this.register(new y.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(D.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(H.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(O.DecorationService),this._instantiationService.setService(I.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((N,j)=>this.refresh(N,j))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(N=>this._reportWindowsOptions(N))),this.register(this._inputHandler.onColor(N=>this._handleColorEvent(N))),this.register((0,y.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,y.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,y.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,y.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(N=>this._afterResize(N.cols,N.rows))),this.register((0,X.toDisposable)(()=>{var N,j;this._customKeyEventHandler=void 0,(j=(N=this.element)===null||N===void 0?void 0:N.parentNode)===null||j===void 0||j.removeChild(this.element)}))}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(P){if(this._themeService)for(const N of P){let j,K="";switch(N.index){case 256:j="foreground",K="10";break;case 257:j="background",K="11";break;case 258:j="cursor",K="12";break;default:j="ansi",K="4;"+N.index}switch(N.type){case 0:const se=F.color.toColorRGB(j==="ansi"?this._themeService.colors.ansi[N.index]:this._themeService.colors[j]);this.coreService.triggerDataEvent(`${g.C0.ESC}]${K};${(0,U.toRgbString)(se)}${g.C1_ESCAPED.ST}`);break;case 1:if(j==="ansi")this._themeService.modifyColors(Y=>Y.ansi[N.index]=F.rgba.toColor(...N.color));else{const Y=j;this._themeService.modifyColors(ce=>ce[Y]=F.rgba.toColor(...N.color))}break;case 2:this._themeService.restoreColor(N.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(P){var N;P?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=this._instantiationService.createInstance(f.AccessibilityManager,this)):((N=this._accessibilityManager)===null||N===void 0||N.dispose(),this._accessibilityManager=void 0)}_handleTextAreaFocus(P){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(g.C0.ESC+"[I"),this.updateCursorStyle(P),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var P;return(P=this.textarea)===null||P===void 0?void 0:P.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(g.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const P=this.buffer.ybase+this.buffer.y,N=this.buffer.lines.get(P);if(!N)return;const j=Math.min(this.buffer.x,this.cols-1),K=this._renderService.dimensions.css.cell.height,se=N.getWidth(j),Y=this._renderService.dimensions.css.cell.width*se,ce=this.buffer.y*this._renderService.dimensions.css.cell.height,le=j*this._renderService.dimensions.css.cell.width;this.textarea.style.left=le+"px",this.textarea.style.top=ce+"px",this.textarea.style.width=Y+"px",this.textarea.style.height=K+"px",this.textarea.style.lineHeight=K+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,c.addDisposableDomListener)(this.element,"copy",N=>{this.hasSelection()&&(0,u.copyHandler)(N,this._selectionService)}));const P=N=>(0,u.handlePasteEvent)(N,this.textarea,this.coreService);this.register((0,c.addDisposableDomListener)(this.textarea,"paste",P)),this.register((0,c.addDisposableDomListener)(this.element,"paste",P)),m.isFirefox?this.register((0,c.addDisposableDomListener)(this.element,"mousedown",N=>{N.button===2&&(0,u.rightClickHandler)(N,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,c.addDisposableDomListener)(this.element,"contextmenu",N=>{(0,u.rightClickHandler)(N,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),m.isLinux&&this.register((0,c.addDisposableDomListener)(this.element,"auxclick",N=>{N.button===1&&(0,u.moveTextAreaUnderMouseCursor)(N,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,c.addDisposableDomListener)(this.textarea,"keyup",P=>this._keyUp(P),!0)),this.register((0,c.addDisposableDomListener)(this.textarea,"keydown",P=>this._keyDown(P),!0)),this.register((0,c.addDisposableDomListener)(this.textarea,"keypress",P=>this._keyPress(P),!0)),this.register((0,c.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,c.addDisposableDomListener)(this.textarea,"compositionupdate",P=>this._compositionHelper.compositionupdate(P))),this.register((0,c.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,c.addDisposableDomListener)(this.textarea,"input",P=>this._inputEvent(P),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(P){var N;if(!P)throw new Error("Terminal requires a parent element.");P.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=P.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),P.appendChild(this.element);const j=W.createDocumentFragment();this._viewportElement=W.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),j.appendChild(this._viewportElement),this._viewportScrollArea=W.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=W.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=W.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),j.appendChild(this.screenElement),this.textarea=W.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",p.promptLabel),m.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(R.CoreBrowserService,this.textarea,(N=this._document.defaultView)!==null&&N!==void 0?N:window),this._instantiationService.setService(S.ICoreBrowserService,this._coreBrowserService),this.register((0,c.addDisposableDomListener)(this.textarea,"focus",K=>this._handleTextAreaFocus(K))),this.register((0,c.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(w.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(S.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(Q.ThemeService),this._instantiationService.setService(S.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(G.CharacterJoinerService),this._instantiationService.setService(S.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(T.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(S.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(K=>this._onRender.fire(K))),this.onResize(K=>this._renderService.resize(K.cols,K.rows)),this._compositionView=W.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(a.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(j);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(A.MouseService),this._instantiationService.setService(S.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(h.Viewport,K=>this.scrollLines(K,!0,1),this._viewportElement,this._viewportScrollArea),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(b.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(S.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(K=>this.scrollLines(K.amount,K.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(K=>this._renderService.handleSelectionChanged(K.start,K.end,K.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(K=>{this.textarea.value=K,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(K=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,c.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(k.BufferDecorationRenderer,this.screenElement)),this.register((0,c.addDisposableDomListener)(this.element,"mousedown",K=>this._selectionService.handleMouseDown(K))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=this._instantiationService.createInstance(f.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",K=>this._handleScreenReaderModeOptionChange(K))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(L.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",K=>{!this._overviewRulerRenderer&&K&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(L.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(d.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const P=this,N=this.element;function j(Y){const ce=P._mouseService.getMouseReportCoords(Y,P.screenElement);if(!ce)return!1;let le,he;switch(Y.overrideType||Y.type){case"mousemove":he=32,Y.buttons===void 0?(le=3,Y.button!==void 0&&(le=Y.button<3?Y.button:3)):le=1&Y.buttons?0:4&Y.buttons?1:2&Y.buttons?2:3;break;case"mouseup":he=0,le=Y.button<3?Y.button:3;break;case"mousedown":he=1,le=Y.button<3?Y.button:3;break;case"wheel":if(P.viewport.getLinesScrolled(Y)===0)return!1;he=Y.deltaY<0?0:1,le=4;break;default:return!1}return!(he===void 0||le===void 0||le>4)&&P.coreMouseService.triggerMouseEvent({col:ce.col,row:ce.row,x:ce.x,y:ce.y,button:le,action:he,ctrl:Y.ctrlKey,alt:Y.altKey,shift:Y.shiftKey})}const K={mouseup:null,wheel:null,mousedrag:null,mousemove:null},se={mouseup:Y=>(j(Y),Y.buttons||(this._document.removeEventListener("mouseup",K.mouseup),K.mousedrag&&this._document.removeEventListener("mousemove",K.mousedrag)),this.cancel(Y)),wheel:Y=>(j(Y),this.cancel(Y,!0)),mousedrag:Y=>{Y.buttons&&j(Y)},mousemove:Y=>{Y.buttons||j(Y)}};this.register(this.coreMouseService.onProtocolChange(Y=>{Y?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(Y)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&Y?K.mousemove||(N.addEventListener("mousemove",se.mousemove),K.mousemove=se.mousemove):(N.removeEventListener("mousemove",K.mousemove),K.mousemove=null),16&Y?K.wheel||(N.addEventListener("wheel",se.wheel,{passive:!1}),K.wheel=se.wheel):(N.removeEventListener("wheel",K.wheel),K.wheel=null),2&Y?K.mouseup||(K.mouseup=se.mouseup):(this._document.removeEventListener("mouseup",K.mouseup),K.mouseup=null),4&Y?K.mousedrag||(K.mousedrag=se.mousedrag):(this._document.removeEventListener("mousemove",K.mousedrag),K.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,c.addDisposableDomListener)(N,"mousedown",Y=>{if(Y.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(Y))return j(Y),K.mouseup&&this._document.addEventListener("mouseup",K.mouseup),K.mousedrag&&this._document.addEventListener("mousemove",K.mousedrag),this.cancel(Y)})),this.register((0,c.addDisposableDomListener)(N,"wheel",Y=>{if(!K.wheel){if(!this.buffer.hasScrollback){const ce=this.viewport.getLinesScrolled(Y);if(ce===0)return;const le=g.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(Y.deltaY<0?"A":"B");let he="";for(let ne=0;ne<Math.abs(ce);ne++)he+=le;return this.coreService.triggerDataEvent(he,!0),this.cancel(Y,!0)}return this.viewport.handleWheel(Y)?this.cancel(Y):void 0}},{passive:!1})),this.register((0,c.addDisposableDomListener)(N,"touchstart",Y=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(Y),this.cancel(Y)},{passive:!0})),this.register((0,c.addDisposableDomListener)(N,"touchmove",Y=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(Y)?void 0:this.cancel(Y)},{passive:!1}))}refresh(P,N){var j;(j=this._renderService)===null||j===void 0||j.refreshRows(P,N)}updateCursorStyle(P){var N;!((N=this._selectionService)===null||N===void 0)&&N.shouldColumnSelect(P)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(P,N,j=0){super.scrollLines(P,N,j),this.refresh(0,this.rows-1)}paste(P){(0,u.paste)(P,this.textarea,this.coreService)}attachCustomKeyEventHandler(P){this._customKeyEventHandler=P}registerLinkProvider(P){return this.linkifier2.registerLinkProvider(P)}registerCharacterJoiner(P){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const N=this._characterJoinerService.register(P);return this.refresh(0,this.rows-1),N}deregisterCharacterJoiner(P){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(P)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}addMarker(P){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+P)}registerDecoration(P){return this._decorationService.registerDecoration(P)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(P,N,j){this._selectionService.setSelection(P,N,j)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var P;(P=this._selectionService)===null||P===void 0||P.clearSelection()}selectAll(){var P;(P=this._selectionService)===null||P===void 0||P.selectAll()}selectLines(P,N){var j;(j=this._selectionService)===null||j===void 0||j.selectLines(P,N)}_keyDown(P){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(P)===!1)return!1;const N=this.browser.isMac&&this.options.macOptionIsMeta&&P.altKey;if(!N&&!this._compositionHelper.keydown(P))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;N||P.key!=="Dead"&&P.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const j=(0,v.evaluateKeyboardEvent)(P,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(P),j.type===3||j.type===2){const K=this.rows-1;return this.scrollLines(j.type===2?-K:K),this.cancel(P,!0)}return j.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,P)||(j.cancel&&this.cancel(P,!0),!j.key||!!(P.key&&!P.ctrlKey&&!P.altKey&&!P.metaKey&&P.key.length===1&&P.key.charCodeAt(0)>=65&&P.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(j.key!==g.C0.ETX&&j.key!==g.C0.CR||(this.textarea.value=""),this._onKey.fire({key:j.key,domEvent:P}),this._showCursor(),this.coreService.triggerDataEvent(j.key,!0),!this.optionsService.rawOptions.screenReaderMode||P.altKey||P.ctrlKey?this.cancel(P,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(P,N){const j=P.isMac&&!this.options.macOptionIsMeta&&N.altKey&&!N.ctrlKey&&!N.metaKey||P.isWindows&&N.altKey&&N.ctrlKey&&!N.metaKey||P.isWindows&&N.getModifierState("AltGraph");return N.type==="keypress"?j:j&&(!N.keyCode||N.keyCode>47)}_keyUp(P){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(P)===!1||(function(N){return N.keyCode===16||N.keyCode===17||N.keyCode===18}(P)||this.focus(),this.updateCursorStyle(P),this._keyPressHandled=!1)}_keyPress(P){let N;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(P)===!1)return!1;if(this.cancel(P),P.charCode)N=P.charCode;else if(P.which===null||P.which===void 0)N=P.keyCode;else{if(P.which===0||P.charCode===0)return!1;N=P.which}return!(!N||(P.altKey||P.ctrlKey||P.metaKey)&&!this._isThirdLevelShift(this.browser,P)||(N=String.fromCharCode(N),this._onKey.fire({key:N,domEvent:P}),this._showCursor(),this.coreService.triggerDataEvent(N,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(P){if(P.data&&P.inputType==="insertText"&&(!P.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const N=P.data;return this.coreService.triggerDataEvent(N,!0),this.cancel(P),!0}return!1}resize(P,N){P!==this.cols||N!==this.rows?super.resize(P,N):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(P,N){var j,K;(j=this._charSizeService)===null||j===void 0||j.measure(),(K=this.viewport)===null||K===void 0||K.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let P=1;P<this.rows;P++)this.buffer.lines.push(this.buffer.getBlankLine(E.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}}reset(){var P,N;this.options.rows=this.rows,this.options.cols=this.cols;const j=this._customKeyEventHandler;this._setup(),super.reset(),(P=this._selectionService)===null||P===void 0||P.reset(),this._decorationService.reset(),this._customKeyEventHandler=j,this.refresh(0,this.rows-1),(N=this.viewport)===null||N===void 0||N.syncScrollArea()}clearTextureAtlas(){var P;(P=this._renderService)===null||P===void 0||P.clearTextureAtlas()}_reportFocus(){var P;!((P=this.element)===null||P===void 0)&&P.classList.contains("focus")?this.coreService.triggerDataEvent(g.C0.ESC+"[I"):this.coreService.triggerDataEvent(g.C0.ESC+"[O")}_reportWindowsOptions(P){if(this._renderService)switch(P){case C.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const N=this._renderService.dimensions.css.canvas.width.toFixed(0),j=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${g.C0.ESC}[4;${j};${N}t`);break;case C.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const K=this._renderService.dimensions.css.cell.width.toFixed(0),se=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${g.C0.ESC}[6;${se};${K}t`)}}cancel(P,N){if(this.options.cancelEvents||N)return P.preventDefault(),P.stopPropagation(),!1}}s.Terminal=q},9924:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TimeBasedDebouncer=void 0,s.TimeBasedDebouncer=class{constructor(n,a=1e3){this._renderCallback=n,this._debounceThresholdMS=a,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(n,a,h){this._rowCount=h,n=n!==void 0?n:0,a=a!==void 0?a:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,n):n,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,a):a;const u=Date.now();if(u-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=u,this._innerRefresh();else if(!this._additionalRefreshRequested){const g=u-this._lastRefreshMs,C=this._debounceThresholdMS-g;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},C)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const n=Math.max(this._rowStart,0),a=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(n,a)}}},1680:function(_,s,n){var a=this&&this.__decorate||function(c,p,f,d){var v,y=arguments.length,E=y<3?p:d===null?d=Object.getOwnPropertyDescriptor(p,f):d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(c,p,f,d);else for(var T=c.length-1;T>=0;T--)(v=c[T])&&(E=(y<3?v(E):y>3?v(p,f,E):v(p,f))||E);return y>3&&E&&Object.defineProperty(p,f,E),E},h=this&&this.__param||function(c,p){return function(f,d){p(f,d,c)}};Object.defineProperty(s,"__esModule",{value:!0}),s.Viewport=void 0;const u=n(844),g=n(3656),C=n(4725),b=n(2585);let m=class extends u.Disposable{constructor(c,p,f,d,v,y,E,T,S){super(),this._scrollLines=c,this._viewportElement=p,this._scrollArea=f,this._bufferService=d,this._optionsService=v,this._charSizeService=y,this._renderService=E,this._coreBrowserService=T,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,g.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(w=>this._activeBuffer=w.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(w=>this._renderDimensions=w)),this._handleThemeChange(S.colors),this.register(S.onChangeColors(w=>this._handleThemeChange(w))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea(),0)}_handleThemeChange(c){this._viewportElement.style.backgroundColor=c.background.css}_refresh(c){if(c)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const p=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==p&&(this._lastRecordedBufferHeight=p,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const c=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==c&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=c),this._refreshAnimationFrame=null}syncScrollArea(c=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(c);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(c)}_handleScroll(c){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);const p=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(p)}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const c=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(c*(this._smoothScrollState.target-this._smoothScrollState.origin)),c<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(c,p){const f=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(p<0&&this._viewportElement.scrollTop!==0||p>0&&f<this._lastRecordedBufferHeight)||(c.cancelable&&c.preventDefault(),!1)}handleWheel(c){const p=this._getPixelsScrolled(c);return p!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+p:this._smoothScrollState.target+=p,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=p,this._bubbleScroll(c,p))}_getPixelsScrolled(c){if(c.deltaY===0||c.shiftKey)return 0;let p=this._applyScrollModifier(c.deltaY,c);return c.deltaMode===WheelEvent.DOM_DELTA_LINE?p*=this._currentRowHeight:c.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(p*=this._currentRowHeight*this._bufferService.rows),p}getBufferElements(c,p){var f;let d,v="";const y=[],E=p??this._bufferService.buffer.lines.length,T=this._bufferService.buffer.lines;for(let S=c;S<E;S++){const w=T.get(S);if(!w)continue;const A=(f=T.get(S+1))===null||f===void 0?void 0:f.isWrapped;if(v+=w.translateToString(!A),!A||S===T.length-1){const D=document.createElement("div");D.textContent=v,y.push(D),v.length>0&&(d=D),v=""}}return{bufferElements:y,cursorElement:d}}getLinesScrolled(c){if(c.deltaY===0||c.shiftKey)return 0;let p=this._applyScrollModifier(c.deltaY,c);return c.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(p/=this._currentRowHeight+0,this._wheelPartialScroll+=p,p=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):c.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(p*=this._bufferService.rows),p}_applyScrollModifier(c,p){const f=this._optionsService.rawOptions.fastScrollModifier;return f==="alt"&&p.altKey||f==="ctrl"&&p.ctrlKey||f==="shift"&&p.shiftKey?c*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:c*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(c){this._lastTouchY=c.touches[0].pageY}handleTouchMove(c){const p=this._lastTouchY-c.touches[0].pageY;return this._lastTouchY=c.touches[0].pageY,p!==0&&(this._viewportElement.scrollTop+=p,this._bubbleScroll(c,p))}};m=a([h(3,b.IBufferService),h(4,b.IOptionsService),h(5,C.ICharSizeService),h(6,C.IRenderService),h(7,C.ICoreBrowserService),h(8,C.IThemeService)],m),s.Viewport=m},3107:function(_,s,n){var a=this&&this.__decorate||function(c,p,f,d){var v,y=arguments.length,E=y<3?p:d===null?d=Object.getOwnPropertyDescriptor(p,f):d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(c,p,f,d);else for(var T=c.length-1;T>=0;T--)(v=c[T])&&(E=(y<3?v(E):y>3?v(p,f,E):v(p,f))||E);return y>3&&E&&Object.defineProperty(p,f,E),E},h=this&&this.__param||function(c,p){return function(f,d){p(f,d,c)}};Object.defineProperty(s,"__esModule",{value:!0}),s.BufferDecorationRenderer=void 0;const u=n(3656),g=n(4725),C=n(844),b=n(2585);let m=class extends C.Disposable{constructor(c,p,f,d){super(),this._screenElement=c,this._bufferService=p,this._decorationService=f,this._renderService=d,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,u.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(v=>this._removeDecoration(v))),this.register((0,C.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const c of this._decorationService.decorations)this._renderDecoration(c);this._dimensionsChanged=!1}_renderDecoration(c){this._refreshStyle(c),this._dimensionsChanged&&this._refreshXPosition(c)}_createElement(c){var p,f;const d=document.createElement("div");d.classList.add("xterm-decoration"),d.classList.toggle("xterm-decoration-top-layer",((p=c==null?void 0:c.options)===null||p===void 0?void 0:p.layer)==="top"),d.style.width=`${Math.round((c.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,d.style.height=(c.options.height||1)*this._renderService.dimensions.css.cell.height+"px",d.style.top=(c.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",d.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const v=(f=c.options.x)!==null&&f!==void 0?f:0;return v&&v>this._bufferService.cols&&(d.style.display="none"),this._refreshXPosition(c,d),d}_refreshStyle(c){const p=c.marker.line-this._bufferService.buffers.active.ydisp;if(p<0||p>=this._bufferService.rows)c.element&&(c.element.style.display="none",c.onRenderEmitter.fire(c.element));else{let f=this._decorationElements.get(c);f||(f=this._createElement(c),c.element=f,this._decorationElements.set(c,f),this._container.appendChild(f)),f.style.top=p*this._renderService.dimensions.css.cell.height+"px",f.style.display=this._altBufferIsActive?"none":"block",c.onRenderEmitter.fire(f)}}_refreshXPosition(c,p=c.element){var f;if(!p)return;const d=(f=c.options.x)!==null&&f!==void 0?f:0;(c.options.anchor||"left")==="right"?p.style.right=d?d*this._renderService.dimensions.css.cell.width+"px":"":p.style.left=d?d*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(c){var p;(p=this._decorationElements.get(c))===null||p===void 0||p.remove(),this._decorationElements.delete(c),c.dispose()}};m=a([h(1,b.IBufferService),h(2,b.IDecorationService),h(3,g.IRenderService)],m),s.BufferDecorationRenderer=m},5871:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ColorZoneStore=void 0,s.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(n){if(n.options.overviewRulerOptions){for(const a of this._zones)if(a.color===n.options.overviewRulerOptions.color&&a.position===n.options.overviewRulerOptions.position){if(this._lineIntersectsZone(a,n.marker.line))return;if(this._lineAdjacentToZone(a,n.marker.line,n.options.overviewRulerOptions.position))return void this._addLineToZone(a,n.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=n.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=n.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=n.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=n.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:n.options.overviewRulerOptions.color,position:n.options.overviewRulerOptions.position,startBufferLine:n.marker.line,endBufferLine:n.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(n){this._linePadding=n}_lineIntersectsZone(n,a){return a>=n.startBufferLine&&a<=n.endBufferLine}_lineAdjacentToZone(n,a,h){return a>=n.startBufferLine-this._linePadding[h||"full"]&&a<=n.endBufferLine+this._linePadding[h||"full"]}_addLineToZone(n,a){n.startBufferLine=Math.min(n.startBufferLine,a),n.endBufferLine=Math.max(n.endBufferLine,a)}}},5744:function(_,s,n){var a=this&&this.__decorate||function(v,y,E,T){var S,w=arguments.length,A=w<3?y:T===null?T=Object.getOwnPropertyDescriptor(y,E):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(v,y,E,T);else for(var D=v.length-1;D>=0;D--)(S=v[D])&&(A=(w<3?S(A):w>3?S(y,E,A):S(y,E))||A);return w>3&&A&&Object.defineProperty(y,E,A),A},h=this&&this.__param||function(v,y){return function(E,T){y(E,T,v)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OverviewRulerRenderer=void 0;const u=n(5871),g=n(3656),C=n(4725),b=n(844),m=n(2585),c={full:0,left:0,center:0,right:0},p={full:0,left:0,center:0,right:0},f={full:0,left:0,center:0,right:0};let d=class extends b.Disposable{constructor(v,y,E,T,S,w,A){var D;super(),this._viewportElement=v,this._screenElement=y,this._bufferService=E,this._decorationService=T,this._renderService=S,this._optionsService=w,this._coreBrowseService=A,this._colorZoneStore=new u.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(D=this._viewportElement.parentElement)===null||D===void 0||D.insertBefore(this._canvas,this._viewportElement);const R=this._canvas.getContext("2d");if(!R)throw new Error("Ctx cannot be null");this._ctx=R,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,b.toDisposable)(()=>{var x;(x=this._canvas)===null||x===void 0||x.remove()}))}get _width(){return this._optionsService.options.overviewRulerWidth||0}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,g.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const v=Math.floor(this._canvas.width/3),y=Math.ceil(this._canvas.width/3);p.full=this._canvas.width,p.left=v,p.center=y,p.right=v,this._refreshDrawHeightConstants(),f.full=0,f.left=0,f.center=p.left,f.right=p.left+p.center}_refreshDrawHeightConstants(){c.full=Math.round(2*this._coreBrowseService.dpr);const v=this._canvas.height/this._bufferService.buffer.lines.length,y=Math.round(Math.max(Math.min(v,12),6)*this._coreBrowseService.dpr);c.left=y,c.center=y,c.right=y}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*c.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*c.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*c.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*c.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const y of this._decorationService.decorations)this._colorZoneStore.addDecoration(y);this._ctx.lineWidth=1;const v=this._colorZoneStore.zones;for(const y of v)y.position!=="full"&&this._renderColorZone(y);for(const y of v)y.position==="full"&&this._renderColorZone(y);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(v){this._ctx.fillStyle=v.color,this._ctx.fillRect(f[v.position||"full"],Math.round((this._canvas.height-1)*(v.startBufferLine/this._bufferService.buffers.active.lines.length)-c[v.position||"full"]/2),p[v.position||"full"],Math.round((this._canvas.height-1)*((v.endBufferLine-v.startBufferLine)/this._bufferService.buffers.active.lines.length)+c[v.position||"full"]))}_queueRefresh(v,y){this._shouldUpdateDimensions=v||this._shouldUpdateDimensions,this._shouldUpdateAnchor=y||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};d=a([h(2,m.IBufferService),h(3,m.IDecorationService),h(4,C.IRenderService),h(5,m.IOptionsService),h(6,C.ICoreBrowserService)],d),s.OverviewRulerRenderer=d},2950:function(_,s,n){var a=this&&this.__decorate||function(m,c,p,f){var d,v=arguments.length,y=v<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,p):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(m,c,p,f);else for(var E=m.length-1;E>=0;E--)(d=m[E])&&(y=(v<3?d(y):v>3?d(c,p,y):d(c,p))||y);return v>3&&y&&Object.defineProperty(c,p,y),y},h=this&&this.__param||function(m,c){return function(p,f){c(p,f,m)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CompositionHelper=void 0;const u=n(4725),g=n(2585),C=n(2584);let b=class{constructor(m,c,p,f,d,v){this._textarea=m,this._compositionView=c,this._bufferService=p,this._optionsService=f,this._coreService=d,this._renderService=v,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(m){this._compositionView.textContent=m.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(m){if(this._isComposing||this._isSendingComposition){if(m.keyCode===229||m.keyCode===16||m.keyCode===17||m.keyCode===18)return!1;this._finalizeComposition(!1)}return m.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(m){if(this._compositionView.classList.remove("active"),this._isComposing=!1,m){const c={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let p;this._isSendingComposition=!1,c.start+=this._dataAlreadySent.length,p=this._isComposing?this._textarea.value.substring(c.start,c.end):this._textarea.value.substring(c.start),p.length>0&&this._coreService.triggerDataEvent(p,!0)}},0)}else{this._isSendingComposition=!1;const c=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(c,!0)}}_handleAnyTextareaChanges(){const m=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const c=this._textarea.value,p=c.replace(m,"");this._dataAlreadySent=p,c.length>m.length?this._coreService.triggerDataEvent(p,!0):c.length<m.length?this._coreService.triggerDataEvent(`${C.C0.DEL}`,!0):c.length===m.length&&c!==m&&this._coreService.triggerDataEvent(c,!0)}},0)}updateCompositionElements(m){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const c=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),p=this._renderService.dimensions.css.cell.height,f=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,d=c*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=d+"px",this._compositionView.style.top=f+"px",this._compositionView.style.height=p+"px",this._compositionView.style.lineHeight=p+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const v=this._compositionView.getBoundingClientRect();this._textarea.style.left=d+"px",this._textarea.style.top=f+"px",this._textarea.style.width=Math.max(v.width,1)+"px",this._textarea.style.height=Math.max(v.height,1)+"px",this._textarea.style.lineHeight=v.height+"px"}m||setTimeout(()=>this.updateCompositionElements(!0),0)}}};b=a([h(2,g.IBufferService),h(3,g.IOptionsService),h(4,g.ICoreService),h(5,u.IRenderService)],b),s.CompositionHelper=b},9806:(_,s)=>{function n(a,h,u){const g=u.getBoundingClientRect(),C=a.getComputedStyle(u),b=parseInt(C.getPropertyValue("padding-left")),m=parseInt(C.getPropertyValue("padding-top"));return[h.clientX-g.left-b,h.clientY-g.top-m]}Object.defineProperty(s,"__esModule",{value:!0}),s.getCoords=s.getCoordsRelativeToElement=void 0,s.getCoordsRelativeToElement=n,s.getCoords=function(a,h,u,g,C,b,m,c,p){if(!b)return;const f=n(a,h,u);return f?(f[0]=Math.ceil((f[0]+(p?m/2:0))/m),f[1]=Math.ceil(f[1]/c),f[0]=Math.min(Math.max(f[0],1),g+(p?1:0)),f[1]=Math.min(Math.max(f[1],1),C),f):void 0}},9504:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.moveToCellSequence=void 0;const a=n(2584);function h(c,p,f,d){const v=c-u(c,f),y=p-u(p,f),E=Math.abs(v-y)-function(T,S,w){let A=0;const D=T-u(T,w),R=S-u(S,w);for(let x=0;x<Math.abs(D-R);x++){const F=g(T,S)==="A"?-1:1,G=w.buffer.lines.get(D+F*x);G!=null&&G.isWrapped&&A++}return A}(c,p,f);return m(E,b(g(c,p),d))}function u(c,p){let f=0,d=p.buffer.lines.get(c),v=d==null?void 0:d.isWrapped;for(;v&&c>=0&&c<p.rows;)f++,d=p.buffer.lines.get(--c),v=d==null?void 0:d.isWrapped;return f}function g(c,p){return c>p?"A":"B"}function C(c,p,f,d,v,y){let E=c,T=p,S="";for(;E!==f||T!==d;)E+=v?1:-1,v&&E>y.cols-1?(S+=y.buffer.translateBufferLineToString(T,!1,c,E),E=0,c=0,T++):!v&&E<0&&(S+=y.buffer.translateBufferLineToString(T,!1,0,c+1),E=y.cols-1,c=E,T--);return S+y.buffer.translateBufferLineToString(T,!1,c,E)}function b(c,p){const f=p?"O":"[";return a.C0.ESC+f+c}function m(c,p){c=Math.floor(c);let f="";for(let d=0;d<c;d++)f+=p;return f}s.moveToCellSequence=function(c,p,f,d){const v=f.buffer.x,y=f.buffer.y;if(!f.buffer.hasScrollback)return function(S,w,A,D,R,x){return h(w,D,R,x).length===0?"":m(C(S,w,S,w-u(w,R),!1,R).length,b("D",x))}(v,y,0,p,f,d)+h(y,p,f,d)+function(S,w,A,D,R,x){let F;F=h(w,D,R,x).length>0?D-u(D,R):w;const G=D,U=function(k,L,O,I,H,X){let Q;return Q=h(O,I,H,X).length>0?I-u(I,H):L,k<O&&Q<=I||k>=O&&Q<I?"C":"D"}(S,w,A,D,R,x);return m(C(S,F,A,G,U==="C",R).length,b(U,x))}(v,y,c,p,f,d);let E;if(y===p)return E=v>c?"D":"C",m(Math.abs(v-c),b(E,d));E=y>p?"D":"C";const T=Math.abs(y-p);return m(function(S,w){return w.cols-S}(y>p?c:v,f)+(T-1)*f.cols+1+((y>p?v:c)-1),b(E,d))}},1296:function(_,s,n){var a=this&&this.__decorate||function(T,S,w,A){var D,R=arguments.length,x=R<3?S:A===null?A=Object.getOwnPropertyDescriptor(S,w):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(T,S,w,A);else for(var F=T.length-1;F>=0;F--)(D=T[F])&&(x=(R<3?D(x):R>3?D(S,w,x):D(S,w))||x);return R>3&&x&&Object.defineProperty(S,w,x),x},h=this&&this.__param||function(T,S){return function(w,A){S(w,A,T)}};Object.defineProperty(s,"__esModule",{value:!0}),s.DomRenderer=void 0;const u=n(3787),g=n(2223),C=n(6171),b=n(4725),m=n(8055),c=n(8460),p=n(844),f=n(2585),d="xterm-dom-renderer-owner-",v="xterm-focus";let y=1,E=class extends p.Disposable{constructor(T,S,w,A,D,R,x,F,G,U){super(),this._element=T,this._screenElement=S,this._viewportElement=w,this._linkifier2=A,this._charSizeService=R,this._optionsService=x,this._bufferService=F,this._coreBrowserService=G,this._themeService=U,this._terminalClass=y++,this._rowElements=[],this._cellToRowElements=[],this.onRequestRedraw=this.register(new c.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add("xterm-rows"),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add("xterm-selection"),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,C.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(k=>this._injectCss(k))),this._injectCss(this._themeService.colors),this._rowFactory=D.createInstance(u.DomRendererRowFactory,document),this._element.classList.add(d+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(k=>this._handleLinkHover(k))),this.register(this._linkifier2.onHideLinkUnderline(k=>this._handleLinkLeave(k))),this.register((0,p.toDisposable)(()=>{this._element.classList.remove(d+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()}))}_updateDimensions(){const T=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*T,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*T),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/T),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/T),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const w of this._rowElements)w.style.width=`${this.dimensions.css.canvas.width}px`,w.style.height=`${this.dimensions.css.cell.height}px`,w.style.lineHeight=`${this.dimensions.css.cell.height}px`,w.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const S=`${this._terminalSelector} .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: ${this.dimensions.css.cell.width}px}`;this._dimensionsStyleElement.textContent=S,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(T){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let S=`${this._terminalSelector} .xterm-rows { color: ${T.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px;}`;S+=`${this._terminalSelector} .xterm-rows .xterm-dim { color: ${m.color.multiplyOpacity(T.foreground,.5).css};}`,S+=`${this._terminalSelector} span:not(.${u.BOLD_CLASS}) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.${u.BOLD_CLASS} { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.${u.ITALIC_CLASS} { font-style: italic;}`,S+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",S+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${T.cursor.css};  color: ${T.cursorAccent.css}; } 50% {  background-color: ${T.cursorAccent.css};  color: ${T.cursor.css}; }}`,S+=`${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_BLOCK_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_BAR_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_UNDERLINE_CLASS} { outline: 1px solid ${T.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .xterm-rows.xterm-focus .${u.CURSOR_CLASS}.${u.CURSOR_BLINK_CLASS}:not(.${u.CURSOR_STYLE_BLOCK_CLASS}) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${u.CURSOR_CLASS}.${u.CURSOR_BLINK_CLASS}.${u.CURSOR_STYLE_BLOCK_CLASS} { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_BLOCK_CLASS} { background-color: ${T.cursor.css}; color: ${T.cursorAccent.css};}${this._terminalSelector} .xterm-rows .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_BAR_CLASS} { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${T.cursor.css} inset;}${this._terminalSelector} .xterm-rows .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_UNDERLINE_CLASS} { box-shadow: 0 -1px 0 ${T.cursor.css} inset;}`,S+=`${this._terminalSelector} .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .xterm-selection div { position: absolute; background-color: ${T.selectionBackgroundOpaque.css};}${this._terminalSelector} .xterm-selection div { position: absolute; background-color: ${T.selectionInactiveBackgroundOpaque.css};}`;for(const[w,A]of T.ansi.entries())S+=`${this._terminalSelector} .xterm-fg-${w} { color: ${A.css}; }${this._terminalSelector} .xterm-fg-${w}.${u.DIM_CLASS} { color: ${m.color.multiplyOpacity(A,.5).css}; }${this._terminalSelector} .xterm-bg-${w} { background-color: ${A.css}; }`;S+=`${this._terminalSelector} .xterm-fg-${g.INVERTED_DEFAULT_COLOR} { color: ${m.color.opaque(T.background).css}; }${this._terminalSelector} .xterm-fg-${g.INVERTED_DEFAULT_COLOR}.${u.DIM_CLASS} { color: ${m.color.multiplyOpacity(m.color.opaque(T.background),.5).css}; }${this._terminalSelector} .xterm-bg-${g.INVERTED_DEFAULT_COLOR} { background-color: ${T.foreground.css}; }`,this._themeStyleElement.textContent=S}handleDevicePixelRatioChange(){this._updateDimensions()}_refreshRowElements(T,S){for(let w=this._rowElements.length;w<=S;w++){const A=document.createElement("div");this._rowContainer.appendChild(A),this._rowElements.push(A)}for(;this._rowElements.length>S;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(T,S){this._refreshRowElements(T,S),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions()}handleBlur(){this._rowContainer.classList.remove(v)}handleFocus(){this._rowContainer.classList.add(v)}handleSelectionChanged(T,S,w){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(this._rowFactory.handleSelectionChanged(T,S,w),this.renderRows(0,this._bufferService.rows-1),!T||!S)return;const A=T[1]-this._bufferService.buffer.ydisp,D=S[1]-this._bufferService.buffer.ydisp,R=Math.max(A,0),x=Math.min(D,this._bufferService.rows-1);if(R>=this._bufferService.rows||x<0)return;const F=document.createDocumentFragment();if(w){const G=T[0]>S[0];F.appendChild(this._createSelectionElement(R,G?S[0]:T[0],G?T[0]:S[0],x-R+1))}else{const G=A===R?T[0]:0,U=R===D?S[0]:this._bufferService.cols;F.appendChild(this._createSelectionElement(R,G,U));const k=x-R-1;if(F.appendChild(this._createSelectionElement(R+1,0,this._bufferService.cols,k)),R!==x){const L=D===x?S[0]:this._bufferService.cols;F.appendChild(this._createSelectionElement(x,0,L))}}this._selectionContainer.appendChild(F)}_createSelectionElement(T,S,w,A=1){const D=document.createElement("div");return D.style.height=A*this.dimensions.css.cell.height+"px",D.style.top=T*this.dimensions.css.cell.height+"px",D.style.left=S*this.dimensions.css.cell.width+"px",D.style.width=this.dimensions.css.cell.width*(w-S)+"px",D}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors)}clear(){for(const T of this._rowElements)T.replaceChildren()}renderRows(T,S){const w=this._bufferService.buffer.ybase+this._bufferService.buffer.y,A=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),D=this._optionsService.rawOptions.cursorBlink;for(let R=T;R<=S;R++){const x=this._rowElements[R],F=R+this._bufferService.buffer.ydisp,G=this._bufferService.buffer.lines.get(F),U=this._optionsService.rawOptions.cursorStyle;this._cellToRowElements[R]&&this._cellToRowElements[R].length===this._bufferService.cols||(this._cellToRowElements[R]=new Int16Array(this._bufferService.cols)),x.replaceChildren(this._rowFactory.createRow(G,F,F===w,U,A,D,this.dimensions.css.cell.width,this._bufferService.cols,this._cellToRowElements[R]))}}get _terminalSelector(){return`.${d}${this._terminalClass}`}_handleLinkHover(T){this._setCellUnderline(T.x1,T.x2,T.y1,T.y2,T.cols,!0)}_handleLinkLeave(T){this._setCellUnderline(T.x1,T.x2,T.y1,T.y2,T.cols,!1)}_setCellUnderline(T,S,w,A,D,R){w<0&&(T=0),A<0&&(S=0);const x=this._cellToRowElements.length-1;w=Math.max(Math.min(w,x),0),A=Math.max(Math.min(A,x),0);const F=this._cellToRowElements[w],G=this._cellToRowElements[A];if(!(T>=F.length||S>=G.length)&&(T=F[T],S=G[S],T!==-1&&S!==-1))for(;T!==S||w!==A;){const U=this._rowElements[w];if(!U)return;const k=U.children[T];k&&(k.style.textDecoration=R?"underline":"none"),++T>=D&&(T=0,w++)}}};E=a([h(4,f.IInstantiationService),h(5,b.ICharSizeService),h(6,f.IOptionsService),h(7,f.IBufferService),h(8,b.ICoreBrowserService),h(9,b.IThemeService)],E),s.DomRenderer=E},3787:function(_,s,n){var a=this&&this.__decorate||function(E,T,S,w){var A,D=arguments.length,R=D<3?T:w===null?w=Object.getOwnPropertyDescriptor(T,S):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(E,T,S,w);else for(var x=E.length-1;x>=0;x--)(A=E[x])&&(R=(D<3?A(R):D>3?A(T,S,R):A(T,S))||R);return D>3&&R&&Object.defineProperty(T,S,R),R},h=this&&this.__param||function(E,T){return function(S,w){T(S,w,E)}};Object.defineProperty(s,"__esModule",{value:!0}),s.DomRendererRowFactory=s.CURSOR_STYLE_UNDERLINE_CLASS=s.CURSOR_STYLE_BAR_CLASS=s.CURSOR_STYLE_BLOCK_CLASS=s.CURSOR_BLINK_CLASS=s.CURSOR_CLASS=s.STRIKETHROUGH_CLASS=s.OVERLINE_CLASS=s.UNDERLINE_CLASS=s.ITALIC_CLASS=s.DIM_CLASS=s.BOLD_CLASS=void 0;const u=n(2223),g=n(643),C=n(511),b=n(2585),m=n(8055),c=n(4725),p=n(4269),f=n(6171),d=n(3734);s.BOLD_CLASS="xterm-bold",s.DIM_CLASS="xterm-dim",s.ITALIC_CLASS="xterm-italic",s.UNDERLINE_CLASS="xterm-underline",s.OVERLINE_CLASS="xterm-overline",s.STRIKETHROUGH_CLASS="xterm-strikethrough",s.CURSOR_CLASS="xterm-cursor",s.CURSOR_BLINK_CLASS="xterm-cursor-blink",s.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",s.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",s.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";let v=class{constructor(E,T,S,w,A,D,R){this._document=E,this._characterJoinerService=T,this._optionsService=S,this._coreBrowserService=w,this._coreService=A,this._decorationService=D,this._themeService=R,this._workCell=new C.CellData,this._columnSelectMode=!1}handleSelectionChanged(E,T,S){this._selectionStart=E,this._selectionEnd=T,this._columnSelectMode=S}createRow(E,T,S,w,A,D,R,x,F){const G=this._document.createDocumentFragment(),U=this._characterJoinerService.getJoinedCharacters(T);let k=0;for(let H=Math.min(E.length,x)-1;H>=0;H--)if(E.loadCell(H,this._workCell).getCode()!==g.NULL_CELL_CODE||S&&H===A){k=H+1;break}const L=this._themeService.colors;let O=-1,I=0;for(;I<k;I++){E.loadCell(I,this._workCell);let H=this._workCell.getWidth();if(H===0){F[I]=O;continue}let X=!1,Q=I,W=this._workCell;if(U.length>0&&I===U[0][0]){X=!0;const ne=U.shift();W=new p.JoinedCellData(this._workCell,E.translateToString(!0,ne[0],ne[1]),ne[1]-ne[0]),Q=ne[1]-1,H=W.getWidth()}const q=this._document.createElement("span");if(H>1&&(q.style.width=R*H+"px"),X&&(q.style.display="inline",A>=I&&A<=Q&&(A=I)),!this._coreService.isCursorHidden&&S&&I===A)switch(q.classList.add(s.CURSOR_CLASS),D&&q.classList.add(s.CURSOR_BLINK_CLASS),w){case"bar":q.classList.add(s.CURSOR_STYLE_BAR_CLASS);break;case"underline":q.classList.add(s.CURSOR_STYLE_UNDERLINE_CLASS);break;default:q.classList.add(s.CURSOR_STYLE_BLOCK_CLASS)}if(W.isBold()&&q.classList.add(s.BOLD_CLASS),W.isItalic()&&q.classList.add(s.ITALIC_CLASS),W.isDim()&&q.classList.add(s.DIM_CLASS),W.isInvisible()?q.textContent=g.WHITESPACE_CELL_CHAR:q.textContent=W.getChars()||g.WHITESPACE_CELL_CHAR,W.isUnderline()&&(q.classList.add(`${s.UNDERLINE_CLASS}-${W.extended.underlineStyle}`),q.textContent===" "&&(q.textContent=""),!W.isUnderlineColorDefault()))if(W.isUnderlineColorRGB())q.style.textDecorationColor=`rgb(${d.AttributeData.toColorRGB(W.getUnderlineColor()).join(",")})`;else{let ne=W.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&W.isBold()&&ne<8&&(ne+=8),q.style.textDecorationColor=L.ansi[ne].css}W.isOverline()&&(q.classList.add(s.OVERLINE_CLASS),q.textContent===" "&&(q.textContent="")),W.isStrikethrough()&&q.classList.add(s.STRIKETHROUGH_CLASS);let M=W.getFgColor(),P=W.getFgColorMode(),N=W.getBgColor(),j=W.getBgColorMode();const K=!!W.isInverse();if(K){const ne=M;M=N,N=ne;const mt=P;P=j,j=mt}let se,Y,ce=!1;this._decorationService.forEachDecorationAtCell(I,T,void 0,ne=>{ne.options.layer!=="top"&&ce||(ne.backgroundColorRGB&&(j=50331648,N=ne.backgroundColorRGB.rgba>>8&16777215,se=ne.backgroundColorRGB),ne.foregroundColorRGB&&(P=50331648,M=ne.foregroundColorRGB.rgba>>8&16777215,Y=ne.foregroundColorRGB),ce=ne.options.layer==="top")});const le=this._isCellInSelection(I,T);let he;switch(ce||L.selectionForeground&&le&&(P=50331648,M=L.selectionForeground.rgba>>8&16777215,Y=L.selectionForeground),le&&(se=this._coreBrowserService.isFocused?L.selectionBackgroundOpaque:L.selectionInactiveBackgroundOpaque,ce=!0),ce&&q.classList.add("xterm-decoration-top"),j){case 16777216:case 33554432:he=L.ansi[N],q.classList.add(`xterm-bg-${N}`);break;case 50331648:he=m.rgba.toColor(N>>16,N>>8&255,255&N),this._addStyle(q,`background-color:#${y((N>>>0).toString(16),"0",6)}`);break;default:K?(he=L.foreground,q.classList.add(`xterm-bg-${u.INVERTED_DEFAULT_COLOR}`)):he=L.background}switch(se||W.isDim()&&(se=m.color.multiplyOpacity(he,.5)),P){case 16777216:case 33554432:W.isBold()&&M<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(M+=8),this._applyMinimumContrast(q,he,L.ansi[M],W,se,void 0)||q.classList.add(`xterm-fg-${M}`);break;case 50331648:const ne=m.rgba.toColor(M>>16&255,M>>8&255,255&M);this._applyMinimumContrast(q,he,ne,W,se,Y)||this._addStyle(q,`color:#${y(M.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(q,he,L.foreground,W,se,void 0)||K&&q.classList.add(`xterm-fg-${u.INVERTED_DEFAULT_COLOR}`)}G.appendChild(q),F[I]=++O,I=Q}return I<x-1&&F.subarray(I).fill(++O),G}_applyMinimumContrast(E,T,S,w,A,D){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,f.excludeFromContrastRatioDemands)(w.getCode()))return!1;let R;return A||D||(R=this._themeService.colors.contrastCache.getColor(T.rgba,S.rgba)),R===void 0&&(R=m.color.ensureContrastRatio(A||T,D||S,this._optionsService.rawOptions.minimumContrastRatio),this._themeService.colors.contrastCache.setColor((A||T).rgba,(D||S).rgba,R??null)),!!R&&(this._addStyle(E,`color:${R.css}`),!0)}_addStyle(E,T){E.setAttribute("style",`${E.getAttribute("style")||""}${T};`)}_isCellInSelection(E,T){const S=this._selectionStart,w=this._selectionEnd;return!(!S||!w)&&(this._columnSelectMode?S[0]<=w[0]?E>=S[0]&&T>=S[1]&&E<w[0]&&T<=w[1]:E<S[0]&&T>=S[1]&&E>=w[0]&&T<=w[1]:T>S[1]&&T<w[1]||S[1]===w[1]&&T===S[1]&&E>=S[0]&&E<w[0]||S[1]<w[1]&&T===w[1]&&E<w[0]||S[1]<w[1]&&T===S[1]&&E>=S[0])}};function y(E,T,S){for(;E.length<S;)E=T+E;return E}v=a([h(1,c.ICharacterJoinerService),h(2,b.IOptionsService),h(3,c.ICoreBrowserService),h(4,b.ICoreService),h(5,b.IDecorationService),h(6,c.IThemeService)],v),s.DomRendererRowFactory=v},2223:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TEXT_BASELINE=s.DIM_OPACITY=s.INVERTED_DEFAULT_COLOR=void 0;const a=n(6114);s.INVERTED_DEFAULT_COLOR=257,s.DIM_OPACITY=.5,s.TEXT_BASELINE=a.isFirefox||a.isLegacyEdge?"bottom":"ideographic"},6171:(_,s)=>{function n(a){return 57508<=a&&a<=57558}Object.defineProperty(s,"__esModule",{value:!0}),s.createRenderDimensions=s.excludeFromContrastRatioDemands=s.isRestrictedPowerlineGlyph=s.isPowerlineGlyph=s.throwIfFalsy=void 0,s.throwIfFalsy=function(a){if(!a)throw new Error("value must not be falsy");return a},s.isPowerlineGlyph=n,s.isRestrictedPowerlineGlyph=function(a){return 57520<=a&&a<=57527},s.excludeFromContrastRatioDemands=function(a){return n(a)||function(h){return 9472<=h&&h<=9631}(a)},s.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SelectionModel=void 0,s.SelectionModel=class{constructor(n){this._bufferService=n,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const n=this.selectionStart[0]+this.selectionStartLength;return n>this._bufferService.cols?n%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)-1]:[n%this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)]:[n,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const n=this.selectionStart[0]+this.selectionStartLength;return n>this._bufferService.cols?[n%this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)]:[Math.max(n,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const n=this.selectionStart,a=this.selectionEnd;return!(!n||!a)&&(n[1]>a[1]||n[1]===a[1]&&n[0]>a[0])}handleTrim(n){return this.selectionStart&&(this.selectionStart[1]-=n),this.selectionEnd&&(this.selectionEnd[1]-=n),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(_,s,n){var a=this&&this.__decorate||function(c,p,f,d){var v,y=arguments.length,E=y<3?p:d===null?d=Object.getOwnPropertyDescriptor(p,f):d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(c,p,f,d);else for(var T=c.length-1;T>=0;T--)(v=c[T])&&(E=(y<3?v(E):y>3?v(p,f,E):v(p,f))||E);return y>3&&E&&Object.defineProperty(p,f,E),E},h=this&&this.__param||function(c,p){return function(f,d){p(f,d,c)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CharSizeService=void 0;const u=n(2585),g=n(8460),C=n(844);let b=class extends C.Disposable{constructor(c,p,f){super(),this._optionsService=f,this.width=0,this.height=0,this._onCharSizeChange=this.register(new g.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new m(c,p,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){const c=this._measureStrategy.measure();c.width===this.width&&c.height===this.height||(this.width=c.width,this.height=c.height,this._onCharSizeChange.fire())}};b=a([h(2,u.IOptionsService)],b),s.CharSizeService=b;class m{constructor(p,f,d){this._document=p,this._parentElement=f,this._optionsService=d,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const p=this._measureElement.getBoundingClientRect();return p.width!==0&&p.height!==0&&(this._result.width=p.width,this._result.height=Math.ceil(p.height)),this._result}}},4269:function(_,s,n){var a=this&&this.__decorate||function(p,f,d,v){var y,E=arguments.length,T=E<3?f:v===null?v=Object.getOwnPropertyDescriptor(f,d):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(p,f,d,v);else for(var S=p.length-1;S>=0;S--)(y=p[S])&&(T=(E<3?y(T):E>3?y(f,d,T):y(f,d))||T);return E>3&&T&&Object.defineProperty(f,d,T),T},h=this&&this.__param||function(p,f){return function(d,v){f(d,v,p)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CharacterJoinerService=s.JoinedCellData=void 0;const u=n(3734),g=n(643),C=n(511),b=n(2585);class m extends u.AttributeData{constructor(f,d,v){super(),this.content=0,this.combinedData="",this.fg=f.fg,this.bg=f.bg,this.combinedData=d,this._width=v}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(f){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}s.JoinedCellData=m;let c=class Pc{constructor(f){this._bufferService=f,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new C.CellData}register(f){const d={id:this._nextCharacterJoinerId++,handler:f};return this._characterJoiners.push(d),d.id}deregister(f){for(let d=0;d<this._characterJoiners.length;d++)if(this._characterJoiners[d].id===f)return this._characterJoiners.splice(d,1),!0;return!1}getJoinedCharacters(f){if(this._characterJoiners.length===0)return[];const d=this._bufferService.buffer.lines.get(f);if(!d||d.length===0)return[];const v=[],y=d.translateToString(!0);let E=0,T=0,S=0,w=d.getFg(0),A=d.getBg(0);for(let D=0;D<d.getTrimmedLength();D++)if(d.loadCell(D,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==w||this._workCell.bg!==A){if(D-E>1){const R=this._getJoinedRanges(y,S,T,d,E);for(let x=0;x<R.length;x++)v.push(R[x])}E=D,S=T,w=this._workCell.fg,A=this._workCell.bg}T+=this._workCell.getChars().length||g.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-E>1){const D=this._getJoinedRanges(y,S,T,d,E);for(let R=0;R<D.length;R++)v.push(D[R])}return v}_getJoinedRanges(f,d,v,y,E){const T=f.substring(d,v);let S=[];try{S=this._characterJoiners[0].handler(T)}catch(w){console.error(w)}for(let w=1;w<this._characterJoiners.length;w++)try{const A=this._characterJoiners[w].handler(T);for(let D=0;D<A.length;D++)Pc._mergeRanges(S,A[D])}catch(A){console.error(A)}return this._stringRangesToCellRanges(S,y,E),S}_stringRangesToCellRanges(f,d,v){let y=0,E=!1,T=0,S=f[y];if(S){for(let w=v;w<this._bufferService.cols;w++){const A=d.getWidth(w),D=d.getString(w).length||g.WHITESPACE_CELL_CHAR.length;if(A!==0){if(!E&&S[0]<=T&&(S[0]=w,E=!0),S[1]<=T){if(S[1]=w,S=f[++y],!S)break;S[0]<=T?(S[0]=w,E=!0):E=!1}T+=D}}S&&(S[1]=this._bufferService.cols)}}static _mergeRanges(f,d){let v=!1;for(let y=0;y<f.length;y++){const E=f[y];if(v){if(d[1]<=E[0])return f[y-1][1]=d[1],f;if(d[1]<=E[1])return f[y-1][1]=Math.max(d[1],E[1]),f.splice(y,1),f;f.splice(y,1),y--}else{if(d[1]<=E[0])return f.splice(y,0,d),f;if(d[1]<=E[1])return E[0]=Math.min(d[0],E[0]),f;d[0]<E[1]&&(E[0]=Math.min(d[0],E[0]),v=!0)}}return v?f[f.length-1][1]=d[1]:f.push(d),f}};c=a([h(0,b.IBufferService)],c),s.CharacterJoinerService=c},5114:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CoreBrowserService=void 0,s.CoreBrowserService=class{constructor(n,a){this._textarea=n,this.window=a,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(_,s,n){var a=this&&this.__decorate||function(b,m,c,p){var f,d=arguments.length,v=d<3?m:p===null?p=Object.getOwnPropertyDescriptor(m,c):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(b,m,c,p);else for(var y=b.length-1;y>=0;y--)(f=b[y])&&(v=(d<3?f(v):d>3?f(m,c,v):f(m,c))||v);return d>3&&v&&Object.defineProperty(m,c,v),v},h=this&&this.__param||function(b,m){return function(c,p){m(c,p,b)}};Object.defineProperty(s,"__esModule",{value:!0}),s.MouseService=void 0;const u=n(4725),g=n(9806);let C=class{constructor(b,m){this._renderService=b,this._charSizeService=m}getCoords(b,m,c,p,f){return(0,g.getCoords)(window,b,m,c,p,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,f)}getMouseReportCoords(b,m){const c=(0,g.getCoordsRelativeToElement)(window,b,m);if(!(!this._charSizeService.hasValidSize||c[0]<0||c[1]<0||c[0]>=this._renderService.dimensions.css.canvas.width||c[1]>=this._renderService.dimensions.css.canvas.height))return{col:Math.floor(c[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(c[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(c[0]),y:Math.floor(c[1])}}};C=a([h(0,u.IRenderService),h(1,u.ICharSizeService)],C),s.MouseService=C},3230:function(_,s,n){var a=this&&this.__decorate||function(v,y,E,T){var S,w=arguments.length,A=w<3?y:T===null?T=Object.getOwnPropertyDescriptor(y,E):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(v,y,E,T);else for(var D=v.length-1;D>=0;D--)(S=v[D])&&(A=(w<3?S(A):w>3?S(y,E,A):S(y,E))||A);return w>3&&A&&Object.defineProperty(y,E,A),A},h=this&&this.__param||function(v,y){return function(E,T){y(E,T,v)}};Object.defineProperty(s,"__esModule",{value:!0}),s.RenderService=void 0;const u=n(6193),g=n(8460),C=n(844),b=n(5596),m=n(3656),c=n(2585),p=n(4725),f=n(7226);let d=class extends C.Disposable{constructor(v,y,E,T,S,w,A,D){if(super(),this._rowCount=v,this._charSizeService=T,this._pausedResizeTask=new f.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new g.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new g.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new g.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new g.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this.register({dispose:()=>{var R;return(R=this._renderer)===null||R===void 0?void 0:R.dispose()}}),this._renderDebouncer=new u.RenderDebouncer(A.window,(R,x)=>this._renderRows(R,x)),this.register(this._renderDebouncer),this._screenDprMonitor=new b.ScreenDprMonitor(A.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(w.onResize(()=>this._fullRefresh())),this.register(w.buffers.onBufferActivate(()=>{var R;return(R=this._renderer)===null||R===void 0?void 0:R.clear()})),this.register(E.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(S.onDecorationRegistered(()=>this._fullRefresh())),this.register(S.onDecorationRemoved(()=>this._fullRefresh())),this.register(E.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(w.cols,w.rows),this._fullRefresh()})),this.register(E.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(w.buffer.y,w.buffer.y,!0))),this.register((0,m.addDisposableDomListener)(A.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(D.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in A.window){const R=new A.window.IntersectionObserver(x=>this._handleIntersectionChange(x[x.length-1]),{threshold:0});R.observe(y),this.register({dispose:()=>R.disconnect()})}}get dimensions(){return this._renderer.dimensions}_handleIntersectionChange(v){this._isPaused=v.isIntersecting===void 0?v.intersectionRatio===0:!v.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(v,y,E=!1){this._isPaused?this._needsFullRefresh=!0:(E||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(v,y,this._rowCount))}_renderRows(v,y){this._renderer&&(v=Math.min(v,this._rowCount-1),y=Math.min(y,this._rowCount-1),this._renderer.renderRows(v,y),this._needsSelectionRefresh&&(this._renderer.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:v,end:y}),this._onRender.fire({start:v,end:y}),this._isNextRenderRedrawOnly=!0)}resize(v,y){this._rowCount=y,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer&&(this._renderer.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions))}hasRenderer(){return!!this._renderer}setRenderer(v){var y;(y=this._renderer)===null||y===void 0||y.dispose(),this._renderer=v,this._renderer.onRequestRedraw(E=>this.refreshRows(E.start,E.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(v){return this._renderDebouncer.addRefreshCallback(v)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var v,y;this._renderer&&((y=(v=this._renderer).clearTextureAtlas)===null||y===void 0||y.call(v),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer&&(this._renderer.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(v,y){this._renderer&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.handleResize(v,y)):this._renderer.handleResize(v,y),this._fullRefresh())}handleCharSizeChanged(){var v;(v=this._renderer)===null||v===void 0||v.handleCharSizeChanged()}handleBlur(){var v;(v=this._renderer)===null||v===void 0||v.handleBlur()}handleFocus(){var v;(v=this._renderer)===null||v===void 0||v.handleFocus()}handleSelectionChanged(v,y,E){var T;this._selectionState.start=v,this._selectionState.end=y,this._selectionState.columnSelectMode=E,(T=this._renderer)===null||T===void 0||T.handleSelectionChanged(v,y,E)}handleCursorMove(){var v;(v=this._renderer)===null||v===void 0||v.handleCursorMove()}clear(){var v;(v=this._renderer)===null||v===void 0||v.clear()}};d=a([h(2,c.IOptionsService),h(3,p.ICharSizeService),h(4,c.IDecorationService),h(5,c.IBufferService),h(6,p.ICoreBrowserService),h(7,p.IThemeService)],d),s.RenderService=d},9312:function(_,s,n){var a=this&&this.__decorate||function(S,w,A,D){var R,x=arguments.length,F=x<3?w:D===null?D=Object.getOwnPropertyDescriptor(w,A):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(S,w,A,D);else for(var G=S.length-1;G>=0;G--)(R=S[G])&&(F=(x<3?R(F):x>3?R(w,A,F):R(w,A))||F);return x>3&&F&&Object.defineProperty(w,A,F),F},h=this&&this.__param||function(S,w){return function(A,D){w(A,D,S)}};Object.defineProperty(s,"__esModule",{value:!0}),s.SelectionService=void 0;const u=n(6114),g=n(456),C=n(511),b=n(8460),m=n(4725),c=n(2585),p=n(9806),f=n(9504),d=n(844),v=n(4841),y=String.fromCharCode(160),E=new RegExp(y,"g");let T=class extends d.Disposable{constructor(S,w,A,D,R,x,F,G,U){super(),this._element=S,this._screenElement=w,this._linkifier=A,this._bufferService=D,this._coreService=R,this._mouseService=x,this._optionsService=F,this._renderService=G,this._coreBrowserService=U,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new C.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new b.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new b.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new b.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new b.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=k=>this._handleMouseMove(k),this._mouseUpListener=k=>this._handleMouseUp(k),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(k=>this._handleTrim(k)),this.register(this._bufferService.buffers.onBufferActivate(k=>this._handleBufferActivate(k))),this.enable(),this._model=new g.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,d.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const S=this._model.finalSelectionStart,w=this._model.finalSelectionEnd;return!(!S||!w||S[0]===w[0]&&S[1]===w[1])}get selectionText(){const S=this._model.finalSelectionStart,w=this._model.finalSelectionEnd;if(!S||!w)return"";const A=this._bufferService.buffer,D=[];if(this._activeSelectionMode===3){if(S[0]===w[0])return"";const R=S[0]<w[0]?S[0]:w[0],x=S[0]<w[0]?w[0]:S[0];for(let F=S[1];F<=w[1];F++){const G=A.translateBufferLineToString(F,!0,R,x);D.push(G)}}else{const R=S[1]===w[1]?w[0]:void 0;D.push(A.translateBufferLineToString(S[1],!0,S[0],R));for(let x=S[1]+1;x<=w[1]-1;x++){const F=A.lines.get(x),G=A.translateBufferLineToString(x,!0);F!=null&&F.isWrapped?D[D.length-1]+=G:D.push(G)}if(S[1]!==w[1]){const x=A.lines.get(w[1]),F=A.translateBufferLineToString(w[1],!0,0,w[0]);x&&x.isWrapped?D[D.length-1]+=F:D.push(F)}}return D.map(R=>R.replace(E," ")).join(u.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(S){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),u.isLinux&&S&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(S){const w=this._getMouseBufferCoords(S),A=this._model.finalSelectionStart,D=this._model.finalSelectionEnd;return!!(A&&D&&w)&&this._areCoordsInSelection(w,A,D)}isCellInSelection(S,w){const A=this._model.finalSelectionStart,D=this._model.finalSelectionEnd;return!(!A||!D)&&this._areCoordsInSelection([S,w],A,D)}_areCoordsInSelection(S,w,A){return S[1]>w[1]&&S[1]<A[1]||w[1]===A[1]&&S[1]===w[1]&&S[0]>=w[0]&&S[0]<A[0]||w[1]<A[1]&&S[1]===A[1]&&S[0]<A[0]||w[1]<A[1]&&S[1]===w[1]&&S[0]>=w[0]}_selectWordAtCursor(S,w){var A,D;const R=(D=(A=this._linkifier.currentLink)===null||A===void 0?void 0:A.link)===null||D===void 0?void 0:D.range;if(R)return this._model.selectionStart=[R.start.x-1,R.start.y-1],this._model.selectionStartLength=(0,v.getRangeLength)(R,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const x=this._getMouseBufferCoords(S);return!!x&&(this._selectWordAt(x,w),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(S,w){this._model.clearSelection(),S=Math.max(S,0),w=Math.min(w,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,S],this._model.selectionEnd=[this._bufferService.cols,w],this.refresh(),this._onSelectionChange.fire()}_handleTrim(S){this._model.handleTrim(S)&&this.refresh()}_getMouseBufferCoords(S){const w=this._mouseService.getCoords(S,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(w)return w[0]--,w[1]--,w[1]+=this._bufferService.buffer.ydisp,w}_getMouseEventScrollAmount(S){let w=(0,p.getCoordsRelativeToElement)(this._coreBrowserService.window,S,this._screenElement)[1];const A=this._renderService.dimensions.css.canvas.height;return w>=0&&w<=A?0:(w>A&&(w-=A),w=Math.min(Math.max(w,-50),50),w/=50,w/Math.abs(w)+Math.round(14*w))}shouldForceSelection(S){return u.isMac?S.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:S.shiftKey}handleMouseDown(S){if(this._mouseDownTimeStamp=S.timeStamp,(S.button!==2||!this.hasSelection)&&S.button===0){if(!this._enabled){if(!this.shouldForceSelection(S))return;S.stopPropagation()}S.preventDefault(),this._dragScrollAmount=0,this._enabled&&S.shiftKey?this._handleIncrementalClick(S):S.detail===1?this._handleSingleClick(S):S.detail===2?this._handleDoubleClick(S):S.detail===3&&this._handleTripleClick(S),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(S){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(S))}_handleSingleClick(S){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(S)?3:0,this._model.selectionStart=this._getMouseBufferCoords(S),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const w=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);w&&w.length!==this._model.selectionStart[0]&&w.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(S){this._selectWordAtCursor(S,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(S){const w=this._getMouseBufferCoords(S);w&&(this._activeSelectionMode=2,this._selectLineAt(w[1]))}shouldColumnSelect(S){return S.altKey&&!(u.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(S){if(S.stopImmediatePropagation(),!this._model.selectionStart)return;const w=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(S),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(S),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const A=this._bufferService.buffer;if(this._model.selectionEnd[1]<A.lines.length){const D=A.lines.get(this._model.selectionEnd[1]);D&&D.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}w&&w[0]===this._model.selectionEnd[0]&&w[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const S=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(S.ydisp+this._bufferService.rows,S.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=S.ydisp),this.refresh()}}_handleMouseUp(S){const w=S.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&w<500&&S.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const A=this._mouseService.getCoords(S,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(A&&A[0]!==void 0&&A[1]!==void 0){const D=(0,f.moveToCellSequence)(A[0]-1,A[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(D,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const S=this._model.finalSelectionStart,w=this._model.finalSelectionEnd,A=!(!S||!w||S[0]===w[0]&&S[1]===w[1]);A?S&&w&&(this._oldSelectionStart&&this._oldSelectionEnd&&S[0]===this._oldSelectionStart[0]&&S[1]===this._oldSelectionStart[1]&&w[0]===this._oldSelectionEnd[0]&&w[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(S,w,A)):this._oldHasSelection&&this._fireOnSelectionChange(S,w,A)}_fireOnSelectionChange(S,w,A){this._oldSelectionStart=S,this._oldSelectionEnd=w,this._oldHasSelection=A,this._onSelectionChange.fire()}_handleBufferActivate(S){this.clearSelection(),this._trimListener.dispose(),this._trimListener=S.activeBuffer.lines.onTrim(w=>this._handleTrim(w))}_convertViewportColToCharacterIndex(S,w){let A=w;for(let D=0;w>=D;D++){const R=S.loadCell(D,this._workCell).getChars().length;this._workCell.getWidth()===0?A--:R>1&&w!==D&&(A+=R-1)}return A}setSelection(S,w,A){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[S,w],this._model.selectionStartLength=A,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(S){this._isClickInSelection(S)||(this._selectWordAtCursor(S,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(S,w,A=!0,D=!0){if(S[0]>=this._bufferService.cols)return;const R=this._bufferService.buffer,x=R.lines.get(S[1]);if(!x)return;const F=R.translateBufferLineToString(S[1],!1);let G=this._convertViewportColToCharacterIndex(x,S[0]),U=G;const k=S[0]-G;let L=0,O=0,I=0,H=0;if(F.charAt(G)===" "){for(;G>0&&F.charAt(G-1)===" ";)G--;for(;U<F.length&&F.charAt(U+1)===" ";)U++}else{let W=S[0],q=S[0];x.getWidth(W)===0&&(L++,W--),x.getWidth(q)===2&&(O++,q++);const M=x.getString(q).length;for(M>1&&(H+=M-1,U+=M-1);W>0&&G>0&&!this._isCharWordSeparator(x.loadCell(W-1,this._workCell));){x.loadCell(W-1,this._workCell);const P=this._workCell.getChars().length;this._workCell.getWidth()===0?(L++,W--):P>1&&(I+=P-1,G-=P-1),G--,W--}for(;q<x.length&&U+1<F.length&&!this._isCharWordSeparator(x.loadCell(q+1,this._workCell));){x.loadCell(q+1,this._workCell);const P=this._workCell.getChars().length;this._workCell.getWidth()===2?(O++,q++):P>1&&(H+=P-1,U+=P-1),U++,q++}}U++;let X=G+k-L+I,Q=Math.min(this._bufferService.cols,U-G+L+O-I-H);if(w||F.slice(G,U).trim()!==""){if(A&&X===0&&x.getCodePoint(0)!==32){const W=R.lines.get(S[1]-1);if(W&&x.isWrapped&&W.getCodePoint(this._bufferService.cols-1)!==32){const q=this._getWordAt([this._bufferService.cols-1,S[1]-1],!1,!0,!1);if(q){const M=this._bufferService.cols-q.start;X-=M,Q+=M}}}if(D&&X+Q===this._bufferService.cols&&x.getCodePoint(this._bufferService.cols-1)!==32){const W=R.lines.get(S[1]+1);if(W!=null&&W.isWrapped&&W.getCodePoint(0)!==32){const q=this._getWordAt([0,S[1]+1],!1,!1,!0);q&&(Q+=q.length)}}return{start:X,length:Q}}}_selectWordAt(S,w){const A=this._getWordAt(S,w);if(A){for(;A.start<0;)A.start+=this._bufferService.cols,S[1]--;this._model.selectionStart=[A.start,S[1]],this._model.selectionStartLength=A.length}}_selectToWordAt(S){const w=this._getWordAt(S,!0);if(w){let A=S[1];for(;w.start<0;)w.start+=this._bufferService.cols,A--;if(!this._model.areSelectionValuesReversed())for(;w.start+w.length>this._bufferService.cols;)w.length-=this._bufferService.cols,A++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?w.start:w.start+w.length,A]}}_isCharWordSeparator(S){return S.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(S.getChars())>=0}_selectLineAt(S){const w=this._bufferService.buffer.getWrappedRangeForLine(S),A={start:{x:0,y:w.first},end:{x:this._bufferService.cols-1,y:w.last}};this._model.selectionStart=[0,w.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,v.getRangeLength)(A,this._bufferService.cols)}};T=a([h(3,c.IBufferService),h(4,c.ICoreService),h(5,m.IMouseService),h(6,c.IOptionsService),h(7,m.IRenderService),h(8,m.ICoreBrowserService)],T),s.SelectionService=T},4725:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.IThemeService=s.ICharacterJoinerService=s.ISelectionService=s.IRenderService=s.IMouseService=s.ICoreBrowserService=s.ICharSizeService=void 0;const a=n(8343);s.ICharSizeService=(0,a.createDecorator)("CharSizeService"),s.ICoreBrowserService=(0,a.createDecorator)("CoreBrowserService"),s.IMouseService=(0,a.createDecorator)("MouseService"),s.IRenderService=(0,a.createDecorator)("RenderService"),s.ISelectionService=(0,a.createDecorator)("SelectionService"),s.ICharacterJoinerService=(0,a.createDecorator)("CharacterJoinerService"),s.IThemeService=(0,a.createDecorator)("ThemeService")},6731:function(_,s,n){var a=this&&this.__decorate||function(T,S,w,A){var D,R=arguments.length,x=R<3?S:A===null?A=Object.getOwnPropertyDescriptor(S,w):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(T,S,w,A);else for(var F=T.length-1;F>=0;F--)(D=T[F])&&(x=(R<3?D(x):R>3?D(S,w,x):D(S,w))||x);return R>3&&x&&Object.defineProperty(S,w,x),x},h=this&&this.__param||function(T,S){return function(w,A){S(w,A,T)}};Object.defineProperty(s,"__esModule",{value:!0}),s.ThemeService=s.DEFAULT_ANSI_COLORS=void 0;const u=n(7239),g=n(8055),C=n(8460),b=n(844),m=n(2585),c=g.css.toColor("#ffffff"),p=g.css.toColor("#000000"),f=g.css.toColor("#ffffff"),d=g.css.toColor("#000000"),v={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};s.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const T=[g.css.toColor("#2e3436"),g.css.toColor("#cc0000"),g.css.toColor("#4e9a06"),g.css.toColor("#c4a000"),g.css.toColor("#3465a4"),g.css.toColor("#75507b"),g.css.toColor("#06989a"),g.css.toColor("#d3d7cf"),g.css.toColor("#555753"),g.css.toColor("#ef2929"),g.css.toColor("#8ae234"),g.css.toColor("#fce94f"),g.css.toColor("#729fcf"),g.css.toColor("#ad7fa8"),g.css.toColor("#34e2e2"),g.css.toColor("#eeeeec")],S=[0,95,135,175,215,255];for(let w=0;w<216;w++){const A=S[w/36%6|0],D=S[w/6%6|0],R=S[w%6];T.push({css:g.channels.toCss(A,D,R),rgba:g.channels.toRgba(A,D,R)})}for(let w=0;w<24;w++){const A=8+10*w;T.push({css:g.channels.toCss(A,A,A),rgba:g.channels.toRgba(A,A,A)})}return T})());let y=class extends b.Disposable{constructor(T){super(),this._optionsService=T,this._onChangeColors=this.register(new C.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._contrastCache=new u.ColorContrastCache,this._colors={foreground:c,background:p,cursor:f,cursorAccent:d,selectionForeground:void 0,selectionBackgroundTransparent:v,selectionBackgroundOpaque:g.color.blend(p,v),selectionInactiveBackgroundTransparent:v,selectionInactiveBackgroundOpaque:g.color.blend(p,v),ansi:s.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(T={}){const S=this._colors;if(S.foreground=E(T.foreground,c),S.background=E(T.background,p),S.cursor=E(T.cursor,f),S.cursorAccent=E(T.cursorAccent,d),S.selectionBackgroundTransparent=E(T.selectionBackground,v),S.selectionBackgroundOpaque=g.color.blend(S.background,S.selectionBackgroundTransparent),S.selectionInactiveBackgroundTransparent=E(T.selectionInactiveBackground,S.selectionBackgroundTransparent),S.selectionInactiveBackgroundOpaque=g.color.blend(S.background,S.selectionInactiveBackgroundTransparent),S.selectionForeground=T.selectionForeground?E(T.selectionForeground,g.NULL_COLOR):void 0,S.selectionForeground===g.NULL_COLOR&&(S.selectionForeground=void 0),g.color.isOpaque(S.selectionBackgroundTransparent)&&(S.selectionBackgroundTransparent=g.color.opacity(S.selectionBackgroundTransparent,.3)),g.color.isOpaque(S.selectionInactiveBackgroundTransparent)&&(S.selectionInactiveBackgroundTransparent=g.color.opacity(S.selectionInactiveBackgroundTransparent,.3)),S.ansi=s.DEFAULT_ANSI_COLORS.slice(),S.ansi[0]=E(T.black,s.DEFAULT_ANSI_COLORS[0]),S.ansi[1]=E(T.red,s.DEFAULT_ANSI_COLORS[1]),S.ansi[2]=E(T.green,s.DEFAULT_ANSI_COLORS[2]),S.ansi[3]=E(T.yellow,s.DEFAULT_ANSI_COLORS[3]),S.ansi[4]=E(T.blue,s.DEFAULT_ANSI_COLORS[4]),S.ansi[5]=E(T.magenta,s.DEFAULT_ANSI_COLORS[5]),S.ansi[6]=E(T.cyan,s.DEFAULT_ANSI_COLORS[6]),S.ansi[7]=E(T.white,s.DEFAULT_ANSI_COLORS[7]),S.ansi[8]=E(T.brightBlack,s.DEFAULT_ANSI_COLORS[8]),S.ansi[9]=E(T.brightRed,s.DEFAULT_ANSI_COLORS[9]),S.ansi[10]=E(T.brightGreen,s.DEFAULT_ANSI_COLORS[10]),S.ansi[11]=E(T.brightYellow,s.DEFAULT_ANSI_COLORS[11]),S.ansi[12]=E(T.brightBlue,s.DEFAULT_ANSI_COLORS[12]),S.ansi[13]=E(T.brightMagenta,s.DEFAULT_ANSI_COLORS[13]),S.ansi[14]=E(T.brightCyan,s.DEFAULT_ANSI_COLORS[14]),S.ansi[15]=E(T.brightWhite,s.DEFAULT_ANSI_COLORS[15]),T.extendedAnsi){const w=Math.min(S.ansi.length-16,T.extendedAnsi.length);for(let A=0;A<w;A++)S.ansi[A+16]=E(T.extendedAnsi[A],s.DEFAULT_ANSI_COLORS[A+16])}this._contrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(T){this._restoreColor(T),this._onChangeColors.fire(this.colors)}_restoreColor(T){if(T!==void 0)switch(T){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[T]=this._restoreColors.ansi[T]}else for(let S=0;S<this._restoreColors.ansi.length;++S)this._colors.ansi[S]=this._restoreColors.ansi[S]}modifyColors(T){T(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function E(T,S){if(T!==void 0)try{return g.css.toColor(T)}catch{}return S}y=a([h(0,m.IOptionsService)],y),s.ThemeService=y},6349:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CircularList=void 0;const a=n(8460),h=n(844);class u extends h.Disposable{constructor(C){super(),this._maxLength=C,this.onDeleteEmitter=this.register(new a.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new a.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new a.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(C){if(this._maxLength===C)return;const b=new Array(C);for(let m=0;m<Math.min(C,this.length);m++)b[m]=this._array[this._getCyclicIndex(m)];this._array=b,this._maxLength=C,this._startIndex=0}get length(){return this._length}set length(C){if(C>this._length)for(let b=this._length;b<C;b++)this._array[b]=void 0;this._length=C}get(C){return this._array[this._getCyclicIndex(C)]}set(C,b){this._array[this._getCyclicIndex(C)]=b}push(C){this._array[this._getCyclicIndex(this._length)]=C,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(C,b,...m){if(b){for(let c=C;c<this._length-b;c++)this._array[this._getCyclicIndex(c)]=this._array[this._getCyclicIndex(c+b)];this._length-=b,this.onDeleteEmitter.fire({index:C,amount:b})}for(let c=this._length-1;c>=C;c--)this._array[this._getCyclicIndex(c+m.length)]=this._array[this._getCyclicIndex(c)];for(let c=0;c<m.length;c++)this._array[this._getCyclicIndex(C+c)]=m[c];if(m.length&&this.onInsertEmitter.fire({index:C,amount:m.length}),this._length+m.length>this._maxLength){const c=this._length+m.length-this._maxLength;this._startIndex+=c,this._length=this._maxLength,this.onTrimEmitter.fire(c)}else this._length+=m.length}trimStart(C){C>this._length&&(C=this._length),this._startIndex+=C,this._length-=C,this.onTrimEmitter.fire(C)}shiftElements(C,b,m){if(!(b<=0)){if(C<0||C>=this._length)throw new Error("start argument out of range");if(C+m<0)throw new Error("Cannot shift elements in list beyond index 0");if(m>0){for(let p=b-1;p>=0;p--)this.set(C+p+m,this.get(C+p));const c=C+b+m-this._length;if(c>0)for(this._length+=c;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let c=0;c<b;c++)this.set(C+c+m,this.get(C+c))}}_getCyclicIndex(C){return(this._startIndex+C)%this._maxLength}}s.CircularList=u},1439:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.clone=void 0,s.clone=function n(a,h=5){if(typeof a!="object")return a;const u=Array.isArray(a)?[]:{};for(const g in a)u[g]=h<=1?a[g]:a[g]&&n(a[g],h-1);return u}},8055:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.contrastRatio=s.toPaddedHex=s.rgba=s.rgb=s.css=s.color=s.channels=s.NULL_COLOR=void 0;const a=n(6114);let h=0,u=0,g=0,C=0;var b,m,c;function p(d){const v=d.toString(16);return v.length<2?"0"+v:v}function f(d,v){return d<v?(v+.05)/(d+.05):(d+.05)/(v+.05)}s.NULL_COLOR={css:"#00000000",rgba:0},function(d){d.toCss=function(v,y,E,T){return T!==void 0?`#${p(v)}${p(y)}${p(E)}${p(T)}`:`#${p(v)}${p(y)}${p(E)}`},d.toRgba=function(v,y,E,T=255){return(v<<24|y<<16|E<<8|T)>>>0}}(b=s.channels||(s.channels={})),function(d){function v(y,E){return C=Math.round(255*E),[h,u,g]=c.toChannels(y.rgba),{css:b.toCss(h,u,g,C),rgba:b.toRgba(h,u,g,C)}}d.blend=function(y,E){if(C=(255&E.rgba)/255,C===1)return{css:E.css,rgba:E.rgba};const T=E.rgba>>24&255,S=E.rgba>>16&255,w=E.rgba>>8&255,A=y.rgba>>24&255,D=y.rgba>>16&255,R=y.rgba>>8&255;return h=A+Math.round((T-A)*C),u=D+Math.round((S-D)*C),g=R+Math.round((w-R)*C),{css:b.toCss(h,u,g),rgba:b.toRgba(h,u,g)}},d.isOpaque=function(y){return(255&y.rgba)==255},d.ensureContrastRatio=function(y,E,T){const S=c.ensureContrastRatio(y.rgba,E.rgba,T);if(S)return c.toColor(S>>24&255,S>>16&255,S>>8&255)},d.opaque=function(y){const E=(255|y.rgba)>>>0;return[h,u,g]=c.toChannels(E),{css:b.toCss(h,u,g),rgba:E}},d.opacity=v,d.multiplyOpacity=function(y,E){return C=255&y.rgba,v(y,C*E/255)},d.toColorRGB=function(y){return[y.rgba>>24&255,y.rgba>>16&255,y.rgba>>8&255]}}(s.color||(s.color={})),function(d){let v,y;if(!a.isNode){const E=document.createElement("canvas");E.width=1,E.height=1;const T=E.getContext("2d",{willReadFrequently:!0});T&&(v=T,v.globalCompositeOperation="copy",y=v.createLinearGradient(0,0,1,1))}d.toColor=function(E){if(E.match(/#[\da-f]{3,8}/i))switch(E.length){case 4:return h=parseInt(E.slice(1,2).repeat(2),16),u=parseInt(E.slice(2,3).repeat(2),16),g=parseInt(E.slice(3,4).repeat(2),16),c.toColor(h,u,g);case 5:return h=parseInt(E.slice(1,2).repeat(2),16),u=parseInt(E.slice(2,3).repeat(2),16),g=parseInt(E.slice(3,4).repeat(2),16),C=parseInt(E.slice(4,5).repeat(2),16),c.toColor(h,u,g,C);case 7:return{css:E,rgba:(parseInt(E.slice(1),16)<<8|255)>>>0};case 9:return{css:E,rgba:parseInt(E.slice(1),16)>>>0}}const T=E.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(T)return h=parseInt(T[1]),u=parseInt(T[2]),g=parseInt(T[3]),C=Math.round(255*(T[5]===void 0?1:parseFloat(T[5]))),c.toColor(h,u,g,C);if(!v||!y)throw new Error("css.toColor: Unsupported css format");if(v.fillStyle=y,v.fillStyle=E,typeof v.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(v.fillRect(0,0,1,1),[h,u,g,C]=v.getImageData(0,0,1,1).data,C!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:b.toRgba(h,u,g,C),css:E}}}(s.css||(s.css={})),function(d){function v(y,E,T){const S=y/255,w=E/255,A=T/255;return .2126*(S<=.03928?S/12.92:Math.pow((S+.055)/1.055,2.4))+.7152*(w<=.03928?w/12.92:Math.pow((w+.055)/1.055,2.4))+.0722*(A<=.03928?A/12.92:Math.pow((A+.055)/1.055,2.4))}d.relativeLuminance=function(y){return v(y>>16&255,y>>8&255,255&y)},d.relativeLuminance2=v}(m=s.rgb||(s.rgb={})),function(d){function v(E,T,S){const w=E>>24&255,A=E>>16&255,D=E>>8&255;let R=T>>24&255,x=T>>16&255,F=T>>8&255,G=f(m.relativeLuminance2(R,x,F),m.relativeLuminance2(w,A,D));for(;G<S&&(R>0||x>0||F>0);)R-=Math.max(0,Math.ceil(.1*R)),x-=Math.max(0,Math.ceil(.1*x)),F-=Math.max(0,Math.ceil(.1*F)),G=f(m.relativeLuminance2(R,x,F),m.relativeLuminance2(w,A,D));return(R<<24|x<<16|F<<8|255)>>>0}function y(E,T,S){const w=E>>24&255,A=E>>16&255,D=E>>8&255;let R=T>>24&255,x=T>>16&255,F=T>>8&255,G=f(m.relativeLuminance2(R,x,F),m.relativeLuminance2(w,A,D));for(;G<S&&(R<255||x<255||F<255);)R=Math.min(255,R+Math.ceil(.1*(255-R))),x=Math.min(255,x+Math.ceil(.1*(255-x))),F=Math.min(255,F+Math.ceil(.1*(255-F))),G=f(m.relativeLuminance2(R,x,F),m.relativeLuminance2(w,A,D));return(R<<24|x<<16|F<<8|255)>>>0}d.ensureContrastRatio=function(E,T,S){const w=m.relativeLuminance(E>>8),A=m.relativeLuminance(T>>8);if(f(w,A)<S){if(A<w){const x=v(E,T,S),F=f(w,m.relativeLuminance(x>>8));if(F<S){const G=y(E,T,S);return F>f(w,m.relativeLuminance(G>>8))?x:G}return x}const D=y(E,T,S),R=f(w,m.relativeLuminance(D>>8));if(R<S){const x=v(E,T,S);return R>f(w,m.relativeLuminance(x>>8))?D:x}return D}},d.reduceLuminance=v,d.increaseLuminance=y,d.toChannels=function(E){return[E>>24&255,E>>16&255,E>>8&255,255&E]},d.toColor=function(E,T,S,w){return{css:b.toCss(E,T,S,w),rgba:b.toRgba(E,T,S,w)}}}(c=s.rgba||(s.rgba={})),s.toPaddedHex=p,s.contrastRatio=f},8969:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CoreTerminal=void 0;const a=n(844),h=n(2585),u=n(4348),g=n(7866),C=n(744),b=n(7302),m=n(6975),c=n(8460),p=n(1753),f=n(1480),d=n(7994),v=n(9282),y=n(5435),E=n(5981),T=n(2660);let S=!1;class w extends a.Disposable{constructor(D){super(),this._onBinary=this.register(new c.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new c.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new c.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new c.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new c.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new c.EventEmitter),this._instantiationService=new u.InstantiationService,this.optionsService=this.register(new b.OptionsService(D)),this._instantiationService.setService(h.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(C.BufferService)),this._instantiationService.setService(h.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(g.LogService)),this._instantiationService.setService(h.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(m.CoreService)),this._instantiationService.setService(h.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(p.CoreMouseService)),this._instantiationService.setService(h.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(f.UnicodeService)),this._instantiationService.setService(h.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(d.CharsetService),this._instantiationService.setService(h.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(T.OscLinkService),this._instantiationService.setService(h.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new y.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,c.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,c.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,c.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,c.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(R=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(R=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new E.WriteBuffer((R,x)=>this._inputHandler.parse(R,x))),this.register((0,c.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed)),this.register((0,a.toDisposable)(()=>{var R;(R=this._windowsWrappingHeuristics)===null||R===void 0||R.dispose(),this._windowsWrappingHeuristics=void 0}))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new c.EventEmitter),this._onScroll.event(D=>{var R;(R=this._onScrollApi)===null||R===void 0||R.fire(D.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(D){for(const R in D)this.optionsService.options[R]=D[R]}write(D,R){this._writeBuffer.write(D,R)}writeSync(D,R){this._logService.logLevel<=h.LogLevelEnum.WARN&&!S&&(this._logService.warn("writeSync is unreliable and will be removed soon."),S=!0),this._writeBuffer.writeSync(D,R)}resize(D,R){isNaN(D)||isNaN(R)||(D=Math.max(D,C.MINIMUM_COLS),R=Math.max(R,C.MINIMUM_ROWS),this._bufferService.resize(D,R))}scroll(D,R=!1){this._bufferService.scroll(D,R)}scrollLines(D,R,x){this._bufferService.scrollLines(D,R,x)}scrollPages(D){this._bufferService.scrollPages(D)}scrollToTop(){this._bufferService.scrollToTop()}scrollToBottom(){this._bufferService.scrollToBottom()}scrollToLine(D){this._bufferService.scrollToLine(D)}registerEscHandler(D,R){return this._inputHandler.registerEscHandler(D,R)}registerDcsHandler(D,R){return this._inputHandler.registerDcsHandler(D,R)}registerCsiHandler(D,R){return this._inputHandler.registerCsiHandler(D,R)}registerOscHandler(D,R){return this._inputHandler.registerOscHandler(D,R)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){var D;let R=!1;const x=this.optionsService.rawOptions.windowsPty;x&&x.buildNumber!==void 0&&x.buildNumber!==void 0?R=x.backend==="conpty"&&x.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(R=!0),R?this._enableWindowsWrappingHeuristics():((D=this._windowsWrappingHeuristics)===null||D===void 0||D.dispose(),this._windowsWrappingHeuristics=void 0)}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics){const D=[];D.push(this.onLineFeed(v.updateWindowsModeWrappedState.bind(null,this._bufferService))),D.push(this.registerCsiHandler({final:"H"},()=>((0,v.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics=(0,a.toDisposable)(()=>{for(const R of D)R.dispose()})}}}s.CoreTerminal=w},8460:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.forwardEvent=s.EventEmitter=void 0,s.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=n=>(this._listeners.push(n),{dispose:()=>{if(!this._disposed){for(let a=0;a<this._listeners.length;a++)if(this._listeners[a]===n)return void this._listeners.splice(a,1)}}})),this._event}fire(n,a){const h=[];for(let u=0;u<this._listeners.length;u++)h.push(this._listeners[u]);for(let u=0;u<h.length;u++)h[u].call(void 0,n,a)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},s.forwardEvent=function(n,a){return n(h=>a.fire(h))}},5435:function(_,s,n){var a=this&&this.__decorate||function(U,k,L,O){var I,H=arguments.length,X=H<3?k:O===null?O=Object.getOwnPropertyDescriptor(k,L):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")X=Reflect.decorate(U,k,L,O);else for(var Q=U.length-1;Q>=0;Q--)(I=U[Q])&&(X=(H<3?I(X):H>3?I(k,L,X):I(k,L))||X);return H>3&&X&&Object.defineProperty(k,L,X),X},h=this&&this.__param||function(U,k){return function(L,O){k(L,O,U)}};Object.defineProperty(s,"__esModule",{value:!0}),s.InputHandler=s.WindowsOptionsReportType=void 0;const u=n(2584),g=n(7116),C=n(2015),b=n(844),m=n(482),c=n(8437),p=n(8460),f=n(643),d=n(511),v=n(3734),y=n(2585),E=n(6242),T=n(6351),S=n(5941),w={"(":0,")":1,"*":2,"+":3,"-":1,".":2},A=131072;function D(U,k){if(U>24)return k.setWinLines||!1;switch(U){case 1:return!!k.restoreWin;case 2:return!!k.minimizeWin;case 3:return!!k.setWinPosition;case 4:return!!k.setWinSizePixels;case 5:return!!k.raiseWin;case 6:return!!k.lowerWin;case 7:return!!k.refreshWin;case 8:return!!k.setWinSizeChars;case 9:return!!k.maximizeWin;case 10:return!!k.fullscreenWin;case 11:return!!k.getWinState;case 13:return!!k.getWinPosition;case 14:return!!k.getWinSizePixels;case 15:return!!k.getScreenSizePixels;case 16:return!!k.getCellSizePixels;case 18:return!!k.getWinSizeChars;case 19:return!!k.getScreenSizeChars;case 20:return!!k.getIconTitle;case 21:return!!k.getWinTitle;case 22:return!!k.pushTitle;case 23:return!!k.popTitle;case 24:return!!k.setWinLines}return!1}var R;(function(U){U[U.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",U[U.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(R=s.WindowsOptionsReportType||(s.WindowsOptionsReportType={}));let x=0;class F extends b.Disposable{constructor(k,L,O,I,H,X,Q,W,q=new C.EscapeSequenceParser){super(),this._bufferService=k,this._charsetService=L,this._coreService=O,this._logService=I,this._optionsService=H,this._oscLinkService=X,this._coreMouseService=Q,this._unicodeService=W,this._parser=q,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new m.StringToUtf32,this._utf8Decoder=new m.Utf8ToUtf32,this._workCell=new d.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=c.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=c.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new p.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new p.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new p.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new p.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new p.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new p.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new p.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new p.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new p.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new p.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new p.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new p.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new p.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new G(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(M=>this._activeBuffer=M.activeBuffer)),this._parser.setCsiHandlerFallback((M,P)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(M),params:P.toArray()})}),this._parser.setEscHandlerFallback(M=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(M)})}),this._parser.setExecuteHandlerFallback(M=>{this._logService.debug("Unknown EXECUTE code: ",{code:M})}),this._parser.setOscHandlerFallback((M,P,N)=>{this._logService.debug("Unknown OSC code: ",{identifier:M,action:P,data:N})}),this._parser.setDcsHandlerFallback((M,P,N)=>{P==="HOOK"&&(N=N.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(M),action:P,payload:N})}),this._parser.setPrintHandler((M,P,N)=>this.print(M,P,N)),this._parser.registerCsiHandler({final:"@"},M=>this.insertChars(M)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},M=>this.scrollLeft(M)),this._parser.registerCsiHandler({final:"A"},M=>this.cursorUp(M)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},M=>this.scrollRight(M)),this._parser.registerCsiHandler({final:"B"},M=>this.cursorDown(M)),this._parser.registerCsiHandler({final:"C"},M=>this.cursorForward(M)),this._parser.registerCsiHandler({final:"D"},M=>this.cursorBackward(M)),this._parser.registerCsiHandler({final:"E"},M=>this.cursorNextLine(M)),this._parser.registerCsiHandler({final:"F"},M=>this.cursorPrecedingLine(M)),this._parser.registerCsiHandler({final:"G"},M=>this.cursorCharAbsolute(M)),this._parser.registerCsiHandler({final:"H"},M=>this.cursorPosition(M)),this._parser.registerCsiHandler({final:"I"},M=>this.cursorForwardTab(M)),this._parser.registerCsiHandler({final:"J"},M=>this.eraseInDisplay(M,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},M=>this.eraseInDisplay(M,!0)),this._parser.registerCsiHandler({final:"K"},M=>this.eraseInLine(M,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},M=>this.eraseInLine(M,!0)),this._parser.registerCsiHandler({final:"L"},M=>this.insertLines(M)),this._parser.registerCsiHandler({final:"M"},M=>this.deleteLines(M)),this._parser.registerCsiHandler({final:"P"},M=>this.deleteChars(M)),this._parser.registerCsiHandler({final:"S"},M=>this.scrollUp(M)),this._parser.registerCsiHandler({final:"T"},M=>this.scrollDown(M)),this._parser.registerCsiHandler({final:"X"},M=>this.eraseChars(M)),this._parser.registerCsiHandler({final:"Z"},M=>this.cursorBackwardTab(M)),this._parser.registerCsiHandler({final:"`"},M=>this.charPosAbsolute(M)),this._parser.registerCsiHandler({final:"a"},M=>this.hPositionRelative(M)),this._parser.registerCsiHandler({final:"b"},M=>this.repeatPrecedingCharacter(M)),this._parser.registerCsiHandler({final:"c"},M=>this.sendDeviceAttributesPrimary(M)),this._parser.registerCsiHandler({prefix:">",final:"c"},M=>this.sendDeviceAttributesSecondary(M)),this._parser.registerCsiHandler({final:"d"},M=>this.linePosAbsolute(M)),this._parser.registerCsiHandler({final:"e"},M=>this.vPositionRelative(M)),this._parser.registerCsiHandler({final:"f"},M=>this.hVPosition(M)),this._parser.registerCsiHandler({final:"g"},M=>this.tabClear(M)),this._parser.registerCsiHandler({final:"h"},M=>this.setMode(M)),this._parser.registerCsiHandler({prefix:"?",final:"h"},M=>this.setModePrivate(M)),this._parser.registerCsiHandler({final:"l"},M=>this.resetMode(M)),this._parser.registerCsiHandler({prefix:"?",final:"l"},M=>this.resetModePrivate(M)),this._parser.registerCsiHandler({final:"m"},M=>this.charAttributes(M)),this._parser.registerCsiHandler({final:"n"},M=>this.deviceStatus(M)),this._parser.registerCsiHandler({prefix:"?",final:"n"},M=>this.deviceStatusPrivate(M)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},M=>this.softReset(M)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},M=>this.setCursorStyle(M)),this._parser.registerCsiHandler({final:"r"},M=>this.setScrollRegion(M)),this._parser.registerCsiHandler({final:"s"},M=>this.saveCursor(M)),this._parser.registerCsiHandler({final:"t"},M=>this.windowOptions(M)),this._parser.registerCsiHandler({final:"u"},M=>this.restoreCursor(M)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},M=>this.insertColumns(M)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},M=>this.deleteColumns(M)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},M=>this.selectProtected(M)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},M=>this.requestMode(M,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},M=>this.requestMode(M,!1)),this._parser.setExecuteHandler(u.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(u.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(u.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(u.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(u.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(u.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(u.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(u.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(u.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(u.C1.IND,()=>this.index()),this._parser.setExecuteHandler(u.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(u.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new E.OscHandler(M=>(this.setTitle(M),this.setIconName(M),!0))),this._parser.registerOscHandler(1,new E.OscHandler(M=>this.setIconName(M))),this._parser.registerOscHandler(2,new E.OscHandler(M=>this.setTitle(M))),this._parser.registerOscHandler(4,new E.OscHandler(M=>this.setOrReportIndexedColor(M))),this._parser.registerOscHandler(8,new E.OscHandler(M=>this.setHyperlink(M))),this._parser.registerOscHandler(10,new E.OscHandler(M=>this.setOrReportFgColor(M))),this._parser.registerOscHandler(11,new E.OscHandler(M=>this.setOrReportBgColor(M))),this._parser.registerOscHandler(12,new E.OscHandler(M=>this.setOrReportCursorColor(M))),this._parser.registerOscHandler(104,new E.OscHandler(M=>this.restoreIndexedColor(M))),this._parser.registerOscHandler(110,new E.OscHandler(M=>this.restoreFgColor(M))),this._parser.registerOscHandler(111,new E.OscHandler(M=>this.restoreBgColor(M))),this._parser.registerOscHandler(112,new E.OscHandler(M=>this.restoreCursorColor(M))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const M in g.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:M},()=>this.selectCharset("("+M)),this._parser.registerEscHandler({intermediates:")",final:M},()=>this.selectCharset(")"+M)),this._parser.registerEscHandler({intermediates:"*",final:M},()=>this.selectCharset("*"+M)),this._parser.registerEscHandler({intermediates:"+",final:M},()=>this.selectCharset("+"+M)),this._parser.registerEscHandler({intermediates:"-",final:M},()=>this.selectCharset("-"+M)),this._parser.registerEscHandler({intermediates:".",final:M},()=>this.selectCharset("."+M)),this._parser.registerEscHandler({intermediates:"/",final:M},()=>this.selectCharset("/"+M));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(M=>(this._logService.error("Parsing error: ",M),M)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new T.DcsHandler((M,P)=>this.requestStatusString(M,P)))}getAttrData(){return this._curAttrData}_preserveStack(k,L,O,I){this._parseStack.paused=!0,this._parseStack.cursorStartX=k,this._parseStack.cursorStartY=L,this._parseStack.decodedLength=O,this._parseStack.position=I}_logSlowResolvingAsync(k){this._logService.logLevel<=y.LogLevelEnum.WARN&&Promise.race([k,new Promise((L,O)=>setTimeout(()=>O("#SLOW_TIMEOUT"),5e3))]).catch(L=>{if(L!=="#SLOW_TIMEOUT")throw L;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(k,L){let O,I=this._activeBuffer.x,H=this._activeBuffer.y,X=0;const Q=this._parseStack.paused;if(Q){if(O=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,L))return this._logSlowResolvingAsync(O),O;I=this._parseStack.cursorStartX,H=this._parseStack.cursorStartY,this._parseStack.paused=!1,k.length>A&&(X=this._parseStack.position+A)}if(this._logService.logLevel<=y.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof k=="string"?` "${k}"`:` "${Array.prototype.map.call(k,W=>String.fromCharCode(W)).join("")}"`),typeof k=="string"?k.split("").map(W=>W.charCodeAt(0)):k),this._parseBuffer.length<k.length&&this._parseBuffer.length<A&&(this._parseBuffer=new Uint32Array(Math.min(k.length,A))),Q||this._dirtyRowTracker.clearRange(),k.length>A)for(let W=X;W<k.length;W+=A){const q=W+A<k.length?W+A:k.length,M=typeof k=="string"?this._stringDecoder.decode(k.substring(W,q),this._parseBuffer):this._utf8Decoder.decode(k.subarray(W,q),this._parseBuffer);if(O=this._parser.parse(this._parseBuffer,M))return this._preserveStack(I,H,M,W),this._logSlowResolvingAsync(O),O}else if(!Q){const W=typeof k=="string"?this._stringDecoder.decode(k,this._parseBuffer):this._utf8Decoder.decode(k,this._parseBuffer);if(O=this._parser.parse(this._parseBuffer,W))return this._preserveStack(I,H,W,0),this._logSlowResolvingAsync(O),O}this._activeBuffer.x===I&&this._activeBuffer.y===H||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(k,L,O){let I,H;const X=this._charsetService.charset,Q=this._optionsService.rawOptions.screenReaderMode,W=this._bufferService.cols,q=this._coreService.decPrivateModes.wraparound,M=this._coreService.modes.insertMode,P=this._curAttrData;let N=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&O-L>0&&N.getWidth(this._activeBuffer.x-1)===2&&N.setCellFromCodePoint(this._activeBuffer.x-1,0,1,P.fg,P.bg,P.extended);for(let j=L;j<O;++j){if(I=k[j],H=this._unicodeService.wcwidth(I),I<127&&X){const K=X[String.fromCharCode(I)];K&&(I=K.charCodeAt(0))}if(Q&&this._onA11yChar.fire((0,m.stringFromCodePoint)(I)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),H||!this._activeBuffer.x){if(this._activeBuffer.x+H-1>=W){if(q){for(;this._activeBuffer.x<W;)N.setCellFromCodePoint(this._activeBuffer.x++,0,1,P.fg,P.bg,P.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),N=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=W-1,H===2)continue}if(M&&(N.insertCells(this._activeBuffer.x,H,this._activeBuffer.getNullCell(P),P),N.getWidth(W-1)===2&&N.setCellFromCodePoint(W-1,f.NULL_CELL_CODE,f.NULL_CELL_WIDTH,P.fg,P.bg,P.extended)),N.setCellFromCodePoint(this._activeBuffer.x++,I,H,P.fg,P.bg,P.extended),H>0)for(;--H;)N.setCellFromCodePoint(this._activeBuffer.x++,0,0,P.fg,P.bg,P.extended)}else N.getWidth(this._activeBuffer.x-1)?N.addCodepointToCell(this._activeBuffer.x-1,I):N.addCodepointToCell(this._activeBuffer.x-2,I)}O-L>0&&(N.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<W&&O-L>0&&N.getWidth(this._activeBuffer.x)===0&&!N.hasContent(this._activeBuffer.x)&&N.setCellFromCodePoint(this._activeBuffer.x,0,1,P.fg,P.bg,P.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(k,L){return k.final!=="t"||k.prefix||k.intermediates?this._parser.registerCsiHandler(k,L):this._parser.registerCsiHandler(k,O=>!D(O.params[0],this._optionsService.rawOptions.windowOptions)||L(O))}registerDcsHandler(k,L){return this._parser.registerDcsHandler(k,new T.DcsHandler(L))}registerEscHandler(k,L){return this._parser.registerEscHandler(k,L)}registerOscHandler(k,L){return this._parser.registerOscHandler(k,new E.OscHandler(L))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var k;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((k=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||k===void 0)&&k.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);L.hasWidth(this._activeBuffer.x)&&!L.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const k=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-k),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(k=this._bufferService.cols-1){this._activeBuffer.x=Math.min(k,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(k,L){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=k,this._activeBuffer.y=this._activeBuffer.scrollTop+L):(this._activeBuffer.x=k,this._activeBuffer.y=L),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(k,L){this._restrictCursor(),this._setCursor(this._activeBuffer.x+k,this._activeBuffer.y+L)}cursorUp(k){const L=this._activeBuffer.y-this._activeBuffer.scrollTop;return L>=0?this._moveCursor(0,-Math.min(L,k.params[0]||1)):this._moveCursor(0,-(k.params[0]||1)),!0}cursorDown(k){const L=this._activeBuffer.scrollBottom-this._activeBuffer.y;return L>=0?this._moveCursor(0,Math.min(L,k.params[0]||1)):this._moveCursor(0,k.params[0]||1),!0}cursorForward(k){return this._moveCursor(k.params[0]||1,0),!0}cursorBackward(k){return this._moveCursor(-(k.params[0]||1),0),!0}cursorNextLine(k){return this.cursorDown(k),this._activeBuffer.x=0,!0}cursorPrecedingLine(k){return this.cursorUp(k),this._activeBuffer.x=0,!0}cursorCharAbsolute(k){return this._setCursor((k.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(k){return this._setCursor(k.length>=2?(k.params[1]||1)-1:0,(k.params[0]||1)-1),!0}charPosAbsolute(k){return this._setCursor((k.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(k){return this._moveCursor(k.params[0]||1,0),!0}linePosAbsolute(k){return this._setCursor(this._activeBuffer.x,(k.params[0]||1)-1),!0}vPositionRelative(k){return this._moveCursor(0,k.params[0]||1),!0}hVPosition(k){return this.cursorPosition(k),!0}tabClear(k){const L=k.params[0];return L===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:L===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(k){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let L=k.params[0]||1;for(;L--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(k){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let L=k.params[0]||1;for(;L--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(k){const L=k.params[0];return L===1&&(this._curAttrData.bg|=536870912),L!==2&&L!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(k,L,O,I=!1,H=!1){const X=this._activeBuffer.lines.get(this._activeBuffer.ybase+k);X.replaceCells(L,O,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),H),I&&(X.isWrapped=!1)}_resetBufferLine(k,L=!1){const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+k);O&&(O.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),L),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+k),O.isWrapped=!1)}eraseInDisplay(k,L=!1){let O;switch(this._restrictCursor(this._bufferService.cols),k.params[0]){case 0:for(O=this._activeBuffer.y,this._dirtyRowTracker.markDirty(O),this._eraseInBufferLine(O++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,L);O<this._bufferService.rows;O++)this._resetBufferLine(O,L);this._dirtyRowTracker.markDirty(O);break;case 1:for(O=this._activeBuffer.y,this._dirtyRowTracker.markDirty(O),this._eraseInBufferLine(O,0,this._activeBuffer.x+1,!0,L),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(O+1).isWrapped=!1);O--;)this._resetBufferLine(O,L);this._dirtyRowTracker.markDirty(0);break;case 2:for(O=this._bufferService.rows,this._dirtyRowTracker.markDirty(O-1);O--;)this._resetBufferLine(O,L);this._dirtyRowTracker.markDirty(0);break;case 3:const I=this._activeBuffer.lines.length-this._bufferService.rows;I>0&&(this._activeBuffer.lines.trimStart(I),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-I,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-I,0),this._onScroll.fire(0))}return!0}eraseInLine(k,L=!1){switch(this._restrictCursor(this._bufferService.cols),k.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,L);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,L);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,L)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(k){this._restrictCursor();let L=k.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=this._activeBuffer.ybase+this._activeBuffer.y,I=this._bufferService.rows-1-this._activeBuffer.scrollBottom,H=this._bufferService.rows-1+this._activeBuffer.ybase-I+1;for(;L--;)this._activeBuffer.lines.splice(H-1,1),this._activeBuffer.lines.splice(O,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(k){this._restrictCursor();let L=k.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=this._activeBuffer.ybase+this._activeBuffer.y;let I;for(I=this._bufferService.rows-1-this._activeBuffer.scrollBottom,I=this._bufferService.rows-1+this._activeBuffer.ybase-I;L--;)this._activeBuffer.lines.splice(O,1),this._activeBuffer.lines.splice(I,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(k){this._restrictCursor();const L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return L&&(L.insertCells(this._activeBuffer.x,k.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(k){this._restrictCursor();const L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return L&&(L.deleteCells(this._activeBuffer.x,k.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(k){let L=k.params[0]||1;for(;L--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(k){let L=k.params[0]||1;for(;L--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(c.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const L=k.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);I.deleteCells(0,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),I.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const L=k.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);I.insertCells(0,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),I.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const L=k.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);I.insertCells(this._activeBuffer.x,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),I.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const L=k.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);I.deleteCells(this._activeBuffer.x,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),I.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(k){this._restrictCursor();const L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return L&&(L.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(k.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(k){if(!this._parser.precedingCodepoint)return!0;const L=k.params[0]||1,O=new Uint32Array(L);for(let I=0;I<L;++I)O[I]=this._parser.precedingCodepoint;return this.print(O,0,O.length),!0}sendDeviceAttributesPrimary(k){return k.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(u.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(u.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(k){return k.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(u.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(u.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(k.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(u.C0.ESC+"[>83;40003;0c")),!0}_is(k){return(this._optionsService.rawOptions.termName+"").indexOf(k)===0}setMode(k){for(let L=0;L<k.length;L++)switch(k.params[L]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(k){for(let L=0;L<k.length;L++)switch(k.params[L]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,g.DEFAULT_CHARSET),this._charsetService.setgCharset(1,g.DEFAULT_CHARSET),this._charsetService.setgCharset(2,g.DEFAULT_CHARSET),this._charsetService.setgCharset(3,g.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(k){for(let L=0;L<k.length;L++)switch(k.params[L]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(k){for(let L=0;L<k.length;L++)switch(k.params[L]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),k.params[L]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(k,L){const O=this._coreService.decPrivateModes,{activeProtocol:I,activeEncoding:H}=this._coreMouseService,X=this._coreService,{buffers:Q,cols:W}=this._bufferService,{active:q,alt:M}=Q,P=this._optionsService.rawOptions,N=Y=>Y?1:2,j=k.params[0];return K=j,se=L?j===2?4:j===4?N(X.modes.insertMode):j===12?3:j===20?N(P.convertEol):0:j===1?N(O.applicationCursorKeys):j===3?P.windowOptions.setWinLines?W===80?2:W===132?1:0:0:j===6?N(O.origin):j===7?N(O.wraparound):j===8?3:j===9?N(I==="X10"):j===12?N(P.cursorBlink):j===25?N(!X.isCursorHidden):j===45?N(O.reverseWraparound):j===66?N(O.applicationKeypad):j===67?4:j===1e3?N(I==="VT200"):j===1002?N(I==="DRAG"):j===1003?N(I==="ANY"):j===1004?N(O.sendFocus):j===1005?4:j===1006?N(H==="SGR"):j===1015?4:j===1016?N(H==="SGR_PIXELS"):j===1048?1:j===47||j===1047||j===1049?N(q===M):j===2004?N(O.bracketedPasteMode):0,X.triggerDataEvent(`${u.C0.ESC}[${L?"":"?"}${K};${se}$y`),!0;var K,se}_updateAttrColor(k,L,O,I,H){return L===2?(k|=50331648,k&=-16777216,k|=v.AttributeData.fromColorRGB([O,I,H])):L===5&&(k&=-50331904,k|=33554432|255&O),k}_extractColor(k,L,O){const I=[0,0,-1,0,0,0];let H=0,X=0;do{if(I[X+H]=k.params[L+X],k.hasSubParams(L+X)){const Q=k.getSubParams(L+X);let W=0;do I[1]===5&&(H=1),I[X+W+1+H]=Q[W];while(++W<Q.length&&W+X+1+H<I.length);break}if(I[1]===5&&X+H>=2||I[1]===2&&X+H>=5)break;I[1]&&(H=1)}while(++X+L<k.length&&X+H<I.length);for(let Q=2;Q<I.length;++Q)I[Q]===-1&&(I[Q]=0);switch(I[0]){case 38:O.fg=this._updateAttrColor(O.fg,I[1],I[3],I[4],I[5]);break;case 48:O.bg=this._updateAttrColor(O.bg,I[1],I[3],I[4],I[5]);break;case 58:O.extended=O.extended.clone(),O.extended.underlineColor=this._updateAttrColor(O.extended.underlineColor,I[1],I[3],I[4],I[5])}return X}_processUnderline(k,L){L.extended=L.extended.clone(),(!~k||k>5)&&(k=1),L.extended.underlineStyle=k,L.fg|=268435456,k===0&&(L.fg&=-268435457),L.updateExtended()}_processSGR0(k){k.fg=c.DEFAULT_ATTR_DATA.fg,k.bg=c.DEFAULT_ATTR_DATA.bg,k.extended=k.extended.clone(),k.extended.underlineStyle=0,k.extended.underlineColor&=-67108864,k.updateExtended()}charAttributes(k){if(k.length===1&&k.params[0]===0)return this._processSGR0(this._curAttrData),!0;const L=k.length;let O;const I=this._curAttrData;for(let H=0;H<L;H++)O=k.params[H],O>=30&&O<=37?(I.fg&=-50331904,I.fg|=16777216|O-30):O>=40&&O<=47?(I.bg&=-50331904,I.bg|=16777216|O-40):O>=90&&O<=97?(I.fg&=-50331904,I.fg|=16777224|O-90):O>=100&&O<=107?(I.bg&=-50331904,I.bg|=16777224|O-100):O===0?this._processSGR0(I):O===1?I.fg|=134217728:O===3?I.bg|=67108864:O===4?(I.fg|=268435456,this._processUnderline(k.hasSubParams(H)?k.getSubParams(H)[0]:1,I)):O===5?I.fg|=536870912:O===7?I.fg|=67108864:O===8?I.fg|=1073741824:O===9?I.fg|=2147483648:O===2?I.bg|=134217728:O===21?this._processUnderline(2,I):O===22?(I.fg&=-134217729,I.bg&=-134217729):O===23?I.bg&=-67108865:O===24?(I.fg&=-268435457,this._processUnderline(0,I)):O===25?I.fg&=-536870913:O===27?I.fg&=-67108865:O===28?I.fg&=-1073741825:O===29?I.fg&=2147483647:O===39?(I.fg&=-67108864,I.fg|=16777215&c.DEFAULT_ATTR_DATA.fg):O===49?(I.bg&=-67108864,I.bg|=16777215&c.DEFAULT_ATTR_DATA.bg):O===38||O===48||O===58?H+=this._extractColor(k,H,I):O===53?I.bg|=1073741824:O===55?I.bg&=-1073741825:O===59?(I.extended=I.extended.clone(),I.extended.underlineColor=-1,I.updateExtended()):O===100?(I.fg&=-67108864,I.fg|=16777215&c.DEFAULT_ATTR_DATA.fg,I.bg&=-67108864,I.bg|=16777215&c.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",O);return!0}deviceStatus(k){switch(k.params[0]){case 5:this._coreService.triggerDataEvent(`${u.C0.ESC}[0n`);break;case 6:const L=this._activeBuffer.y+1,O=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${u.C0.ESC}[${L};${O}R`)}return!0}deviceStatusPrivate(k){if(k.params[0]===6){const L=this._activeBuffer.y+1,O=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${u.C0.ESC}[?${L};${O}R`)}return!0}softReset(k){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=c.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(k){const L=k.params[0]||1;switch(L){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const O=L%2==1;return this._optionsService.options.cursorBlink=O,!0}setScrollRegion(k){const L=k.params[0]||1;let O;return(k.length<2||(O=k.params[1])>this._bufferService.rows||O===0)&&(O=this._bufferService.rows),O>L&&(this._activeBuffer.scrollTop=L-1,this._activeBuffer.scrollBottom=O-1,this._setCursor(0,0)),!0}windowOptions(k){if(!D(k.params[0],this._optionsService.rawOptions.windowOptions))return!0;const L=k.length>1?k.params[1]:0;switch(k.params[0]){case 14:L!==2&&this._onRequestWindowsOptionsReport.fire(R.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(R.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${u.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:L!==0&&L!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),L!==0&&L!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:L!==0&&L!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),L!==0&&L!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(k){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(k){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(k){return this._windowTitle=k,this._onTitleChange.fire(k),!0}setIconName(k){return this._iconName=k,!0}setOrReportIndexedColor(k){const L=[],O=k.split(";");for(;O.length>1;){const I=O.shift(),H=O.shift();if(/^\d+$/.exec(I)){const X=parseInt(I);if(0<=X&&X<256)if(H==="?")L.push({type:0,index:X});else{const Q=(0,S.parseColor)(H);Q&&L.push({type:1,index:X,color:Q})}}}return L.length&&this._onColor.fire(L),!0}setHyperlink(k){const L=k.split(";");return!(L.length<2)&&(L[1]?this._createHyperlink(L[0],L[1]):!L[0]&&this._finishHyperlink())}_createHyperlink(k,L){this._getCurrentLinkId()&&this._finishHyperlink();const O=k.split(":");let I;const H=O.findIndex(X=>X.startsWith("id="));return H!==-1&&(I=O[H].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:I,uri:L}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(k,L){const O=k.split(";");for(let I=0;I<O.length&&!(L>=this._specialColors.length);++I,++L)if(O[I]==="?")this._onColor.fire([{type:0,index:this._specialColors[L]}]);else{const H=(0,S.parseColor)(O[I]);H&&this._onColor.fire([{type:1,index:this._specialColors[L],color:H}])}return!0}setOrReportFgColor(k){return this._setOrReportSpecialColor(k,0)}setOrReportBgColor(k){return this._setOrReportSpecialColor(k,1)}setOrReportCursorColor(k){return this._setOrReportSpecialColor(k,2)}restoreIndexedColor(k){if(!k)return this._onColor.fire([{type:2}]),!0;const L=[],O=k.split(";");for(let I=0;I<O.length;++I)if(/^\d+$/.exec(O[I])){const H=parseInt(O[I]);0<=H&&H<256&&L.push({type:2,index:H})}return L.length&&this._onColor.fire(L),!0}restoreFgColor(k){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(k){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(k){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,g.DEFAULT_CHARSET),!0}selectCharset(k){return k.length!==2?(this.selectDefaultCharset(),!0):(k[0]==="/"||this._charsetService.setgCharset(w[k[0]],g.CHARSETS[k[1]]||g.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const k=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,k,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=c.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=c.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(k){return this._charsetService.setgLevel(k),!0}screenAlignmentPattern(){const k=new d.CellData;k.content=4194304|"E".charCodeAt(0),k.fg=this._curAttrData.fg,k.bg=this._curAttrData.bg,this._setCursor(0,0);for(let L=0;L<this._bufferService.rows;++L){const O=this._activeBuffer.ybase+this._activeBuffer.y+L,I=this._activeBuffer.lines.get(O);I&&(I.fill(k),I.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(k,L){const O=this._bufferService.buffer,I=this._optionsService.rawOptions;return(H=>(this._coreService.triggerDataEvent(`${u.C0.ESC}${H}${u.C0.ESC}\\`),!0))(k==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:k==='"p'?'P1$r61;1"p':k==="r"?`P1$r${O.scrollTop+1};${O.scrollBottom+1}r`:k==="m"?"P1$r0m":k===" q"?`P1$r${{block:2,underline:4,bar:6}[I.cursorStyle]-(I.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(k,L){this._dirtyRowTracker.markRangeDirty(k,L)}}s.InputHandler=F;let G=class{constructor(U){this._bufferService=U,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(U){U<this.start?this.start=U:U>this.end&&(this.end=U)}markRangeDirty(U,k){U>k&&(x=U,U=k,k=x),U<this.start&&(this.start=U),k>this.end&&(this.end=k)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};G=a([h(0,y.IBufferService)],G)},844:(_,s)=>{function n(a){for(const h of a)h.dispose();a.length=0}Object.defineProperty(s,"__esModule",{value:!0}),s.getDisposeArrayDisposable=s.disposeArray=s.toDisposable=s.Disposable=void 0,s.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const a of this._disposables)a.dispose();this._disposables.length=0}register(a){return this._disposables.push(a),a}unregister(a){const h=this._disposables.indexOf(a);h!==-1&&this._disposables.splice(h,1)}},s.toDisposable=function(a){return{dispose:a}},s.disposeArray=n,s.getDisposeArrayDisposable=function(a){return{dispose:()=>n(a)}}},1505:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.FourKeyMap=s.TwoKeyMap=void 0;class n{constructor(){this._data={}}set(h,u,g){this._data[h]||(this._data[h]={}),this._data[h][u]=g}get(h,u){return this._data[h]?this._data[h][u]:void 0}clear(){this._data={}}}s.TwoKeyMap=n,s.FourKeyMap=class{constructor(){this._data=new n}set(a,h,u,g,C){this._data.get(a,h)||this._data.set(a,h,new n),this._data.get(a,h).set(u,g,C)}get(a,h,u,g){var C;return(C=this._data.get(a,h))===null||C===void 0?void 0:C.get(u,g)}clear(){this._data.clear()}}},6114:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.isChromeOS=s.isLinux=s.isWindows=s.isIphone=s.isIpad=s.isMac=s.getSafariVersion=s.isSafari=s.isLegacyEdge=s.isFirefox=s.isNode=void 0,s.isNode=typeof navigator>"u";const n=s.isNode?"node":navigator.userAgent,a=s.isNode?"node":navigator.platform;s.isFirefox=n.includes("Firefox"),s.isLegacyEdge=n.includes("Edge"),s.isSafari=/^((?!chrome|android).)*safari/i.test(n),s.getSafariVersion=function(){if(!s.isSafari)return 0;const h=n.match(/Version\/(\d+)/);return h===null||h.length<2?0:parseInt(h[1])},s.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(a),s.isIpad=a==="iPad",s.isIphone=a==="iPhone",s.isWindows=["Windows","Win16","Win32","WinCE"].includes(a),s.isLinux=a.indexOf("Linux")>=0,s.isChromeOS=/\bCrOS\b/.test(n)},6106:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SortedList=void 0;let n=0;s.SortedList=class{constructor(a){this._getKey=a,this._array=[]}clear(){this._array.length=0}insert(a){this._array.length!==0?(n=this._search(this._getKey(a),0,this._array.length-1),this._array.splice(n,0,a)):this._array.push(a)}delete(a){if(this._array.length===0)return!1;const h=this._getKey(a);if(h===void 0||(n=this._search(h,0,this._array.length-1),n===-1)||this._getKey(this._array[n])!==h)return!1;do if(this._array[n]===a)return this._array.splice(n,1),!0;while(++n<this._array.length&&this._getKey(this._array[n])===h);return!1}*getKeyIterator(a){if(this._array.length!==0&&(n=this._search(a,0,this._array.length-1),!(n<0||n>=this._array.length)&&this._getKey(this._array[n])===a))do yield this._array[n];while(++n<this._array.length&&this._getKey(this._array[n])===a)}forEachByKey(a,h){if(this._array.length!==0&&(n=this._search(a,0,this._array.length-1),!(n<0||n>=this._array.length)&&this._getKey(this._array[n])===a))do h(this._array[n]);while(++n<this._array.length&&this._getKey(this._array[n])===a)}values(){return this._array.values()}_search(a,h,u){if(u<h)return h;let g=Math.floor((h+u)/2);const C=this._getKey(this._array[g]);if(C>a)return this._search(a,h,g-1);if(C<a)return this._search(a,g+1,u);for(;g>0&&this._getKey(this._array[g-1])===a;)g--;return g}}},7226:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DebouncedIdleTask=s.IdleTaskQueue=s.PriorityTaskQueue=void 0;const a=n(6114);class h{constructor(){this._tasks=[],this._i=0}enqueue(C){this._tasks.push(C),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(C){this._idleCallback=void 0;let b=0,m=0,c=C.timeRemaining(),p=0;for(;this._i<this._tasks.length;){if(b=Date.now(),this._tasks[this._i]()||this._i++,b=Math.max(1,Date.now()-b),m=Math.max(b,m),p=C.timeRemaining(),1.5*m>p)return c-b<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(c-b))}ms`),void this._start();c=p}this.clear()}}class u extends h{_requestCallback(C){return setTimeout(()=>C(this._createDeadline(16)))}_cancelCallback(C){clearTimeout(C)}_createDeadline(C){const b=Date.now()+C;return{timeRemaining:()=>Math.max(0,b-Date.now())}}}s.PriorityTaskQueue=u,s.IdleTaskQueue=!a.isNode&&"requestIdleCallback"in window?class extends h{_requestCallback(g){return requestIdleCallback(g)}_cancelCallback(g){cancelIdleCallback(g)}}:u,s.DebouncedIdleTask=class{constructor(){this._queue=new s.IdleTaskQueue}set(g){this._queue.clear(),this._queue.enqueue(g)}flush(){this._queue.flush()}}},9282:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.updateWindowsModeWrappedState=void 0;const a=n(643);s.updateWindowsModeWrappedState=function(h){const u=h.buffer.lines.get(h.buffer.ybase+h.buffer.y-1),g=u==null?void 0:u.get(h.cols-1),C=h.buffer.lines.get(h.buffer.ybase+h.buffer.y);C&&g&&(C.isWrapped=g[a.CHAR_DATA_CODE_INDEX]!==a.NULL_CELL_CODE&&g[a.CHAR_DATA_CODE_INDEX]!==a.WHITESPACE_CELL_CODE)}},3734:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ExtendedAttrs=s.AttributeData=void 0;class n{constructor(){this.fg=0,this.bg=0,this.extended=new a}static toColorRGB(u){return[u>>>16&255,u>>>8&255,255&u]}static fromColorRGB(u){return(255&u[0])<<16|(255&u[1])<<8|255&u[2]}clone(){const u=new n;return u.fg=this.fg,u.bg=this.bg,u.extended=this.extended.clone(),u}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}s.AttributeData=n;class a{constructor(u=0,g=0){this._ext=0,this._urlId=0,this._ext=u,this._urlId=g}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(u){this._ext=u}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(u){this._ext&=-469762049,this._ext|=u<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(u){this._ext&=-67108864,this._ext|=67108863&u}get urlId(){return this._urlId}set urlId(u){this._urlId=u}clone(){return new a(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}s.ExtendedAttrs=a},9092:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Buffer=s.MAX_BUFFER_SIZE=void 0;const a=n(6349),h=n(8437),u=n(511),g=n(643),C=n(4634),b=n(4863),m=n(7116),c=n(3734),p=n(7226);s.MAX_BUFFER_SIZE=4294967295,s.Buffer=class{constructor(f,d,v){this._hasScrollback=f,this._optionsService=d,this._bufferService=v,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=h.DEFAULT_ATTR_DATA.clone(),this.savedCharset=m.DEFAULT_CHARSET,this.markers=[],this._nullCell=u.CellData.fromCharData([0,g.NULL_CELL_CHAR,g.NULL_CELL_WIDTH,g.NULL_CELL_CODE]),this._whitespaceCell=u.CellData.fromCharData([0,g.WHITESPACE_CELL_CHAR,g.WHITESPACE_CELL_WIDTH,g.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new p.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new a.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(f){return f?(this._nullCell.fg=f.fg,this._nullCell.bg=f.bg,this._nullCell.extended=f.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new c.ExtendedAttrs),this._nullCell}getWhitespaceCell(f){return f?(this._whitespaceCell.fg=f.fg,this._whitespaceCell.bg=f.bg,this._whitespaceCell.extended=f.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new c.ExtendedAttrs),this._whitespaceCell}getBlankLine(f,d){return new h.BufferLine(this._bufferService.cols,this.getNullCell(f),d)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const f=this.ybase+this.y-this.ydisp;return f>=0&&f<this._rows}_getCorrectBufferLength(f){if(!this._hasScrollback)return f;const d=f+this._optionsService.rawOptions.scrollback;return d>s.MAX_BUFFER_SIZE?s.MAX_BUFFER_SIZE:d}fillViewportRows(f){if(this.lines.length===0){f===void 0&&(f=h.DEFAULT_ATTR_DATA);let d=this._rows;for(;d--;)this.lines.push(this.getBlankLine(f))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new a.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(f,d){const v=this.getNullCell(h.DEFAULT_ATTR_DATA);let y=0;const E=this._getCorrectBufferLength(d);if(E>this.lines.maxLength&&(this.lines.maxLength=E),this.lines.length>0){if(this._cols<f)for(let S=0;S<this.lines.length;S++)y+=+this.lines.get(S).resize(f,v);let T=0;if(this._rows<d)for(let S=this._rows;S<d;S++)this.lines.length<d+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new h.BufferLine(f,v)):this.ybase>0&&this.lines.length<=this.ybase+this.y+T+1?(this.ybase--,T++,this.ydisp>0&&this.ydisp--):this.lines.push(new h.BufferLine(f,v)));else for(let S=this._rows;S>d;S--)this.lines.length>d+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(E<this.lines.maxLength){const S=this.lines.length-E;S>0&&(this.lines.trimStart(S),this.ybase=Math.max(this.ybase-S,0),this.ydisp=Math.max(this.ydisp-S,0),this.savedY=Math.max(this.savedY-S,0)),this.lines.maxLength=E}this.x=Math.min(this.x,f-1),this.y=Math.min(this.y,d-1),T&&(this.y+=T),this.savedX=Math.min(this.savedX,f-1),this.scrollTop=0}if(this.scrollBottom=d-1,this._isReflowEnabled&&(this._reflow(f,d),this._cols>f))for(let T=0;T<this.lines.length;T++)y+=+this.lines.get(T).resize(f,v);this._cols=f,this._rows=d,this._memoryCleanupQueue.clear(),y>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let f=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,f=!1);let d=0;for(;this._memoryCleanupPosition<this.lines.length;)if(d+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),d>100)return!0;return f}get _isReflowEnabled(){const f=this._optionsService.rawOptions.windowsPty;return f&&f.buildNumber?this._hasScrollback&&f.backend==="conpty"&&f.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(f,d){this._cols!==f&&(f>this._cols?this._reflowLarger(f,d):this._reflowSmaller(f,d))}_reflowLarger(f,d){const v=(0,C.reflowLargerGetLinesToRemove)(this.lines,this._cols,f,this.ybase+this.y,this.getNullCell(h.DEFAULT_ATTR_DATA));if(v.length>0){const y=(0,C.reflowLargerCreateNewLayout)(this.lines,v);(0,C.reflowLargerApplyNewLayout)(this.lines,y.layout),this._reflowLargerAdjustViewport(f,d,y.countRemoved)}}_reflowLargerAdjustViewport(f,d,v){const y=this.getNullCell(h.DEFAULT_ATTR_DATA);let E=v;for(;E-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<d&&this.lines.push(new h.BufferLine(f,y))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-v,0)}_reflowSmaller(f,d){const v=this.getNullCell(h.DEFAULT_ATTR_DATA),y=[];let E=0;for(let T=this.lines.length-1;T>=0;T--){let S=this.lines.get(T);if(!S||!S.isWrapped&&S.getTrimmedLength()<=f)continue;const w=[S];for(;S.isWrapped&&T>0;)S=this.lines.get(--T),w.unshift(S);const A=this.ybase+this.y;if(A>=T&&A<T+w.length)continue;const D=w[w.length-1].getTrimmedLength(),R=(0,C.reflowSmallerGetNewLineLengths)(w,this._cols,f),x=R.length-w.length;let F;F=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+x):Math.max(0,this.lines.length-this.lines.maxLength+x);const G=[];for(let H=0;H<x;H++){const X=this.getBlankLine(h.DEFAULT_ATTR_DATA,!0);G.push(X)}G.length>0&&(y.push({start:T+w.length+E,newLines:G}),E+=G.length),w.push(...G);let U=R.length-1,k=R[U];k===0&&(U--,k=R[U]);let L=w.length-x-1,O=D;for(;L>=0;){const H=Math.min(O,k);if(w[U]===void 0)break;if(w[U].copyCellsFrom(w[L],O-H,k-H,H,!0),k-=H,k===0&&(U--,k=R[U]),O-=H,O===0){L--;const X=Math.max(L,0);O=(0,C.getWrappedLineTrimmedLength)(w,X,this._cols)}}for(let H=0;H<w.length;H++)R[H]<f&&w[H].setCell(R[H],v);let I=x-F;for(;I-- >0;)this.ybase===0?this.y<d-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+E)-d&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+x,this.ybase+d-1)}if(y.length>0){const T=[],S=[];for(let U=0;U<this.lines.length;U++)S.push(this.lines.get(U));const w=this.lines.length;let A=w-1,D=0,R=y[D];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+E);let x=0;for(let U=Math.min(this.lines.maxLength-1,w+E-1);U>=0;U--)if(R&&R.start>A+x){for(let k=R.newLines.length-1;k>=0;k--)this.lines.set(U--,R.newLines[k]);U++,T.push({index:A+1,amount:R.newLines.length}),x+=R.newLines.length,R=y[++D]}else this.lines.set(U,S[A--]);let F=0;for(let U=T.length-1;U>=0;U--)T[U].index+=F,this.lines.onInsertEmitter.fire(T[U]),F+=T[U].amount;const G=Math.max(0,w+E-this.lines.maxLength);G>0&&this.lines.onTrimEmitter.fire(G)}}translateBufferLineToString(f,d,v=0,y){const E=this.lines.get(f);return E?E.translateToString(d,v,y):""}getWrappedRangeForLine(f){let d=f,v=f;for(;d>0&&this.lines.get(d).isWrapped;)d--;for(;v+1<this.lines.length&&this.lines.get(v+1).isWrapped;)v++;return{first:d,last:v}}setupTabStops(f){for(f!=null?this.tabs[f]||(f=this.prevStop(f)):(this.tabs={},f=0);f<this._cols;f+=this._optionsService.rawOptions.tabStopWidth)this.tabs[f]=!0}prevStop(f){for(f==null&&(f=this.x);!this.tabs[--f]&&f>0;);return f>=this._cols?this._cols-1:f<0?0:f}nextStop(f){for(f==null&&(f=this.x);!this.tabs[++f]&&f<this._cols;);return f>=this._cols?this._cols-1:f<0?0:f}clearMarkers(f){this._isClearing=!0;for(let d=0;d<this.markers.length;d++)this.markers[d].line===f&&(this.markers[d].dispose(),this.markers.splice(d--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let f=0;f<this.markers.length;f++)this.markers[f].dispose(),this.markers.splice(f--,1);this._isClearing=!1}addMarker(f){const d=new b.Marker(f);return this.markers.push(d),d.register(this.lines.onTrim(v=>{d.line-=v,d.line<0&&d.dispose()})),d.register(this.lines.onInsert(v=>{d.line>=v.index&&(d.line+=v.amount)})),d.register(this.lines.onDelete(v=>{d.line>=v.index&&d.line<v.index+v.amount&&d.dispose(),d.line>v.index&&(d.line-=v.amount)})),d.register(d.onDispose(()=>this._removeMarker(d))),d}_removeMarker(f){this._isClearing||this.markers.splice(this.markers.indexOf(f),1)}}},8437:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferLine=s.DEFAULT_ATTR_DATA=void 0;const a=n(482),h=n(643),u=n(511),g=n(3734);s.DEFAULT_ATTR_DATA=Object.freeze(new g.AttributeData);let C=0;class b{constructor(c,p,f=!1){this.isWrapped=f,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*c);const d=p||u.CellData.fromCharData([0,h.NULL_CELL_CHAR,h.NULL_CELL_WIDTH,h.NULL_CELL_CODE]);for(let v=0;v<c;++v)this.setCell(v,d);this.length=c}get(c){const p=this._data[3*c+0],f=2097151&p;return[this._data[3*c+1],2097152&p?this._combined[c]:f?(0,a.stringFromCodePoint)(f):"",p>>22,2097152&p?this._combined[c].charCodeAt(this._combined[c].length-1):f]}set(c,p){this._data[3*c+1]=p[h.CHAR_DATA_ATTR_INDEX],p[h.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[c]=p[1],this._data[3*c+0]=2097152|c|p[h.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*c+0]=p[h.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|p[h.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(c){return this._data[3*c+0]>>22}hasWidth(c){return 12582912&this._data[3*c+0]}getFg(c){return this._data[3*c+1]}getBg(c){return this._data[3*c+2]}hasContent(c){return 4194303&this._data[3*c+0]}getCodePoint(c){const p=this._data[3*c+0];return 2097152&p?this._combined[c].charCodeAt(this._combined[c].length-1):2097151&p}isCombined(c){return 2097152&this._data[3*c+0]}getString(c){const p=this._data[3*c+0];return 2097152&p?this._combined[c]:2097151&p?(0,a.stringFromCodePoint)(2097151&p):""}isProtected(c){return 536870912&this._data[3*c+2]}loadCell(c,p){return C=3*c,p.content=this._data[C+0],p.fg=this._data[C+1],p.bg=this._data[C+2],2097152&p.content&&(p.combinedData=this._combined[c]),268435456&p.bg&&(p.extended=this._extendedAttrs[c]),p}setCell(c,p){2097152&p.content&&(this._combined[c]=p.combinedData),268435456&p.bg&&(this._extendedAttrs[c]=p.extended),this._data[3*c+0]=p.content,this._data[3*c+1]=p.fg,this._data[3*c+2]=p.bg}setCellFromCodePoint(c,p,f,d,v,y){268435456&v&&(this._extendedAttrs[c]=y),this._data[3*c+0]=p|f<<22,this._data[3*c+1]=d,this._data[3*c+2]=v}addCodepointToCell(c,p){let f=this._data[3*c+0];2097152&f?this._combined[c]+=(0,a.stringFromCodePoint)(p):(2097151&f?(this._combined[c]=(0,a.stringFromCodePoint)(2097151&f)+(0,a.stringFromCodePoint)(p),f&=-2097152,f|=2097152):f=p|4194304,this._data[3*c+0]=f)}insertCells(c,p,f,d){if((c%=this.length)&&this.getWidth(c-1)===2&&this.setCellFromCodePoint(c-1,0,1,(d==null?void 0:d.fg)||0,(d==null?void 0:d.bg)||0,(d==null?void 0:d.extended)||new g.ExtendedAttrs),p<this.length-c){const v=new u.CellData;for(let y=this.length-c-p-1;y>=0;--y)this.setCell(c+p+y,this.loadCell(c+y,v));for(let y=0;y<p;++y)this.setCell(c+y,f)}else for(let v=c;v<this.length;++v)this.setCell(v,f);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(d==null?void 0:d.fg)||0,(d==null?void 0:d.bg)||0,(d==null?void 0:d.extended)||new g.ExtendedAttrs)}deleteCells(c,p,f,d){if(c%=this.length,p<this.length-c){const v=new u.CellData;for(let y=0;y<this.length-c-p;++y)this.setCell(c+y,this.loadCell(c+p+y,v));for(let y=this.length-p;y<this.length;++y)this.setCell(y,f)}else for(let v=c;v<this.length;++v)this.setCell(v,f);c&&this.getWidth(c-1)===2&&this.setCellFromCodePoint(c-1,0,1,(d==null?void 0:d.fg)||0,(d==null?void 0:d.bg)||0,(d==null?void 0:d.extended)||new g.ExtendedAttrs),this.getWidth(c)!==0||this.hasContent(c)||this.setCellFromCodePoint(c,0,1,(d==null?void 0:d.fg)||0,(d==null?void 0:d.bg)||0,(d==null?void 0:d.extended)||new g.ExtendedAttrs)}replaceCells(c,p,f,d,v=!1){if(v)for(c&&this.getWidth(c-1)===2&&!this.isProtected(c-1)&&this.setCellFromCodePoint(c-1,0,1,(d==null?void 0:d.fg)||0,(d==null?void 0:d.bg)||0,(d==null?void 0:d.extended)||new g.ExtendedAttrs),p<this.length&&this.getWidth(p-1)===2&&!this.isProtected(p)&&this.setCellFromCodePoint(p,0,1,(d==null?void 0:d.fg)||0,(d==null?void 0:d.bg)||0,(d==null?void 0:d.extended)||new g.ExtendedAttrs);c<p&&c<this.length;)this.isProtected(c)||this.setCell(c,f),c++;else for(c&&this.getWidth(c-1)===2&&this.setCellFromCodePoint(c-1,0,1,(d==null?void 0:d.fg)||0,(d==null?void 0:d.bg)||0,(d==null?void 0:d.extended)||new g.ExtendedAttrs),p<this.length&&this.getWidth(p-1)===2&&this.setCellFromCodePoint(p,0,1,(d==null?void 0:d.fg)||0,(d==null?void 0:d.bg)||0,(d==null?void 0:d.extended)||new g.ExtendedAttrs);c<p&&c<this.length;)this.setCell(c++,f)}resize(c,p){if(c===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const f=3*c;if(c>this.length){if(this._data.buffer.byteLength>=4*f)this._data=new Uint32Array(this._data.buffer,0,f);else{const d=new Uint32Array(f);d.set(this._data),this._data=d}for(let d=this.length;d<c;++d)this.setCell(d,p)}else{this._data=this._data.subarray(0,f);const d=Object.keys(this._combined);for(let y=0;y<d.length;y++){const E=parseInt(d[y],10);E>=c&&delete this._combined[E]}const v=Object.keys(this._extendedAttrs);for(let y=0;y<v.length;y++){const E=parseInt(v[y],10);E>=c&&delete this._extendedAttrs[E]}}return this.length=c,4*f*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const c=new Uint32Array(this._data.length);return c.set(this._data),this._data=c,1}return 0}fill(c,p=!1){if(p)for(let f=0;f<this.length;++f)this.isProtected(f)||this.setCell(f,c);else{this._combined={},this._extendedAttrs={};for(let f=0;f<this.length;++f)this.setCell(f,c)}}copyFrom(c){this.length!==c.length?this._data=new Uint32Array(c._data):this._data.set(c._data),this.length=c.length,this._combined={};for(const p in c._combined)this._combined[p]=c._combined[p];this._extendedAttrs={};for(const p in c._extendedAttrs)this._extendedAttrs[p]=c._extendedAttrs[p];this.isWrapped=c.isWrapped}clone(){const c=new b(0);c._data=new Uint32Array(this._data),c.length=this.length;for(const p in this._combined)c._combined[p]=this._combined[p];for(const p in this._extendedAttrs)c._extendedAttrs[p]=this._extendedAttrs[p];return c.isWrapped=this.isWrapped,c}getTrimmedLength(){for(let c=this.length-1;c>=0;--c)if(4194303&this._data[3*c+0])return c+(this._data[3*c+0]>>22);return 0}copyCellsFrom(c,p,f,d,v){const y=c._data;if(v)for(let T=d-1;T>=0;T--){for(let S=0;S<3;S++)this._data[3*(f+T)+S]=y[3*(p+T)+S];268435456&y[3*(p+T)+2]&&(this._extendedAttrs[f+T]=c._extendedAttrs[p+T])}else for(let T=0;T<d;T++){for(let S=0;S<3;S++)this._data[3*(f+T)+S]=y[3*(p+T)+S];268435456&y[3*(p+T)+2]&&(this._extendedAttrs[f+T]=c._extendedAttrs[p+T])}const E=Object.keys(c._combined);for(let T=0;T<E.length;T++){const S=parseInt(E[T],10);S>=p&&(this._combined[S-p+f]=c._combined[S])}}translateToString(c=!1,p=0,f=this.length){c&&(f=Math.min(f,this.getTrimmedLength()));let d="";for(;p<f;){const v=this._data[3*p+0],y=2097151&v;d+=2097152&v?this._combined[p]:y?(0,a.stringFromCodePoint)(y):h.WHITESPACE_CELL_CHAR,p+=v>>22||1}return d}}s.BufferLine=b},4841:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.getRangeLength=void 0,s.getRangeLength=function(n,a){if(n.start.y>n.end.y)throw new Error(`Buffer range end (${n.end.x}, ${n.end.y}) cannot be before start (${n.start.x}, ${n.start.y})`);return a*(n.end.y-n.start.y)+(n.end.x-n.start.x+1)}},4634:(_,s)=>{function n(a,h,u){if(h===a.length-1)return a[h].getTrimmedLength();const g=!a[h].hasContent(u-1)&&a[h].getWidth(u-1)===1,C=a[h+1].getWidth(0)===2;return g&&C?u-1:u}Object.defineProperty(s,"__esModule",{value:!0}),s.getWrappedLineTrimmedLength=s.reflowSmallerGetNewLineLengths=s.reflowLargerApplyNewLayout=s.reflowLargerCreateNewLayout=s.reflowLargerGetLinesToRemove=void 0,s.reflowLargerGetLinesToRemove=function(a,h,u,g,C){const b=[];for(let m=0;m<a.length-1;m++){let c=m,p=a.get(++c);if(!p.isWrapped)continue;const f=[a.get(m)];for(;c<a.length&&p.isWrapped;)f.push(p),p=a.get(++c);if(g>=m&&g<c){m+=f.length-1;continue}let d=0,v=n(f,d,h),y=1,E=0;for(;y<f.length;){const S=n(f,y,h),w=S-E,A=u-v,D=Math.min(w,A);f[d].copyCellsFrom(f[y],E,v,D,!1),v+=D,v===u&&(d++,v=0),E+=D,E===S&&(y++,E=0),v===0&&d!==0&&f[d-1].getWidth(u-1)===2&&(f[d].copyCellsFrom(f[d-1],u-1,v++,1,!1),f[d-1].setCell(u-1,C))}f[d].replaceCells(v,u,C);let T=0;for(let S=f.length-1;S>0&&(S>d||f[S].getTrimmedLength()===0);S--)T++;T>0&&(b.push(m+f.length-T),b.push(T)),m+=f.length-1}return b},s.reflowLargerCreateNewLayout=function(a,h){const u=[];let g=0,C=h[g],b=0;for(let m=0;m<a.length;m++)if(C===m){const c=h[++g];a.onDeleteEmitter.fire({index:m-b,amount:c}),m+=c-1,b+=c,C=h[++g]}else u.push(m);return{layout:u,countRemoved:b}},s.reflowLargerApplyNewLayout=function(a,h){const u=[];for(let g=0;g<h.length;g++)u.push(a.get(h[g]));for(let g=0;g<u.length;g++)a.set(g,u[g]);a.length=h.length},s.reflowSmallerGetNewLineLengths=function(a,h,u){const g=[],C=a.map((p,f)=>n(a,f,h)).reduce((p,f)=>p+f);let b=0,m=0,c=0;for(;c<C;){if(C-c<u){g.push(C-c);break}b+=u;const p=n(a,m,h);b>p&&(b-=p,m++);const f=a[m].getWidth(b-1)===2;f&&b--;const d=f?u-1:u;g.push(d),c+=d}return g},s.getWrappedLineTrimmedLength=n},5295:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferSet=void 0;const a=n(9092),h=n(8460),u=n(844);class g extends u.Disposable{constructor(b,m){super(),this._optionsService=b,this._bufferService=m,this._onBufferActivate=this.register(new h.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new a.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new a.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(b){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(b),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(b,m){this._normal.resize(b,m),this._alt.resize(b,m),this.setupTabStops(b)}setupTabStops(b){this._normal.setupTabStops(b),this._alt.setupTabStops(b)}}s.BufferSet=g},511:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CellData=void 0;const a=n(482),h=n(643),u=n(3734);class g extends u.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new u.ExtendedAttrs,this.combinedData=""}static fromCharData(b){const m=new g;return m.setFromCharData(b),m}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,a.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(b){this.fg=b[h.CHAR_DATA_ATTR_INDEX],this.bg=0;let m=!1;if(b[h.CHAR_DATA_CHAR_INDEX].length>2)m=!0;else if(b[h.CHAR_DATA_CHAR_INDEX].length===2){const c=b[h.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=c&&c<=56319){const p=b[h.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=p&&p<=57343?this.content=1024*(c-55296)+p-56320+65536|b[h.CHAR_DATA_WIDTH_INDEX]<<22:m=!0}else m=!0}else this.content=b[h.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|b[h.CHAR_DATA_WIDTH_INDEX]<<22;m&&(this.combinedData=b[h.CHAR_DATA_CHAR_INDEX],this.content=2097152|b[h.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}s.CellData=g},643:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WHITESPACE_CELL_CODE=s.WHITESPACE_CELL_WIDTH=s.WHITESPACE_CELL_CHAR=s.NULL_CELL_CODE=s.NULL_CELL_WIDTH=s.NULL_CELL_CHAR=s.CHAR_DATA_CODE_INDEX=s.CHAR_DATA_WIDTH_INDEX=s.CHAR_DATA_CHAR_INDEX=s.CHAR_DATA_ATTR_INDEX=s.DEFAULT_EXT=s.DEFAULT_ATTR=s.DEFAULT_COLOR=void 0,s.DEFAULT_COLOR=0,s.DEFAULT_ATTR=256|s.DEFAULT_COLOR<<9,s.DEFAULT_EXT=0,s.CHAR_DATA_ATTR_INDEX=0,s.CHAR_DATA_CHAR_INDEX=1,s.CHAR_DATA_WIDTH_INDEX=2,s.CHAR_DATA_CODE_INDEX=3,s.NULL_CELL_CHAR="",s.NULL_CELL_WIDTH=1,s.NULL_CELL_CODE=0,s.WHITESPACE_CELL_CHAR=" ",s.WHITESPACE_CELL_WIDTH=1,s.WHITESPACE_CELL_CODE=32},4863:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Marker=void 0;const a=n(8460),h=n(844);class u{constructor(C){this.line=C,this.isDisposed=!1,this._disposables=[],this._id=u._nextId++,this._onDispose=this.register(new a.EventEmitter),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,h.disposeArray)(this._disposables),this._disposables.length=0)}register(C){return this._disposables.push(C),C}}s.Marker=u,u._nextId=1},7116:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DEFAULT_CHARSET=s.CHARSETS=void 0,s.CHARSETS={},s.DEFAULT_CHARSET=s.CHARSETS.B,s.CHARSETS[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""},s.CHARSETS.A={"#":""},s.CHARSETS.B=void 0,s.CHARSETS[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""},s.CHARSETS.C=s.CHARSETS[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},s.CHARSETS.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},s.CHARSETS.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS.E=s.CHARSETS[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""},s.CHARSETS.H=s.CHARSETS[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""}},2584:(_,s)=>{var n,a;Object.defineProperty(s,"__esModule",{value:!0}),s.C1_ESCAPED=s.C1=s.C0=void 0,function(h){h.NUL="\0",h.SOH="",h.STX="",h.ETX="",h.EOT="",h.ENQ="",h.ACK="",h.BEL="\x07",h.BS="\b",h.HT="	",h.LF=`
`,h.VT="\v",h.FF="\f",h.CR="\r",h.SO="",h.SI="",h.DLE="",h.DC1="",h.DC2="",h.DC3="",h.DC4="",h.NAK="",h.SYN="",h.ETB="",h.CAN="",h.EM="",h.SUB="",h.ESC="\x1B",h.FS="",h.GS="",h.RS="",h.US="",h.SP=" ",h.DEL=""}(n=s.C0||(s.C0={})),(a=s.C1||(s.C1={})).PAD="",a.HOP="",a.BPH="",a.NBH="",a.IND="",a.NEL="",a.SSA="",a.ESA="",a.HTS="",a.HTJ="",a.VTS="",a.PLD="",a.PLU="",a.RI="",a.SS2="",a.SS3="",a.DCS="",a.PU1="",a.PU2="",a.STS="",a.CCH="",a.MW="",a.SPA="",a.EPA="",a.SOS="",a.SGCI="",a.SCI="",a.CSI="",a.ST="",a.OSC="",a.PM="",a.APC="",(s.C1_ESCAPED||(s.C1_ESCAPED={})).ST=`${n.ESC}\\`},7399:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.evaluateKeyboardEvent=void 0;const a=n(2584),h={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};s.evaluateKeyboardEvent=function(u,g,C,b){const m={type:0,cancel:!1,key:void 0},c=(u.shiftKey?1:0)|(u.altKey?2:0)|(u.ctrlKey?4:0)|(u.metaKey?8:0);switch(u.keyCode){case 0:u.key==="UIKeyInputUpArrow"?m.key=g?a.C0.ESC+"OA":a.C0.ESC+"[A":u.key==="UIKeyInputLeftArrow"?m.key=g?a.C0.ESC+"OD":a.C0.ESC+"[D":u.key==="UIKeyInputRightArrow"?m.key=g?a.C0.ESC+"OC":a.C0.ESC+"[C":u.key==="UIKeyInputDownArrow"&&(m.key=g?a.C0.ESC+"OB":a.C0.ESC+"[B");break;case 8:if(u.altKey){m.key=a.C0.ESC+a.C0.DEL;break}m.key=a.C0.DEL;break;case 9:if(u.shiftKey){m.key=a.C0.ESC+"[Z";break}m.key=a.C0.HT,m.cancel=!0;break;case 13:m.key=u.altKey?a.C0.ESC+a.C0.CR:a.C0.CR,m.cancel=!0;break;case 27:m.key=a.C0.ESC,u.altKey&&(m.key=a.C0.ESC+a.C0.ESC),m.cancel=!0;break;case 37:if(u.metaKey)break;c?(m.key=a.C0.ESC+"[1;"+(c+1)+"D",m.key===a.C0.ESC+"[1;3D"&&(m.key=a.C0.ESC+(C?"b":"[1;5D"))):m.key=g?a.C0.ESC+"OD":a.C0.ESC+"[D";break;case 39:if(u.metaKey)break;c?(m.key=a.C0.ESC+"[1;"+(c+1)+"C",m.key===a.C0.ESC+"[1;3C"&&(m.key=a.C0.ESC+(C?"f":"[1;5C"))):m.key=g?a.C0.ESC+"OC":a.C0.ESC+"[C";break;case 38:if(u.metaKey)break;c?(m.key=a.C0.ESC+"[1;"+(c+1)+"A",C||m.key!==a.C0.ESC+"[1;3A"||(m.key=a.C0.ESC+"[1;5A")):m.key=g?a.C0.ESC+"OA":a.C0.ESC+"[A";break;case 40:if(u.metaKey)break;c?(m.key=a.C0.ESC+"[1;"+(c+1)+"B",C||m.key!==a.C0.ESC+"[1;3B"||(m.key=a.C0.ESC+"[1;5B")):m.key=g?a.C0.ESC+"OB":a.C0.ESC+"[B";break;case 45:u.shiftKey||u.ctrlKey||(m.key=a.C0.ESC+"[2~");break;case 46:m.key=c?a.C0.ESC+"[3;"+(c+1)+"~":a.C0.ESC+"[3~";break;case 36:m.key=c?a.C0.ESC+"[1;"+(c+1)+"H":g?a.C0.ESC+"OH":a.C0.ESC+"[H";break;case 35:m.key=c?a.C0.ESC+"[1;"+(c+1)+"F":g?a.C0.ESC+"OF":a.C0.ESC+"[F";break;case 33:u.shiftKey?m.type=2:u.ctrlKey?m.key=a.C0.ESC+"[5;"+(c+1)+"~":m.key=a.C0.ESC+"[5~";break;case 34:u.shiftKey?m.type=3:u.ctrlKey?m.key=a.C0.ESC+"[6;"+(c+1)+"~":m.key=a.C0.ESC+"[6~";break;case 112:m.key=c?a.C0.ESC+"[1;"+(c+1)+"P":a.C0.ESC+"OP";break;case 113:m.key=c?a.C0.ESC+"[1;"+(c+1)+"Q":a.C0.ESC+"OQ";break;case 114:m.key=c?a.C0.ESC+"[1;"+(c+1)+"R":a.C0.ESC+"OR";break;case 115:m.key=c?a.C0.ESC+"[1;"+(c+1)+"S":a.C0.ESC+"OS";break;case 116:m.key=c?a.C0.ESC+"[15;"+(c+1)+"~":a.C0.ESC+"[15~";break;case 117:m.key=c?a.C0.ESC+"[17;"+(c+1)+"~":a.C0.ESC+"[17~";break;case 118:m.key=c?a.C0.ESC+"[18;"+(c+1)+"~":a.C0.ESC+"[18~";break;case 119:m.key=c?a.C0.ESC+"[19;"+(c+1)+"~":a.C0.ESC+"[19~";break;case 120:m.key=c?a.C0.ESC+"[20;"+(c+1)+"~":a.C0.ESC+"[20~";break;case 121:m.key=c?a.C0.ESC+"[21;"+(c+1)+"~":a.C0.ESC+"[21~";break;case 122:m.key=c?a.C0.ESC+"[23;"+(c+1)+"~":a.C0.ESC+"[23~";break;case 123:m.key=c?a.C0.ESC+"[24;"+(c+1)+"~":a.C0.ESC+"[24~";break;default:if(!u.ctrlKey||u.shiftKey||u.altKey||u.metaKey)if(C&&!b||!u.altKey||u.metaKey)!C||u.altKey||u.ctrlKey||u.shiftKey||!u.metaKey?u.key&&!u.ctrlKey&&!u.altKey&&!u.metaKey&&u.keyCode>=48&&u.key.length===1?m.key=u.key:u.key&&u.ctrlKey&&(u.key==="_"&&(m.key=a.C0.US),u.key==="@"&&(m.key=a.C0.NUL)):u.keyCode===65&&(m.type=1);else{const p=h[u.keyCode],f=p==null?void 0:p[u.shiftKey?1:0];if(f)m.key=a.C0.ESC+f;else if(u.keyCode>=65&&u.keyCode<=90){const d=u.ctrlKey?u.keyCode-64:u.keyCode+32;let v=String.fromCharCode(d);u.shiftKey&&(v=v.toUpperCase()),m.key=a.C0.ESC+v}else if(u.keyCode===32)m.key=a.C0.ESC+(u.ctrlKey?a.C0.NUL:" ");else if(u.key==="Dead"&&u.code.startsWith("Key")){let d=u.code.slice(3,4);u.shiftKey||(d=d.toLowerCase()),m.key=a.C0.ESC+d,m.cancel=!0}}else u.keyCode>=65&&u.keyCode<=90?m.key=String.fromCharCode(u.keyCode-64):u.keyCode===32?m.key=a.C0.NUL:u.keyCode>=51&&u.keyCode<=55?m.key=String.fromCharCode(u.keyCode-51+27):u.keyCode===56?m.key=a.C0.DEL:u.keyCode===219?m.key=a.C0.ESC:u.keyCode===220?m.key=a.C0.FS:u.keyCode===221&&(m.key=a.C0.GS)}return m}},482:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Utf8ToUtf32=s.StringToUtf32=s.utf32ToString=s.stringFromCodePoint=void 0,s.stringFromCodePoint=function(n){return n>65535?(n-=65536,String.fromCharCode(55296+(n>>10))+String.fromCharCode(n%1024+56320)):String.fromCharCode(n)},s.utf32ToString=function(n,a=0,h=n.length){let u="";for(let g=a;g<h;++g){let C=n[g];C>65535?(C-=65536,u+=String.fromCharCode(55296+(C>>10))+String.fromCharCode(C%1024+56320)):u+=String.fromCharCode(C)}return u},s.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(n,a){const h=n.length;if(!h)return 0;let u=0,g=0;if(this._interim){const C=n.charCodeAt(g++);56320<=C&&C<=57343?a[u++]=1024*(this._interim-55296)+C-56320+65536:(a[u++]=this._interim,a[u++]=C),this._interim=0}for(let C=g;C<h;++C){const b=n.charCodeAt(C);if(55296<=b&&b<=56319){if(++C>=h)return this._interim=b,u;const m=n.charCodeAt(C);56320<=m&&m<=57343?a[u++]=1024*(b-55296)+m-56320+65536:(a[u++]=b,a[u++]=m)}else b!==65279&&(a[u++]=b)}return u}},s.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(n,a){const h=n.length;if(!h)return 0;let u,g,C,b,m=0,c=0,p=0;if(this.interim[0]){let v=!1,y=this.interim[0];y&=(224&y)==192?31:(240&y)==224?15:7;let E,T=0;for(;(E=63&this.interim[++T])&&T<4;)y<<=6,y|=E;const S=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,w=S-T;for(;p<w;){if(p>=h)return 0;if(E=n[p++],(192&E)!=128){p--,v=!0;break}this.interim[T++]=E,y<<=6,y|=63&E}v||(S===2?y<128?p--:a[m++]=y:S===3?y<2048||y>=55296&&y<=57343||y===65279||(a[m++]=y):y<65536||y>1114111||(a[m++]=y)),this.interim.fill(0)}const f=h-4;let d=p;for(;d<h;){for(;!(!(d<f)||128&(u=n[d])||128&(g=n[d+1])||128&(C=n[d+2])||128&(b=n[d+3]));)a[m++]=u,a[m++]=g,a[m++]=C,a[m++]=b,d+=4;if(u=n[d++],u<128)a[m++]=u;else if((224&u)==192){if(d>=h)return this.interim[0]=u,m;if(g=n[d++],(192&g)!=128){d--;continue}if(c=(31&u)<<6|63&g,c<128){d--;continue}a[m++]=c}else if((240&u)==224){if(d>=h)return this.interim[0]=u,m;if(g=n[d++],(192&g)!=128){d--;continue}if(d>=h)return this.interim[0]=u,this.interim[1]=g,m;if(C=n[d++],(192&C)!=128){d--;continue}if(c=(15&u)<<12|(63&g)<<6|63&C,c<2048||c>=55296&&c<=57343||c===65279)continue;a[m++]=c}else if((248&u)==240){if(d>=h)return this.interim[0]=u,m;if(g=n[d++],(192&g)!=128){d--;continue}if(d>=h)return this.interim[0]=u,this.interim[1]=g,m;if(C=n[d++],(192&C)!=128){d--;continue}if(d>=h)return this.interim[0]=u,this.interim[1]=g,this.interim[2]=C,m;if(b=n[d++],(192&b)!=128){d--;continue}if(c=(7&u)<<18|(63&g)<<12|(63&C)<<6|63&b,c<65536||c>1114111)continue;a[m++]=c}}return m}}},225:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeV6=void 0;const n=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],a=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let h;s.UnicodeV6=class{constructor(){if(this.version="6",!h){h=new Uint8Array(65536),h.fill(1),h[0]=0,h.fill(0,1,32),h.fill(0,127,160),h.fill(2,4352,4448),h[9001]=2,h[9002]=2,h.fill(2,11904,42192),h[12351]=1,h.fill(2,44032,55204),h.fill(2,63744,64256),h.fill(2,65040,65050),h.fill(2,65072,65136),h.fill(2,65280,65377),h.fill(2,65504,65511);for(let u=0;u<n.length;++u)h.fill(0,n[u][0],n[u][1]+1)}}wcwidth(u){return u<32?0:u<127?1:u<65536?h[u]:function(g,C){let b,m=0,c=C.length-1;if(g<C[0][0]||g>C[c][1])return!1;for(;c>=m;)if(b=m+c>>1,g>C[b][1])m=b+1;else{if(!(g<C[b][0]))return!0;c=b-1}return!1}(u,a)?0:u>=131072&&u<=196605||u>=196608&&u<=262141?2:1}}},5981:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WriteBuffer=void 0;const a=n(8460),h=n(844);class u extends h.Disposable{constructor(C){super(),this._action=C,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new a.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(C,b){if(b!==void 0&&this._syncCalls>b)return void(this._syncCalls=0);if(this._pendingData+=C.length,this._writeBuffer.push(C),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let m;for(this._isSyncWriting=!0;m=this._writeBuffer.shift();){this._action(m);const c=this._callbacks.shift();c&&c()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(C,b){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=C.length,this._writeBuffer.push(C),this._callbacks.push(b),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=C.length,this._writeBuffer.push(C),this._callbacks.push(b)}_innerWrite(C=0,b=!0){const m=C||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const c=this._writeBuffer[this._bufferOffset],p=this._action(c,b);if(p){const d=v=>Date.now()-m>=12?setTimeout(()=>this._innerWrite(0,v)):this._innerWrite(m,v);return void p.catch(v=>(queueMicrotask(()=>{throw v}),Promise.resolve(!1))).then(d)}const f=this._callbacks[this._bufferOffset];if(f&&f(),this._bufferOffset++,this._pendingData-=c.length,Date.now()-m>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}s.WriteBuffer=u},5941:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.toRgbString=s.parseColor=void 0;const n=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,a=/^[\da-f]+$/;function h(u,g){const C=u.toString(16),b=C.length<2?"0"+C:C;switch(g){case 4:return C[0];case 8:return b;case 12:return(b+b).slice(0,3);default:return b+b}}s.parseColor=function(u){if(!u)return;let g=u.toLowerCase();if(g.indexOf("rgb:")===0){g=g.slice(4);const C=n.exec(g);if(C){const b=C[1]?15:C[4]?255:C[7]?4095:65535;return[Math.round(parseInt(C[1]||C[4]||C[7]||C[10],16)/b*255),Math.round(parseInt(C[2]||C[5]||C[8]||C[11],16)/b*255),Math.round(parseInt(C[3]||C[6]||C[9]||C[12],16)/b*255)]}}else if(g.indexOf("#")===0&&(g=g.slice(1),a.exec(g)&&[3,6,9,12].includes(g.length))){const C=g.length/3,b=[0,0,0];for(let m=0;m<3;++m){const c=parseInt(g.slice(C*m,C*m+C),16);b[m]=C===1?c<<4:C===2?c:C===3?c>>4:c>>8}return b}},s.toRgbString=function(u,g=16){const[C,b,m]=u;return`rgb:${h(C,g)}/${h(b,g)}/${h(m,g)}`}},5770:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PAYLOAD_LIMIT=void 0,s.PAYLOAD_LIMIT=1e7},6351:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DcsHandler=s.DcsParser=void 0;const a=n(482),h=n(8742),u=n(5770),g=[];s.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=g,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=g}registerHandler(b,m){this._handlers[b]===void 0&&(this._handlers[b]=[]);const c=this._handlers[b];return c.push(m),{dispose:()=>{const p=c.indexOf(m);p!==-1&&c.splice(p,1)}}}clearHandler(b){this._handlers[b]&&delete this._handlers[b]}setHandlerFallback(b){this._handlerFb=b}reset(){if(this._active.length)for(let b=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;b>=0;--b)this._active[b].unhook(!1);this._stack.paused=!1,this._active=g,this._ident=0}hook(b,m){if(this.reset(),this._ident=b,this._active=this._handlers[b]||g,this._active.length)for(let c=this._active.length-1;c>=0;c--)this._active[c].hook(m);else this._handlerFb(this._ident,"HOOK",m)}put(b,m,c){if(this._active.length)for(let p=this._active.length-1;p>=0;p--)this._active[p].put(b,m,c);else this._handlerFb(this._ident,"PUT",(0,a.utf32ToString)(b,m,c))}unhook(b,m=!0){if(this._active.length){let c=!1,p=this._active.length-1,f=!1;if(this._stack.paused&&(p=this._stack.loopPosition-1,c=m,f=this._stack.fallThrough,this._stack.paused=!1),!f&&c===!1){for(;p>=0&&(c=this._active[p].unhook(b),c!==!0);p--)if(c instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=p,this._stack.fallThrough=!1,c;p--}for(;p>=0;p--)if(c=this._active[p].unhook(!1),c instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=p,this._stack.fallThrough=!0,c}else this._handlerFb(this._ident,"UNHOOK",b);this._active=g,this._ident=0}};const C=new h.Params;C.addParam(0),s.DcsHandler=class{constructor(b){this._handler=b,this._data="",this._params=C,this._hitLimit=!1}hook(b){this._params=b.length>1||b.params[0]?b.clone():C,this._data="",this._hitLimit=!1}put(b,m,c){this._hitLimit||(this._data+=(0,a.utf32ToString)(b,m,c),this._data.length>u.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(b){let m=!1;if(this._hitLimit)m=!1;else if(b&&(m=this._handler(this._data,this._params),m instanceof Promise))return m.then(c=>(this._params=C,this._data="",this._hitLimit=!1,c));return this._params=C,this._data="",this._hitLimit=!1,m}}},2015:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.EscapeSequenceParser=s.VT500_TRANSITION_TABLE=s.TransitionTable=void 0;const a=n(844),h=n(8742),u=n(6242),g=n(6351);class C{constructor(p){this.table=new Uint8Array(p)}setDefault(p,f){this.table.fill(p<<4|f)}add(p,f,d,v){this.table[f<<8|p]=d<<4|v}addMany(p,f,d,v){for(let y=0;y<p.length;y++)this.table[f<<8|p[y]]=d<<4|v}}s.TransitionTable=C;const b=160;s.VT500_TRANSITION_TABLE=function(){const c=new C(4095),p=Array.apply(null,Array(256)).map((T,S)=>S),f=(T,S)=>p.slice(T,S),d=f(32,127),v=f(0,24);v.push(25),v.push.apply(v,f(28,32));const y=f(0,14);let E;for(E in c.setDefault(1,0),c.addMany(d,0,2,0),y)c.addMany([24,26,153,154],E,3,0),c.addMany(f(128,144),E,3,0),c.addMany(f(144,152),E,3,0),c.add(156,E,0,0),c.add(27,E,11,1),c.add(157,E,4,8),c.addMany([152,158,159],E,0,7),c.add(155,E,11,3),c.add(144,E,11,9);return c.addMany(v,0,3,0),c.addMany(v,1,3,1),c.add(127,1,0,1),c.addMany(v,8,0,8),c.addMany(v,3,3,3),c.add(127,3,0,3),c.addMany(v,4,3,4),c.add(127,4,0,4),c.addMany(v,6,3,6),c.addMany(v,5,3,5),c.add(127,5,0,5),c.addMany(v,2,3,2),c.add(127,2,0,2),c.add(93,1,4,8),c.addMany(d,8,5,8),c.add(127,8,5,8),c.addMany([156,27,24,26,7],8,6,0),c.addMany(f(28,32),8,0,8),c.addMany([88,94,95],1,0,7),c.addMany(d,7,0,7),c.addMany(v,7,0,7),c.add(156,7,0,0),c.add(127,7,0,7),c.add(91,1,11,3),c.addMany(f(64,127),3,7,0),c.addMany(f(48,60),3,8,4),c.addMany([60,61,62,63],3,9,4),c.addMany(f(48,60),4,8,4),c.addMany(f(64,127),4,7,0),c.addMany([60,61,62,63],4,0,6),c.addMany(f(32,64),6,0,6),c.add(127,6,0,6),c.addMany(f(64,127),6,0,0),c.addMany(f(32,48),3,9,5),c.addMany(f(32,48),5,9,5),c.addMany(f(48,64),5,0,6),c.addMany(f(64,127),5,7,0),c.addMany(f(32,48),4,9,5),c.addMany(f(32,48),1,9,2),c.addMany(f(32,48),2,9,2),c.addMany(f(48,127),2,10,0),c.addMany(f(48,80),1,10,0),c.addMany(f(81,88),1,10,0),c.addMany([89,90,92],1,10,0),c.addMany(f(96,127),1,10,0),c.add(80,1,11,9),c.addMany(v,9,0,9),c.add(127,9,0,9),c.addMany(f(28,32),9,0,9),c.addMany(f(32,48),9,9,12),c.addMany(f(48,60),9,8,10),c.addMany([60,61,62,63],9,9,10),c.addMany(v,11,0,11),c.addMany(f(32,128),11,0,11),c.addMany(f(28,32),11,0,11),c.addMany(v,10,0,10),c.add(127,10,0,10),c.addMany(f(28,32),10,0,10),c.addMany(f(48,60),10,8,10),c.addMany([60,61,62,63],10,0,11),c.addMany(f(32,48),10,9,12),c.addMany(v,12,0,12),c.add(127,12,0,12),c.addMany(f(28,32),12,0,12),c.addMany(f(32,48),12,9,12),c.addMany(f(48,64),12,0,11),c.addMany(f(64,127),12,12,13),c.addMany(f(64,127),10,12,13),c.addMany(f(64,127),9,12,13),c.addMany(v,13,13,13),c.addMany(d,13,13,13),c.add(127,13,0,13),c.addMany([27,156,24,26],13,14,0),c.add(b,0,2,0),c.add(b,8,5,8),c.add(b,6,0,6),c.add(b,11,0,11),c.add(b,13,13,13),c}();class m extends a.Disposable{constructor(p=s.VT500_TRANSITION_TABLE){super(),this._transitions=p,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new h.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(f,d,v)=>{},this._executeHandlerFb=f=>{},this._csiHandlerFb=(f,d)=>{},this._escHandlerFb=f=>{},this._errorHandlerFb=f=>f,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,a.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new u.OscParser),this._dcsParser=this.register(new g.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(p,f=[64,126]){let d=0;if(p.prefix){if(p.prefix.length>1)throw new Error("only one byte as prefix supported");if(d=p.prefix.charCodeAt(0),d&&60>d||d>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(p.intermediates){if(p.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let y=0;y<p.intermediates.length;++y){const E=p.intermediates.charCodeAt(y);if(32>E||E>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");d<<=8,d|=E}}if(p.final.length!==1)throw new Error("final must be a single byte");const v=p.final.charCodeAt(0);if(f[0]>v||v>f[1])throw new Error(`final must be in range ${f[0]} .. ${f[1]}`);return d<<=8,d|=v,d}identToString(p){const f=[];for(;p;)f.push(String.fromCharCode(255&p)),p>>=8;return f.reverse().join("")}setPrintHandler(p){this._printHandler=p}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(p,f){const d=this._identifier(p,[48,126]);this._escHandlers[d]===void 0&&(this._escHandlers[d]=[]);const v=this._escHandlers[d];return v.push(f),{dispose:()=>{const y=v.indexOf(f);y!==-1&&v.splice(y,1)}}}clearEscHandler(p){this._escHandlers[this._identifier(p,[48,126])]&&delete this._escHandlers[this._identifier(p,[48,126])]}setEscHandlerFallback(p){this._escHandlerFb=p}setExecuteHandler(p,f){this._executeHandlers[p.charCodeAt(0)]=f}clearExecuteHandler(p){this._executeHandlers[p.charCodeAt(0)]&&delete this._executeHandlers[p.charCodeAt(0)]}setExecuteHandlerFallback(p){this._executeHandlerFb=p}registerCsiHandler(p,f){const d=this._identifier(p);this._csiHandlers[d]===void 0&&(this._csiHandlers[d]=[]);const v=this._csiHandlers[d];return v.push(f),{dispose:()=>{const y=v.indexOf(f);y!==-1&&v.splice(y,1)}}}clearCsiHandler(p){this._csiHandlers[this._identifier(p)]&&delete this._csiHandlers[this._identifier(p)]}setCsiHandlerFallback(p){this._csiHandlerFb=p}registerDcsHandler(p,f){return this._dcsParser.registerHandler(this._identifier(p),f)}clearDcsHandler(p){this._dcsParser.clearHandler(this._identifier(p))}setDcsHandlerFallback(p){this._dcsParser.setHandlerFallback(p)}registerOscHandler(p,f){return this._oscParser.registerHandler(p,f)}clearOscHandler(p){this._oscParser.clearHandler(p)}setOscHandlerFallback(p){this._oscParser.setHandlerFallback(p)}setErrorHandler(p){this._errorHandler=p}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(p,f,d,v,y){this._parseStack.state=p,this._parseStack.handlers=f,this._parseStack.handlerPos=d,this._parseStack.transition=v,this._parseStack.chunkPos=y}parse(p,f,d){let v,y=0,E=0,T=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,T=this._parseStack.chunkPos+1;else{if(d===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const S=this._parseStack.handlers;let w=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(d===!1&&w>-1){for(;w>=0&&(v=S[w](this._params),v!==!0);w--)if(v instanceof Promise)return this._parseStack.handlerPos=w,v}this._parseStack.handlers=[];break;case 4:if(d===!1&&w>-1){for(;w>=0&&(v=S[w](),v!==!0);w--)if(v instanceof Promise)return this._parseStack.handlerPos=w,v}this._parseStack.handlers=[];break;case 6:if(y=p[this._parseStack.chunkPos],v=this._dcsParser.unhook(y!==24&&y!==26,d),v)return v;y===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(y=p[this._parseStack.chunkPos],v=this._oscParser.end(y!==24&&y!==26,d),v)return v;y===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,T=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let S=T;S<f;++S){switch(y=p[S],E=this._transitions.table[this.currentState<<8|(y<160?y:b)],E>>4){case 2:for(let x=S+1;;++x){if(x>=f||(y=p[x])<32||y>126&&y<b){this._printHandler(p,S,x),S=x-1;break}if(++x>=f||(y=p[x])<32||y>126&&y<b){this._printHandler(p,S,x),S=x-1;break}if(++x>=f||(y=p[x])<32||y>126&&y<b){this._printHandler(p,S,x),S=x-1;break}if(++x>=f||(y=p[x])<32||y>126&&y<b){this._printHandler(p,S,x),S=x-1;break}}break;case 3:this._executeHandlers[y]?this._executeHandlers[y]():this._executeHandlerFb(y),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:S,code:y,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const w=this._csiHandlers[this._collect<<8|y];let A=w?w.length-1:-1;for(;A>=0&&(v=w[A](this._params),v!==!0);A--)if(v instanceof Promise)return this._preserveStack(3,w,A,E,S),v;A<0&&this._csiHandlerFb(this._collect<<8|y,this._params),this.precedingCodepoint=0;break;case 8:do switch(y){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(y-48)}while(++S<f&&(y=p[S])>47&&y<60);S--;break;case 9:this._collect<<=8,this._collect|=y;break;case 10:const D=this._escHandlers[this._collect<<8|y];let R=D?D.length-1:-1;for(;R>=0&&(v=D[R](),v!==!0);R--)if(v instanceof Promise)return this._preserveStack(4,D,R,E,S),v;R<0&&this._escHandlerFb(this._collect<<8|y),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|y,this._params);break;case 13:for(let x=S+1;;++x)if(x>=f||(y=p[x])===24||y===26||y===27||y>127&&y<b){this._dcsParser.put(p,S,x),S=x-1;break}break;case 14:if(v=this._dcsParser.unhook(y!==24&&y!==26),v)return this._preserveStack(6,[],0,E,S),v;y===27&&(E|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let x=S+1;;x++)if(x>=f||(y=p[x])<32||y>127&&y<b){this._oscParser.put(p,S,x),S=x-1;break}break;case 6:if(v=this._oscParser.end(y!==24&&y!==26),v)return this._preserveStack(5,[],0,E,S),v;y===27&&(E|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&E}}}s.EscapeSequenceParser=m},6242:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.OscHandler=s.OscParser=void 0;const a=n(5770),h=n(482),u=[];s.OscParser=class{constructor(){this._state=0,this._active=u,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(g,C){this._handlers[g]===void 0&&(this._handlers[g]=[]);const b=this._handlers[g];return b.push(C),{dispose:()=>{const m=b.indexOf(C);m!==-1&&b.splice(m,1)}}}clearHandler(g){this._handlers[g]&&delete this._handlers[g]}setHandlerFallback(g){this._handlerFb=g}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=u}reset(){if(this._state===2)for(let g=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;g>=0;--g)this._active[g].end(!1);this._stack.paused=!1,this._active=u,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||u,this._active.length)for(let g=this._active.length-1;g>=0;g--)this._active[g].start();else this._handlerFb(this._id,"START")}_put(g,C,b){if(this._active.length)for(let m=this._active.length-1;m>=0;m--)this._active[m].put(g,C,b);else this._handlerFb(this._id,"PUT",(0,h.utf32ToString)(g,C,b))}start(){this.reset(),this._state=1}put(g,C,b){if(this._state!==3){if(this._state===1)for(;C<b;){const m=g[C++];if(m===59){this._state=2,this._start();break}if(m<48||57<m)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+m-48}this._state===2&&b-C>0&&this._put(g,C,b)}}end(g,C=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let b=!1,m=this._active.length-1,c=!1;if(this._stack.paused&&(m=this._stack.loopPosition-1,b=C,c=this._stack.fallThrough,this._stack.paused=!1),!c&&b===!1){for(;m>=0&&(b=this._active[m].end(g),b!==!0);m--)if(b instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=m,this._stack.fallThrough=!1,b;m--}for(;m>=0;m--)if(b=this._active[m].end(!1),b instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=m,this._stack.fallThrough=!0,b}else this._handlerFb(this._id,"END",g);this._active=u,this._id=-1,this._state=0}}},s.OscHandler=class{constructor(g){this._handler=g,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(g,C,b){this._hitLimit||(this._data+=(0,h.utf32ToString)(g,C,b),this._data.length>a.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(g){let C=!1;if(this._hitLimit)C=!1;else if(g&&(C=this._handler(this._data),C instanceof Promise))return C.then(b=>(this._data="",this._hitLimit=!1,b));return this._data="",this._hitLimit=!1,C}}},8742:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Params=void 0;const n=2147483647;class a{constructor(u=32,g=32){if(this.maxLength=u,this.maxSubParamsLength=g,g>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(u),this.length=0,this._subParams=new Int32Array(g),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(u),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(u){const g=new a;if(!u.length)return g;for(let C=Array.isArray(u[0])?1:0;C<u.length;++C){const b=u[C];if(Array.isArray(b))for(let m=0;m<b.length;++m)g.addSubParam(b[m]);else g.addParam(b)}return g}clone(){const u=new a(this.maxLength,this.maxSubParamsLength);return u.params.set(this.params),u.length=this.length,u._subParams.set(this._subParams),u._subParamsLength=this._subParamsLength,u._subParamsIdx.set(this._subParamsIdx),u._rejectDigits=this._rejectDigits,u._rejectSubDigits=this._rejectSubDigits,u._digitIsSub=this._digitIsSub,u}toArray(){const u=[];for(let g=0;g<this.length;++g){u.push(this.params[g]);const C=this._subParamsIdx[g]>>8,b=255&this._subParamsIdx[g];b-C>0&&u.push(Array.prototype.slice.call(this._subParams,C,b))}return u}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(u){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(u<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=u>n?n:u}}addSubParam(u){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(u<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=u>n?n:u,this._subParamsIdx[this.length-1]++}}hasSubParams(u){return(255&this._subParamsIdx[u])-(this._subParamsIdx[u]>>8)>0}getSubParams(u){const g=this._subParamsIdx[u]>>8,C=255&this._subParamsIdx[u];return C-g>0?this._subParams.subarray(g,C):null}getSubParamsAll(){const u={};for(let g=0;g<this.length;++g){const C=this._subParamsIdx[g]>>8,b=255&this._subParamsIdx[g];b-C>0&&(u[g]=this._subParams.slice(C,b))}return u}addDigit(u){let g;if(this._rejectDigits||!(g=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const C=this._digitIsSub?this._subParams:this.params,b=C[g-1];C[g-1]=~b?Math.min(10*b+u,n):u}}s.Params=a},5741:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.AddonManager=void 0,s.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let n=this._addons.length-1;n>=0;n--)this._addons[n].instance.dispose()}loadAddon(n,a){const h={instance:a,dispose:a.dispose,isDisposed:!1};this._addons.push(h),a.dispose=()=>this._wrappedAddonDispose(h),a.activate(n)}_wrappedAddonDispose(n){if(n.isDisposed)return;let a=-1;for(let h=0;h<this._addons.length;h++)if(this._addons[h]===n){a=h;break}if(a===-1)throw new Error("Could not dispose an addon that has not been loaded");n.isDisposed=!0,n.dispose.apply(n.instance),this._addons.splice(a,1)}}},8771:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferApiView=void 0;const a=n(3785),h=n(511);s.BufferApiView=class{constructor(u,g){this._buffer=u,this.type=g}init(u){return this._buffer=u,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(u){const g=this._buffer.lines.get(u);if(g)return new a.BufferLineApiView(g)}getNullCell(){return new h.CellData}}},3785:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferLineApiView=void 0;const a=n(511);s.BufferLineApiView=class{constructor(h){this._line=h}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(h,u){if(!(h<0||h>=this._line.length))return u?(this._line.loadCell(h,u),u):this._line.loadCell(h,new a.CellData)}translateToString(h,u,g){return this._line.translateToString(h,u,g)}}},8285:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferNamespaceApi=void 0;const a=n(8771),h=n(8460);s.BufferNamespaceApi=class{constructor(u){this._core=u,this._onBufferChange=new h.EventEmitter,this.onBufferChange=this._onBufferChange.event,this._normal=new a.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new a.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}},7975:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ParserApi=void 0,s.ParserApi=class{constructor(n){this._core=n}registerCsiHandler(n,a){return this._core.registerCsiHandler(n,h=>a(h.toArray()))}addCsiHandler(n,a){return this.registerCsiHandler(n,a)}registerDcsHandler(n,a){return this._core.registerDcsHandler(n,(h,u)=>a(h,u.toArray()))}addDcsHandler(n,a){return this.registerDcsHandler(n,a)}registerEscHandler(n,a){return this._core.registerEscHandler(n,a)}addEscHandler(n,a){return this.registerEscHandler(n,a)}registerOscHandler(n,a){return this._core.registerOscHandler(n,a)}addOscHandler(n,a){return this.registerOscHandler(n,a)}}},7090:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeApi=void 0,s.UnicodeApi=class{constructor(n){this._core=n}register(n){this._core.unicodeService.register(n)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(n){this._core.unicodeService.activeVersion=n}}},744:function(_,s,n){var a=this&&this.__decorate||function(c,p,f,d){var v,y=arguments.length,E=y<3?p:d===null?d=Object.getOwnPropertyDescriptor(p,f):d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(c,p,f,d);else for(var T=c.length-1;T>=0;T--)(v=c[T])&&(E=(y<3?v(E):y>3?v(p,f,E):v(p,f))||E);return y>3&&E&&Object.defineProperty(p,f,E),E},h=this&&this.__param||function(c,p){return function(f,d){p(f,d,c)}};Object.defineProperty(s,"__esModule",{value:!0}),s.BufferService=s.MINIMUM_ROWS=s.MINIMUM_COLS=void 0;const u=n(2585),g=n(5295),C=n(8460),b=n(844);s.MINIMUM_COLS=2,s.MINIMUM_ROWS=1;let m=class extends b.Disposable{constructor(c){super(),this.isUserScrolling=!1,this._onResize=this.register(new C.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new C.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(c.rawOptions.cols||0,s.MINIMUM_COLS),this.rows=Math.max(c.rawOptions.rows||0,s.MINIMUM_ROWS),this.buffers=this.register(new g.BufferSet(c,this))}get buffer(){return this.buffers.active}resize(c,p){this.cols=c,this.rows=p,this.buffers.resize(c,p),this._onResize.fire({cols:c,rows:p})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(c,p=!1){const f=this.buffer;let d;d=this._cachedBlankLine,d&&d.length===this.cols&&d.getFg(0)===c.fg&&d.getBg(0)===c.bg||(d=f.getBlankLine(c,p),this._cachedBlankLine=d),d.isWrapped=p;const v=f.ybase+f.scrollTop,y=f.ybase+f.scrollBottom;if(f.scrollTop===0){const E=f.lines.isFull;y===f.lines.length-1?E?f.lines.recycle().copyFrom(d):f.lines.push(d.clone()):f.lines.splice(y+1,0,d.clone()),E?this.isUserScrolling&&(f.ydisp=Math.max(f.ydisp-1,0)):(f.ybase++,this.isUserScrolling||f.ydisp++)}else{const E=y-v+1;f.lines.shiftElements(v+1,E-1,-1),f.lines.set(y,d.clone())}this.isUserScrolling||(f.ydisp=f.ybase),this._onScroll.fire(f.ydisp)}scrollLines(c,p,f){const d=this.buffer;if(c<0){if(d.ydisp===0)return;this.isUserScrolling=!0}else c+d.ydisp>=d.ybase&&(this.isUserScrolling=!1);const v=d.ydisp;d.ydisp=Math.max(Math.min(d.ydisp+c,d.ybase),0),v!==d.ydisp&&(p||this._onScroll.fire(d.ydisp))}scrollPages(c){this.scrollLines(c*(this.rows-1))}scrollToTop(){this.scrollLines(-this.buffer.ydisp)}scrollToBottom(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)}scrollToLine(c){const p=c-this.buffer.ydisp;p!==0&&this.scrollLines(p)}};m=a([h(0,u.IOptionsService)],m),s.BufferService=m},7994:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CharsetService=void 0,s.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(n){this.glevel=n,this.charset=this._charsets[n]}setgCharset(n,a){this._charsets[n]=a,this.glevel===n&&(this.charset=a)}}},1753:function(_,s,n){var a=this&&this.__decorate||function(d,v,y,E){var T,S=arguments.length,w=S<3?v:E===null?E=Object.getOwnPropertyDescriptor(v,y):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(d,v,y,E);else for(var A=d.length-1;A>=0;A--)(T=d[A])&&(w=(S<3?T(w):S>3?T(v,y,w):T(v,y))||w);return S>3&&w&&Object.defineProperty(v,y,w),w},h=this&&this.__param||function(d,v){return function(y,E){v(y,E,d)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CoreMouseService=void 0;const u=n(2585),g=n(8460),C=n(844),b={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:d=>d.button!==4&&d.action===1&&(d.ctrl=!1,d.alt=!1,d.shift=!1,!0)},VT200:{events:19,restrict:d=>d.action!==32},DRAG:{events:23,restrict:d=>d.action!==32||d.button!==3},ANY:{events:31,restrict:d=>!0}};function m(d,v){let y=(d.ctrl?16:0)|(d.shift?4:0)|(d.alt?8:0);return d.button===4?(y|=64,y|=d.action):(y|=3&d.button,4&d.button&&(y|=64),8&d.button&&(y|=128),d.action===32?y|=32:d.action!==0||v||(y|=3)),y}const c=String.fromCharCode,p={DEFAULT:d=>{const v=[m(d,!1)+32,d.col+32,d.row+32];return v[0]>255||v[1]>255||v[2]>255?"":`\x1B[M${c(v[0])}${c(v[1])}${c(v[2])}`},SGR:d=>{const v=d.action===0&&d.button!==4?"m":"M";return`\x1B[<${m(d,!0)};${d.col};${d.row}${v}`},SGR_PIXELS:d=>{const v=d.action===0&&d.button!==4?"m":"M";return`\x1B[<${m(d,!0)};${d.x};${d.y}${v}`}};let f=class extends C.Disposable{constructor(d,v){super(),this._bufferService=d,this._coreService=v,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new g.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const y of Object.keys(b))this.addProtocol(y,b[y]);for(const y of Object.keys(p))this.addEncoding(y,p[y]);this.reset()}addProtocol(d,v){this._protocols[d]=v}addEncoding(d,v){this._encodings[d]=v}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(d){if(!this._protocols[d])throw new Error(`unknown protocol "${d}"`);this._activeProtocol=d,this._onProtocolChange.fire(this._protocols[d].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(d){if(!this._encodings[d])throw new Error(`unknown encoding "${d}"`);this._activeEncoding=d}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(d){if(d.col<0||d.col>=this._bufferService.cols||d.row<0||d.row>=this._bufferService.rows||d.button===4&&d.action===32||d.button===3&&d.action!==32||d.button!==4&&(d.action===2||d.action===3)||(d.col++,d.row++,d.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,d,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(d))return!1;const v=this._encodings[this._activeEncoding](d);return v&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(v):this._coreService.triggerDataEvent(v,!0)),this._lastEvent=d,!0}explainEvents(d){return{down:!!(1&d),up:!!(2&d),drag:!!(4&d),move:!!(8&d),wheel:!!(16&d)}}_equalEvents(d,v,y){if(y){if(d.x!==v.x||d.y!==v.y)return!1}else if(d.col!==v.col||d.row!==v.row)return!1;return d.button===v.button&&d.action===v.action&&d.ctrl===v.ctrl&&d.alt===v.alt&&d.shift===v.shift}};f=a([h(0,u.IBufferService),h(1,u.ICoreService)],f),s.CoreMouseService=f},6975:function(_,s,n){var a=this&&this.__decorate||function(f,d,v,y){var E,T=arguments.length,S=T<3?d:y===null?y=Object.getOwnPropertyDescriptor(d,v):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(f,d,v,y);else for(var w=f.length-1;w>=0;w--)(E=f[w])&&(S=(T<3?E(S):T>3?E(d,v,S):E(d,v))||S);return T>3&&S&&Object.defineProperty(d,v,S),S},h=this&&this.__param||function(f,d){return function(v,y){d(v,y,f)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CoreService=void 0;const u=n(2585),g=n(8460),C=n(1439),b=n(844),m=Object.freeze({insertMode:!1}),c=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let p=class extends b.Disposable{constructor(f,d,v){super(),this._bufferService=f,this._logService=d,this._optionsService=v,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new g.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new g.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new g.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new g.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,C.clone)(m),this.decPrivateModes=(0,C.clone)(c)}reset(){this.modes=(0,C.clone)(m),this.decPrivateModes=(0,C.clone)(c)}triggerDataEvent(f,d=!1){if(this._optionsService.rawOptions.disableStdin)return;const v=this._bufferService.buffer;d&&this._optionsService.rawOptions.scrollOnUserInput&&v.ybase!==v.ydisp&&this._onRequestScrollToBottom.fire(),d&&this._onUserInput.fire(),this._logService.debug(`sending data "${f}"`,()=>f.split("").map(y=>y.charCodeAt(0))),this._onData.fire(f)}triggerBinaryEvent(f){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${f}"`,()=>f.split("").map(d=>d.charCodeAt(0))),this._onBinary.fire(f))}};p=a([h(0,u.IBufferService),h(1,u.ILogService),h(2,u.IOptionsService)],p),s.CoreService=p},9074:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DecorationService=void 0;const a=n(8055),h=n(8460),u=n(844),g=n(6106);let C=0,b=0;class m extends u.Disposable{constructor(){super(),this._decorations=new g.SortedList(f=>f==null?void 0:f.marker.line),this._onDecorationRegistered=this.register(new h.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new h.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,u.toDisposable)(()=>{for(const f of this._decorations.values())this._onDecorationRemoved.fire(f);this.reset()}))}get decorations(){return this._decorations.values()}registerDecoration(f){if(f.marker.isDisposed)return;const d=new c(f);if(d){const v=d.marker.onDispose(()=>d.dispose());d.onDispose(()=>{d&&(this._decorations.delete(d)&&this._onDecorationRemoved.fire(d),v.dispose())}),this._decorations.insert(d),this._onDecorationRegistered.fire(d)}return d}reset(){for(const f of this._decorations.values())f.dispose();this._decorations.clear()}*getDecorationsAtCell(f,d,v){var y,E,T;let S=0,w=0;for(const A of this._decorations.getKeyIterator(d))S=(y=A.options.x)!==null&&y!==void 0?y:0,w=S+((E=A.options.width)!==null&&E!==void 0?E:1),f>=S&&f<w&&(!v||((T=A.options.layer)!==null&&T!==void 0?T:"bottom")===v)&&(yield A)}forEachDecorationAtCell(f,d,v,y){this._decorations.forEachByKey(d,E=>{var T,S,w;C=(T=E.options.x)!==null&&T!==void 0?T:0,b=C+((S=E.options.width)!==null&&S!==void 0?S:1),f>=C&&f<b&&(!v||((w=E.options.layer)!==null&&w!==void 0?w:"bottom")===v)&&y(E)})}dispose(){for(const f of this._decorations.values())this._onDecorationRemoved.fire(f);this.reset()}}s.DecorationService=m;class c extends u.Disposable{constructor(f){super(),this.options=f,this.onRenderEmitter=this.register(new h.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new h.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=f.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=a.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=a.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.InstantiationService=s.ServiceCollection=void 0;const a=n(2585),h=n(8343);class u{constructor(...C){this._entries=new Map;for(const[b,m]of C)this.set(b,m)}set(C,b){const m=this._entries.get(C);return this._entries.set(C,b),m}forEach(C){for(const[b,m]of this._entries.entries())C(b,m)}has(C){return this._entries.has(C)}get(C){return this._entries.get(C)}}s.ServiceCollection=u,s.InstantiationService=class{constructor(){this._services=new u,this._services.set(a.IInstantiationService,this)}setService(g,C){this._services.set(g,C)}getService(g){return this._services.get(g)}createInstance(g,...C){const b=(0,h.getServiceDependencies)(g).sort((p,f)=>p.index-f.index),m=[];for(const p of b){const f=this._services.get(p.id);if(!f)throw new Error(`[createInstance] ${g.name} depends on UNKNOWN service ${p.id}.`);m.push(f)}const c=b.length>0?b[0].index:C.length;if(C.length!==c)throw new Error(`[createInstance] First service dependency of ${g.name} at position ${c+1} conflicts with ${C.length} static arguments`);return new g(...C,...m)}}},7866:function(_,s,n){var a=this&&this.__decorate||function(m,c,p,f){var d,v=arguments.length,y=v<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,p):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(m,c,p,f);else for(var E=m.length-1;E>=0;E--)(d=m[E])&&(y=(v<3?d(y):v>3?d(c,p,y):d(c,p))||y);return v>3&&y&&Object.defineProperty(c,p,y),y},h=this&&this.__param||function(m,c){return function(p,f){c(p,f,m)}};Object.defineProperty(s,"__esModule",{value:!0}),s.LogService=void 0;const u=n(844),g=n(2585),C={debug:g.LogLevelEnum.DEBUG,info:g.LogLevelEnum.INFO,warn:g.LogLevelEnum.WARN,error:g.LogLevelEnum.ERROR,off:g.LogLevelEnum.OFF};let b=class extends u.Disposable{constructor(m){super(),this._optionsService=m,this.logLevel=g.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}_updateLogLevel(){this.logLevel=C[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(m){for(let c=0;c<m.length;c++)typeof m[c]=="function"&&(m[c]=m[c]())}_log(m,c,p){this._evalLazyOptionalParams(p),m.call(console,"xterm.js: "+c,...p)}debug(m,...c){this.logLevel<=g.LogLevelEnum.DEBUG&&this._log(console.log,m,c)}info(m,...c){this.logLevel<=g.LogLevelEnum.INFO&&this._log(console.info,m,c)}warn(m,...c){this.logLevel<=g.LogLevelEnum.WARN&&this._log(console.warn,m,c)}error(m,...c){this.logLevel<=g.LogLevelEnum.ERROR&&this._log(console.error,m,c)}};b=a([h(0,g.IOptionsService)],b),s.LogService=b},7302:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.OptionsService=s.DEFAULT_OPTIONS=void 0;const a=n(8460),h=n(6114),u=n(844);s.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:h.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const g=["normal","bold","100","200","300","400","500","600","700","800","900"];class C extends u.Disposable{constructor(m){super(),this._onOptionChange=this.register(new a.EventEmitter),this.onOptionChange=this._onOptionChange.event;const c=Object.assign({},s.DEFAULT_OPTIONS);for(const p in m)if(p in c)try{const f=m[p];c[p]=this._sanitizeAndValidateOption(p,f)}catch(f){console.error(f)}this.rawOptions=c,this.options=Object.assign({},c),this._setupOptions()}onSpecificOptionChange(m,c){return this.onOptionChange(p=>{p===m&&c(this.rawOptions[m])})}onMultipleOptionChange(m,c){return this.onOptionChange(p=>{m.indexOf(p)!==-1&&c()})}_setupOptions(){const m=p=>{if(!(p in s.DEFAULT_OPTIONS))throw new Error(`No option with key "${p}"`);return this.rawOptions[p]},c=(p,f)=>{if(!(p in s.DEFAULT_OPTIONS))throw new Error(`No option with key "${p}"`);f=this._sanitizeAndValidateOption(p,f),this.rawOptions[p]!==f&&(this.rawOptions[p]=f,this._onOptionChange.fire(p))};for(const p in this.rawOptions){const f={get:m.bind(this,p),set:c.bind(this,p)};Object.defineProperty(this.options,p,f)}}_sanitizeAndValidateOption(m,c){switch(m){case"cursorStyle":if(c||(c=s.DEFAULT_OPTIONS[m]),!function(p){return p==="block"||p==="underline"||p==="bar"}(c))throw new Error(`"${c}" is not a valid value for ${m}`);break;case"wordSeparator":c||(c=s.DEFAULT_OPTIONS[m]);break;case"fontWeight":case"fontWeightBold":if(typeof c=="number"&&1<=c&&c<=1e3)break;c=g.includes(c)?c:s.DEFAULT_OPTIONS[m];break;case"cursorWidth":c=Math.floor(c);case"lineHeight":case"tabStopWidth":if(c<1)throw new Error(`${m} cannot be less than 1, value: ${c}`);break;case"minimumContrastRatio":c=Math.max(1,Math.min(21,Math.round(10*c)/10));break;case"scrollback":if((c=Math.min(c,4294967295))<0)throw new Error(`${m} cannot be less than 0, value: ${c}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(c<=0)throw new Error(`${m} cannot be less than or equal to 0, value: ${c}`);break;case"rows":case"cols":if(!c&&c!==0)throw new Error(`${m} must be numeric, value: ${c}`);break;case"windowsPty":c=c??{}}return c}}s.OptionsService=C},2660:function(_,s,n){var a=this&&this.__decorate||function(C,b,m,c){var p,f=arguments.length,d=f<3?b:c===null?c=Object.getOwnPropertyDescriptor(b,m):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(C,b,m,c);else for(var v=C.length-1;v>=0;v--)(p=C[v])&&(d=(f<3?p(d):f>3?p(b,m,d):p(b,m))||d);return f>3&&d&&Object.defineProperty(b,m,d),d},h=this&&this.__param||function(C,b){return function(m,c){b(m,c,C)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OscLinkService=void 0;const u=n(2585);let g=class{constructor(C){this._bufferService=C,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(C){const b=this._bufferService.buffer;if(C.id===void 0){const v=b.addMarker(b.ybase+b.y),y={data:C,id:this._nextId++,lines:[v]};return v.onDispose(()=>this._removeMarkerFromLink(y,v)),this._dataByLinkId.set(y.id,y),y.id}const m=C,c=this._getEntryIdKey(m),p=this._entriesWithId.get(c);if(p)return this.addLineToLink(p.id,b.ybase+b.y),p.id;const f=b.addMarker(b.ybase+b.y),d={id:this._nextId++,key:this._getEntryIdKey(m),data:m,lines:[f]};return f.onDispose(()=>this._removeMarkerFromLink(d,f)),this._entriesWithId.set(d.key,d),this._dataByLinkId.set(d.id,d),d.id}addLineToLink(C,b){const m=this._dataByLinkId.get(C);if(m&&m.lines.every(c=>c.line!==b)){const c=this._bufferService.buffer.addMarker(b);m.lines.push(c),c.onDispose(()=>this._removeMarkerFromLink(m,c))}}getLinkData(C){var b;return(b=this._dataByLinkId.get(C))===null||b===void 0?void 0:b.data}_getEntryIdKey(C){return`${C.id};;${C.uri}`}_removeMarkerFromLink(C,b){const m=C.lines.indexOf(b);m!==-1&&(C.lines.splice(m,1),C.lines.length===0&&(C.data.id!==void 0&&this._entriesWithId.delete(C.key),this._dataByLinkId.delete(C.id)))}};g=a([h(0,u.IBufferService)],g),s.OscLinkService=g},8343:(_,s)=>{function n(a,h,u){h.di$target===h?h.di$dependencies.push({id:a,index:u}):(h.di$dependencies=[{id:a,index:u}],h.di$target=h)}Object.defineProperty(s,"__esModule",{value:!0}),s.createDecorator=s.getServiceDependencies=s.serviceRegistry=void 0,s.serviceRegistry=new Map,s.getServiceDependencies=function(a){return a.di$dependencies||[]},s.createDecorator=function(a){if(s.serviceRegistry.has(a))return s.serviceRegistry.get(a);const h=function(u,g,C){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");n(h,u,C)};return h.toString=()=>a,s.serviceRegistry.set(a,h),h}},2585:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.IDecorationService=s.IUnicodeService=s.IOscLinkService=s.IOptionsService=s.ILogService=s.LogLevelEnum=s.IInstantiationService=s.ICharsetService=s.ICoreService=s.ICoreMouseService=s.IBufferService=void 0;const a=n(8343);var h;s.IBufferService=(0,a.createDecorator)("BufferService"),s.ICoreMouseService=(0,a.createDecorator)("CoreMouseService"),s.ICoreService=(0,a.createDecorator)("CoreService"),s.ICharsetService=(0,a.createDecorator)("CharsetService"),s.IInstantiationService=(0,a.createDecorator)("InstantiationService"),(h=s.LogLevelEnum||(s.LogLevelEnum={}))[h.DEBUG=0]="DEBUG",h[h.INFO=1]="INFO",h[h.WARN=2]="WARN",h[h.ERROR=3]="ERROR",h[h.OFF=4]="OFF",s.ILogService=(0,a.createDecorator)("LogService"),s.IOptionsService=(0,a.createDecorator)("OptionsService"),s.IOscLinkService=(0,a.createDecorator)("OscLinkService"),s.IUnicodeService=(0,a.createDecorator)("UnicodeService"),s.IDecorationService=(0,a.createDecorator)("DecorationService")},1480:(_,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeService=void 0;const a=n(8460),h=n(225);s.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new a.EventEmitter,this.onChange=this._onChange.event;const u=new h.UnicodeV6;this.register(u),this._active=u.version,this._activeProvider=u}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(u){if(!this._providers[u])throw new Error(`unknown Unicode version "${u}"`);this._active=u,this._activeProvider=this._providers[u],this._onChange.fire(u)}register(u){this._providers[u.version]=u}wcwidth(u){return this._activeProvider.wcwidth(u)}getStringCellWidth(u){let g=0;const C=u.length;for(let b=0;b<C;++b){let m=u.charCodeAt(b);if(55296<=m&&m<=56319){if(++b>=C)return g+this.wcwidth(m);const c=u.charCodeAt(b);56320<=c&&c<=57343?m=1024*(m-55296)+c-56320+65536:g+=this.wcwidth(c)}g+=this.wcwidth(m)}return g}}}},i={};function o(_){var s=i[_];if(s!==void 0)return s.exports;var n=i[_]={exports:{}};return r[_].call(n.exports,n,n.exports,o),n.exports}var l={};return(()=>{var _=l;Object.defineProperty(_,"__esModule",{value:!0}),_.Terminal=void 0;const s=o(3236),n=o(9042),a=o(7975),h=o(7090),u=o(5741),g=o(8285),C=["cols","rows"];_.Terminal=class{constructor(b){this._core=new s.Terminal(b),this._addonManager=new u.AddonManager,this._publicOptions=Object.assign({},this._core.options);const m=p=>this._core.options[p],c=(p,f)=>{this._checkReadonlyOptions(p),this._core.options[p]=f};for(const p in this._core.options){const f={get:m.bind(this,p),set:c.bind(this,p)};Object.defineProperty(this._publicOptions,p,f)}}_checkReadonlyOptions(b){if(C.includes(b))throw new Error(`Option "${b}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new a.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new h.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=new g.BufferNamespaceApi(this._core)),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const b=this._core.coreService.decPrivateModes;let m="none";switch(this._core.coreMouseService.activeProtocol){case"X10":m="x10";break;case"VT200":m="vt200";break;case"DRAG":m="drag";break;case"ANY":m="any"}return{applicationCursorKeysMode:b.applicationCursorKeys,applicationKeypadMode:b.applicationKeypad,bracketedPasteMode:b.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:m,originMode:b.origin,reverseWraparoundMode:b.reverseWraparound,sendFocusMode:b.sendFocus,wraparoundMode:b.wraparound}}get options(){return this._publicOptions}set options(b){for(const m in b)this._publicOptions[m]=b[m]}blur(){this._core.blur()}focus(){this._core.focus()}resize(b,m){this._verifyIntegers(b,m),this._core.resize(b,m)}open(b){this._core.open(b)}attachCustomKeyEventHandler(b){this._core.attachCustomKeyEventHandler(b)}registerLinkProvider(b){return this._core.registerLinkProvider(b)}registerCharacterJoiner(b){return this._checkProposedApi(),this._core.registerCharacterJoiner(b)}deregisterCharacterJoiner(b){this._checkProposedApi(),this._core.deregisterCharacterJoiner(b)}registerMarker(b=0){return this._verifyIntegers(b),this._core.addMarker(b)}registerDecoration(b){var m,c,p;return this._checkProposedApi(),this._verifyPositiveIntegers((m=b.x)!==null&&m!==void 0?m:0,(c=b.width)!==null&&c!==void 0?c:0,(p=b.height)!==null&&p!==void 0?p:0),this._core.registerDecoration(b)}hasSelection(){return this._core.hasSelection()}select(b,m,c){this._verifyIntegers(b,m,c),this._core.select(b,m,c)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(b,m){this._verifyIntegers(b,m),this._core.selectLines(b,m)}dispose(){this._addonManager.dispose(),this._core.dispose()}scrollLines(b){this._verifyIntegers(b),this._core.scrollLines(b)}scrollPages(b){this._verifyIntegers(b),this._core.scrollPages(b)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(b){this._verifyIntegers(b),this._core.scrollToLine(b)}clear(){this._core.clear()}write(b,m){this._core.write(b,m)}writeln(b,m){this._core.write(b),this._core.write(`\r
`,m)}paste(b){this._core.paste(b)}refresh(b,m){this._verifyIntegers(b,m),this._core.refresh(b,m)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(b){return this._addonManager.loadAddon(this,b)}static get strings(){return n}_verifyIntegers(...b){for(const m of b)if(m===1/0||isNaN(m)||m%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...b){for(const m of b)if(m&&(m===1/0||isNaN(m)||m%1!=0||m<0))throw new Error("This API only accepts positive integers")}}})(),l})())})(xc);var qu=xc.exports,be="top",Re="bottom",De="right",Ce="left",Ci="auto",Qt=[be,Re,De,Ce],kt="start",zt="end",Mc="clippingParents",ln="viewport",$t="popper",Ic="reference",$s=Qt.reduce(function(t,e){return t.concat([e+"-"+kt,e+"-"+zt])},[]),hn=[].concat(Qt,[Ci]).reduce(function(t,e){return t.concat([e,e+"-"+kt,e+"-"+zt])},[]),Bc="beforeRead",Nc="read",$c="afterRead",Hc="beforeMain",Fc="main",jc="afterMain",Uc="beforeWrite",Wc="write",zc="afterWrite",Vc=[Bc,Nc,$c,Hc,Fc,jc,Uc,Wc,zc];function Ye(t){return t?(t.nodeName||"").toLowerCase():null}function Le(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function At(t){var e=Le(t).Element;return t instanceof e||t instanceof Element}function Pe(t){var e=Le(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function un(t){if(typeof ShadowRoot>"u")return!1;var e=Le(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function Yu(t){var e=t.state;Object.keys(e.elements).forEach(function(r){var i=e.styles[r]||{},o=e.attributes[r]||{},l=e.elements[r];!Pe(l)||!Ye(l)||(Object.assign(l.style,i),Object.keys(o).forEach(function(_){var s=o[_];s===!1?l.removeAttribute(_):l.setAttribute(_,s===!0?"":s)}))})}function Ju(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(i){var o=e.elements[i],l=e.attributes[i]||{},_=Object.keys(e.styles.hasOwnProperty(i)?e.styles[i]:r[i]),s=_.reduce(function(n,a){return n[a]="",n},{});!Pe(o)||!Ye(o)||(Object.assign(o.style,s),Object.keys(l).forEach(function(n){o.removeAttribute(n)}))})}}const dn={name:"applyStyles",enabled:!0,phase:"write",fn:Yu,effect:Ju,requires:["computeStyles"]};function Ge(t){return t.split("-")[0]}var Tt=Math.max,di=Math.min,Vt=Math.round;function Hs(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Kc(){return!/^((?!chrome|android).)*safari/i.test(Hs())}function Kt(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var i=t.getBoundingClientRect(),o=1,l=1;e&&Pe(t)&&(o=t.offsetWidth>0&&Vt(i.width)/t.offsetWidth||1,l=t.offsetHeight>0&&Vt(i.height)/t.offsetHeight||1);var _=At(t)?Le(t):window,s=_.visualViewport,n=!Kc()&&r,a=(i.left+(n&&s?s.offsetLeft:0))/o,h=(i.top+(n&&s?s.offsetTop:0))/l,u=i.width/o,g=i.height/l;return{width:u,height:g,top:h,right:a+u,bottom:h+g,left:a,x:a,y:h}}function fn(t){var e=Kt(t),r=t.offsetWidth,i=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-i)<=1&&(i=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:i}}function Gc(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&un(r)){var i=e;do{if(i&&t.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function at(t){return Le(t).getComputedStyle(t)}function Xu(t){return["table","td","th"].indexOf(Ye(t))>=0}function pt(t){return((At(t)?t.ownerDocument:t.document)||window.document).documentElement}function Ei(t){return Ye(t)==="html"?t:t.assignedSlot||t.parentNode||(un(t)?t.host:null)||pt(t)}function mo(t){return!Pe(t)||at(t).position==="fixed"?null:t.offsetParent}function Qu(t){var e=/firefox/i.test(Hs()),r=/Trident/i.test(Hs());if(r&&Pe(t)){var i=at(t);if(i.position==="fixed")return null}var o=Ei(t);for(un(o)&&(o=o.host);Pe(o)&&["html","body"].indexOf(Ye(o))<0;){var l=at(o);if(l.transform!=="none"||l.perspective!=="none"||l.contain==="paint"||["transform","perspective"].indexOf(l.willChange)!==-1||e&&l.willChange==="filter"||e&&l.filter&&l.filter!=="none")return o;o=o.parentNode}return null}function wr(t){for(var e=Le(t),r=mo(t);r&&Xu(r)&&at(r).position==="static";)r=mo(r);return r&&(Ye(r)==="html"||Ye(r)==="body"&&at(r).position==="static")?e:r||Qu(t)||e}function pn(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function mr(t,e,r){return Tt(t,di(e,r))}function Zu(t,e,r){var i=mr(t,e,r);return i>r?r:i}function qc(){return{top:0,right:0,bottom:0,left:0}}function Yc(t){return Object.assign({},qc(),t)}function Jc(t,e){return e.reduce(function(r,i){return r[i]=t,r},{})}var ed=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,Yc(typeof e!="number"?e:Jc(e,Qt))};function td(t){var e,r=t.state,i=t.name,o=t.options,l=r.elements.arrow,_=r.modifiersData.popperOffsets,s=Ge(r.placement),n=pn(s),a=[Ce,De].indexOf(s)>=0,h=a?"height":"width";if(!(!l||!_)){var u=ed(o.padding,r),g=fn(l),C=n==="y"?be:Ce,b=n==="y"?Re:De,m=r.rects.reference[h]+r.rects.reference[n]-_[n]-r.rects.popper[h],c=_[n]-r.rects.reference[n],p=wr(l),f=p?n==="y"?p.clientHeight||0:p.clientWidth||0:0,d=m/2-c/2,v=u[C],y=f-g[h]-u[b],E=f/2-g[h]/2+d,T=mr(v,E,y),S=n;r.modifiersData[i]=(e={},e[S]=T,e.centerOffset=T-E,e)}}function rd(t){var e=t.state,r=t.options,i=r.element,o=i===void 0?"[data-popper-arrow]":i;o!=null&&(typeof o=="string"&&(o=e.elements.popper.querySelector(o),!o)||Gc(e.elements.popper,o)&&(e.elements.arrow=o))}const Xc={name:"arrow",enabled:!0,phase:"main",fn:td,effect:rd,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Gt(t){return t.split("-")[1]}var id={top:"auto",right:"auto",bottom:"auto",left:"auto"};function sd(t,e){var r=t.x,i=t.y,o=e.devicePixelRatio||1;return{x:Vt(r*o)/o||0,y:Vt(i*o)/o||0}}function vo(t){var e,r=t.popper,i=t.popperRect,o=t.placement,l=t.variation,_=t.offsets,s=t.position,n=t.gpuAcceleration,a=t.adaptive,h=t.roundOffsets,u=t.isFixed,g=_.x,C=g===void 0?0:g,b=_.y,m=b===void 0?0:b,c=typeof h=="function"?h({x:C,y:m}):{x:C,y:m};C=c.x,m=c.y;var p=_.hasOwnProperty("x"),f=_.hasOwnProperty("y"),d=Ce,v=be,y=window;if(a){var E=wr(r),T="clientHeight",S="clientWidth";if(E===Le(r)&&(E=pt(r),at(E).position!=="static"&&s==="absolute"&&(T="scrollHeight",S="scrollWidth")),E=E,o===be||(o===Ce||o===De)&&l===zt){v=Re;var w=u&&E===y&&y.visualViewport?y.visualViewport.height:E[T];m-=w-i.height,m*=n?1:-1}if(o===Ce||(o===be||o===Re)&&l===zt){d=De;var A=u&&E===y&&y.visualViewport?y.visualViewport.width:E[S];C-=A-i.width,C*=n?1:-1}}var D=Object.assign({position:s},a&&id),R=h===!0?sd({x:C,y:m},Le(r)):{x:C,y:m};if(C=R.x,m=R.y,n){var x;return Object.assign({},D,(x={},x[v]=f?"0":"",x[d]=p?"0":"",x.transform=(y.devicePixelRatio||1)<=1?"translate("+C+"px, "+m+"px)":"translate3d("+C+"px, "+m+"px, 0)",x))}return Object.assign({},D,(e={},e[v]=f?m+"px":"",e[d]=p?C+"px":"",e.transform="",e))}function nd(t){var e=t.state,r=t.options,i=r.gpuAcceleration,o=i===void 0?!0:i,l=r.adaptive,_=l===void 0?!0:l,s=r.roundOffsets,n=s===void 0?!0:s,a={placement:Ge(e.placement),variation:Gt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:o,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,vo(Object.assign({},a,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:_,roundOffsets:n})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,vo(Object.assign({},a,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:n})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const _n={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:nd,data:{}};var Hr={passive:!0};function od(t){var e=t.state,r=t.instance,i=t.options,o=i.scroll,l=o===void 0?!0:o,_=i.resize,s=_===void 0?!0:_,n=Le(e.elements.popper),a=[].concat(e.scrollParents.reference,e.scrollParents.popper);return l&&a.forEach(function(h){h.addEventListener("scroll",r.update,Hr)}),s&&n.addEventListener("resize",r.update,Hr),function(){l&&a.forEach(function(h){h.removeEventListener("scroll",r.update,Hr)}),s&&n.removeEventListener("resize",r.update,Hr)}}const gn={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:od,data:{}};var ad={left:"right",right:"left",bottom:"top",top:"bottom"};function Qr(t){return t.replace(/left|right|bottom|top/g,function(e){return ad[e]})}var cd={start:"end",end:"start"};function yo(t){return t.replace(/start|end/g,function(e){return cd[e]})}function mn(t){var e=Le(t),r=e.pageXOffset,i=e.pageYOffset;return{scrollLeft:r,scrollTop:i}}function vn(t){return Kt(pt(t)).left+mn(t).scrollLeft}function ld(t,e){var r=Le(t),i=pt(t),o=r.visualViewport,l=i.clientWidth,_=i.clientHeight,s=0,n=0;if(o){l=o.width,_=o.height;var a=Kc();(a||!a&&e==="fixed")&&(s=o.offsetLeft,n=o.offsetTop)}return{width:l,height:_,x:s+vn(t),y:n}}function hd(t){var e,r=pt(t),i=mn(t),o=(e=t.ownerDocument)==null?void 0:e.body,l=Tt(r.scrollWidth,r.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),_=Tt(r.scrollHeight,r.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),s=-i.scrollLeft+vn(t),n=-i.scrollTop;return at(o||r).direction==="rtl"&&(s+=Tt(r.clientWidth,o?o.clientWidth:0)-l),{width:l,height:_,x:s,y:n}}function yn(t){var e=at(t),r=e.overflow,i=e.overflowX,o=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+o+i)}function Qc(t){return["html","body","#document"].indexOf(Ye(t))>=0?t.ownerDocument.body:Pe(t)&&yn(t)?t:Qc(Ei(t))}function vr(t,e){var r;e===void 0&&(e=[]);var i=Qc(t),o=i===((r=t.ownerDocument)==null?void 0:r.body),l=Le(i),_=o?[l].concat(l.visualViewport||[],yn(i)?i:[]):i,s=e.concat(_);return o?s:s.concat(vr(Ei(_)))}function Fs(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function ud(t,e){var r=Kt(t,!1,e==="fixed");return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function So(t,e,r){return e===ln?Fs(ld(t,r)):At(e)?ud(e,r):Fs(hd(pt(t)))}function dd(t){var e=vr(Ei(t)),r=["absolute","fixed"].indexOf(at(t).position)>=0,i=r&&Pe(t)?wr(t):t;return At(i)?e.filter(function(o){return At(o)&&Gc(o,i)&&Ye(o)!=="body"}):[]}function fd(t,e,r,i){var o=e==="clippingParents"?dd(t):[].concat(e),l=[].concat(o,[r]),_=l[0],s=l.reduce(function(n,a){var h=So(t,a,i);return n.top=Tt(h.top,n.top),n.right=di(h.right,n.right),n.bottom=di(h.bottom,n.bottom),n.left=Tt(h.left,n.left),n},So(t,_,i));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function Zc(t){var e=t.reference,r=t.element,i=t.placement,o=i?Ge(i):null,l=i?Gt(i):null,_=e.x+e.width/2-r.width/2,s=e.y+e.height/2-r.height/2,n;switch(o){case be:n={x:_,y:e.y-r.height};break;case Re:n={x:_,y:e.y+e.height};break;case De:n={x:e.x+e.width,y:s};break;case Ce:n={x:e.x-r.width,y:s};break;default:n={x:e.x,y:e.y}}var a=o?pn(o):null;if(a!=null){var h=a==="y"?"height":"width";switch(l){case kt:n[a]=n[a]-(e[h]/2-r[h]/2);break;case zt:n[a]=n[a]+(e[h]/2-r[h]/2);break}}return n}function qt(t,e){e===void 0&&(e={});var r=e,i=r.placement,o=i===void 0?t.placement:i,l=r.strategy,_=l===void 0?t.strategy:l,s=r.boundary,n=s===void 0?Mc:s,a=r.rootBoundary,h=a===void 0?ln:a,u=r.elementContext,g=u===void 0?$t:u,C=r.altBoundary,b=C===void 0?!1:C,m=r.padding,c=m===void 0?0:m,p=Yc(typeof c!="number"?c:Jc(c,Qt)),f=g===$t?Ic:$t,d=t.rects.popper,v=t.elements[b?f:g],y=fd(At(v)?v:v.contextElement||pt(t.elements.popper),n,h,_),E=Kt(t.elements.reference),T=Zc({reference:E,element:d,strategy:"absolute",placement:o}),S=Fs(Object.assign({},d,T)),w=g===$t?S:E,A={top:y.top-w.top+p.top,bottom:w.bottom-y.bottom+p.bottom,left:y.left-w.left+p.left,right:w.right-y.right+p.right},D=t.modifiersData.offset;if(g===$t&&D){var R=D[o];Object.keys(A).forEach(function(x){var F=[De,Re].indexOf(x)>=0?1:-1,G=[be,Re].indexOf(x)>=0?"y":"x";A[x]+=R[G]*F})}return A}function pd(t,e){e===void 0&&(e={});var r=e,i=r.placement,o=r.boundary,l=r.rootBoundary,_=r.padding,s=r.flipVariations,n=r.allowedAutoPlacements,a=n===void 0?hn:n,h=Gt(i),u=h?s?$s:$s.filter(function(b){return Gt(b)===h}):Qt,g=u.filter(function(b){return a.indexOf(b)>=0});g.length===0&&(g=u);var C=g.reduce(function(b,m){return b[m]=qt(t,{placement:m,boundary:o,rootBoundary:l,padding:_})[Ge(m)],b},{});return Object.keys(C).sort(function(b,m){return C[b]-C[m]})}function _d(t){if(Ge(t)===Ci)return[];var e=Qr(t);return[yo(t),e,yo(e)]}function gd(t){var e=t.state,r=t.options,i=t.name;if(!e.modifiersData[i]._skip){for(var o=r.mainAxis,l=o===void 0?!0:o,_=r.altAxis,s=_===void 0?!0:_,n=r.fallbackPlacements,a=r.padding,h=r.boundary,u=r.rootBoundary,g=r.altBoundary,C=r.flipVariations,b=C===void 0?!0:C,m=r.allowedAutoPlacements,c=e.options.placement,p=Ge(c),f=p===c,d=n||(f||!b?[Qr(c)]:_d(c)),v=[c].concat(d).reduce(function(W,q){return W.concat(Ge(q)===Ci?pd(e,{placement:q,boundary:h,rootBoundary:u,padding:a,flipVariations:b,allowedAutoPlacements:m}):q)},[]),y=e.rects.reference,E=e.rects.popper,T=new Map,S=!0,w=v[0],A=0;A<v.length;A++){var D=v[A],R=Ge(D),x=Gt(D)===kt,F=[be,Re].indexOf(R)>=0,G=F?"width":"height",U=qt(e,{placement:D,boundary:h,rootBoundary:u,altBoundary:g,padding:a}),k=F?x?De:Ce:x?Re:be;y[G]>E[G]&&(k=Qr(k));var L=Qr(k),O=[];if(l&&O.push(U[R]<=0),s&&O.push(U[k]<=0,U[L]<=0),O.every(function(W){return W})){w=D,S=!1;break}T.set(D,O)}if(S)for(var I=b?3:1,H=function(q){var M=v.find(function(P){var N=T.get(P);if(N)return N.slice(0,q).every(function(j){return j})});if(M)return w=M,"break"},X=I;X>0;X--){var Q=H(X);if(Q==="break")break}e.placement!==w&&(e.modifiersData[i]._skip=!0,e.placement=w,e.reset=!0)}}const el={name:"flip",enabled:!0,phase:"main",fn:gd,requiresIfExists:["offset"],data:{_skip:!1}};function bo(t,e,r){return r===void 0&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function Co(t){return[be,De,Re,Ce].some(function(e){return t[e]>=0})}function md(t){var e=t.state,r=t.name,i=e.rects.reference,o=e.rects.popper,l=e.modifiersData.preventOverflow,_=qt(e,{elementContext:"reference"}),s=qt(e,{altBoundary:!0}),n=bo(_,i),a=bo(s,o,l),h=Co(n),u=Co(a);e.modifiersData[r]={referenceClippingOffsets:n,popperEscapeOffsets:a,isReferenceHidden:h,hasPopperEscaped:u},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":u})}const tl={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:md};function vd(t,e,r){var i=Ge(t),o=[Ce,be].indexOf(i)>=0?-1:1,l=typeof r=="function"?r(Object.assign({},e,{placement:t})):r,_=l[0],s=l[1];return _=_||0,s=(s||0)*o,[Ce,De].indexOf(i)>=0?{x:s,y:_}:{x:_,y:s}}function yd(t){var e=t.state,r=t.options,i=t.name,o=r.offset,l=o===void 0?[0,0]:o,_=hn.reduce(function(h,u){return h[u]=vd(u,e.rects,l),h},{}),s=_[e.placement],n=s.x,a=s.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=n,e.modifiersData.popperOffsets.y+=a),e.modifiersData[i]=_}const rl={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:yd};function Sd(t){var e=t.state,r=t.name;e.modifiersData[r]=Zc({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const Sn={name:"popperOffsets",enabled:!0,phase:"read",fn:Sd,data:{}};function bd(t){return t==="x"?"y":"x"}function Cd(t){var e=t.state,r=t.options,i=t.name,o=r.mainAxis,l=o===void 0?!0:o,_=r.altAxis,s=_===void 0?!1:_,n=r.boundary,a=r.rootBoundary,h=r.altBoundary,u=r.padding,g=r.tether,C=g===void 0?!0:g,b=r.tetherOffset,m=b===void 0?0:b,c=qt(e,{boundary:n,rootBoundary:a,padding:u,altBoundary:h}),p=Ge(e.placement),f=Gt(e.placement),d=!f,v=pn(p),y=bd(v),E=e.modifiersData.popperOffsets,T=e.rects.reference,S=e.rects.popper,w=typeof m=="function"?m(Object.assign({},e.rects,{placement:e.placement})):m,A=typeof w=="number"?{mainAxis:w,altAxis:w}:Object.assign({mainAxis:0,altAxis:0},w),D=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,R={x:0,y:0};if(E){if(l){var x,F=v==="y"?be:Ce,G=v==="y"?Re:De,U=v==="y"?"height":"width",k=E[v],L=k+c[F],O=k-c[G],I=C?-S[U]/2:0,H=f===kt?T[U]:S[U],X=f===kt?-S[U]:-T[U],Q=e.elements.arrow,W=C&&Q?fn(Q):{width:0,height:0},q=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:qc(),M=q[F],P=q[G],N=mr(0,T[U],W[U]),j=d?T[U]/2-I-N-M-A.mainAxis:H-N-M-A.mainAxis,K=d?-T[U]/2+I+N+P+A.mainAxis:X+N+P+A.mainAxis,se=e.elements.arrow&&wr(e.elements.arrow),Y=se?v==="y"?se.clientTop||0:se.clientLeft||0:0,ce=(x=D==null?void 0:D[v])!=null?x:0,le=k+j-ce-Y,he=k+K-ce,ne=mr(C?di(L,le):L,k,C?Tt(O,he):O);E[v]=ne,R[v]=ne-k}if(s){var mt,Lr=v==="x"?be:Ce,Li=v==="x"?Re:De,$e=E[y],We=y==="y"?"height":"width",Xe=$e+c[Lr],Qe=$e-c[Li],Lt=[be,Ce].indexOf(p)!==-1,tr=(mt=D==null?void 0:D[y])!=null?mt:0,rr=Lt?Xe:$e-T[We]-S[We]-tr+A.altAxis,Ot=Lt?$e+T[We]+S[We]-tr-A.altAxis:Qe,ir=C&&Lt?Zu(rr,$e,Ot):mr(C?rr:Xe,$e,C?Ot:Qe);E[y]=ir,R[y]=ir-$e}e.modifiersData[i]=R}}const il={name:"preventOverflow",enabled:!0,phase:"main",fn:Cd,requiresIfExists:["offset"]};function Ed(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Td(t){return t===Le(t)||!Pe(t)?mn(t):Ed(t)}function wd(t){var e=t.getBoundingClientRect(),r=Vt(e.width)/t.offsetWidth||1,i=Vt(e.height)/t.offsetHeight||1;return r!==1||i!==1}function kd(t,e,r){r===void 0&&(r=!1);var i=Pe(e),o=Pe(e)&&wd(e),l=pt(e),_=Kt(t,o,r),s={scrollLeft:0,scrollTop:0},n={x:0,y:0};return(i||!i&&!r)&&((Ye(e)!=="body"||yn(l))&&(s=Td(e)),Pe(e)?(n=Kt(e,!0),n.x+=e.clientLeft,n.y+=e.clientTop):l&&(n.x=vn(l))),{x:_.left+s.scrollLeft-n.x,y:_.top+s.scrollTop-n.y,width:_.width,height:_.height}}function Ad(t){var e=new Map,r=new Set,i=[];t.forEach(function(l){e.set(l.name,l)});function o(l){r.add(l.name);var _=[].concat(l.requires||[],l.requiresIfExists||[]);_.forEach(function(s){if(!r.has(s)){var n=e.get(s);n&&o(n)}}),i.push(l)}return t.forEach(function(l){r.has(l.name)||o(l)}),i}function Rd(t){var e=Ad(t);return Vc.reduce(function(r,i){return r.concat(e.filter(function(o){return o.phase===i}))},[])}function Dd(t){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(t())})})),e}}function Ld(t){var e=t.reduce(function(r,i){var o=r[i.name];return r[i.name]=o?Object.assign({},o,i,{options:Object.assign({},o.options,i.options),data:Object.assign({},o.data,i.data)}):i,r},{});return Object.keys(e).map(function(r){return e[r]})}var Eo={placement:"bottom",modifiers:[],strategy:"absolute"};function To(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function Ti(t){t===void 0&&(t={});var e=t,r=e.defaultModifiers,i=r===void 0?[]:r,o=e.defaultOptions,l=o===void 0?Eo:o;return function(s,n,a){a===void 0&&(a=l);var h={placement:"bottom",orderedModifiers:[],options:Object.assign({},Eo,l),modifiersData:{},elements:{reference:s,popper:n},attributes:{},styles:{}},u=[],g=!1,C={state:h,setOptions:function(p){var f=typeof p=="function"?p(h.options):p;m(),h.options=Object.assign({},l,h.options,f),h.scrollParents={reference:At(s)?vr(s):s.contextElement?vr(s.contextElement):[],popper:vr(n)};var d=Rd(Ld([].concat(i,h.options.modifiers)));return h.orderedModifiers=d.filter(function(v){return v.enabled}),b(),C.update()},forceUpdate:function(){if(!g){var p=h.elements,f=p.reference,d=p.popper;if(To(f,d)){h.rects={reference:kd(f,wr(d),h.options.strategy==="fixed"),popper:fn(d)},h.reset=!1,h.placement=h.options.placement,h.orderedModifiers.forEach(function(A){return h.modifiersData[A.name]=Object.assign({},A.data)});for(var v=0;v<h.orderedModifiers.length;v++){if(h.reset===!0){h.reset=!1,v=-1;continue}var y=h.orderedModifiers[v],E=y.fn,T=y.options,S=T===void 0?{}:T,w=y.name;typeof E=="function"&&(h=E({state:h,options:S,name:w,instance:C})||h)}}}},update:Dd(function(){return new Promise(function(c){C.forceUpdate(),c(h)})}),destroy:function(){m(),g=!0}};if(!To(s,n))return C;C.setOptions(a).then(function(c){!g&&a.onFirstUpdate&&a.onFirstUpdate(c)});function b(){h.orderedModifiers.forEach(function(c){var p=c.name,f=c.options,d=f===void 0?{}:f,v=c.effect;if(typeof v=="function"){var y=v({state:h,name:p,instance:C,options:d}),E=function(){};u.push(y||E)}})}function m(){u.forEach(function(c){return c()}),u=[]}return C}}var Od=Ti(),xd=[gn,Sn,_n,dn],Pd=Ti({defaultModifiers:xd}),Md=[gn,Sn,_n,dn,rl,el,il,Xc,tl],bn=Ti({defaultModifiers:Md});const sl=Object.freeze(Object.defineProperty({__proto__:null,afterMain:jc,afterRead:$c,afterWrite:zc,applyStyles:dn,arrow:Xc,auto:Ci,basePlacements:Qt,beforeMain:Hc,beforeRead:Bc,beforeWrite:Uc,bottom:Re,clippingParents:Mc,computeStyles:_n,createPopper:bn,createPopperBase:Od,createPopperLite:Pd,detectOverflow:qt,end:zt,eventListeners:gn,flip:el,hide:tl,left:Ce,main:Fc,modifierPhases:Vc,offset:rl,placements:hn,popper:$t,popperGenerator:Ti,popperOffsets:Sn,preventOverflow:il,read:Nc,reference:Ic,right:De,start:kt,top:be,variationPlacements:$s,viewport:ln,write:Wc},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.3.0 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const lt=new Map,zi={set(t,e,r){lt.has(t)||lt.set(t,new Map);const i=lt.get(t);if(!i.has(e)&&i.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(i.keys())[0]}.`);return}i.set(e,r)},get(t,e){return lt.has(t)&&lt.get(t).get(e)||null},remove(t,e){if(!lt.has(t))return;const r=lt.get(t);r.delete(e),r.size===0&&lt.delete(t)}},Id=1e6,Bd=1e3,js="transitionend",nl=t=>(t&&window.CSS&&window.CSS.escape&&(t=t.replace(/#([^\s"#']+)/g,(e,r)=>`#${CSS.escape(r)}`)),t),Nd=t=>t==null?`${t}`:Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase(),$d=t=>{do t+=Math.floor(Math.random()*Id);while(document.getElementById(t));return t},Hd=t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:r}=window.getComputedStyle(t);const i=Number.parseFloat(e),o=Number.parseFloat(r);return!i&&!o?0:(e=e.split(",")[0],r=r.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(r))*Bd)},ol=t=>{t.dispatchEvent(new Event(js))},st=t=>!t||typeof t!="object"?!1:(typeof t.jquery<"u"&&(t=t[0]),typeof t.nodeType<"u"),ut=t=>st(t)?t.jquery?t[0]:t:typeof t=="string"&&t.length>0?document.querySelector(nl(t)):null,Zt=t=>{if(!st(t)||t.getClientRects().length===0)return!1;const e=getComputedStyle(t).getPropertyValue("visibility")==="visible",r=t.closest("details:not([open])");if(!r)return e;if(r!==t){const i=t.closest("summary");if(i&&i.parentNode!==r||i===null)return!1}return e},dt=t=>!t||t.nodeType!==Node.ELEMENT_NODE||t.classList.contains("disabled")?!0:typeof t.disabled<"u"?t.disabled:t.hasAttribute("disabled")&&t.getAttribute("disabled")!=="false",al=t=>{if(!document.documentElement.attachShadow)return null;if(typeof t.getRootNode=="function"){const e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?al(t.parentNode):null},fi=()=>{},kr=t=>{t.offsetHeight},cl=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Vi=[],Fd=t=>{document.readyState==="loading"?(Vi.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Vi)e()}),Vi.push(t)):t()},Me=()=>document.documentElement.dir==="rtl",Ne=t=>{Fd(()=>{const e=cl();if(e){const r=t.NAME,i=e.fn[r];e.fn[r]=t.jQueryInterface,e.fn[r].Constructor=t,e.fn[r].noConflict=()=>(e.fn[r]=i,t.jQueryInterface)}})},ke=(t,e=[],r=t)=>typeof t=="function"?t(...e):r,ll=(t,e,r=!0)=>{if(!r){ke(t);return}const i=5,o=Hd(e)+i;let l=!1;const _=({target:s})=>{s===e&&(l=!0,e.removeEventListener(js,_),ke(t))};e.addEventListener(js,_),setTimeout(()=>{l||ol(e)},o)},Cn=(t,e,r,i)=>{const o=t.length;let l=t.indexOf(e);return l===-1?!r&&i?t[o-1]:t[0]:(l+=r?1:-1,i&&(l=(l+o)%o),t[Math.max(0,Math.min(l,o-1))])},jd=/[^.]*(?=\..*)\.|.*/,Ud=/\..*/,Wd=/::\d+$/,Ki={};let wo=1;const hl={mouseenter:"mouseover",mouseleave:"mouseout"},zd=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ul(t,e){return e&&`${e}::${wo++}`||t.uidEvent||wo++}function dl(t){const e=ul(t);return t.uidEvent=e,Ki[e]=Ki[e]||{},Ki[e]}function Vd(t,e){return function r(i){return En(i,{delegateTarget:t}),r.oneOff&&z.off(t,i.type,e),e.apply(t,[i])}}function Kd(t,e,r){return function i(o){const l=t.querySelectorAll(e);for(let{target:_}=o;_&&_!==this;_=_.parentNode)for(const s of l)if(s===_)return En(o,{delegateTarget:_}),i.oneOff&&z.off(t,o.type,e,r),r.apply(_,[o])}}function fl(t,e,r=null){return Object.values(t).find(i=>i.callable===e&&i.delegationSelector===r)}function pl(t,e,r){const i=typeof e=="string",o=i?r:e||r;let l=_l(t);return zd.has(l)||(l=t),[i,o,l]}function ko(t,e,r,i,o){if(typeof e!="string"||!t)return;let[l,_,s]=pl(e,r,i);e in hl&&(_=(b=>function(m){if(!m.relatedTarget||m.relatedTarget!==m.delegateTarget&&!m.delegateTarget.contains(m.relatedTarget))return b.call(this,m)})(_));const n=dl(t),a=n[s]||(n[s]={}),h=fl(a,_,l?r:null);if(h){h.oneOff=h.oneOff&&o;return}const u=ul(_,e.replace(jd,"")),g=l?Kd(t,r,_):Vd(t,_);g.delegationSelector=l?r:null,g.callable=_,g.oneOff=o,g.uidEvent=u,a[u]=g,t.addEventListener(s,g,l)}function Us(t,e,r,i,o){const l=fl(e[r],i,o);l&&(t.removeEventListener(r,l,!!o),delete e[r][l.uidEvent])}function Gd(t,e,r,i){const o=e[r]||{};for(const[l,_]of Object.entries(o))l.includes(i)&&Us(t,e,r,_.callable,_.delegationSelector)}function _l(t){return t=t.replace(Ud,""),hl[t]||t}const z={on(t,e,r,i){ko(t,e,r,i,!1)},one(t,e,r,i){ko(t,e,r,i,!0)},off(t,e,r,i){if(typeof e!="string"||!t)return;const[o,l,_]=pl(e,r,i),s=_!==e,n=dl(t),a=n[_]||{},h=e.startsWith(".");if(typeof l<"u"){if(!Object.keys(a).length)return;Us(t,n,_,l,o?r:null);return}if(h)for(const u of Object.keys(n))Gd(t,n,u,e.slice(1));for(const[u,g]of Object.entries(a)){const C=u.replace(Wd,"");(!s||e.includes(C))&&Us(t,n,_,g.callable,g.delegationSelector)}},trigger(t,e,r){if(typeof e!="string"||!t)return null;const i=cl(),o=_l(e),l=e!==o;let _=null,s=!0,n=!0,a=!1;l&&i&&(_=i.Event(e,r),i(t).trigger(_),s=!_.isPropagationStopped(),n=!_.isImmediatePropagationStopped(),a=_.isDefaultPrevented());const h=En(new Event(e,{bubbles:s,cancelable:!0}),r);return a&&h.preventDefault(),n&&t.dispatchEvent(h),h.defaultPrevented&&_&&_.preventDefault(),h}};function En(t,e={}){for(const[r,i]of Object.entries(e))try{t[r]=i}catch{Object.defineProperty(t,r,{configurable:!0,get(){return i}})}return t}function Ao(t){if(t==="true")return!0;if(t==="false")return!1;if(t===Number(t).toString())return Number(t);if(t===""||t==="null")return null;if(typeof t!="string")return t;try{return JSON.parse(decodeURIComponent(t))}catch{return t}}function Gi(t){return t.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const nt={setDataAttribute(t,e,r){t.setAttribute(`data-bs-${Gi(e)}`,r)},removeDataAttribute(t,e){t.removeAttribute(`data-bs-${Gi(e)}`)},getDataAttributes(t){if(!t)return{};const e={},r=Object.keys(t.dataset).filter(i=>i.startsWith("bs")&&!i.startsWith("bsConfig"));for(const i of r){let o=i.replace(/^bs/,"");o=o.charAt(0).toLowerCase()+o.slice(1,o.length),e[o]=Ao(t.dataset[i])}return e},getDataAttribute(t,e){return Ao(t.getAttribute(`data-bs-${Gi(e)}`))}};class Ar{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,r){const i=st(r)?nt.getDataAttribute(r,"config"):{};return{...this.constructor.Default,...typeof i=="object"?i:{},...st(r)?nt.getDataAttributes(r):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,r=this.constructor.DefaultType){for(const[i,o]of Object.entries(r)){const l=e[i],_=st(l)?"element":Nd(l);if(!new RegExp(o).test(_))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${i}" provided type "${_}" but expected type "${o}".`)}}}const qd="5.3.0";class Ue extends Ar{constructor(e,r){super(),e=ut(e),e&&(this._element=e,this._config=this._getConfig(r),zi.set(this._element,this.constructor.DATA_KEY,this))}dispose(){zi.remove(this._element,this.constructor.DATA_KEY),z.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,r,i=!0){ll(e,r,i)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return zi.get(ut(e),this.DATA_KEY)}static getOrCreateInstance(e,r={}){return this.getInstance(e)||new this(e,typeof r=="object"?r:null)}static get VERSION(){return qd}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const qi=t=>{let e=t.getAttribute("data-bs-target");if(!e||e==="#"){let r=t.getAttribute("href");if(!r||!r.includes("#")&&!r.startsWith("."))return null;r.includes("#")&&!r.startsWith("#")&&(r=`#${r.split("#")[1]}`),e=r&&r!=="#"?r.trim():null}return nl(e)},te={find(t,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,t))},findOne(t,e=document.documentElement){return Element.prototype.querySelector.call(e,t)},children(t,e){return[].concat(...t.children).filter(r=>r.matches(e))},parents(t,e){const r=[];let i=t.parentNode.closest(e);for(;i;)r.push(i),i=i.parentNode.closest(e);return r},prev(t,e){let r=t.previousElementSibling;for(;r;){if(r.matches(e))return[r];r=r.previousElementSibling}return[]},next(t,e){let r=t.nextElementSibling;for(;r;){if(r.matches(e))return[r];r=r.nextElementSibling}return[]},focusableChildren(t){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(r=>`${r}:not([tabindex^="-"])`).join(",");return this.find(e,t).filter(r=>!dt(r)&&Zt(r))},getSelectorFromElement(t){const e=qi(t);return e&&te.findOne(e)?e:null},getElementFromSelector(t){const e=qi(t);return e?te.findOne(e):null},getMultipleElementsFromSelector(t){const e=qi(t);return e?te.find(e):[]}},wi=(t,e="hide")=>{const r=`click.dismiss${t.EVENT_KEY}`,i=t.NAME;z.on(document,r,`[data-bs-dismiss="${i}"]`,function(o){if(["A","AREA"].includes(this.tagName)&&o.preventDefault(),dt(this))return;const l=te.getElementFromSelector(this)||this.closest(`.${i}`);t.getOrCreateInstance(l)[e]()})},Yd="alert",Jd="bs.alert",gl=`.${Jd}`,Xd=`close${gl}`,Qd=`closed${gl}`,Zd="fade",ef="show";class ki extends Ue{static get NAME(){return Yd}close(){if(z.trigger(this._element,Xd).defaultPrevented)return;this._element.classList.remove(ef);const r=this._element.classList.contains(Zd);this._queueCallback(()=>this._destroyElement(),this._element,r)}_destroyElement(){this._element.remove(),z.trigger(this._element,Qd),this.dispose()}static jQueryInterface(e){return this.each(function(){const r=ki.getOrCreateInstance(this);if(typeof e=="string"){if(r[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);r[e](this)}})}}wi(ki,"close");Ne(ki);const tf="button",rf="bs.button",sf=`.${rf}`,nf=".data-api",of="active",Ro='[data-bs-toggle="button"]',af=`click${sf}${nf}`;class Ai extends Ue{static get NAME(){return tf}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(of))}static jQueryInterface(e){return this.each(function(){const r=Ai.getOrCreateInstance(this);e==="toggle"&&r[e]()})}}z.on(document,af,Ro,t=>{t.preventDefault();const e=t.target.closest(Ro);Ai.getOrCreateInstance(e).toggle()});Ne(Ai);const cf="swipe",er=".bs.swipe",lf=`touchstart${er}`,hf=`touchmove${er}`,uf=`touchend${er}`,df=`pointerdown${er}`,ff=`pointerup${er}`,pf="touch",_f="pen",gf="pointer-event",mf=40,vf={endCallback:null,leftCallback:null,rightCallback:null},yf={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class pi extends Ar{constructor(e,r){super(),this._element=e,!(!e||!pi.isSupported())&&(this._config=this._getConfig(r),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return vf}static get DefaultType(){return yf}static get NAME(){return cf}dispose(){z.off(this._element,er)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),ke(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=mf)return;const r=e/this._deltaX;this._deltaX=0,r&&ke(r>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(z.on(this._element,df,e=>this._start(e)),z.on(this._element,ff,e=>this._end(e)),this._element.classList.add(gf)):(z.on(this._element,lf,e=>this._start(e)),z.on(this._element,hf,e=>this._move(e)),z.on(this._element,uf,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===_f||e.pointerType===pf)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Sf="carousel",bf="bs.carousel",_t=`.${bf}`,ml=".data-api",Cf="ArrowLeft",Ef="ArrowRight",Tf=500,ar="next",It="prev",Ht="left",Zr="right",wf=`slide${_t}`,Yi=`slid${_t}`,kf=`keydown${_t}`,Af=`mouseenter${_t}`,Rf=`mouseleave${_t}`,Df=`dragstart${_t}`,Lf=`load${_t}${ml}`,Of=`click${_t}${ml}`,vl="carousel",Fr="active",xf="slide",Pf="carousel-item-end",Mf="carousel-item-start",If="carousel-item-next",Bf="carousel-item-prev",yl=".active",Sl=".carousel-item",Nf=yl+Sl,$f=".carousel-item img",Hf=".carousel-indicators",Ff="[data-bs-slide], [data-bs-slide-to]",jf='[data-bs-ride="carousel"]',Uf={[Cf]:Zr,[Ef]:Ht},Wf={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},zf={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Rr extends Ue{constructor(e,r){super(e,r),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=te.findOne(Hf,this._element),this._addEventListeners(),this._config.ride===vl&&this.cycle()}static get Default(){return Wf}static get DefaultType(){return zf}static get NAME(){return Sf}next(){this._slide(ar)}nextWhenVisible(){!document.hidden&&Zt(this._element)&&this.next()}prev(){this._slide(It)}pause(){this._isSliding&&ol(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){z.one(this._element,Yi,()=>this.cycle());return}this.cycle()}}to(e){const r=this._getItems();if(e>r.length-1||e<0)return;if(this._isSliding){z.one(this._element,Yi,()=>this.to(e));return}const i=this._getItemIndex(this._getActive());if(i===e)return;const o=e>i?ar:It;this._slide(o,r[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&z.on(this._element,kf,e=>this._keydown(e)),this._config.pause==="hover"&&(z.on(this._element,Af,()=>this.pause()),z.on(this._element,Rf,()=>this._maybeEnableCycle())),this._config.touch&&pi.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const i of te.find($f,this._element))z.on(i,Df,o=>o.preventDefault());const r={leftCallback:()=>this._slide(this._directionToOrder(Ht)),rightCallback:()=>this._slide(this._directionToOrder(Zr)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),Tf+this._config.interval))}};this._swipeHelper=new pi(this._element,r)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const r=Uf[e.key];r&&(e.preventDefault(),this._slide(this._directionToOrder(r)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const r=te.findOne(yl,this._indicatorsElement);r.classList.remove(Fr),r.removeAttribute("aria-current");const i=te.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);i&&(i.classList.add(Fr),i.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const r=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=r||this._config.defaultInterval}_slide(e,r=null){if(this._isSliding)return;const i=this._getActive(),o=e===ar,l=r||Cn(this._getItems(),i,o,this._config.wrap);if(l===i)return;const _=this._getItemIndex(l),s=C=>z.trigger(this._element,C,{relatedTarget:l,direction:this._orderToDirection(e),from:this._getItemIndex(i),to:_});if(s(wf).defaultPrevented||!i||!l)return;const a=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(_),this._activeElement=l;const h=o?Mf:Pf,u=o?If:Bf;l.classList.add(u),kr(l),i.classList.add(h),l.classList.add(h);const g=()=>{l.classList.remove(h,u),l.classList.add(Fr),i.classList.remove(Fr,u,h),this._isSliding=!1,s(Yi)};this._queueCallback(g,i,this._isAnimated()),a&&this.cycle()}_isAnimated(){return this._element.classList.contains(xf)}_getActive(){return te.findOne(Nf,this._element)}_getItems(){return te.find(Sl,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Me()?e===Ht?It:ar:e===Ht?ar:It}_orderToDirection(e){return Me()?e===It?Ht:Zr:e===It?Zr:Ht}static jQueryInterface(e){return this.each(function(){const r=Rr.getOrCreateInstance(this,e);if(typeof e=="number"){r.to(e);return}if(typeof e=="string"){if(r[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);r[e]()}})}}z.on(document,Of,Ff,function(t){const e=te.getElementFromSelector(this);if(!e||!e.classList.contains(vl))return;t.preventDefault();const r=Rr.getOrCreateInstance(e),i=this.getAttribute("data-bs-slide-to");if(i){r.to(i),r._maybeEnableCycle();return}if(nt.getDataAttribute(this,"slide")==="next"){r.next(),r._maybeEnableCycle();return}r.prev(),r._maybeEnableCycle()});z.on(window,Lf,()=>{const t=te.find(jf);for(const e of t)Rr.getOrCreateInstance(e)});Ne(Rr);const Vf="collapse",Kf="bs.collapse",Dr=`.${Kf}`,Gf=".data-api",qf=`show${Dr}`,Yf=`shown${Dr}`,Jf=`hide${Dr}`,Xf=`hidden${Dr}`,Qf=`click${Dr}${Gf}`,Ji="show",jt="collapse",jr="collapsing",Zf="collapsed",ep=`:scope .${jt} .${jt}`,tp="collapse-horizontal",rp="width",ip="height",sp=".collapse.show, .collapse.collapsing",Ws='[data-bs-toggle="collapse"]',np={parent:null,toggle:!0},op={parent:"(null|element)",toggle:"boolean"};class br extends Ue{constructor(e,r){super(e,r),this._isTransitioning=!1,this._triggerArray=[];const i=te.find(Ws);for(const o of i){const l=te.getSelectorFromElement(o),_=te.find(l).filter(s=>s===this._element);l!==null&&_.length&&this._triggerArray.push(o)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return np}static get DefaultType(){return op}static get NAME(){return Vf}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(sp).filter(s=>s!==this._element).map(s=>br.getOrCreateInstance(s,{toggle:!1}))),e.length&&e[0]._isTransitioning||z.trigger(this._element,qf).defaultPrevented)return;for(const s of e)s.hide();const i=this._getDimension();this._element.classList.remove(jt),this._element.classList.add(jr),this._element.style[i]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(jr),this._element.classList.add(jt,Ji),this._element.style[i]="",z.trigger(this._element,Yf)},_=`scroll${i[0].toUpperCase()+i.slice(1)}`;this._queueCallback(o,this._element,!0),this._element.style[i]=`${this._element[_]}px`}hide(){if(this._isTransitioning||!this._isShown()||z.trigger(this._element,Jf).defaultPrevented)return;const r=this._getDimension();this._element.style[r]=`${this._element.getBoundingClientRect()[r]}px`,kr(this._element),this._element.classList.add(jr),this._element.classList.remove(jt,Ji);for(const o of this._triggerArray){const l=te.getElementFromSelector(o);l&&!this._isShown(l)&&this._addAriaAndCollapsedClass([o],!1)}this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(jr),this._element.classList.add(jt),z.trigger(this._element,Xf)};this._element.style[r]="",this._queueCallback(i,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Ji)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=ut(e.parent),e}_getDimension(){return this._element.classList.contains(tp)?rp:ip}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Ws);for(const r of e){const i=te.getElementFromSelector(r);i&&this._addAriaAndCollapsedClass([r],this._isShown(i))}}_getFirstLevelChildren(e){const r=te.find(ep,this._config.parent);return te.find(e,this._config.parent).filter(i=>!r.includes(i))}_addAriaAndCollapsedClass(e,r){if(e.length)for(const i of e)i.classList.toggle(Zf,!r),i.setAttribute("aria-expanded",r)}static jQueryInterface(e){const r={};return typeof e=="string"&&/show|hide/.test(e)&&(r.toggle=!1),this.each(function(){const i=br.getOrCreateInstance(this,r);if(typeof e=="string"){if(typeof i[e]>"u")throw new TypeError(`No method named "${e}"`);i[e]()}})}}z.on(document,Qf,Ws,function(t){(t.target.tagName==="A"||t.delegateTarget&&t.delegateTarget.tagName==="A")&&t.preventDefault();for(const e of te.getMultipleElementsFromSelector(this))br.getOrCreateInstance(e,{toggle:!1}).toggle()});Ne(br);const Do="dropdown",ap="bs.dropdown",Rt=`.${ap}`,Tn=".data-api",cp="Escape",Lo="Tab",lp="ArrowUp",Oo="ArrowDown",hp=2,up=`hide${Rt}`,dp=`hidden${Rt}`,fp=`show${Rt}`,pp=`shown${Rt}`,bl=`click${Rt}${Tn}`,Cl=`keydown${Rt}${Tn}`,_p=`keyup${Rt}${Tn}`,Ft="show",gp="dropup",mp="dropend",vp="dropstart",yp="dropup-center",Sp="dropdown-center",Ct='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',bp=`${Ct}.${Ft}`,ei=".dropdown-menu",Cp=".navbar",Ep=".navbar-nav",Tp=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",wp=Me()?"top-end":"top-start",kp=Me()?"top-start":"top-end",Ap=Me()?"bottom-end":"bottom-start",Rp=Me()?"bottom-start":"bottom-end",Dp=Me()?"left-start":"right-start",Lp=Me()?"right-start":"left-start",Op="top",xp="bottom",Pp={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Mp={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class qe extends Ue{constructor(e,r){super(e,r),this._popper=null,this._parent=this._element.parentNode,this._menu=te.next(this._element,ei)[0]||te.prev(this._element,ei)[0]||te.findOne(ei,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Pp}static get DefaultType(){return Mp}static get NAME(){return Do}toggle(){return this._isShown()?this.hide():this.show()}show(){if(dt(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!z.trigger(this._element,fp,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(Ep))for(const i of[].concat(...document.body.children))z.on(i,"mouseover",fi);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Ft),this._element.classList.add(Ft),z.trigger(this._element,pp,e)}}hide(){if(dt(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!z.trigger(this._element,up,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))z.off(i,"mouseover",fi);this._popper&&this._popper.destroy(),this._menu.classList.remove(Ft),this._element.classList.remove(Ft),this._element.setAttribute("aria-expanded","false"),nt.removeDataAttribute(this._menu,"popper"),z.trigger(this._element,dp,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!st(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Do.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof sl>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let e=this._element;this._config.reference==="parent"?e=this._parent:st(this._config.reference)?e=ut(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const r=this._getPopperConfig();this._popper=bn(e,this._menu,r)}_isShown(){return this._menu.classList.contains(Ft)}_getPlacement(){const e=this._parent;if(e.classList.contains(mp))return Dp;if(e.classList.contains(vp))return Lp;if(e.classList.contains(yp))return Op;if(e.classList.contains(Sp))return xp;const r=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(gp)?r?kp:wp:r?Rp:Ap}_detectNavbar(){return this._element.closest(Cp)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(r=>Number.parseInt(r,10)):typeof e=="function"?r=>e(r,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(nt.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...ke(this._config.popperConfig,[e])}}_selectMenuItem({key:e,target:r}){const i=te.find(Tp,this._menu).filter(o=>Zt(o));i.length&&Cn(i,r,e===Oo,!i.includes(r)).focus()}static jQueryInterface(e){return this.each(function(){const r=qe.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof r[e]>"u")throw new TypeError(`No method named "${e}"`);r[e]()}})}static clearMenus(e){if(e.button===hp||e.type==="keyup"&&e.key!==Lo)return;const r=te.find(bp);for(const i of r){const o=qe.getInstance(i);if(!o||o._config.autoClose===!1)continue;const l=e.composedPath(),_=l.includes(o._menu);if(l.includes(o._element)||o._config.autoClose==="inside"&&!_||o._config.autoClose==="outside"&&_||o._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Lo||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const s={relatedTarget:o._element};e.type==="click"&&(s.clickEvent=e),o._completeHide(s)}}static dataApiKeydownHandler(e){const r=/input|textarea/i.test(e.target.tagName),i=e.key===cp,o=[lp,Oo].includes(e.key);if(!o&&!i||r&&!i)return;e.preventDefault();const l=this.matches(Ct)?this:te.prev(this,Ct)[0]||te.next(this,Ct)[0]||te.findOne(Ct,e.delegateTarget.parentNode),_=qe.getOrCreateInstance(l);if(o){e.stopPropagation(),_.show(),_._selectMenuItem(e);return}_._isShown()&&(e.stopPropagation(),_.hide(),l.focus())}}z.on(document,Cl,Ct,qe.dataApiKeydownHandler);z.on(document,Cl,ei,qe.dataApiKeydownHandler);z.on(document,bl,qe.clearMenus);z.on(document,_p,qe.clearMenus);z.on(document,bl,Ct,function(t){t.preventDefault(),qe.getOrCreateInstance(this).toggle()});Ne(qe);const El="backdrop",Ip="fade",xo="show",Po=`mousedown.bs.${El}`,Bp={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Np={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Tl extends Ar{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Bp}static get DefaultType(){return Np}static get NAME(){return El}show(e){if(!this._config.isVisible){ke(e);return}this._append();const r=this._getElement();this._config.isAnimated&&kr(r),r.classList.add(xo),this._emulateAnimation(()=>{ke(e)})}hide(e){if(!this._config.isVisible){ke(e);return}this._getElement().classList.remove(xo),this._emulateAnimation(()=>{this.dispose(),ke(e)})}dispose(){this._isAppended&&(z.off(this._element,Po),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Ip),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=ut(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),z.on(e,Po,()=>{ke(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){ll(e,this._getElement(),this._config.isAnimated)}}const $p="focustrap",Hp="bs.focustrap",_i=`.${Hp}`,Fp=`focusin${_i}`,jp=`keydown.tab${_i}`,Up="Tab",Wp="forward",Mo="backward",zp={autofocus:!0,trapElement:null},Vp={autofocus:"boolean",trapElement:"element"};class wl extends Ar{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return zp}static get DefaultType(){return Vp}static get NAME(){return $p}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),z.off(document,_i),z.on(document,Fp,e=>this._handleFocusin(e)),z.on(document,jp,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,z.off(document,_i))}_handleFocusin(e){const{trapElement:r}=this._config;if(e.target===document||e.target===r||r.contains(e.target))return;const i=te.focusableChildren(r);i.length===0?r.focus():this._lastTabNavDirection===Mo?i[i.length-1].focus():i[0].focus()}_handleKeydown(e){e.key===Up&&(this._lastTabNavDirection=e.shiftKey?Mo:Wp)}}const Io=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Bo=".sticky-top",Ur="padding-right",No="margin-right";class zs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Ur,r=>r+e),this._setElementAttributes(Io,Ur,r=>r+e),this._setElementAttributes(Bo,No,r=>r-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Ur),this._resetElementAttributes(Io,Ur),this._resetElementAttributes(Bo,No)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,r,i){const o=this.getWidth(),l=_=>{if(_!==this._element&&window.innerWidth>_.clientWidth+o)return;this._saveInitialAttribute(_,r);const s=window.getComputedStyle(_).getPropertyValue(r);_.style.setProperty(r,`${i(Number.parseFloat(s))}px`)};this._applyManipulationCallback(e,l)}_saveInitialAttribute(e,r){const i=e.style.getPropertyValue(r);i&&nt.setDataAttribute(e,r,i)}_resetElementAttributes(e,r){const i=o=>{const l=nt.getDataAttribute(o,r);if(l===null){o.style.removeProperty(r);return}nt.removeDataAttribute(o,r),o.style.setProperty(r,l)};this._applyManipulationCallback(e,i)}_applyManipulationCallback(e,r){if(st(e)){r(e);return}for(const i of te.find(e,this._element))r(i)}}const Kp="modal",Gp="bs.modal",Ie=`.${Gp}`,qp=".data-api",Yp="Escape",Jp=`hide${Ie}`,Xp=`hidePrevented${Ie}`,kl=`hidden${Ie}`,Al=`show${Ie}`,Qp=`shown${Ie}`,Zp=`resize${Ie}`,e_=`click.dismiss${Ie}`,t_=`mousedown.dismiss${Ie}`,r_=`keydown.dismiss${Ie}`,i_=`click${Ie}${qp}`,$o="modal-open",s_="fade",Ho="show",Xi="modal-static",n_=".modal.show",o_=".modal-dialog",a_=".modal-body",c_='[data-bs-toggle="modal"]',l_={backdrop:!0,focus:!0,keyboard:!0},h_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Yt extends Ue{constructor(e,r){super(e,r),this._dialog=te.findOne(o_,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new zs,this._addEventListeners()}static get Default(){return l_}static get DefaultType(){return h_}static get NAME(){return Kp}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||z.trigger(this._element,Al,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add($o),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||z.trigger(this._element,Jp).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Ho),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){z.off(window,Ie),z.off(this._dialog,Ie),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Tl({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new wl({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const r=te.findOne(a_,this._dialog);r&&(r.scrollTop=0),kr(this._element),this._element.classList.add(Ho);const i=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,z.trigger(this._element,Qp,{relatedTarget:e})};this._queueCallback(i,this._dialog,this._isAnimated())}_addEventListeners(){z.on(this._element,r_,e=>{if(e.key===Yp){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),z.on(window,Zp,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),z.on(this._element,t_,e=>{z.one(this._element,e_,r=>{if(!(this._element!==e.target||this._element!==r.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove($o),this._resetAdjustments(),this._scrollBar.reset(),z.trigger(this._element,kl)})}_isAnimated(){return this._element.classList.contains(s_)}_triggerBackdropTransition(){if(z.trigger(this._element,Xp).defaultPrevented)return;const r=this._element.scrollHeight>document.documentElement.clientHeight,i=this._element.style.overflowY;i==="hidden"||this._element.classList.contains(Xi)||(r||(this._element.style.overflowY="hidden"),this._element.classList.add(Xi),this._queueCallback(()=>{this._element.classList.remove(Xi),this._queueCallback(()=>{this._element.style.overflowY=i},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,r=this._scrollBar.getWidth(),i=r>0;if(i&&!e){const o=Me()?"paddingLeft":"paddingRight";this._element.style[o]=`${r}px`}if(!i&&e){const o=Me()?"paddingRight":"paddingLeft";this._element.style[o]=`${r}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,r){return this.each(function(){const i=Yt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof i[e]>"u")throw new TypeError(`No method named "${e}"`);i[e](r)}})}}z.on(document,i_,c_,function(t){const e=te.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&t.preventDefault(),z.one(e,Al,o=>{o.defaultPrevented||z.one(e,kl,()=>{Zt(this)&&this.focus()})});const r=te.findOne(n_);r&&Yt.getInstance(r).hide(),Yt.getOrCreateInstance(e).toggle(this)});wi(Yt);Ne(Yt);const u_="offcanvas",d_="bs.offcanvas",ct=`.${d_}`,Rl=".data-api",f_=`load${ct}${Rl}`,p_="Escape",Fo="show",jo="showing",Uo="hiding",__="offcanvas-backdrop",Dl=".offcanvas.show",g_=`show${ct}`,m_=`shown${ct}`,v_=`hide${ct}`,Wo=`hidePrevented${ct}`,Ll=`hidden${ct}`,y_=`resize${ct}`,S_=`click${ct}${Rl}`,b_=`keydown.dismiss${ct}`,C_='[data-bs-toggle="offcanvas"]',E_={backdrop:!0,keyboard:!0,scroll:!1},T_={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class ft extends Ue{constructor(e,r){super(e,r),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return E_}static get DefaultType(){return T_}static get NAME(){return u_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||z.trigger(this._element,g_,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new zs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(jo);const i=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Fo),this._element.classList.remove(jo),z.trigger(this._element,m_,{relatedTarget:e})};this._queueCallback(i,this._element,!0)}hide(){if(!this._isShown||z.trigger(this._element,v_).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Uo),this._backdrop.hide();const r=()=>{this._element.classList.remove(Fo,Uo),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new zs().reset(),z.trigger(this._element,Ll)};this._queueCallback(r,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){z.trigger(this._element,Wo);return}this.hide()},r=!!this._config.backdrop;return new Tl({className:__,isVisible:r,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:r?e:null})}_initializeFocusTrap(){return new wl({trapElement:this._element})}_addEventListeners(){z.on(this._element,b_,e=>{if(e.key===p_){if(this._config.keyboard){this.hide();return}z.trigger(this._element,Wo)}})}static jQueryInterface(e){return this.each(function(){const r=ft.getOrCreateInstance(this,e);if(typeof e=="string"){if(r[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);r[e](this)}})}}z.on(document,S_,C_,function(t){const e=te.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&t.preventDefault(),dt(this))return;z.one(e,Ll,()=>{Zt(this)&&this.focus()});const r=te.findOne(Dl);r&&r!==e&&ft.getInstance(r).hide(),ft.getOrCreateInstance(e).toggle(this)});z.on(window,f_,()=>{for(const t of te.find(Dl))ft.getOrCreateInstance(t).show()});z.on(window,y_,()=>{for(const t of te.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(t).position!=="fixed"&&ft.getOrCreateInstance(t).hide()});wi(ft);Ne(ft);const w_=/^aria-[\w-]*$/i,Ol={"*":["class","dir","id","lang","role",w_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},k_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),A_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,R_=(t,e)=>{const r=t.nodeName.toLowerCase();return e.includes(r)?k_.has(r)?!!A_.test(t.nodeValue):!0:e.filter(i=>i instanceof RegExp).some(i=>i.test(r))};function D_(t,e,r){if(!t.length)return t;if(r&&typeof r=="function")return r(t);const o=new window.DOMParser().parseFromString(t,"text/html"),l=[].concat(...o.body.querySelectorAll("*"));for(const _ of l){const s=_.nodeName.toLowerCase();if(!Object.keys(e).includes(s)){_.remove();continue}const n=[].concat(..._.attributes),a=[].concat(e["*"]||[],e[s]||[]);for(const h of n)R_(h,a)||_.removeAttribute(h.nodeName)}return o.body.innerHTML}const L_="TemplateFactory",O_={allowList:Ol,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},x_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},P_={entry:"(string|element|function|null)",selector:"(string|element)"};class M_ extends Ar{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return O_}static get DefaultType(){return x_}static get NAME(){return L_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[o,l]of Object.entries(this._config.content))this._setContent(e,l,o);const r=e.children[0],i=this._resolvePossibleFunction(this._config.extraClass);return i&&r.classList.add(...i.split(" ")),r}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[r,i]of Object.entries(e))super._typeCheckConfig({selector:r,entry:i},P_)}_setContent(e,r,i){const o=te.findOne(i,e);if(o){if(r=this._resolvePossibleFunction(r),!r){o.remove();return}if(st(r)){this._putElementInTemplate(ut(r),o);return}if(this._config.html){o.innerHTML=this._maybeSanitize(r);return}o.textContent=r}}_maybeSanitize(e){return this._config.sanitize?D_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return ke(e,[this])}_putElementInTemplate(e,r){if(this._config.html){r.innerHTML="",r.append(e);return}r.textContent=e.textContent}}const I_="tooltip",B_=new Set(["sanitize","allowList","sanitizeFn"]),Qi="fade",N_="modal",Wr="show",$_=".tooltip-inner",zo=`.${N_}`,Vo="hide.bs.modal",cr="hover",Zi="focus",H_="click",F_="manual",j_="hide",U_="hidden",W_="show",z_="shown",V_="inserted",K_="click",G_="focusin",q_="focusout",Y_="mouseenter",J_="mouseleave",X_={AUTO:"auto",TOP:"top",RIGHT:Me()?"left":"right",BOTTOM:"bottom",LEFT:Me()?"right":"left"},Q_={allowList:Ol,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Z_={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class ot extends Ue{constructor(e,r){if(typeof sl>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(e,r),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Q_}static get DefaultType(){return Z_}static get NAME(){return I_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),z.off(this._element.closest(zo),Vo,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=z.trigger(this._element,this.constructor.eventName(W_)),i=(al(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!i)return;this._disposePopper();const o=this._getTipElement();this._element.setAttribute("aria-describedby",o.getAttribute("id"));const{container:l}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(l.append(o),z.trigger(this._element,this.constructor.eventName(V_))),this._popper=this._createPopper(o),o.classList.add(Wr),"ontouchstart"in document.documentElement)for(const s of[].concat(...document.body.children))z.on(s,"mouseover",fi);const _=()=>{z.trigger(this._element,this.constructor.eventName(z_)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(_,this.tip,this._isAnimated())}hide(){if(!this._isShown()||z.trigger(this._element,this.constructor.eventName(j_)).defaultPrevented)return;if(this._getTipElement().classList.remove(Wr),"ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))z.off(o,"mouseover",fi);this._activeTrigger[H_]=!1,this._activeTrigger[Zi]=!1,this._activeTrigger[cr]=!1,this._isHovered=null;const i=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),z.trigger(this._element,this.constructor.eventName(U_)))};this._queueCallback(i,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const r=this._getTemplateFactory(e).toHtml();if(!r)return null;r.classList.remove(Qi,Wr),r.classList.add(`bs-${this.constructor.NAME}-auto`);const i=$d(this.constructor.NAME).toString();return r.setAttribute("id",i),this._isAnimated()&&r.classList.add(Qi),r}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new M_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[$_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Qi)}_isShown(){return this.tip&&this.tip.classList.contains(Wr)}_createPopper(e){const r=ke(this._config.placement,[this,e,this._element]),i=X_[r.toUpperCase()];return bn(this._element,e,this._getPopperConfig(i))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(r=>Number.parseInt(r,10)):typeof e=="function"?r=>e(r,this._element):e}_resolvePossibleFunction(e){return ke(e,[this._element])}_getPopperConfig(e){const r={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:i=>{this._getTipElement().setAttribute("data-popper-placement",i.state.placement)}}]};return{...r,...ke(this._config.popperConfig,[r])}}_setListeners(){const e=this._config.trigger.split(" ");for(const r of e)if(r==="click")z.on(this._element,this.constructor.eventName(K_),this._config.selector,i=>{this._initializeOnDelegatedTarget(i).toggle()});else if(r!==F_){const i=r===cr?this.constructor.eventName(Y_):this.constructor.eventName(G_),o=r===cr?this.constructor.eventName(J_):this.constructor.eventName(q_);z.on(this._element,i,this._config.selector,l=>{const _=this._initializeOnDelegatedTarget(l);_._activeTrigger[l.type==="focusin"?Zi:cr]=!0,_._enter()}),z.on(this._element,o,this._config.selector,l=>{const _=this._initializeOnDelegatedTarget(l);_._activeTrigger[l.type==="focusout"?Zi:cr]=_._element.contains(l.relatedTarget),_._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},z.on(this._element.closest(zo),Vo,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,r){clearTimeout(this._timeout),this._timeout=setTimeout(e,r)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const r=nt.getDataAttributes(this._element);for(const i of Object.keys(r))B_.has(i)&&delete r[i];return e={...r,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:ut(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[r,i]of Object.entries(this._config))this.constructor.Default[r]!==i&&(e[r]=i);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const r=ot.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof r[e]>"u")throw new TypeError(`No method named "${e}"`);r[e]()}})}}Ne(ot);const eg="popover",tg=".popover-header",rg=".popover-body",ig={...ot.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},sg={...ot.DefaultType,content:"(null|string|element|function)"};class wn extends ot{static get Default(){return ig}static get DefaultType(){return sg}static get NAME(){return eg}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[tg]:this._getTitle(),[rg]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const r=wn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof r[e]>"u")throw new TypeError(`No method named "${e}"`);r[e]()}})}}Ne(wn);const ng="scrollspy",og="bs.scrollspy",kn=`.${og}`,ag=".data-api",cg=`activate${kn}`,Ko=`click${kn}`,lg=`load${kn}${ag}`,hg="dropdown-item",Bt="active",ug='[data-bs-spy="scroll"]',es="[href]",dg=".nav, .list-group",Go=".nav-link",fg=".nav-item",pg=".list-group-item",_g=`${Go}, ${fg} > ${Go}, ${pg}`,gg=".dropdown",mg=".dropdown-toggle",vg={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},yg={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Ri extends Ue{constructor(e,r){super(e,r),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return vg}static get DefaultType(){return yg}static get NAME(){return ng}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=ut(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(r=>Number.parseFloat(r))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(z.off(this._config.target,Ko),z.on(this._config.target,Ko,es,e=>{const r=this._observableSections.get(e.target.hash);if(r){e.preventDefault();const i=this._rootElement||window,o=r.offsetTop-this._element.offsetTop;if(i.scrollTo){i.scrollTo({top:o,behavior:"smooth"});return}i.scrollTop=o}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(r=>this._observerCallback(r),e)}_observerCallback(e){const r=_=>this._targetLinks.get(`#${_.target.id}`),i=_=>{this._previousScrollData.visibleEntryTop=_.target.offsetTop,this._process(r(_))},o=(this._rootElement||document.documentElement).scrollTop,l=o>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=o;for(const _ of e){if(!_.isIntersecting){this._activeTarget=null,this._clearActiveClass(r(_));continue}const s=_.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(l&&s){if(i(_),!o)return;continue}!l&&!s&&i(_)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=te.find(es,this._config.target);for(const r of e){if(!r.hash||dt(r))continue;const i=te.findOne(decodeURI(r.hash),this._element);Zt(i)&&(this._targetLinks.set(decodeURI(r.hash),r),this._observableSections.set(r.hash,i))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(Bt),this._activateParents(e),z.trigger(this._element,cg,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(hg)){te.findOne(mg,e.closest(gg)).classList.add(Bt);return}for(const r of te.parents(e,dg))for(const i of te.prev(r,_g))i.classList.add(Bt)}_clearActiveClass(e){e.classList.remove(Bt);const r=te.find(`${es}.${Bt}`,e);for(const i of r)i.classList.remove(Bt)}static jQueryInterface(e){return this.each(function(){const r=Ri.getOrCreateInstance(this,e);if(typeof e=="string"){if(r[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);r[e]()}})}}z.on(window,lg,()=>{for(const t of te.find(ug))Ri.getOrCreateInstance(t)});Ne(Ri);const Sg="tab",bg="bs.tab",Dt=`.${bg}`,Cg=`hide${Dt}`,Eg=`hidden${Dt}`,Tg=`show${Dt}`,wg=`shown${Dt}`,kg=`click${Dt}`,Ag=`keydown${Dt}`,Rg=`load${Dt}`,Dg="ArrowLeft",qo="ArrowRight",Lg="ArrowUp",Yo="ArrowDown",Et="active",Jo="fade",ts="show",Og="dropdown",xg=".dropdown-toggle",Pg=".dropdown-menu",rs=":not(.dropdown-toggle)",Mg='.list-group, .nav, [role="tablist"]',Ig=".nav-item, .list-group-item",Bg=`.nav-link${rs}, .list-group-item${rs}, [role="tab"]${rs}`,xl='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',is=`${Bg}, ${xl}`,Ng=`.${Et}[data-bs-toggle="tab"], .${Et}[data-bs-toggle="pill"], .${Et}[data-bs-toggle="list"]`;class Jt extends Ue{constructor(e){super(e),this._parent=this._element.closest(Mg),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),z.on(this._element,Ag,r=>this._keydown(r)))}static get NAME(){return Sg}show(){const e=this._element;if(this._elemIsActive(e))return;const r=this._getActiveElem(),i=r?z.trigger(r,Cg,{relatedTarget:e}):null;z.trigger(e,Tg,{relatedTarget:r}).defaultPrevented||i&&i.defaultPrevented||(this._deactivate(r,e),this._activate(e,r))}_activate(e,r){if(!e)return;e.classList.add(Et),this._activate(te.getElementFromSelector(e));const i=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(ts);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),z.trigger(e,wg,{relatedTarget:r})};this._queueCallback(i,e,e.classList.contains(Jo))}_deactivate(e,r){if(!e)return;e.classList.remove(Et),e.blur(),this._deactivate(te.getElementFromSelector(e));const i=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(ts);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),z.trigger(e,Eg,{relatedTarget:r})};this._queueCallback(i,e,e.classList.contains(Jo))}_keydown(e){if(![Dg,qo,Lg,Yo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const r=[qo,Yo].includes(e.key),i=Cn(this._getChildren().filter(o=>!dt(o)),e.target,r,!0);i&&(i.focus({preventScroll:!0}),Jt.getOrCreateInstance(i).show())}_getChildren(){return te.find(is,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,r){this._setAttributeIfNotExists(e,"role","tablist");for(const i of r)this._setInitialAttributesOnChild(i)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const r=this._elemIsActive(e),i=this._getOuterElement(e);e.setAttribute("aria-selected",r),i!==e&&this._setAttributeIfNotExists(i,"role","presentation"),r||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const r=te.getElementFromSelector(e);r&&(this._setAttributeIfNotExists(r,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(r,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,r){const i=this._getOuterElement(e);if(!i.classList.contains(Og))return;const o=(l,_)=>{const s=te.findOne(l,i);s&&s.classList.toggle(_,r)};o(xg,Et),o(Pg,ts),i.setAttribute("aria-expanded",r)}_setAttributeIfNotExists(e,r,i){e.hasAttribute(r)||e.setAttribute(r,i)}_elemIsActive(e){return e.classList.contains(Et)}_getInnerElement(e){return e.matches(is)?e:te.findOne(is,e)}_getOuterElement(e){return e.closest(Ig)||e}static jQueryInterface(e){return this.each(function(){const r=Jt.getOrCreateInstance(this);if(typeof e=="string"){if(r[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);r[e]()}})}}z.on(document,kg,xl,function(t){["A","AREA"].includes(this.tagName)&&t.preventDefault(),!dt(this)&&Jt.getOrCreateInstance(this).show()});z.on(window,Rg,()=>{for(const t of te.find(Ng))Jt.getOrCreateInstance(t)});Ne(Jt);const $g="toast",Hg="bs.toast",gt=`.${Hg}`,Fg=`mouseover${gt}`,jg=`mouseout${gt}`,Ug=`focusin${gt}`,Wg=`focusout${gt}`,zg=`hide${gt}`,Vg=`hidden${gt}`,Kg=`show${gt}`,Gg=`shown${gt}`,qg="fade",Xo="hide",zr="show",Vr="showing",Yg={animation:"boolean",autohide:"boolean",delay:"number"},Jg={animation:!0,autohide:!0,delay:5e3};class Di extends Ue{constructor(e,r){super(e,r),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Jg}static get DefaultType(){return Yg}static get NAME(){return $g}show(){if(z.trigger(this._element,Kg).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(qg);const r=()=>{this._element.classList.remove(Vr),z.trigger(this._element,Gg),this._maybeScheduleHide()};this._element.classList.remove(Xo),kr(this._element),this._element.classList.add(zr,Vr),this._queueCallback(r,this._element,this._config.animation)}hide(){if(!this.isShown()||z.trigger(this._element,zg).defaultPrevented)return;const r=()=>{this._element.classList.add(Xo),this._element.classList.remove(Vr,zr),z.trigger(this._element,Vg)};this._element.classList.add(Vr),this._queueCallback(r,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(zr),super.dispose()}isShown(){return this._element.classList.contains(zr)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,r){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=r;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=r;break}}if(r){this._clearTimeout();return}const i=e.relatedTarget;this._element===i||this._element.contains(i)||this._maybeScheduleHide()}_setListeners(){z.on(this._element,Fg,e=>this._onInteraction(e,!0)),z.on(this._element,jg,e=>this._onInteraction(e,!1)),z.on(this._element,Ug,e=>this._onInteraction(e,!0)),z.on(this._element,Wg,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const r=Di.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof r[e]>"u")throw new TypeError(`No method named "${e}"`);r[e](this)}})}}wi(Di);Ne(Di);/*! @license DOMPurify 3.0.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.0.5/LICENSE */const{entries:Pl,setPrototypeOf:Qo,isFrozen:Xg,getPrototypeOf:Qg,getOwnPropertyDescriptor:Zg}=Object;let{freeze:Te,seal:je,create:em}=Object,{apply:Vs,construct:Ks}=typeof Reflect<"u"&&Reflect;Vs||(Vs=function(e,r,i){return e.apply(r,i)});Te||(Te=function(e){return e});je||(je=function(e){return e});Ks||(Ks=function(e,r){return new e(...r)});const tm=Be(Array.prototype.forEach),Zo=Be(Array.prototype.pop),lr=Be(Array.prototype.push),ti=Be(String.prototype.toLowerCase),ss=Be(String.prototype.toString),rm=Be(String.prototype.match),He=Be(String.prototype.replace),im=Be(String.prototype.indexOf),sm=Be(String.prototype.trim),Ae=Be(RegExp.prototype.test),hr=nm(TypeError);function Be(t){return function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return Vs(t,e,i)}}function nm(t){return function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return Ks(t,r)}}function ie(t,e,r){var i;r=(i=r)!==null&&i!==void 0?i:ti,Qo&&Qo(t,null);let o=e.length;for(;o--;){let l=e[o];if(typeof l=="string"){const _=r(l);_!==l&&(Xg(e)||(e[o]=_),l=_)}t[l]=!0}return t}function Nt(t){const e=em(null);for(const[r,i]of Pl(t))e[r]=i;return e}function Kr(t,e){for(;t!==null;){const i=Zg(t,e);if(i){if(i.get)return Be(i.get);if(typeof i.value=="function")return Be(i.value)}t=Qg(t)}function r(i){return console.warn("fallback value for",i),null}return r}const ea=Te(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ns=Te(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),os=Te(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),om=Te(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),as=Te(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),am=Te(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ta=Te(["#text"]),ra=Te(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),cs=Te(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ia=Te(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Gr=Te(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),cm=je(/\{\{[\w\W]*|[\w\W]*\}\}/gm),lm=je(/<%[\w\W]*|[\w\W]*%>/gm),hm=je(/\${[\w\W]*}/gm),um=je(/^data-[\-\w.\u00B7-\uFFFF]/),dm=je(/^aria-[\-\w]+$/),Ml=je(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),fm=je(/^(?:\w+script|data):/i),pm=je(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Il=je(/^html$/i);var sa=Object.freeze({__proto__:null,MUSTACHE_EXPR:cm,ERB_EXPR:lm,TMPLIT_EXPR:hm,DATA_ATTR:um,ARIA_ATTR:dm,IS_ALLOWED_URI:Ml,IS_SCRIPT_OR_DATA:fm,ATTR_WHITESPACE:pm,DOCTYPE_NAME:Il});const _m=()=>typeof window>"u"?null:window,gm=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const o="data-tt-policy-suffix";r&&r.hasAttribute(o)&&(i=r.getAttribute(o));const l="dompurify"+(i?"#"+i:"");try{return e.createPolicy(l,{createHTML(_){return _},createScriptURL(_){return _}})}catch{return console.warn("TrustedTypes policy "+l+" could not be created."),null}};function Bl(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_m();const e=ee=>Bl(ee);if(e.version="3.0.5",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;const r=t.document,i=r.currentScript;let{document:o}=t;const{DocumentFragment:l,HTMLTemplateElement:_,Node:s,Element:n,NodeFilter:a,NamedNodeMap:h=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:u,DOMParser:g,trustedTypes:C}=t,b=n.prototype,m=Kr(b,"cloneNode"),c=Kr(b,"nextSibling"),p=Kr(b,"childNodes"),f=Kr(b,"parentNode");if(typeof _=="function"){const ee=o.createElement("template");ee.content&&ee.content.ownerDocument&&(o=ee.content.ownerDocument)}let d,v="";const{implementation:y,createNodeIterator:E,createDocumentFragment:T,getElementsByTagName:S}=o,{importNode:w}=r;let A={};e.isSupported=typeof Pl=="function"&&typeof f=="function"&&y&&y.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:D,ERB_EXPR:R,TMPLIT_EXPR:x,DATA_ATTR:F,ARIA_ATTR:G,IS_SCRIPT_OR_DATA:U,ATTR_WHITESPACE:k}=sa;let{IS_ALLOWED_URI:L}=sa,O=null;const I=ie({},[...ea,...ns,...os,...as,...ta]);let H=null;const X=ie({},[...ra,...cs,...ia,...Gr]);let Q=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),W=null,q=null,M=!0,P=!0,N=!1,j=!0,K=!1,se=!1,Y=!1,ce=!1,le=!1,he=!1,ne=!1,mt=!0,Lr=!1;const Li="user-content-";let $e=!0,We=!1,Xe={},Qe=null;const Lt=ie({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let tr=null;const rr=ie({},["audio","video","img","source","image","track"]);let Ot=null;const ir=ie({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Or="http://www.w3.org/1998/Math/MathML",xr="http://www.w3.org/2000/svg",Ze="http://www.w3.org/1999/xhtml";let xt=Ze,Oi=!1,xi=null;const Hl=ie({},[Or,xr,Ze],ss);let vt;const Fl=["application/xhtml+xml","text/html"],jl="text/html";let pe,Pt=null;const Ul=o.createElement("form"),An=function(B){return B instanceof RegExp||B instanceof Function},Pi=function(B){if(!(Pt&&Pt===B)){if((!B||typeof B!="object")&&(B={}),B=Nt(B),vt=Fl.indexOf(B.PARSER_MEDIA_TYPE)===-1?vt=jl:vt=B.PARSER_MEDIA_TYPE,pe=vt==="application/xhtml+xml"?ss:ti,O="ALLOWED_TAGS"in B?ie({},B.ALLOWED_TAGS,pe):I,H="ALLOWED_ATTR"in B?ie({},B.ALLOWED_ATTR,pe):X,xi="ALLOWED_NAMESPACES"in B?ie({},B.ALLOWED_NAMESPACES,ss):Hl,Ot="ADD_URI_SAFE_ATTR"in B?ie(Nt(ir),B.ADD_URI_SAFE_ATTR,pe):ir,tr="ADD_DATA_URI_TAGS"in B?ie(Nt(rr),B.ADD_DATA_URI_TAGS,pe):rr,Qe="FORBID_CONTENTS"in B?ie({},B.FORBID_CONTENTS,pe):Lt,W="FORBID_TAGS"in B?ie({},B.FORBID_TAGS,pe):{},q="FORBID_ATTR"in B?ie({},B.FORBID_ATTR,pe):{},Xe="USE_PROFILES"in B?B.USE_PROFILES:!1,M=B.ALLOW_ARIA_ATTR!==!1,P=B.ALLOW_DATA_ATTR!==!1,N=B.ALLOW_UNKNOWN_PROTOCOLS||!1,j=B.ALLOW_SELF_CLOSE_IN_ATTR!==!1,K=B.SAFE_FOR_TEMPLATES||!1,se=B.WHOLE_DOCUMENT||!1,le=B.RETURN_DOM||!1,he=B.RETURN_DOM_FRAGMENT||!1,ne=B.RETURN_TRUSTED_TYPE||!1,ce=B.FORCE_BODY||!1,mt=B.SANITIZE_DOM!==!1,Lr=B.SANITIZE_NAMED_PROPS||!1,$e=B.KEEP_CONTENT!==!1,We=B.IN_PLACE||!1,L=B.ALLOWED_URI_REGEXP||Ml,xt=B.NAMESPACE||Ze,Q=B.CUSTOM_ELEMENT_HANDLING||{},B.CUSTOM_ELEMENT_HANDLING&&An(B.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Q.tagNameCheck=B.CUSTOM_ELEMENT_HANDLING.tagNameCheck),B.CUSTOM_ELEMENT_HANDLING&&An(B.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Q.attributeNameCheck=B.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),B.CUSTOM_ELEMENT_HANDLING&&typeof B.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Q.allowCustomizedBuiltInElements=B.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),K&&(P=!1),he&&(le=!0),Xe&&(O=ie({},[...ta]),H=[],Xe.html===!0&&(ie(O,ea),ie(H,ra)),Xe.svg===!0&&(ie(O,ns),ie(H,cs),ie(H,Gr)),Xe.svgFilters===!0&&(ie(O,os),ie(H,cs),ie(H,Gr)),Xe.mathMl===!0&&(ie(O,as),ie(H,ia),ie(H,Gr))),B.ADD_TAGS&&(O===I&&(O=Nt(O)),ie(O,B.ADD_TAGS,pe)),B.ADD_ATTR&&(H===X&&(H=Nt(H)),ie(H,B.ADD_ATTR,pe)),B.ADD_URI_SAFE_ATTR&&ie(Ot,B.ADD_URI_SAFE_ATTR,pe),B.FORBID_CONTENTS&&(Qe===Lt&&(Qe=Nt(Qe)),ie(Qe,B.FORBID_CONTENTS,pe)),$e&&(O["#text"]=!0),se&&ie(O,["html","head","body"]),O.table&&(ie(O,["tbody"]),delete W.tbody),B.TRUSTED_TYPES_POLICY){if(typeof B.TRUSTED_TYPES_POLICY.createHTML!="function")throw hr('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof B.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw hr('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');d=B.TRUSTED_TYPES_POLICY,v=d.createHTML("")}else d===void 0&&(d=gm(C,i)),d!==null&&typeof v=="string"&&(v=d.createHTML(""));Te&&Te(B),Pt=B}},Rn=ie({},["mi","mo","mn","ms","mtext"]),Dn=ie({},["foreignobject","desc","title","annotation-xml"]),Wl=ie({},["title","style","font","a","script"]),Pr=ie({},ns);ie(Pr,os),ie(Pr,om);const Mi=ie({},as);ie(Mi,am);const zl=function(B){let V=f(B);(!V||!V.tagName)&&(V={namespaceURI:xt,tagName:"template"});const J=ti(B.tagName),ae=ti(V.tagName);return xi[B.namespaceURI]?B.namespaceURI===xr?V.namespaceURI===Ze?J==="svg":V.namespaceURI===Or?J==="svg"&&(ae==="annotation-xml"||Rn[ae]):!!Pr[J]:B.namespaceURI===Or?V.namespaceURI===Ze?J==="math":V.namespaceURI===xr?J==="math"&&Dn[ae]:!!Mi[J]:B.namespaceURI===Ze?V.namespaceURI===xr&&!Dn[ae]||V.namespaceURI===Or&&!Rn[ae]?!1:!Mi[J]&&(Wl[J]||!Pr[J]):!!(vt==="application/xhtml+xml"&&xi[B.namespaceURI]):!1},yt=function(B){lr(e.removed,{element:B});try{B.parentNode.removeChild(B)}catch{B.remove()}},Ii=function(B,V){try{lr(e.removed,{attribute:V.getAttributeNode(B),from:V})}catch{lr(e.removed,{attribute:null,from:V})}if(V.removeAttribute(B),B==="is"&&!H[B])if(le||he)try{yt(V)}catch{}else try{V.setAttribute(B,"")}catch{}},Ln=function(B){let V,J;if(ce)B="<remove></remove>"+B;else{const Oe=rm(B,/^[\r\n\t ]+/);J=Oe&&Oe[0]}vt==="application/xhtml+xml"&&xt===Ze&&(B='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+B+"</body></html>");const ae=d?d.createHTML(B):B;if(xt===Ze)try{V=new g().parseFromString(ae,vt)}catch{}if(!V||!V.documentElement){V=y.createDocument(xt,"template",null);try{V.documentElement.innerHTML=Oi?v:ae}catch{}}const _e=V.body||V.documentElement;return B&&J&&_e.insertBefore(o.createTextNode(J),_e.childNodes[0]||null),xt===Ze?S.call(V,se?"html":"body")[0]:se?V.documentElement:_e},On=function(B){return E.call(B.ownerDocument||B,B,a.SHOW_ELEMENT|a.SHOW_COMMENT|a.SHOW_TEXT,null,!1)},Vl=function(B){return B instanceof u&&(typeof B.nodeName!="string"||typeof B.textContent!="string"||typeof B.removeChild!="function"||!(B.attributes instanceof h)||typeof B.removeAttribute!="function"||typeof B.setAttribute!="function"||typeof B.namespaceURI!="string"||typeof B.insertBefore!="function"||typeof B.hasChildNodes!="function")},Mr=function(B){return typeof s=="object"?B instanceof s:B&&typeof B=="object"&&typeof B.nodeType=="number"&&typeof B.nodeName=="string"},et=function(B,V,J){A[B]&&tm(A[B],ae=>{ae.call(e,V,J,Pt)})},xn=function(B){let V;if(et("beforeSanitizeElements",B,null),Vl(B))return yt(B),!0;const J=pe(B.nodeName);if(et("uponSanitizeElement",B,{tagName:J,allowedTags:O}),B.hasChildNodes()&&!Mr(B.firstElementChild)&&(!Mr(B.content)||!Mr(B.content.firstElementChild))&&Ae(/<[/\w]/g,B.innerHTML)&&Ae(/<[/\w]/g,B.textContent))return yt(B),!0;if(!O[J]||W[J]){if(!W[J]&&Mn(J)&&(Q.tagNameCheck instanceof RegExp&&Ae(Q.tagNameCheck,J)||Q.tagNameCheck instanceof Function&&Q.tagNameCheck(J)))return!1;if($e&&!Qe[J]){const ae=f(B)||B.parentNode,_e=p(B)||B.childNodes;if(_e&&ae){const Oe=_e.length;for(let ue=Oe-1;ue>=0;--ue)ae.insertBefore(m(_e[ue],!0),c(B))}}return yt(B),!0}return B instanceof n&&!zl(B)||(J==="noscript"||J==="noembed"||J==="noframes")&&Ae(/<\/no(script|embed|frames)/i,B.innerHTML)?(yt(B),!0):(K&&B.nodeType===3&&(V=B.textContent,V=He(V,D," "),V=He(V,R," "),V=He(V,x," "),B.textContent!==V&&(lr(e.removed,{element:B.cloneNode()}),B.textContent=V)),et("afterSanitizeElements",B,null),!1)},Pn=function(B,V,J){if(mt&&(V==="id"||V==="name")&&(J in o||J in Ul))return!1;if(!(P&&!q[V]&&Ae(F,V))){if(!(M&&Ae(G,V))){if(!H[V]||q[V]){if(!(Mn(B)&&(Q.tagNameCheck instanceof RegExp&&Ae(Q.tagNameCheck,B)||Q.tagNameCheck instanceof Function&&Q.tagNameCheck(B))&&(Q.attributeNameCheck instanceof RegExp&&Ae(Q.attributeNameCheck,V)||Q.attributeNameCheck instanceof Function&&Q.attributeNameCheck(V))||V==="is"&&Q.allowCustomizedBuiltInElements&&(Q.tagNameCheck instanceof RegExp&&Ae(Q.tagNameCheck,J)||Q.tagNameCheck instanceof Function&&Q.tagNameCheck(J))))return!1}else if(!Ot[V]){if(!Ae(L,He(J,k,""))){if(!((V==="src"||V==="xlink:href"||V==="href")&&B!=="script"&&im(J,"data:")===0&&tr[B])){if(!(N&&!Ae(U,He(J,k,"")))){if(J)return!1}}}}}}return!0},Mn=function(B){return B.indexOf("-")>0},In=function(B){let V,J,ae,_e;et("beforeSanitizeAttributes",B,null);const{attributes:Oe}=B;if(!Oe)return;const ue={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:H};for(_e=Oe.length;_e--;){V=Oe[_e];const{name:ze,namespaceURI:Bi}=V;if(J=ze==="value"?V.value:sm(V.value),ae=pe(ze),ue.attrName=ae,ue.attrValue=J,ue.keepAttr=!0,ue.forceKeepAttr=void 0,et("uponSanitizeAttribute",B,ue),J=ue.attrValue,ue.forceKeepAttr||(Ii(ze,B),!ue.keepAttr))continue;if(!j&&Ae(/\/>/i,J)){Ii(ze,B);continue}K&&(J=He(J,D," "),J=He(J,R," "),J=He(J,x," "));const Bn=pe(B.nodeName);if(Pn(Bn,ae,J)){if(Lr&&(ae==="id"||ae==="name")&&(Ii(ze,B),J=Li+J),d&&typeof C=="object"&&typeof C.getAttributeType=="function"&&!Bi)switch(C.getAttributeType(Bn,ae)){case"TrustedHTML":{J=d.createHTML(J);break}case"TrustedScriptURL":{J=d.createScriptURL(J);break}}try{Bi?B.setAttributeNS(Bi,ze,J):B.setAttribute(ze,J),Zo(e.removed)}catch{}}}et("afterSanitizeAttributes",B,null)},Kl=function ee(B){let V;const J=On(B);for(et("beforeSanitizeShadowDOM",B,null);V=J.nextNode();)et("uponSanitizeShadowNode",V,null),!xn(V)&&(V.content instanceof l&&ee(V.content),In(V));et("afterSanitizeShadowDOM",B,null)};return e.sanitize=function(ee){let B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},V,J,ae,_e;if(Oi=!ee,Oi&&(ee="<!-->"),typeof ee!="string"&&!Mr(ee))if(typeof ee.toString=="function"){if(ee=ee.toString(),typeof ee!="string")throw hr("dirty is not a string, aborting")}else throw hr("toString is not a function");if(!e.isSupported)return ee;if(Y||Pi(B),e.removed=[],typeof ee=="string"&&(We=!1),We){if(ee.nodeName){const ze=pe(ee.nodeName);if(!O[ze]||W[ze])throw hr("root node is forbidden and cannot be sanitized in-place")}}else if(ee instanceof s)V=Ln("<!---->"),J=V.ownerDocument.importNode(ee,!0),J.nodeType===1&&J.nodeName==="BODY"||J.nodeName==="HTML"?V=J:V.appendChild(J);else{if(!le&&!K&&!se&&ee.indexOf("<")===-1)return d&&ne?d.createHTML(ee):ee;if(V=Ln(ee),!V)return le?null:ne?v:""}V&&ce&&yt(V.firstChild);const Oe=On(We?ee:V);for(;ae=Oe.nextNode();)xn(ae)||(ae.content instanceof l&&Kl(ae.content),In(ae));if(We)return ee;if(le){if(he)for(_e=T.call(V.ownerDocument);V.firstChild;)_e.appendChild(V.firstChild);else _e=V;return(H.shadowroot||H.shadowrootmode)&&(_e=w.call(r,_e,!0)),_e}let ue=se?V.outerHTML:V.innerHTML;return se&&O["!doctype"]&&V.ownerDocument&&V.ownerDocument.doctype&&V.ownerDocument.doctype.name&&Ae(Il,V.ownerDocument.doctype.name)&&(ue="<!DOCTYPE "+V.ownerDocument.doctype.name+`>
`+ue),K&&(ue=He(ue,D," "),ue=He(ue,R," "),ue=He(ue,x," ")),d&&ne?d.createHTML(ue):ue},e.setConfig=function(ee){Pi(ee),Y=!0},e.clearConfig=function(){Pt=null,Y=!1},e.isValidAttribute=function(ee,B,V){Pt||Pi({});const J=pe(ee),ae=pe(B);return Pn(J,ae,V)},e.addHook=function(ee,B){typeof B=="function"&&(A[ee]=A[ee]||[],lr(A[ee],B))},e.removeHook=function(ee){if(A[ee])return Zo(A[ee])},e.removeHooks=function(ee){A[ee]&&(A[ee]=[])},e.removeAllHooks=function(){A={}},e}var mm=Bl();const ls=document.querySelector("input#hostPeerID"),Gs=document.querySelector("#chatInput"),Nl=document.querySelector("#myPeerID"),na=document.querySelector("#knownPeers");var wt=vm("#terminal"),fe;gi();ym();function vm(t){let e=new qu.Terminal;return e.open(document.querySelector(t)),document.term=e,e}function gi(){fe&&fe.close(),fe=new Gu(localStorage.getItem("myPeerID"),"../config.toml"),fe.onPeerConnectedHook=bm,fe.onPeerDisconnectedHook=Cm,fe.onPeerJSUserDataReceivedHook=Sm,fe.onPeerIDReadyHook=t=>{Nl.value=Cr(t),localStorage.setItem("myPeerID",t),console.log("My peer ID is: "+t)},wt.writeln("Loading PyScript runtime..."),fe.onRuntimeReadyHook=()=>{wt.writeln("PyScript runtime ready.")},fe.onPyScriptDisplayHook=t=>{wt.writeln(t)},document.mpyc=fe,document.r=gi,document.run=()=>fe.runMPyCDemo(!1),document.runa=()=>fe.runMPyCDemo(!0)}function ym(){document.querySelector("button#resetPeerID").onclick=()=>{localStorage.removeItem("myPeerID"),fe.close(),gi()},document.querySelector("button#startButton").onclick=()=>{fe.runMPyCDemo(!1)},document.querySelector("button#startAsyncButton").onclick=()=>fe.runMPyCDemo(!0),document.querySelector("button#stopButton").onclick=gi,document.querySelector("button#connect").onclick=()=>{localStorage.setItem("hostPeerID",ls.value),fe.connectToPeer(ls.value)};var t=localStorage.getItem("hostPeerID");t&&(ls.value=t),$("button#copyPeerID").on("click",function(){let r=$(this);navigator.clipboard.writeText(Nl.value).then(function(){r.find("i").switchClass("bi-clipboard","bi-check2"),r.switchClass("btn-primary","btn-success"),ot.getInstance("button#copyPeerID").setContent({".tooltip-inner":"Copied!"}),setTimeout(()=>{r.switchClass("btn-success","btn-primary"),r.find("i").switchClass("bi-check2","bi-clipboard"),ot.getInstance("button#copyPeerID").setContent({".tooltip-inner":"Copy to clipboard"}),r.attr("data-bs-title","Copy to clipboard")},3e3),console.log("Async: Copying to clipboard was successful!")},function(i){console.error("Async: Could not copy text: ",i)})}),document.querySelector("#sendMessageButton").onclick=()=>{oa(fe)},Gs.addEventListener("keypress",function(r){let i=r;if(i.key==="Enter"&&!i.shiftKey)return oa(fe)}),document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(r=>new ot(r))}function oa(t){let e=Gs.value;Gs.value="",wt.writeln(`Me: ${Cr(e)}`),t.broadcastMessage({chatMessage:e})}function Sm(t,e){e&&wt.writeln(`${Cr(t)}: ${Cr(e==null?void 0:e.chatMessage)}`)}function Cr(t){return mm.sanitize(t)}function bm(t,e){console.log(`Connected to: ${t}`),wt.writeln(`Connected to: ${t}`),$l(e)}function Cm(t,e){console.log(`Disconnected from: ${t}`),wt.writeln(`Disconnected from: ${t}`),$l(e)}function $l(t){na.innerHTML="",t.forEach((e,r)=>{na.innerHTML+=`<li class="list-group-item ${e==fe.peer.id?"list-group-item-light":""}"> <span style="user-select:none">${r}: </span><span>${Cr(e)} </span></li>`})}
