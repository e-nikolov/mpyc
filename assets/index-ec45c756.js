var If=Object.defineProperty;var Bf=(t,e,r)=>e in t?If(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var ir=(t,e,r)=>(Bf(t,typeof e!="symbol"?e+"":e,r),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const f of a)if(f.type==="childList")for(const y of f.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&i(y)}).observe(document,{childList:!0,subtree:!0});function r(a){const f={};return a.integrity&&(f.integrity=a.integrity),a.referrerPolicy&&(f.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?f.credentials="include":a.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function i(a){if(a.ep)return;a.ep=!0;const f=r(a);fetch(a.href,f)}})();var Nf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ls(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var bl={exports:{}};(function(t){var e={};e.useBlobBuilder=function(){try{return new Blob([]),!1}catch{return!0}}(),e.useArrayBufferView=!e.useBlobBuilder&&function(){try{return new Blob([new Uint8Array([])]).size===0}catch{return!0}}(),t.exports.binaryFeatures=e;var r=t.exports.BlobBuilder;typeof window<"u"&&(r=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder);function i(){this._pieces=[],this._parts=[]}i.prototype.append=function(a){typeof a=="number"?this._pieces.push(a):(this.flush(),this._parts.push(a))},i.prototype.flush=function(){if(this._pieces.length>0){var a=new Uint8Array(this._pieces);e.useArrayBufferView||(a=a.buffer),this._parts.push(a),this._pieces=[]}},i.prototype.getBuffer=function(){if(this.flush(),e.useBlobBuilder){for(var a=new r,f=0,y=this._parts.length;f<y;f++)a.append(this._parts[f]);return a.getBlob()}else return new Blob(this._parts)},t.exports.BufferBuilder=i})(bl);var Cl=bl.exports,Hf=Cl.BufferBuilder,Ja=Cl.binaryFeatures,$f={unpack:function(t){var e=new rt(t);return e.unpack()},pack:function(t){var e=new it;e.pack(t);var r=e.getBuffer();return r}},Ff=$f;function rt(t){this.index=0,this.dataBuffer=t,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}rt.prototype.unpack=function(){var t=this.unpack_uint8();if(t<128)return t;if((t^224)<32)return(t^224)-32;var e;if((e=t^160)<=15)return this.unpack_raw(e);if((e=t^176)<=15)return this.unpack_string(e);if((e=t^144)<=15)return this.unpack_array(e);if((e=t^128)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}};rt.prototype.unpack_uint8=function(){var t=this.dataView[this.index]&255;return this.index++,t};rt.prototype.unpack_uint16=function(){var t=this.read(2),e=(t[0]&255)*256+(t[1]&255);return this.index+=2,e};rt.prototype.unpack_uint32=function(){var t=this.read(4),e=((t[0]*256+t[1])*256+t[2])*256+t[3];return this.index+=4,e};rt.prototype.unpack_uint64=function(){var t=this.read(8),e=((((((t[0]*256+t[1])*256+t[2])*256+t[3])*256+t[4])*256+t[5])*256+t[6])*256+t[7];return this.index+=8,e};rt.prototype.unpack_int8=function(){var t=this.unpack_uint8();return t<128?t:t-256};rt.prototype.unpack_int16=function(){var t=this.unpack_uint16();return t<32768?t:t-65536};rt.prototype.unpack_int32=function(){var t=this.unpack_uint32();return t<Math.pow(2,31)?t:t-Math.pow(2,32)};rt.prototype.unpack_int64=function(){var t=this.unpack_uint64();return t<Math.pow(2,63)?t:t-Math.pow(2,64)};rt.prototype.unpack_raw=function(t){if(this.length<this.index+t)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+t+" "+this.length);var e=this.dataBuffer.slice(this.index,this.index+t);return this.index+=t,e};rt.prototype.unpack_string=function(t){for(var e=this.read(t),r=0,i="",a,f;r<t;)a=e[r],a<128?(i+=String.fromCharCode(a),r++):(a^192)<32?(f=(a^192)<<6|e[r+1]&63,i+=String.fromCharCode(f),r+=2):(f=(a&15)<<12|(e[r+1]&63)<<6|e[r+2]&63,i+=String.fromCharCode(f),r+=3);return this.index+=t,i};rt.prototype.unpack_array=function(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=this.unpack();return e};rt.prototype.unpack_map=function(t){for(var e={},r=0;r<t;r++){var i=this.unpack(),a=this.unpack();e[i]=a}return e};rt.prototype.unpack_float=function(){var t=this.unpack_uint32(),e=t>>31,r=(t>>23&255)-127,i=t&8388607|8388608;return(e===0?1:-1)*i*Math.pow(2,r-23)};rt.prototype.unpack_double=function(){var t=this.unpack_uint32(),e=this.unpack_uint32(),r=t>>31,i=(t>>20&2047)-1023,a=t&1048575|1048576,f=a*Math.pow(2,i-20)+e*Math.pow(2,i-52);return(r===0?1:-1)*f};rt.prototype.read=function(t){var e=this.index;if(e+t<=this.length)return this.dataView.subarray(e,e+t);throw new Error("BinaryPackFailure: read index out of range")};function it(){this.bufferBuilder=new Hf}it.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()};it.prototype.pack=function(t){var e=typeof t;if(e==="string")this.pack_string(t);else if(e==="number")Math.floor(t)===t?this.pack_integer(t):this.pack_double(t);else if(e==="boolean")t===!0?this.bufferBuilder.append(195):t===!1&&this.bufferBuilder.append(194);else if(e==="undefined")this.bufferBuilder.append(192);else if(e==="object")if(t===null)this.bufferBuilder.append(192);else{var r=t.constructor;if(r==Array)this.pack_array(t);else if(r==Blob||r==File||t instanceof Blob||t instanceof File)this.pack_bin(t);else if(r==ArrayBuffer)Ja.useArrayBufferView?this.pack_bin(new Uint8Array(t)):this.pack_bin(t);else if("BYTES_PER_ELEMENT"in t)Ja.useArrayBufferView?this.pack_bin(new Uint8Array(t.buffer)):this.pack_bin(t.buffer);else if(r==Object||r.toString().startsWith("class"))this.pack_object(t);else if(r==Date)this.pack_string(t.toString());else if(typeof t.toBinaryPack=="function")this.bufferBuilder.append(t.toBinaryPack());else throw new Error('Type "'+r.toString()+'" not yet supported')}else throw new Error('Type "'+e+'" not yet supported');this.bufferBuilder.flush()};it.prototype.pack_bin=function(t){var e=t.length||t.byteLength||t.size;if(e<=15)this.pack_uint8(160+e);else if(e<=65535)this.bufferBuilder.append(218),this.pack_uint16(e);else if(e<=4294967295)this.bufferBuilder.append(219),this.pack_uint32(e);else throw new Error("Invalid length");this.bufferBuilder.append(t)};it.prototype.pack_string=function(t){var e=Uf(t);if(e<=15)this.pack_uint8(176+e);else if(e<=65535)this.bufferBuilder.append(216),this.pack_uint16(e);else if(e<=4294967295)this.bufferBuilder.append(217),this.pack_uint32(e);else throw new Error("Invalid length");this.bufferBuilder.append(t)};it.prototype.pack_array=function(t){var e=t.length;if(e<=15)this.pack_uint8(144+e);else if(e<=65535)this.bufferBuilder.append(220),this.pack_uint16(e);else if(e<=4294967295)this.bufferBuilder.append(221),this.pack_uint32(e);else throw new Error("Invalid length");for(var r=0;r<e;r++)this.pack(t[r])};it.prototype.pack_integer=function(t){if(t>=-32&&t<=127)this.bufferBuilder.append(t&255);else if(t>=0&&t<=255)this.bufferBuilder.append(204),this.pack_uint8(t);else if(t>=-128&&t<=127)this.bufferBuilder.append(208),this.pack_int8(t);else if(t>=0&&t<=65535)this.bufferBuilder.append(205),this.pack_uint16(t);else if(t>=-32768&&t<=32767)this.bufferBuilder.append(209),this.pack_int16(t);else if(t>=0&&t<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(t);else if(t>=-2147483648&&t<=2147483647)this.bufferBuilder.append(210),this.pack_int32(t);else if(t>=-9223372036854776e3&&t<=9223372036854776e3)this.bufferBuilder.append(211),this.pack_int64(t);else if(t>=0&&t<=18446744073709552e3)this.bufferBuilder.append(207),this.pack_uint64(t);else throw new Error("Invalid integer")};it.prototype.pack_double=function(t){var e=0;t<0&&(e=1,t=-t);var r=Math.floor(Math.log(t)/Math.LN2),i=t/Math.pow(2,r)-1,a=Math.floor(i*Math.pow(2,52)),f=Math.pow(2,32),y=e<<31|r+1023<<20|a/f&1048575,s=a%f;this.bufferBuilder.append(203),this.pack_int32(y),this.pack_int32(s)};it.prototype.pack_object=function(t){var e=Object.keys(t),r=e.length;if(r<=15)this.pack_uint8(128+r);else if(r<=65535)this.bufferBuilder.append(222),this.pack_uint16(r);else if(r<=4294967295)this.bufferBuilder.append(223),this.pack_uint32(r);else throw new Error("Invalid length");for(var i in t)t.hasOwnProperty(i)&&(this.pack(i),this.pack(t[i]))};it.prototype.pack_uint8=function(t){this.bufferBuilder.append(t)};it.prototype.pack_uint16=function(t){this.bufferBuilder.append(t>>8),this.bufferBuilder.append(t&255)};it.prototype.pack_uint32=function(t){var e=t&4294967295;this.bufferBuilder.append((e&4278190080)>>>24),this.bufferBuilder.append((e&16711680)>>>16),this.bufferBuilder.append((e&65280)>>>8),this.bufferBuilder.append(e&255)};it.prototype.pack_uint64=function(t){var e=t/Math.pow(2,32),r=t%Math.pow(2,32);this.bufferBuilder.append((e&4278190080)>>>24),this.bufferBuilder.append((e&16711680)>>>16),this.bufferBuilder.append((e&65280)>>>8),this.bufferBuilder.append(e&255),this.bufferBuilder.append((r&4278190080)>>>24),this.bufferBuilder.append((r&16711680)>>>16),this.bufferBuilder.append((r&65280)>>>8),this.bufferBuilder.append(r&255)};it.prototype.pack_int8=function(t){this.bufferBuilder.append(t&255)};it.prototype.pack_int16=function(t){this.bufferBuilder.append((t&65280)>>8),this.bufferBuilder.append(t&255)};it.prototype.pack_int32=function(t){this.bufferBuilder.append(t>>>24&255),this.bufferBuilder.append((t&16711680)>>>16),this.bufferBuilder.append((t&65280)>>>8),this.bufferBuilder.append(t&255)};it.prototype.pack_int64=function(t){var e=Math.floor(t/Math.pow(2,32)),r=t%Math.pow(2,32);this.bufferBuilder.append((e&4278190080)>>>24),this.bufferBuilder.append((e&16711680)>>>16),this.bufferBuilder.append((e&65280)>>>8),this.bufferBuilder.append(e&255),this.bufferBuilder.append((r&4278190080)>>>24),this.bufferBuilder.append((r&16711680)>>>16),this.bufferBuilder.append((r&65280)>>>8),this.bufferBuilder.append(r&255)};function jf(t){var e=t.charCodeAt(0);return e<=2047?"00":e<=65535?"000":e<=2097151?"0000":e<=67108863?"00000":"000000"}function Uf(t){return t.length>600?new Blob([t]).size:t.replace(/[^\u0000-\u007F]/g,jf).length}const Qa=ls(Ff);let El=!0,Tl=!0;function Yi(t,e,r){const i=t.match(e);return i&&i.length>=r&&parseInt(i[r],10)}function Ai(t,e,r){if(!t.RTCPeerConnection)return;const i=t.RTCPeerConnection.prototype,a=i.addEventListener;i.addEventListener=function(y,s){if(y!==e)return a.apply(this,arguments);const o=c=>{const d=r(c);d&&(s.handleEvent?s.handleEvent(d):s(d))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(s,o),a.apply(this,[y,o])};const f=i.removeEventListener;i.removeEventListener=function(y,s){if(y!==e||!this._eventMap||!this._eventMap[e])return f.apply(this,arguments);if(!this._eventMap[e].has(s))return f.apply(this,arguments);const o=this._eventMap[e].get(s);return this._eventMap[e].delete(s),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,f.apply(this,[y,o])},Object.defineProperty(i,"on"+e,{get(){return this["_on"+e]},set(y){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),y&&this.addEventListener(e,this["_on"+e]=y)},enumerable:!0,configurable:!0})}function Wf(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(El=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function zf(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(Tl=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function ea(){if(typeof window=="object"){if(El)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function hs(t,e){Tl&&console.warn(t+" is deprecated, please use "+e+" instead.")}function Vf(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator)return e.browser="Not a browser.",e;const{navigator:r}=t;if(r.mozGetUserMedia)e.browser="firefox",e.version=Yi(r.userAgent,/Firefox\/(\d+)\./,1);else if(r.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection&&!t.RTCIceGatherer)e.browser="chrome",e.version=Yi(r.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(r.mediaDevices&&r.userAgent.match(/Edge\/(\d+).(\d+)$/))e.browser="edge",e.version=Yi(r.userAgent,/Edge\/(\d+).(\d+)$/,2);else if(t.RTCPeerConnection&&r.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=Yi(r.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function Za(t){return Object.prototype.toString.call(t)==="[object Object]"}function wl(t){return Za(t)?Object.keys(t).reduce(function(e,r){const i=Za(t[r]),a=i?wl(t[r]):t[r],f=i&&!Object.keys(a).length;return a===void 0||f?e:Object.assign(e,{[r]:a})},{}):t}function go(t,e,r){!e||r.has(e.id)||(r.set(e.id,e),Object.keys(e).forEach(i=>{i.endsWith("Id")?go(t,t.get(e[i]),r):i.endsWith("Ids")&&e[i].forEach(a=>{go(t,t.get(a),r)})}))}function ec(t,e,r){const i=r?"outbound-rtp":"inbound-rtp",a=new Map;if(e===null)return a;const f=[];return t.forEach(y=>{y.type==="track"&&y.trackIdentifier===e.id&&f.push(y)}),f.forEach(y=>{t.forEach(s=>{s.type===i&&s.trackId===y.id&&go(t,s,a)})}),a}const tc=ea;function kl(t,e){const r=t&&t.navigator;if(!r.mediaDevices)return;const i=function(s){if(typeof s!="object"||s.mandatory||s.optional)return s;const o={};return Object.keys(s).forEach(c=>{if(c==="require"||c==="advanced"||c==="mediaSource")return;const d=typeof s[c]=="object"?s[c]:{ideal:s[c]};d.exact!==void 0&&typeof d.exact=="number"&&(d.min=d.max=d.exact);const _=function(v,E){return v?v+E.charAt(0).toUpperCase()+E.slice(1):E==="deviceId"?"sourceId":E};if(d.ideal!==void 0){o.optional=o.optional||[];let v={};typeof d.ideal=="number"?(v[_("min",c)]=d.ideal,o.optional.push(v),v={},v[_("max",c)]=d.ideal,o.optional.push(v)):(v[_("",c)]=d.ideal,o.optional.push(v))}d.exact!==void 0&&typeof d.exact!="number"?(o.mandatory=o.mandatory||{},o.mandatory[_("",c)]=d.exact):["min","max"].forEach(v=>{d[v]!==void 0&&(o.mandatory=o.mandatory||{},o.mandatory[_(v,c)]=d[v])})}),s.advanced&&(o.optional=(o.optional||[]).concat(s.advanced)),o},a=function(s,o){if(e.version>=61)return o(s);if(s=JSON.parse(JSON.stringify(s)),s&&typeof s.audio=="object"){const c=function(d,_,v){_ in d&&!(v in d)&&(d[v]=d[_],delete d[_])};s=JSON.parse(JSON.stringify(s)),c(s.audio,"autoGainControl","googAutoGainControl"),c(s.audio,"noiseSuppression","googNoiseSuppression"),s.audio=i(s.audio)}if(s&&typeof s.video=="object"){let c=s.video.facingMode;c=c&&(typeof c=="object"?c:{ideal:c});const d=e.version<66;if(c&&(c.exact==="user"||c.exact==="environment"||c.ideal==="user"||c.ideal==="environment")&&!(r.mediaDevices.getSupportedConstraints&&r.mediaDevices.getSupportedConstraints().facingMode&&!d)){delete s.video.facingMode;let _;if(c.exact==="environment"||c.ideal==="environment"?_=["back","rear"]:(c.exact==="user"||c.ideal==="user")&&(_=["front"]),_)return r.mediaDevices.enumerateDevices().then(v=>{v=v.filter(C=>C.kind==="videoinput");let E=v.find(C=>_.some(S=>C.label.toLowerCase().includes(S)));return!E&&v.length&&_.includes("back")&&(E=v[v.length-1]),E&&(s.video.deviceId=c.exact?{exact:E.deviceId}:{ideal:E.deviceId}),s.video=i(s.video),tc("chrome: "+JSON.stringify(s)),o(s)})}s.video=i(s.video)}return tc("chrome: "+JSON.stringify(s)),o(s)},f=function(s){return e.version>=64?s:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[s.name]||s.name,message:s.message,constraint:s.constraint||s.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},y=function(s,o,c){a(s,d=>{r.webkitGetUserMedia(d,o,_=>{c&&c(f(_))})})};if(r.getUserMedia=y.bind(r),r.mediaDevices.getUserMedia){const s=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(o){return a(o,c=>s(c).then(d=>{if(c.audio&&!d.getAudioTracks().length||c.video&&!d.getVideoTracks().length)throw d.getTracks().forEach(_=>{_.stop()}),new DOMException("","NotFoundError");return d},d=>Promise.reject(f(d))))}}}function qf(t,e){if(!(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices)&&t.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}t.navigator.mediaDevices.getDisplayMedia=function(i){return e(i).then(a=>{const f=i.video&&i.video.width,y=i.video&&i.video.height,s=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:a,maxFrameRate:s||3}},f&&(i.video.mandatory.maxWidth=f),y&&(i.video.mandatory.maxHeight=y),t.navigator.mediaDevices.getUserMedia(i)})}}}function Al(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function Rl(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(r){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=r)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=i=>{i.stream.addEventListener("addtrack",a=>{let f;t.RTCPeerConnection.prototype.getReceivers?f=this.getReceivers().find(s=>s.track&&s.track.id===a.track.id):f={track:a.track};const y=new Event("track");y.track=a.track,y.receiver=f,y.transceiver={receiver:f},y.streams=[i.stream],this.dispatchEvent(y)}),i.stream.getTracks().forEach(a=>{let f;t.RTCPeerConnection.prototype.getReceivers?f=this.getReceivers().find(s=>s.track&&s.track.id===a.id):f={track:a};const y=new Event("track");y.track=a,y.receiver=f,y.transceiver={receiver:f},y.streams=[i.stream],this.dispatchEvent(y)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Ai(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function xl(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(a,f){return{track:f,get dtmf(){return this._dtmf===void 0&&(f.kind==="audio"?this._dtmf=a.createDTMFSender(f):this._dtmf=null),this._dtmf},_pc:a}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const a=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(s,o){let c=a.apply(this,arguments);return c||(c=e(this,s),this._senders.push(c)),c};const f=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(s){f.apply(this,arguments);const o=this._senders.indexOf(s);o!==-1&&this._senders.splice(o,1)}}const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(f){this._senders=this._senders||[],r.apply(this,[f]),f.getTracks().forEach(y=>{this._senders.push(e(this,y))})};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(f){this._senders=this._senders||[],i.apply(this,[f]),f.getTracks().forEach(y=>{const s=this._senders.find(o=>o.track===y);s&&this._senders.splice(this._senders.indexOf(s),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(a=>a._pc=this),i},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Dl(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[i,a,f]=arguments;if(arguments.length>0&&typeof i=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof i!="function"))return e.apply(this,[]);const y=function(o){const c={};return o.result().forEach(_=>{const v={id:_.id,timestamp:_.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[_.type]||_.type};_.names().forEach(E=>{v[E]=_.stat(E)}),c[v.id]=v}),c},s=function(o){return new Map(Object.keys(o).map(c=>[c,o[c]]))};if(arguments.length>=2){const o=function(c){a(s(y(c)))};return e.apply(this,[o,i])}return new Promise((o,c)=>{e.apply(this,[function(d){o(s(y(d)))},c])}).then(a,f)}}function Ll(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const r=t.RTCPeerConnection.prototype.getSenders;r&&(t.RTCPeerConnection.prototype.getSenders=function(){const f=r.apply(this,[]);return f.forEach(y=>y._pc=this),f});const i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function(){const f=i.apply(this,arguments);return f._pc=this,f}),t.RTCRtpSender.prototype.getStats=function(){const f=this;return this._pc.getStats().then(y=>ec(y,f.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const r=t.RTCPeerConnection.prototype.getReceivers;r&&(t.RTCPeerConnection.prototype.getReceivers=function(){const a=r.apply(this,[]);return a.forEach(f=>f._pc=this),a}),Ai(t,"track",i=>(i.receiver._pc=i.srcElement,i)),t.RTCRtpReceiver.prototype.getStats=function(){const a=this;return this._pc.getStats().then(f=>ec(f,a.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const i=arguments[0];let a,f,y;return this.getSenders().forEach(s=>{s.track===i&&(a?y=!0:a=s)}),this.getReceivers().forEach(s=>(s.track===i&&(f?y=!0:f=s),s.track===i)),y||a&&f?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):a?a.getStats():f?f.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function Ol(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(y=>this._shimmedLocalStreams[y][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(y,s){if(!s)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const o=e.apply(this,arguments);return this._shimmedLocalStreams[s.id]?this._shimmedLocalStreams[s.id].indexOf(o)===-1&&this._shimmedLocalStreams[s.id].push(o):this._shimmedLocalStreams[s.id]=[s,o],o};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(y){this._shimmedLocalStreams=this._shimmedLocalStreams||{},y.getTracks().forEach(c=>{if(this.getSenders().find(_=>_.track===c))throw new DOMException("Track already exists.","InvalidAccessError")});const s=this.getSenders();r.apply(this,arguments);const o=this.getSenders().filter(c=>s.indexOf(c)===-1);this._shimmedLocalStreams[y.id]=[y].concat(o)};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(y){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[y.id],i.apply(this,arguments)};const a=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(y){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},y&&Object.keys(this._shimmedLocalStreams).forEach(s=>{const o=this._shimmedLocalStreams[s].indexOf(y);o!==-1&&this._shimmedLocalStreams[s].splice(o,1),this._shimmedLocalStreams[s].length===1&&delete this._shimmedLocalStreams[s]}),a.apply(this,arguments)}}function Pl(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return Ol(t);const r=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const d=r.apply(this);return this._reverseStreams=this._reverseStreams||{},d.map(_=>this._reverseStreams[_.id])};const i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(d){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},d.getTracks().forEach(_=>{if(this.getSenders().find(E=>E.track===_))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[d.id]){const _=new t.MediaStream(d.getTracks());this._streams[d.id]=_,this._reverseStreams[_.id]=d,d=_}i.apply(this,[d])};const a=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(d){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},a.apply(this,[this._streams[d.id]||d]),delete this._reverseStreams[this._streams[d.id]?this._streams[d.id].id:d.id],delete this._streams[d.id]},t.RTCPeerConnection.prototype.addTrack=function(d,_){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const v=[].slice.call(arguments,1);if(v.length!==1||!v[0].getTracks().find(S=>S===d))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(S=>S.track===d))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const C=this._streams[_.id];if(C)C.addTrack(d),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const S=new t.MediaStream([d]);this._streams[_.id]=S,this._reverseStreams[S.id]=_,this.addStream(S)}return this.getSenders().find(S=>S.track===d)};function f(c,d){let _=d.sdp;return Object.keys(c._reverseStreams||[]).forEach(v=>{const E=c._reverseStreams[v],C=c._streams[E.id];_=_.replace(new RegExp(C.id,"g"),E.id)}),new RTCSessionDescription({type:d.type,sdp:_})}function y(c,d){let _=d.sdp;return Object.keys(c._reverseStreams||[]).forEach(v=>{const E=c._reverseStreams[v],C=c._streams[E.id];_=_.replace(new RegExp(E.id,"g"),C.id)}),new RTCSessionDescription({type:d.type,sdp:_})}["createOffer","createAnswer"].forEach(function(c){const d=t.RTCPeerConnection.prototype[c],_={[c](){const v=arguments;return arguments.length&&typeof arguments[0]=="function"?d.apply(this,[C=>{const S=f(this,C);v[0].apply(null,[S])},C=>{v[1]&&v[1].apply(null,C)},arguments[2]]):d.apply(this,arguments).then(C=>f(this,C))}};t.RTCPeerConnection.prototype[c]=_[c]});const s=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?s.apply(this,arguments):(arguments[0]=y(this,arguments[0]),s.apply(this,arguments))};const o=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const c=o.get.apply(this);return c.type===""?c:f(this,c)}}),t.RTCPeerConnection.prototype.removeTrack=function(d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!d._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(d._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let v;Object.keys(this._streams).forEach(E=>{this._streams[E].getTracks().find(S=>d.track===S)&&(v=this._streams[E])}),v&&(v.getTracks().length===1?this.removeStream(this._reverseStreams[v.id]):v.removeTrack(d.track),this.dispatchEvent(new Event("negotiationneeded")))}}function mo(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const i=t.RTCPeerConnection.prototype[r],a={[r](){return arguments[0]=new(r==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};t.RTCPeerConnection.prototype[r]=a[r]})}function Ml(t,e){Ai(t,"negotiationneeded",r=>{const i=r.target;if(!((e.version<72||i.getConfiguration&&i.getConfiguration().sdpSemantics==="plan-b")&&i.signalingState!=="stable"))return r})}const rc=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:Ml,shimAddTrackRemoveTrack:Pl,shimAddTrackRemoveTrackWithNative:Ol,shimGetDisplayMedia:qf,shimGetSendersWithDtmf:xl,shimGetStats:Dl,shimGetUserMedia:kl,shimMediaStream:Al,shimOnTrack:Rl,shimPeerConnection:mo,shimSenderReceiverGetStats:Ll},Symbol.toStringTag,{value:"Module"}));function Kf(t,e){let r=!1;return t=JSON.parse(JSON.stringify(t)),t.filter(i=>{if(i&&(i.urls||i.url)){let a=i.urls||i.url;i.url&&!i.urls&&hs("RTCIceServer.url","RTCIceServer.urls");const f=typeof a=="string";return f&&(a=[a]),a=a.filter(y=>{if(y.indexOf("stun:")===0)return!1;const s=y.startsWith("turn")&&!y.startsWith("turn:[")&&y.includes("transport=udp");return s&&!r?(r=!0,!0):s&&!r}),delete i.url,i.urls=f?a[0]:a,!!a.length}})}var Il={exports:{}};(function(t){var e={};e.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},e.localCName=e.generateIdentifier(),e.splitLines=function(r){return r.trim().split(`
`).map(function(i){return i.trim()})},e.splitSections=function(r){var i=r.split(`
m=`);return i.map(function(a,f){return(f>0?"m="+a:a).trim()+`\r
`})},e.getDescription=function(r){var i=e.splitSections(r);return i&&i[0]},e.getMediaSections=function(r){var i=e.splitSections(r);return i.shift(),i},e.matchPrefix=function(r,i){return e.splitLines(r).filter(function(a){return a.indexOf(i)===0})},e.parseCandidate=function(r){var i;r.indexOf("a=candidate:")===0?i=r.substring(12).split(" "):i=r.substring(10).split(" ");for(var a={foundation:i[0],component:parseInt(i[1],10),protocol:i[2].toLowerCase(),priority:parseInt(i[3],10),ip:i[4],address:i[4],port:parseInt(i[5],10),type:i[7]},f=8;f<i.length;f+=2)switch(i[f]){case"raddr":a.relatedAddress=i[f+1];break;case"rport":a.relatedPort=parseInt(i[f+1],10);break;case"tcptype":a.tcpType=i[f+1];break;case"ufrag":a.ufrag=i[f+1],a.usernameFragment=i[f+1];break;default:a[i[f]]=i[f+1];break}return a},e.writeCandidate=function(r){var i=[];i.push(r.foundation),i.push(r.component),i.push(r.protocol.toUpperCase()),i.push(r.priority),i.push(r.address||r.ip),i.push(r.port);var a=r.type;return i.push("typ"),i.push(a),a!=="host"&&r.relatedAddress&&r.relatedPort&&(i.push("raddr"),i.push(r.relatedAddress),i.push("rport"),i.push(r.relatedPort)),r.tcpType&&r.protocol.toLowerCase()==="tcp"&&(i.push("tcptype"),i.push(r.tcpType)),(r.usernameFragment||r.ufrag)&&(i.push("ufrag"),i.push(r.usernameFragment||r.ufrag)),"candidate:"+i.join(" ")},e.parseIceOptions=function(r){return r.substr(14).split(" ")},e.parseRtpMap=function(r){var i=r.substr(9).split(" "),a={payloadType:parseInt(i.shift(),10)};return i=i[0].split("/"),a.name=i[0],a.clockRate=parseInt(i[1],10),a.channels=i.length===3?parseInt(i[2],10):1,a.numChannels=a.channels,a},e.writeRtpMap=function(r){var i=r.payloadType;r.preferredPayloadType!==void 0&&(i=r.preferredPayloadType);var a=r.channels||r.numChannels||1;return"a=rtpmap:"+i+" "+r.name+"/"+r.clockRate+(a!==1?"/"+a:"")+`\r
`},e.parseExtmap=function(r){var i=r.substr(9).split(" ");return{id:parseInt(i[0],10),direction:i[0].indexOf("/")>0?i[0].split("/")[1]:"sendrecv",uri:i[1]}},e.writeExtmap=function(r){return"a=extmap:"+(r.id||r.preferredId)+(r.direction&&r.direction!=="sendrecv"?"/"+r.direction:"")+" "+r.uri+`\r
`},e.parseFmtp=function(r){for(var i={},a,f=r.substr(r.indexOf(" ")+1).split(";"),y=0;y<f.length;y++)a=f[y].trim().split("="),i[a[0].trim()]=a[1];return i},e.writeFmtp=function(r){var i="",a=r.payloadType;if(r.preferredPayloadType!==void 0&&(a=r.preferredPayloadType),r.parameters&&Object.keys(r.parameters).length){var f=[];Object.keys(r.parameters).forEach(function(y){r.parameters[y]?f.push(y+"="+r.parameters[y]):f.push(y)}),i+="a=fmtp:"+a+" "+f.join(";")+`\r
`}return i},e.parseRtcpFb=function(r){var i=r.substr(r.indexOf(" ")+1).split(" ");return{type:i.shift(),parameter:i.join(" ")}},e.writeRtcpFb=function(r){var i="",a=r.payloadType;return r.preferredPayloadType!==void 0&&(a=r.preferredPayloadType),r.rtcpFeedback&&r.rtcpFeedback.length&&r.rtcpFeedback.forEach(function(f){i+="a=rtcp-fb:"+a+" "+f.type+(f.parameter&&f.parameter.length?" "+f.parameter:"")+`\r
`}),i},e.parseSsrcMedia=function(r){var i=r.indexOf(" "),a={ssrc:parseInt(r.substr(7,i-7),10)},f=r.indexOf(":",i);return f>-1?(a.attribute=r.substr(i+1,f-i-1),a.value=r.substr(f+1)):a.attribute=r.substr(i+1),a},e.parseSsrcGroup=function(r){var i=r.substr(13).split(" ");return{semantics:i.shift(),ssrcs:i.map(function(a){return parseInt(a,10)})}},e.getMid=function(r){var i=e.matchPrefix(r,"a=mid:")[0];if(i)return i.substr(6)},e.parseFingerprint=function(r){var i=r.substr(14).split(" ");return{algorithm:i[0].toLowerCase(),value:i[1]}},e.getDtlsParameters=function(r,i){var a=e.matchPrefix(r+i,"a=fingerprint:");return{role:"auto",fingerprints:a.map(e.parseFingerprint)}},e.writeDtlsParameters=function(r,i){var a="a=setup:"+i+`\r
`;return r.fingerprints.forEach(function(f){a+="a=fingerprint:"+f.algorithm+" "+f.value+`\r
`}),a},e.parseCryptoLine=function(r){var i=r.substr(9).split(" ");return{tag:parseInt(i[0],10),cryptoSuite:i[1],keyParams:i[2],sessionParams:i.slice(3)}},e.writeCryptoLine=function(r){return"a=crypto:"+r.tag+" "+r.cryptoSuite+" "+(typeof r.keyParams=="object"?e.writeCryptoKeyParams(r.keyParams):r.keyParams)+(r.sessionParams?" "+r.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(r){if(r.indexOf("inline:")!==0)return null;var i=r.substr(7).split("|");return{keyMethod:"inline",keySalt:i[0],lifeTime:i[1],mkiValue:i[2]?i[2].split(":")[0]:void 0,mkiLength:i[2]?i[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(r){return r.keyMethod+":"+r.keySalt+(r.lifeTime?"|"+r.lifeTime:"")+(r.mkiValue&&r.mkiLength?"|"+r.mkiValue+":"+r.mkiLength:"")},e.getCryptoParameters=function(r,i){var a=e.matchPrefix(r+i,"a=crypto:");return a.map(e.parseCryptoLine)},e.getIceParameters=function(r,i){var a=e.matchPrefix(r+i,"a=ice-ufrag:")[0],f=e.matchPrefix(r+i,"a=ice-pwd:")[0];return a&&f?{usernameFragment:a.substr(12),password:f.substr(10)}:null},e.writeIceParameters=function(r){return"a=ice-ufrag:"+r.usernameFragment+`\r
a=ice-pwd:`+r.password+`\r
`},e.parseRtpParameters=function(r){for(var i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},a=e.splitLines(r),f=a[0].split(" "),y=3;y<f.length;y++){var s=f[y],o=e.matchPrefix(r,"a=rtpmap:"+s+" ")[0];if(o){var c=e.parseRtpMap(o),d=e.matchPrefix(r,"a=fmtp:"+s+" ");switch(c.parameters=d.length?e.parseFmtp(d[0]):{},c.rtcpFeedback=e.matchPrefix(r,"a=rtcp-fb:"+s+" ").map(e.parseRtcpFb),i.codecs.push(c),c.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(c.name.toUpperCase());break}}}return e.matchPrefix(r,"a=extmap:").forEach(function(_){i.headerExtensions.push(e.parseExtmap(_))}),i},e.writeRtpDescription=function(r,i){var a="";a+="m="+r+" ",a+=i.codecs.length>0?"9":"0",a+=" UDP/TLS/RTP/SAVPF ",a+=i.codecs.map(function(y){return y.preferredPayloadType!==void 0?y.preferredPayloadType:y.payloadType}).join(" ")+`\r
`,a+=`c=IN IP4 0.0.0.0\r
`,a+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,i.codecs.forEach(function(y){a+=e.writeRtpMap(y),a+=e.writeFmtp(y),a+=e.writeRtcpFb(y)});var f=0;return i.codecs.forEach(function(y){y.maxptime>f&&(f=y.maxptime)}),f>0&&(a+="a=maxptime:"+f+`\r
`),a+=`a=rtcp-mux\r
`,i.headerExtensions&&i.headerExtensions.forEach(function(y){a+=e.writeExtmap(y)}),a},e.parseRtpEncodingParameters=function(r){var i=[],a=e.parseRtpParameters(r),f=a.fecMechanisms.indexOf("RED")!==-1,y=a.fecMechanisms.indexOf("ULPFEC")!==-1,s=e.matchPrefix(r,"a=ssrc:").map(function(v){return e.parseSsrcMedia(v)}).filter(function(v){return v.attribute==="cname"}),o=s.length>0&&s[0].ssrc,c,d=e.matchPrefix(r,"a=ssrc-group:FID").map(function(v){var E=v.substr(17).split(" ");return E.map(function(C){return parseInt(C,10)})});d.length>0&&d[0].length>1&&d[0][0]===o&&(c=d[0][1]),a.codecs.forEach(function(v){if(v.name.toUpperCase()==="RTX"&&v.parameters.apt){var E={ssrc:o,codecPayloadType:parseInt(v.parameters.apt,10)};o&&c&&(E.rtx={ssrc:c}),i.push(E),f&&(E=JSON.parse(JSON.stringify(E)),E.fec={ssrc:o,mechanism:y?"red+ulpfec":"red"},i.push(E))}}),i.length===0&&o&&i.push({ssrc:o});var _=e.matchPrefix(r,"b=");return _.length&&(_[0].indexOf("b=TIAS:")===0?_=parseInt(_[0].substr(7),10):_[0].indexOf("b=AS:")===0?_=parseInt(_[0].substr(5),10)*1e3*.95-50*40*8:_=void 0,i.forEach(function(v){v.maxBitrate=_})),i},e.parseRtcpParameters=function(r){var i={},a=e.matchPrefix(r,"a=ssrc:").map(function(s){return e.parseSsrcMedia(s)}).filter(function(s){return s.attribute==="cname"})[0];a&&(i.cname=a.value,i.ssrc=a.ssrc);var f=e.matchPrefix(r,"a=rtcp-rsize");i.reducedSize=f.length>0,i.compound=f.length===0;var y=e.matchPrefix(r,"a=rtcp-mux");return i.mux=y.length>0,i},e.parseMsid=function(r){var i,a=e.matchPrefix(r,"a=msid:");if(a.length===1)return i=a[0].substr(7).split(" "),{stream:i[0],track:i[1]};var f=e.matchPrefix(r,"a=ssrc:").map(function(y){return e.parseSsrcMedia(y)}).filter(function(y){return y.attribute==="msid"});if(f.length>0)return i=f[0].value.split(" "),{stream:i[0],track:i[1]}},e.parseSctpDescription=function(r){var i=e.parseMLine(r),a=e.matchPrefix(r,"a=max-message-size:"),f;a.length>0&&(f=parseInt(a[0].substr(19),10)),isNaN(f)&&(f=65536);var y=e.matchPrefix(r,"a=sctp-port:");if(y.length>0)return{port:parseInt(y[0].substr(12),10),protocol:i.fmt,maxMessageSize:f};var s=e.matchPrefix(r,"a=sctpmap:");if(s.length>0){var o=e.matchPrefix(r,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(o[0],10),protocol:o[1],maxMessageSize:f}}},e.writeSctpDescription=function(r,i){var a=[];return r.protocol!=="DTLS/SCTP"?a=["m="+r.kind+" 9 "+r.protocol+" "+i.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+i.port+`\r
`]:a=["m="+r.kind+" 9 "+r.protocol+" "+i.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+i.port+" "+i.protocol+` 65535\r
`],i.maxMessageSize!==void 0&&a.push("a=max-message-size:"+i.maxMessageSize+`\r
`),a.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,21)},e.writeSessionBoilerplate=function(r,i,a){var f,y=i!==void 0?i:2;r?f=r:f=e.generateSessionId();var s=a||"thisisadapterortc";return`v=0\r
o=`+s+" "+f+" "+y+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.writeMediaSection=function(r,i,a,f){var y=e.writeRtpDescription(r.kind,i);if(y+=e.writeIceParameters(r.iceGatherer.getLocalParameters()),y+=e.writeDtlsParameters(r.dtlsTransport.getLocalParameters(),a==="offer"?"actpass":"active"),y+="a=mid:"+r.mid+`\r
`,r.direction?y+="a="+r.direction+`\r
`:r.rtpSender&&r.rtpReceiver?y+=`a=sendrecv\r
`:r.rtpSender?y+=`a=sendonly\r
`:r.rtpReceiver?y+=`a=recvonly\r
`:y+=`a=inactive\r
`,r.rtpSender){var s="msid:"+f.id+" "+r.rtpSender.track.id+`\r
`;y+="a="+s,y+="a=ssrc:"+r.sendEncodingParameters[0].ssrc+" "+s,r.sendEncodingParameters[0].rtx&&(y+="a=ssrc:"+r.sendEncodingParameters[0].rtx.ssrc+" "+s,y+="a=ssrc-group:FID "+r.sendEncodingParameters[0].ssrc+" "+r.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return y+="a=ssrc:"+r.sendEncodingParameters[0].ssrc+" cname:"+e.localCName+`\r
`,r.rtpSender&&r.sendEncodingParameters[0].rtx&&(y+="a=ssrc:"+r.sendEncodingParameters[0].rtx.ssrc+" cname:"+e.localCName+`\r
`),y},e.getDirection=function(r,i){for(var a=e.splitLines(r),f=0;f<a.length;f++)switch(a[f]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return a[f].substr(2)}return i?e.getDirection(i):"sendrecv"},e.getKind=function(r){var i=e.splitLines(r),a=i[0].split(" ");return a[0].substr(2)},e.isRejected=function(r){return r.split(" ",2)[1]==="0"},e.parseMLine=function(r){var i=e.splitLines(r),a=i[0].substr(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}},e.parseOLine=function(r){var i=e.matchPrefix(r,"o=")[0],a=i.substr(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}},e.isValidSDP=function(r){if(typeof r!="string"||r.length===0)return!1;for(var i=e.splitLines(r),a=0;a<i.length;a++)if(i[a].length<2||i[a].charAt(1)!=="=")return!1;return!0},t.exports=e})(Il);var Bl=Il.exports;const jn=ls(Bl);var ke=Bl;function Gf(t){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type}function ic(t,e,r,i,a){var f=ke.writeRtpDescription(t.kind,e);if(f+=ke.writeIceParameters(t.iceGatherer.getLocalParameters()),f+=ke.writeDtlsParameters(t.dtlsTransport.getLocalParameters(),r==="offer"?"actpass":a||"active"),f+="a=mid:"+t.mid+`\r
`,t.rtpSender&&t.rtpReceiver?f+=`a=sendrecv\r
`:t.rtpSender?f+=`a=sendonly\r
`:t.rtpReceiver?f+=`a=recvonly\r
`:f+=`a=inactive\r
`,t.rtpSender){var y=t.rtpSender._initialTrackId||t.rtpSender.track.id;t.rtpSender._initialTrackId=y;var s="msid:"+(i?i.id:"-")+" "+y+`\r
`;f+="a="+s,f+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" "+s,t.sendEncodingParameters[0].rtx&&(f+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" "+s,f+="a=ssrc-group:FID "+t.sendEncodingParameters[0].ssrc+" "+t.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return f+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" cname:"+ke.localCName+`\r
`,t.rtpSender&&t.sendEncodingParameters[0].rtx&&(f+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" cname:"+ke.localCName+`\r
`),f}function Yf(t,e){var r=!1;return t=JSON.parse(JSON.stringify(t)),t.filter(function(i){if(i&&(i.urls||i.url)){var a=i.urls||i.url;i.url&&!i.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var f=typeof a=="string";return f&&(a=[a]),a=a.filter(function(y){var s=y.indexOf("turn:")===0&&y.indexOf("transport=udp")!==-1&&y.indexOf("turn:[")===-1&&!r;return s?(r=!0,!0):y.indexOf("stun:")===0&&e>=14393&&y.indexOf("?transport=udp")===-1}),delete i.url,i.urls=f?a[0]:a,!!a.length}})}function Rn(t,e){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},i=function(f,y){f=parseInt(f,10);for(var s=0;s<y.length;s++)if(y[s].payloadType===f||y[s].preferredPayloadType===f)return y[s]},a=function(f,y,s,o){var c=i(f.parameters.apt,s),d=i(y.parameters.apt,o);return c&&d&&c.name.toLowerCase()===d.name.toLowerCase()};return t.codecs.forEach(function(f){for(var y=0;y<e.codecs.length;y++){var s=e.codecs[y];if(f.name.toLowerCase()===s.name.toLowerCase()&&f.clockRate===s.clockRate){if(f.name.toLowerCase()==="rtx"&&f.parameters&&s.parameters.apt&&!a(f,s,t.codecs,e.codecs))continue;s=JSON.parse(JSON.stringify(s)),s.numChannels=Math.min(f.numChannels,s.numChannels),r.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter(function(o){for(var c=0;c<f.rtcpFeedback.length;c++)if(f.rtcpFeedback[c].type===o.type&&f.rtcpFeedback[c].parameter===o.parameter)return!0;return!1});break}}}),t.headerExtensions.forEach(function(f){for(var y=0;y<e.headerExtensions.length;y++){var s=e.headerExtensions[y];if(f.uri===s.uri){r.headerExtensions.push(s);break}}}),r}function nc(t,e,r){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[e][t].indexOf(r)!==-1}function js(t,e){var r=t.getRemoteCandidates().find(function(i){return e.foundation===i.foundation&&e.ip===i.ip&&e.port===i.port&&e.priority===i.priority&&e.protocol===i.protocol&&e.type===i.type});return r||t.addRemoteCandidate(e),!r}function at(t,e){var r=new Error(e);return r.name=t,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[t],r}var Xf=function(t,e){function r(o,c){c.addTrack(o),c.dispatchEvent(new t.MediaStreamTrackEvent("addtrack",{track:o}))}function i(o,c){c.removeTrack(o),c.dispatchEvent(new t.MediaStreamTrackEvent("removetrack",{track:o}))}function a(o,c,d,_){var v=new Event("track");v.track=c,v.receiver=d,v.transceiver={receiver:d},v.streams=_,t.setTimeout(function(){o._dispatchEvent("track",v)})}var f=function(o){var c=this,d=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(v){c[v]=d[v].bind(d)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",o=JSON.parse(JSON.stringify(o||{})),this.usingBundle=o.bundlePolicy==="max-bundle",o.rtcpMuxPolicy==="negotiate")throw at("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(o.rtcpMuxPolicy||(o.rtcpMuxPolicy="require"),o.iceTransportPolicy){case"all":case"relay":break;default:o.iceTransportPolicy="all";break}switch(o.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:o.bundlePolicy="balanced";break}if(o.iceServers=Yf(o.iceServers||[],e),this._iceGatherers=[],o.iceCandidatePoolSize)for(var _=o.iceCandidatePoolSize;_>0;_--)this._iceGatherers.push(new t.RTCIceGatherer({iceServers:o.iceServers,gatherPolicy:o.iceTransportPolicy}));else o.iceCandidatePoolSize=0;this._config=o,this.transceivers=[],this._sdpSessionId=ke.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(f.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(f.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),f.prototype.onicecandidate=null,f.prototype.onaddstream=null,f.prototype.ontrack=null,f.prototype.onremovestream=null,f.prototype.onsignalingstatechange=null,f.prototype.oniceconnectionstatechange=null,f.prototype.onconnectionstatechange=null,f.prototype.onicegatheringstatechange=null,f.prototype.onnegotiationneeded=null,f.prototype.ondatachannel=null,f.prototype._dispatchEvent=function(o,c){this._isClosed||(this.dispatchEvent(c),typeof this["on"+o]=="function"&&this["on"+o](c))},f.prototype._emitGatheringStateChange=function(){var o=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",o)},f.prototype.getConfiguration=function(){return this._config},f.prototype.getLocalStreams=function(){return this.localStreams},f.prototype.getRemoteStreams=function(){return this.remoteStreams},f.prototype._createTransceiver=function(o,c){var d=this.transceivers.length>0,_={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:o,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&d)_.iceTransport=this.transceivers[0].iceTransport,_.dtlsTransport=this.transceivers[0].dtlsTransport;else{var v=this._createIceAndDtlsTransports();_.iceTransport=v.iceTransport,_.dtlsTransport=v.dtlsTransport}return c||this.transceivers.push(_),_},f.prototype.addTrack=function(o,c){if(this._isClosed)throw at("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var d=this.transceivers.find(function(E){return E.track===o});if(d)throw at("InvalidAccessError","Track already exists.");for(var _,v=0;v<this.transceivers.length;v++)!this.transceivers[v].track&&this.transceivers[v].kind===o.kind&&(_=this.transceivers[v]);return _||(_=this._createTransceiver(o.kind)),this._maybeFireNegotiationNeeded(),this.localStreams.indexOf(c)===-1&&this.localStreams.push(c),_.track=o,_.stream=c,_.rtpSender=new t.RTCRtpSender(o,_.dtlsTransport),_.rtpSender},f.prototype.addStream=function(o){var c=this;if(e>=15025)o.getTracks().forEach(function(_){c.addTrack(_,o)});else{var d=o.clone();o.getTracks().forEach(function(_,v){var E=d.getTracks()[v];_.addEventListener("enabled",function(C){E.enabled=C.enabled})}),d.getTracks().forEach(function(_){c.addTrack(_,d)})}},f.prototype.removeTrack=function(o){if(this._isClosed)throw at("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(o instanceof t.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var c=this.transceivers.find(function(v){return v.rtpSender===o});if(!c)throw at("InvalidAccessError","Sender was not created by this connection.");var d=c.stream;c.rtpSender.stop(),c.rtpSender=null,c.track=null,c.stream=null;var _=this.transceivers.map(function(v){return v.stream});_.indexOf(d)===-1&&this.localStreams.indexOf(d)>-1&&this.localStreams.splice(this.localStreams.indexOf(d),1),this._maybeFireNegotiationNeeded()},f.prototype.removeStream=function(o){var c=this;o.getTracks().forEach(function(d){var _=c.getSenders().find(function(v){return v.track===d});_&&c.removeTrack(_)})},f.prototype.getSenders=function(){return this.transceivers.filter(function(o){return!!o.rtpSender}).map(function(o){return o.rtpSender})},f.prototype.getReceivers=function(){return this.transceivers.filter(function(o){return!!o.rtpReceiver}).map(function(o){return o.rtpReceiver})},f.prototype._createIceGatherer=function(o,c){var d=this;if(c&&o>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var _=new t.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(_,"state",{value:"new",writable:!0}),this.transceivers[o].bufferedCandidateEvents=[],this.transceivers[o].bufferCandidates=function(v){var E=!v.candidate||Object.keys(v.candidate).length===0;_.state=E?"completed":"gathering",d.transceivers[o].bufferedCandidateEvents!==null&&d.transceivers[o].bufferedCandidateEvents.push(v)},_.addEventListener("localcandidate",this.transceivers[o].bufferCandidates),_},f.prototype._gather=function(o,c){var d=this,_=this.transceivers[c].iceGatherer;if(!_.onlocalcandidate){var v=this.transceivers[c].bufferedCandidateEvents;this.transceivers[c].bufferedCandidateEvents=null,_.removeEventListener("localcandidate",this.transceivers[c].bufferCandidates),_.onlocalcandidate=function(E){if(!(d.usingBundle&&c>0)){var C=new Event("icecandidate");C.candidate={sdpMid:o,sdpMLineIndex:c};var S=E.candidate,h=!S||Object.keys(S).length===0;if(h)(_.state==="new"||_.state==="gathering")&&(_.state="completed");else{_.state==="new"&&(_.state="gathering"),S.component=1,S.ufrag=_.getLocalParameters().usernameFragment;var p=ke.writeCandidate(S);C.candidate=Object.assign(C.candidate,ke.parseCandidate(p)),C.candidate.candidate=p,C.candidate.toJSON=function(){return{candidate:C.candidate.candidate,sdpMid:C.candidate.sdpMid,sdpMLineIndex:C.candidate.sdpMLineIndex,usernameFragment:C.candidate.usernameFragment}}}var g=ke.getMediaSections(d._localDescription.sdp);h?g[C.candidate.sdpMLineIndex]+=`a=end-of-candidates\r
`:g[C.candidate.sdpMLineIndex]+="a="+C.candidate.candidate+`\r
`,d._localDescription.sdp=ke.getDescription(d._localDescription.sdp)+g.join("");var m=d.transceivers.every(function(T){return T.iceGatherer&&T.iceGatherer.state==="completed"});d.iceGatheringState!=="gathering"&&(d.iceGatheringState="gathering",d._emitGatheringStateChange()),h||d._dispatchEvent("icecandidate",C),m&&(d._dispatchEvent("icecandidate",new Event("icecandidate")),d.iceGatheringState="complete",d._emitGatheringStateChange())}},t.setTimeout(function(){v.forEach(function(E){_.onlocalcandidate(E)})},0)}},f.prototype._createIceAndDtlsTransports=function(){var o=this,c=new t.RTCIceTransport(null);c.onicestatechange=function(){o._updateIceConnectionState(),o._updateConnectionState()};var d=new t.RTCDtlsTransport(c);return d.ondtlsstatechange=function(){o._updateConnectionState()},d.onerror=function(){Object.defineProperty(d,"state",{value:"failed",writable:!0}),o._updateConnectionState()},{iceTransport:c,dtlsTransport:d}},f.prototype._disposeIceAndDtlsTransports=function(o){var c=this.transceivers[o].iceGatherer;c&&(delete c.onlocalcandidate,delete this.transceivers[o].iceGatherer);var d=this.transceivers[o].iceTransport;d&&(delete d.onicestatechange,delete this.transceivers[o].iceTransport);var _=this.transceivers[o].dtlsTransport;_&&(delete _.ondtlsstatechange,delete _.onerror,delete this.transceivers[o].dtlsTransport)},f.prototype._transceive=function(o,c,d){var _=Rn(o.localCapabilities,o.remoteCapabilities);c&&o.rtpSender&&(_.encodings=o.sendEncodingParameters,_.rtcp={cname:ke.localCName,compound:o.rtcpParameters.compound},o.recvEncodingParameters.length&&(_.rtcp.ssrc=o.recvEncodingParameters[0].ssrc),o.rtpSender.send(_)),d&&o.rtpReceiver&&_.codecs.length>0&&(o.kind==="video"&&o.recvEncodingParameters&&e<15019&&o.recvEncodingParameters.forEach(function(v){delete v.rtx}),o.recvEncodingParameters.length?_.encodings=o.recvEncodingParameters:_.encodings=[{}],_.rtcp={compound:o.rtcpParameters.compound},o.rtcpParameters.cname&&(_.rtcp.cname=o.rtcpParameters.cname),o.sendEncodingParameters.length&&(_.rtcp.ssrc=o.sendEncodingParameters[0].ssrc),o.rtpReceiver.receive(_))},f.prototype.setLocalDescription=function(o){var c=this;if(["offer","answer"].indexOf(o.type)===-1)return Promise.reject(at("TypeError",'Unsupported type "'+o.type+'"'));if(!nc("setLocalDescription",o.type,c.signalingState)||c._isClosed)return Promise.reject(at("InvalidStateError","Can not set local "+o.type+" in state "+c.signalingState));var d,_;if(o.type==="offer")d=ke.splitSections(o.sdp),_=d.shift(),d.forEach(function(E,C){var S=ke.parseRtpParameters(E);c.transceivers[C].localCapabilities=S}),c.transceivers.forEach(function(E,C){c._gather(E.mid,C)});else if(o.type==="answer"){d=ke.splitSections(c._remoteDescription.sdp),_=d.shift();var v=ke.matchPrefix(_,"a=ice-lite").length>0;d.forEach(function(E,C){var S=c.transceivers[C],h=S.iceGatherer,p=S.iceTransport,g=S.dtlsTransport,m=S.localCapabilities,T=S.remoteCapabilities,w=ke.isRejected(E)&&ke.matchPrefix(E,"a=bundle-only").length===0;if(!w&&!S.rejected){var R=ke.getIceParameters(E,_),l=ke.getDtlsParameters(E,_);v&&(l.role="server"),(!c.usingBundle||C===0)&&(c._gather(S.mid,C),p.state==="new"&&p.start(h,R,v?"controlling":"controlled"),g.state==="new"&&g.start(l));var k=Rn(m,T);c._transceive(S,k.codecs.length>0,!1)}})}return c._localDescription={type:o.type,sdp:o.sdp},o.type==="offer"?c._updateSignalingState("have-local-offer"):c._updateSignalingState("stable"),Promise.resolve()},f.prototype.setRemoteDescription=function(o){var c=this;if(["offer","answer"].indexOf(o.type)===-1)return Promise.reject(at("TypeError",'Unsupported type "'+o.type+'"'));if(!nc("setRemoteDescription",o.type,c.signalingState)||c._isClosed)return Promise.reject(at("InvalidStateError","Can not set remote "+o.type+" in state "+c.signalingState));var d={};c.remoteStreams.forEach(function(p){d[p.id]=p});var _=[],v=ke.splitSections(o.sdp),E=v.shift(),C=ke.matchPrefix(E,"a=ice-lite").length>0,S=ke.matchPrefix(E,"a=group:BUNDLE ").length>0;c.usingBundle=S;var h=ke.matchPrefix(E,"a=ice-options:")[0];return h?c.canTrickleIceCandidates=h.substr(14).split(" ").indexOf("trickle")>=0:c.canTrickleIceCandidates=!1,v.forEach(function(p,g){var m=ke.splitLines(p),T=ke.getKind(p),w=ke.isRejected(p)&&ke.matchPrefix(p,"a=bundle-only").length===0,R=m[0].substr(2).split(" ")[2],l=ke.getDirection(p,E),k=ke.parseMsid(p),x=ke.getMid(p)||ke.generateIdentifier();if(w||T==="application"&&(R==="DTLS/SCTP"||R==="UDP/DTLS/SCTP")){c.transceivers[g]={mid:x,kind:T,protocol:R,rejected:!0};return}!w&&c.transceivers[g]&&c.transceivers[g].rejected&&(c.transceivers[g]=c._createTransceiver(T,!0));var M,$,B,N,ee,ue,se,P,F,j=ke.parseRtpParameters(p),q,te;w||(q=ke.getIceParameters(p,E),te=ke.getDtlsParameters(p,E),te.role="client"),se=ke.parseRtpEncodingParameters(p);var ge=ke.parseRtcpParameters(p),me=ke.matchPrefix(p,"a=end-of-candidates",E).length>0,oe=ke.matchPrefix(p,"a=candidate:").map(function(re){return ke.parseCandidate(re)}).filter(function(re){return re.component===1});if((o.type==="offer"||o.type==="answer")&&!w&&S&&g>0&&c.transceivers[g]&&(c._disposeIceAndDtlsTransports(g),c.transceivers[g].iceGatherer=c.transceivers[0].iceGatherer,c.transceivers[g].iceTransport=c.transceivers[0].iceTransport,c.transceivers[g].dtlsTransport=c.transceivers[0].dtlsTransport,c.transceivers[g].rtpSender&&c.transceivers[g].rtpSender.setTransport(c.transceivers[0].dtlsTransport),c.transceivers[g].rtpReceiver&&c.transceivers[g].rtpReceiver.setTransport(c.transceivers[0].dtlsTransport)),o.type==="offer"&&!w){M=c.transceivers[g]||c._createTransceiver(T),M.mid=x,M.iceGatherer||(M.iceGatherer=c._createIceGatherer(g,S)),oe.length&&M.iceTransport.state==="new"&&(me&&(!S||g===0)?M.iceTransport.setRemoteCandidates(oe):oe.forEach(function(re){js(M.iceTransport,re)})),P=t.RTCRtpReceiver.getCapabilities(T),e<15019&&(P.codecs=P.codecs.filter(function(re){return re.name!=="rtx"})),ue=M.sendEncodingParameters||[{ssrc:(2*g+2)*1001}];var pe=!1;if(l==="sendrecv"||l==="sendonly"){if(pe=!M.rtpReceiver,ee=M.rtpReceiver||new t.RTCRtpReceiver(M.dtlsTransport,T),pe){var z;F=ee.track,k&&k.stream==="-"||(k?(d[k.stream]||(d[k.stream]=new t.MediaStream,Object.defineProperty(d[k.stream],"id",{get:function(){return k.stream}})),Object.defineProperty(F,"id",{get:function(){return k.track}}),z=d[k.stream]):(d.default||(d.default=new t.MediaStream),z=d.default)),z&&(r(F,z),M.associatedRemoteMediaStreams.push(z)),_.push([F,ee,z])}}else M.rtpReceiver&&M.rtpReceiver.track&&(M.associatedRemoteMediaStreams.forEach(function(re){var ae=re.getTracks().find(function(Oe){return Oe.id===M.rtpReceiver.track.id});ae&&i(ae,re)}),M.associatedRemoteMediaStreams=[]);M.localCapabilities=P,M.remoteCapabilities=j,M.rtpReceiver=ee,M.rtcpParameters=ge,M.sendEncodingParameters=ue,M.recvEncodingParameters=se,c._transceive(c.transceivers[g],!1,pe)}else if(o.type==="answer"&&!w){M=c.transceivers[g],$=M.iceGatherer,B=M.iceTransport,N=M.dtlsTransport,ee=M.rtpReceiver,ue=M.sendEncodingParameters,P=M.localCapabilities,c.transceivers[g].recvEncodingParameters=se,c.transceivers[g].remoteCapabilities=j,c.transceivers[g].rtcpParameters=ge,oe.length&&B.state==="new"&&((C||me)&&(!S||g===0)?B.setRemoteCandidates(oe):oe.forEach(function(re){js(M.iceTransport,re)})),(!S||g===0)&&(B.state==="new"&&B.start($,q,"controlling"),N.state==="new"&&N.start(te));var W=Rn(M.localCapabilities,M.remoteCapabilities),Y=W.codecs.filter(function(re){return re.name.toLowerCase()==="rtx"}).length;!Y&&M.sendEncodingParameters[0].rtx&&delete M.sendEncodingParameters[0].rtx,c._transceive(M,l==="sendrecv"||l==="recvonly",l==="sendrecv"||l==="sendonly"),ee&&(l==="sendrecv"||l==="sendonly")?(F=ee.track,k?(d[k.stream]||(d[k.stream]=new t.MediaStream),r(F,d[k.stream]),_.push([F,ee,d[k.stream]])):(d.default||(d.default=new t.MediaStream),r(F,d.default),_.push([F,ee,d.default]))):delete M.rtpReceiver}}),c._dtlsRole===void 0&&(c._dtlsRole=o.type==="offer"?"active":"passive"),c._remoteDescription={type:o.type,sdp:o.sdp},o.type==="offer"?c._updateSignalingState("have-remote-offer"):c._updateSignalingState("stable"),Object.keys(d).forEach(function(p){var g=d[p];if(g.getTracks().length){if(c.remoteStreams.indexOf(g)===-1){c.remoteStreams.push(g);var m=new Event("addstream");m.stream=g,t.setTimeout(function(){c._dispatchEvent("addstream",m)})}_.forEach(function(T){var w=T[0],R=T[1];g.id===T[2].id&&a(c,w,R,[g])})}}),_.forEach(function(p){p[2]||a(c,p[0],p[1],[])}),t.setTimeout(function(){c&&c.transceivers&&c.transceivers.forEach(function(p){p.iceTransport&&p.iceTransport.state==="new"&&p.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),p.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},f.prototype.close=function(){this.transceivers.forEach(function(o){o.iceTransport&&o.iceTransport.stop(),o.dtlsTransport&&o.dtlsTransport.stop(),o.rtpSender&&o.rtpSender.stop(),o.rtpReceiver&&o.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},f.prototype._updateSignalingState=function(o){this.signalingState=o;var c=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",c)},f.prototype._maybeFireNegotiationNeeded=function(){var o=this;this.signalingState!=="stable"||this.needNegotiation===!0||(this.needNegotiation=!0,t.setTimeout(function(){if(o.needNegotiation){o.needNegotiation=!1;var c=new Event("negotiationneeded");o._dispatchEvent("negotiationneeded",c)}},0))},f.prototype._updateIceConnectionState=function(){var o,c={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(_){_.iceTransport&&!_.rejected&&c[_.iceTransport.state]++}),o="new",c.failed>0?o="failed":c.checking>0?o="checking":c.disconnected>0?o="disconnected":c.new>0?o="new":c.connected>0?o="connected":c.completed>0&&(o="completed"),o!==this.iceConnectionState){this.iceConnectionState=o;var d=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",d)}},f.prototype._updateConnectionState=function(){var o,c={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(_){_.iceTransport&&_.dtlsTransport&&!_.rejected&&(c[_.iceTransport.state]++,c[_.dtlsTransport.state]++)}),c.connected+=c.completed,o="new",c.failed>0?o="failed":c.connecting>0?o="connecting":c.disconnected>0?o="disconnected":c.new>0?o="new":c.connected>0&&(o="connected"),o!==this.connectionState){this.connectionState=o;var d=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",d)}},f.prototype.createOffer=function(){var o=this;if(o._isClosed)return Promise.reject(at("InvalidStateError","Can not call createOffer after close"));var c=o.transceivers.filter(function(C){return C.kind==="audio"}).length,d=o.transceivers.filter(function(C){return C.kind==="video"}).length,_=arguments[0];if(_){if(_.mandatory||_.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");_.offerToReceiveAudio!==void 0&&(_.offerToReceiveAudio===!0?c=1:_.offerToReceiveAudio===!1?c=0:c=_.offerToReceiveAudio),_.offerToReceiveVideo!==void 0&&(_.offerToReceiveVideo===!0?d=1:_.offerToReceiveVideo===!1?d=0:d=_.offerToReceiveVideo)}for(o.transceivers.forEach(function(C){C.kind==="audio"?(c--,c<0&&(C.wantReceive=!1)):C.kind==="video"&&(d--,d<0&&(C.wantReceive=!1))});c>0||d>0;)c>0&&(o._createTransceiver("audio"),c--),d>0&&(o._createTransceiver("video"),d--);var v=ke.writeSessionBoilerplate(o._sdpSessionId,o._sdpSessionVersion++);o.transceivers.forEach(function(C,S){var h=C.track,p=C.kind,g=C.mid||ke.generateIdentifier();C.mid=g,C.iceGatherer||(C.iceGatherer=o._createIceGatherer(S,o.usingBundle));var m=t.RTCRtpSender.getCapabilities(p);e<15019&&(m.codecs=m.codecs.filter(function(w){return w.name!=="rtx"})),m.codecs.forEach(function(w){w.name==="H264"&&w.parameters["level-asymmetry-allowed"]===void 0&&(w.parameters["level-asymmetry-allowed"]="1"),C.remoteCapabilities&&C.remoteCapabilities.codecs&&C.remoteCapabilities.codecs.forEach(function(R){w.name.toLowerCase()===R.name.toLowerCase()&&w.clockRate===R.clockRate&&(w.preferredPayloadType=R.payloadType)})}),m.headerExtensions.forEach(function(w){var R=C.remoteCapabilities&&C.remoteCapabilities.headerExtensions||[];R.forEach(function(l){w.uri===l.uri&&(w.id=l.id)})});var T=C.sendEncodingParameters||[{ssrc:(2*S+1)*1001}];h&&e>=15019&&p==="video"&&!T[0].rtx&&(T[0].rtx={ssrc:T[0].ssrc+1}),C.wantReceive&&(C.rtpReceiver=new t.RTCRtpReceiver(C.dtlsTransport,p)),C.localCapabilities=m,C.sendEncodingParameters=T}),o._config.bundlePolicy!=="max-compat"&&(v+="a=group:BUNDLE "+o.transceivers.map(function(C){return C.mid}).join(" ")+`\r
`),v+=`a=ice-options:trickle\r
`,o.transceivers.forEach(function(C,S){v+=ic(C,C.localCapabilities,"offer",C.stream,o._dtlsRole),v+=`a=rtcp-rsize\r
`,C.iceGatherer&&o.iceGatheringState!=="new"&&(S===0||!o.usingBundle)&&(C.iceGatherer.getLocalCandidates().forEach(function(h){h.component=1,v+="a="+ke.writeCandidate(h)+`\r
`}),C.iceGatherer.state==="completed"&&(v+=`a=end-of-candidates\r
`))});var E=new t.RTCSessionDescription({type:"offer",sdp:v});return Promise.resolve(E)},f.prototype.createAnswer=function(){var o=this;if(o._isClosed)return Promise.reject(at("InvalidStateError","Can not call createAnswer after close"));if(!(o.signalingState==="have-remote-offer"||o.signalingState==="have-local-pranswer"))return Promise.reject(at("InvalidStateError","Can not call createAnswer in signalingState "+o.signalingState));var c=ke.writeSessionBoilerplate(o._sdpSessionId,o._sdpSessionVersion++);o.usingBundle&&(c+="a=group:BUNDLE "+o.transceivers.map(function(v){return v.mid}).join(" ")+`\r
`),c+=`a=ice-options:trickle\r
`;var d=ke.getMediaSections(o._remoteDescription.sdp).length;o.transceivers.forEach(function(v,E){if(!(E+1>d)){if(v.rejected){v.kind==="application"?v.protocol==="DTLS/SCTP"?c+=`m=application 0 DTLS/SCTP 5000\r
`:c+="m=application 0 "+v.protocol+` webrtc-datachannel\r
`:v.kind==="audio"?c+=`m=audio 0 UDP/TLS/RTP/SAVPF 0\r
a=rtpmap:0 PCMU/8000\r
`:v.kind==="video"&&(c+=`m=video 0 UDP/TLS/RTP/SAVPF 120\r
a=rtpmap:120 VP8/90000\r
`),c+=`c=IN IP4 0.0.0.0\r
a=inactive\r
a=mid:`+v.mid+`\r
`;return}if(v.stream){var C;v.kind==="audio"?C=v.stream.getAudioTracks()[0]:v.kind==="video"&&(C=v.stream.getVideoTracks()[0]),C&&e>=15019&&v.kind==="video"&&!v.sendEncodingParameters[0].rtx&&(v.sendEncodingParameters[0].rtx={ssrc:v.sendEncodingParameters[0].ssrc+1})}var S=Rn(v.localCapabilities,v.remoteCapabilities),h=S.codecs.filter(function(p){return p.name.toLowerCase()==="rtx"}).length;!h&&v.sendEncodingParameters[0].rtx&&delete v.sendEncodingParameters[0].rtx,c+=ic(v,S,"answer",v.stream,o._dtlsRole),v.rtcpParameters&&v.rtcpParameters.reducedSize&&(c+=`a=rtcp-rsize\r
`)}});var _=new t.RTCSessionDescription({type:"answer",sdp:c});return Promise.resolve(_)},f.prototype.addIceCandidate=function(o){var c=this,d;return o&&!(o.sdpMLineIndex!==void 0||o.sdpMid)?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(_,v){if(c._remoteDescription)if(!o||o.candidate==="")for(var E=0;E<c.transceivers.length&&!(!c.transceivers[E].rejected&&(c.transceivers[E].iceTransport.addRemoteCandidate({}),d=ke.getMediaSections(c._remoteDescription.sdp),d[E]+=`a=end-of-candidates\r
`,c._remoteDescription.sdp=ke.getDescription(c._remoteDescription.sdp)+d.join(""),c.usingBundle));E++);else{var C=o.sdpMLineIndex;if(o.sdpMid){for(var S=0;S<c.transceivers.length;S++)if(c.transceivers[S].mid===o.sdpMid){C=S;break}}var h=c.transceivers[C];if(h){if(h.rejected)return _();var p=Object.keys(o.candidate).length>0?ke.parseCandidate(o.candidate):{};if(p.protocol==="tcp"&&(p.port===0||p.port===9)||p.component&&p.component!==1)return _();if((C===0||C>0&&h.iceTransport!==c.transceivers[0].iceTransport)&&!js(h.iceTransport,p))return v(at("OperationError","Can not add ICE candidate"));var g=o.candidate.trim();g.indexOf("a=")===0&&(g=g.substr(2)),d=ke.getMediaSections(c._remoteDescription.sdp),d[C]+="a="+(p.type?g:"end-of-candidates")+`\r
`,c._remoteDescription.sdp=ke.getDescription(c._remoteDescription.sdp)+d.join("")}else return v(at("OperationError","Can not add ICE candidate"))}else return v(at("InvalidStateError","Can not add ICE candidate without a remote description"));_()})},f.prototype.getStats=function(o){if(o&&o instanceof t.MediaStreamTrack){var c=null;if(this.transceivers.forEach(function(_){_.rtpSender&&_.rtpSender.track===o?c=_.rtpSender:_.rtpReceiver&&_.rtpReceiver.track===o&&(c=_.rtpReceiver)}),!c)throw at("InvalidAccessError","Invalid selector.");return c.getStats()}var d=[];return this.transceivers.forEach(function(_){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(v){_[v]&&d.push(_[v].getStats())})}),Promise.all(d).then(function(_){var v=new Map;return _.forEach(function(E){E.forEach(function(C){v.set(C.id,C)})}),v})};var y=["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"];y.forEach(function(o){var c=t[o];if(c&&c.prototype&&c.prototype.getStats){var d=c.prototype.getStats;c.prototype.getStats=function(){return d.apply(this).then(function(_){var v=new Map;return Object.keys(_).forEach(function(E){_[E].type=Gf(_[E]),v.set(E,_[E])}),v})}}});var s=["createOffer","createAnswer"];return s.forEach(function(o){var c=f.prototype[o];f.prototype[o]=function(){var d=arguments;return typeof d[0]=="function"||typeof d[1]=="function"?c.apply(this,[arguments[2]]).then(function(_){typeof d[0]=="function"&&d[0].apply(null,[_])},function(_){typeof d[1]=="function"&&d[1].apply(null,[_])}):c.apply(this,arguments)}}),s=["setLocalDescription","setRemoteDescription","addIceCandidate"],s.forEach(function(o){var c=f.prototype[o];f.prototype[o]=function(){var d=arguments;return typeof d[1]=="function"||typeof d[2]=="function"?c.apply(this,arguments).then(function(){typeof d[1]=="function"&&d[1].apply(null)},function(_){typeof d[2]=="function"&&d[2].apply(null,[_])}):c.apply(this,arguments)}}),["getStats"].forEach(function(o){var c=f.prototype[o];f.prototype[o]=function(){var d=arguments;return typeof d[1]=="function"?c.apply(this,arguments).then(function(){typeof d[1]=="function"&&d[1].apply(null)}):c.apply(this,arguments)}}),f};const Jf=ls(Xf);function Nl(t){const e=t&&t.navigator,r=function(a){return{name:{PermissionDeniedError:"NotAllowedError"}[a.name]||a.name,message:a.message,constraint:a.constraint,toString(){return this.name}}},i=e.mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(a){return i(a).catch(f=>Promise.reject(r(f)))}}function Hl(t){"getDisplayMedia"in t.navigator&&t.navigator.mediaDevices&&(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||(t.navigator.mediaDevices.getDisplayMedia=t.navigator.getDisplayMedia.bind(t.navigator)))}function vo(t,e){if(t.RTCIceGatherer&&(t.RTCIceCandidate||(t.RTCIceCandidate=function(a){return a}),t.RTCSessionDescription||(t.RTCSessionDescription=function(a){return a}),e.version<15025)){const i=Object.getOwnPropertyDescriptor(t.MediaStreamTrack.prototype,"enabled");Object.defineProperty(t.MediaStreamTrack.prototype,"enabled",{set(a){i.set.call(this,a);const f=new Event("enabled");f.enabled=a,this.dispatchEvent(f)}})}t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)&&Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=new t.RTCDtmfSender(this):this.track.kind==="video"&&(this._dtmf=null)),this._dtmf}}),t.RTCDtmfSender&&!t.RTCDTMFSender&&(t.RTCDTMFSender=t.RTCDtmfSender);const r=Jf(t,e.version);t.RTCPeerConnection=function(a){return a&&a.iceServers&&(a.iceServers=Kf(a.iceServers,e.version),ea("ICE servers after filtering:",a.iceServers)),new r(a)},t.RTCPeerConnection.prototype=r.prototype}function $l(t){t.RTCRtpSender&&!("replaceTrack"in t.RTCRtpSender.prototype)&&(t.RTCRtpSender.prototype.replaceTrack=t.RTCRtpSender.prototype.setTrack)}const sc=Object.freeze(Object.defineProperty({__proto__:null,shimGetDisplayMedia:Hl,shimGetUserMedia:Nl,shimPeerConnection:vo,shimReplaceTrack:$l},Symbol.toStringTag,{value:"Module"}));function Fl(t,e){const r=t&&t.navigator,i=t&&t.MediaStreamTrack;if(r.getUserMedia=function(a,f,y){hs("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(a).then(f,y)},!(e.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){const a=function(y,s,o){s in y&&!(o in y)&&(y[o]=y[s],delete y[s])},f=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(y){return typeof y=="object"&&typeof y.audio=="object"&&(y=JSON.parse(JSON.stringify(y)),a(y.audio,"autoGainControl","mozAutoGainControl"),a(y.audio,"noiseSuppression","mozNoiseSuppression")),f(y)},i&&i.prototype.getSettings){const y=i.prototype.getSettings;i.prototype.getSettings=function(){const s=y.apply(this,arguments);return a(s,"mozAutoGainControl","autoGainControl"),a(s,"mozNoiseSuppression","noiseSuppression"),s}}if(i&&i.prototype.applyConstraints){const y=i.prototype.applyConstraints;i.prototype.applyConstraints=function(s){return this.kind==="audio"&&typeof s=="object"&&(s=JSON.parse(JSON.stringify(s)),a(s,"autoGainControl","mozAutoGainControl"),a(s,"noiseSuppression","mozNoiseSuppression")),y.apply(this,[s])}}}}function Qf(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(i){if(!(i&&i.video)){const a=new DOMException("getDisplayMedia without video constraints is undefined");return a.name="NotFoundError",a.code=8,Promise.reject(a)}return i.video===!0?i.video={mediaSource:e}:i.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(i)})}function jl(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function yo(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){const f=t.RTCPeerConnection.prototype[a],y={[a](){return arguments[0]=new(a==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),f.apply(this,arguments)}};t.RTCPeerConnection.prototype[a]=y[a]});const r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[f,y,s]=arguments;return i.apply(this,[f||null]).then(o=>{if(e.version<53&&!y)try{o.forEach(c=>{c.type=r[c.type]||c.type})}catch(c){if(c.name!=="TypeError")throw c;o.forEach((d,_)=>{o.set(_,Object.assign({},d,{type:r[d.type]||d.type}))})}return o}).then(y,s)}}function Ul(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const a=e.apply(this,[]);return a.forEach(f=>f._pc=this),a});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const a=r.apply(this,arguments);return a._pc=this,a}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Wl(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=e.apply(this,[]);return i.forEach(a=>a._pc=this),i}),Ai(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function zl(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(r){hs("removeStream","removeTrack"),this.getSenders().forEach(i=>{i.track&&r.getTracks().includes(i.track)&&this.removeTrack(i)})})}function Vl(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function ql(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const i=arguments[1],a=i&&"sendEncodings"in i;a&&i.sendEncodings.forEach(y=>{if("rid"in y&&!/^[a-z0-9]{0,16}$/i.test(y.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in y&&!(parseFloat(y.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in y&&!(parseFloat(y.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const f=e.apply(this,arguments);if(a){const{sender:y}=f,s=y.getParameters();(!("encodings"in s)||s.encodings.length===1&&Object.keys(s.encodings[0]).length===0)&&(s.encodings=i.sendEncodings,y.sendEncodings=i.sendEncodings,this.setParametersPromises.push(y.setParameters(s).then(()=>{delete y.sendEncodings}).catch(()=>{delete y.sendEncodings})))}return f})}function Kl(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const i=e.apply(this,arguments);return"encodings"in i||(i.encodings=[].concat(this.sendEncodings||[{}])),i})}function Gl(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function Yl(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const oc=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:ql,shimCreateAnswer:Yl,shimCreateOffer:Gl,shimGetDisplayMedia:Qf,shimGetParameters:Kl,shimGetUserMedia:Fl,shimOnTrack:jl,shimPeerConnection:yo,shimRTCDataChannel:Vl,shimReceiverGetStats:Wl,shimRemoveStream:zl,shimSenderGetStats:Ul},Symbol.toStringTag,{value:"Module"}));function Xl(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(i){this._localStreams||(this._localStreams=[]),this._localStreams.includes(i)||this._localStreams.push(i),i.getAudioTracks().forEach(a=>e.call(this,a,i)),i.getVideoTracks().forEach(a=>e.call(this,a,i))},t.RTCPeerConnection.prototype.addTrack=function(i,...a){return a&&a.forEach(f=>{this._localStreams?this._localStreams.includes(f)||this._localStreams.push(f):this._localStreams=[f]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(r){this._localStreams||(this._localStreams=[]);const i=this._localStreams.indexOf(r);if(i===-1)return;this._localStreams.splice(i,1);const a=r.getTracks();this.getSenders().forEach(f=>{a.includes(f.track)&&this.removeTrack(f)})})}}function Jl(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(r){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=r),this.addEventListener("track",this._onaddstreampoly=i=>{i.streams.forEach(a=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(a))return;this._remoteStreams.push(a);const f=new Event("addstream");f.stream=a,this.dispatchEvent(f)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const i=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(f=>{if(i._remoteStreams||(i._remoteStreams=[]),i._remoteStreams.indexOf(f)>=0)return;i._remoteStreams.push(f);const y=new Event("addstream");y.stream=f,i.dispatchEvent(y)})}),e.apply(i,arguments)}}}function Ql(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,r=e.createOffer,i=e.createAnswer,a=e.setLocalDescription,f=e.setRemoteDescription,y=e.addIceCandidate;e.createOffer=function(c,d){const _=arguments.length>=2?arguments[2]:arguments[0],v=r.apply(this,[_]);return d?(v.then(c,d),Promise.resolve()):v},e.createAnswer=function(c,d){const _=arguments.length>=2?arguments[2]:arguments[0],v=i.apply(this,[_]);return d?(v.then(c,d),Promise.resolve()):v};let s=function(o,c,d){const _=a.apply(this,[o]);return d?(_.then(c,d),Promise.resolve()):_};e.setLocalDescription=s,s=function(o,c,d){const _=f.apply(this,[o]);return d?(_.then(c,d),Promise.resolve()):_},e.setRemoteDescription=s,s=function(o,c,d){const _=y.apply(this,[o]);return d?(_.then(c,d),Promise.resolve()):_},e.addIceCandidate=s}function Zl(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const r=e.mediaDevices,i=r.getUserMedia.bind(r);e.mediaDevices.getUserMedia=a=>i(eh(a))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(i,a,f){e.mediaDevices.getUserMedia(i).then(a,f)}).bind(e))}function eh(t){return t&&t.video!==void 0?Object.assign({},t,{video:wl(t.video)}):t}function th(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(i,a){if(i&&i.iceServers){const f=[];for(let y=0;y<i.iceServers.length;y++){let s=i.iceServers[y];!s.hasOwnProperty("urls")&&s.hasOwnProperty("url")?(hs("RTCIceServer.url","RTCIceServer.urls"),s=JSON.parse(JSON.stringify(s)),s.urls=s.url,delete s.url,f.push(s)):f.push(i.iceServers[y])}i.iceServers=f}return new e(i,a)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function rh(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ih(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(i){if(i){typeof i.offerToReceiveAudio<"u"&&(i.offerToReceiveAudio=!!i.offerToReceiveAudio);const a=this.getTransceivers().find(y=>y.receiver.track.kind==="audio");i.offerToReceiveAudio===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):i.offerToReceiveAudio===!0&&!a&&this.addTransceiver("audio"),typeof i.offerToReceiveVideo<"u"&&(i.offerToReceiveVideo=!!i.offerToReceiveVideo);const f=this.getTransceivers().find(y=>y.receiver.track.kind==="video");i.offerToReceiveVideo===!1&&f?f.direction==="sendrecv"?f.setDirection?f.setDirection("sendonly"):f.direction="sendonly":f.direction==="recvonly"&&(f.setDirection?f.setDirection("inactive"):f.direction="inactive"):i.offerToReceiveVideo===!0&&!f&&this.addTransceiver("video")}return e.apply(this,arguments)}}function nh(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}const ac=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:nh,shimCallbacksAPI:Ql,shimConstraints:eh,shimCreateOfferLegacy:ih,shimGetUserMedia:Zl,shimLocalStreamsAPI:Xl,shimRTCIceServerUrls:th,shimRemoteStreamsAPI:Jl,shimTrackEventTransceiver:rh},Symbol.toStringTag,{value:"Module"}));function Un(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(i){if(typeof i=="object"&&i.candidate&&i.candidate.indexOf("a=")===0&&(i=JSON.parse(JSON.stringify(i)),i.candidate=i.candidate.substr(2)),i.candidate&&i.candidate.length){const a=new e(i),f=jn.parseCandidate(i.candidate),y=Object.assign(a,f);return y.toJSON=function(){return{candidate:y.candidate,sdpMid:y.sdpMid,sdpMLineIndex:y.sdpMLineIndex,usernameFragment:y.usernameFragment}},y}return new e(i)},t.RTCIceCandidate.prototype=e.prototype,Ai(t,"icecandidate",r=>(r.candidate&&Object.defineProperty(r,"candidate",{value:new t.RTCIceCandidate(r.candidate),writable:"false"}),r))}function Xi(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const r=function(s){if(!s||!s.sdp)return!1;const o=jn.splitSections(s.sdp);return o.shift(),o.some(c=>{const d=jn.parseMLine(c);return d&&d.kind==="application"&&d.protocol.indexOf("SCTP")!==-1})},i=function(s){const o=s.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(o===null||o.length<2)return-1;const c=parseInt(o[1],10);return c!==c?-1:c},a=function(s){let o=65536;return e.browser==="firefox"&&(e.version<57?s===-1?o=16384:o=2147483637:e.version<60?o=e.version===57?65535:65536:o=2147483637),o},f=function(s,o){let c=65536;e.browser==="firefox"&&e.version===57&&(c=65535);const d=jn.matchPrefix(s.sdp,"a=max-message-size:");return d.length>0?c=parseInt(d[0].substr(19),10):e.browser==="firefox"&&o!==-1&&(c=2147483637),c},y=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:o}=this.getConfiguration();o==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(r(arguments[0])){const o=i(arguments[0]),c=a(o),d=f(arguments[0],o);let _;c===0&&d===0?_=Number.POSITIVE_INFINITY:c===0||d===0?_=Math.max(c,d):_=Math.min(c,d);const v={};Object.defineProperty(v,"maxMessageSize",{get(){return _}}),this._sctp=v}return y.apply(this,arguments)}}function Ji(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(i,a){const f=i.send;i.send=function(){const s=arguments[0],o=s.length||s.size||s.byteLength;if(i.readyState==="open"&&a.sctp&&o>a.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+a.sctp.maxMessageSize+" bytes)");return f.apply(i,arguments)}}const r=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const a=r.apply(this,arguments);return e(a,this),a},Ai(t,"datachannel",i=>(e(i.channel,i.target),i))}function So(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(r){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),r&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=r)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(r=>{const i=e[r];e[r]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=a=>{const f=a.target;if(f._lastConnectionState!==f.connectionState){f._lastConnectionState=f.connectionState;const y=new Event("connectionstatechange",a);f.dispatchEvent(y)}return a},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}})}function bo(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(a){if(a&&a.sdp&&a.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const f=a.sdp.split(`
`).filter(y=>y.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&a instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:a.type,sdp:f}):a.sdp=f}return r.apply(this,arguments)}}function Wn(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const r=t.RTCPeerConnection.prototype.addIceCandidate;!r||r.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}const Zf=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:bo,shimAddIceCandidateNullOrEmpty:Wn,shimConnectionState:So,shimMaxMessageSize:Xi,shimRTCIceCandidate:Un,shimSendThrowTypeError:Ji},Symbol.toStringTag,{value:"Module"}));function ed({window:t}={},e={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const r=ea,i=Vf(t),a={browserDetails:i,commonShim:Zf,extractVersion:Yi,disableLog:Wf,disableWarnings:zf};switch(i.browser){case"chrome":if(!rc||!mo||!e.shimChrome)return r("Chrome shim is not included in this adapter release."),a;if(i.version===null)return r("Chrome shim can not determine version, not shimming."),a;r("adapter.js shimming chrome."),a.browserShim=rc,Wn(t,i),kl(t,i),Al(t),mo(t,i),Rl(t),Pl(t,i),xl(t),Dl(t),Ll(t),Ml(t,i),Un(t),So(t),Xi(t,i),Ji(t),bo(t,i);break;case"firefox":if(!oc||!yo||!e.shimFirefox)return r("Firefox shim is not included in this adapter release."),a;r("adapter.js shimming firefox."),a.browserShim=oc,Wn(t,i),Fl(t,i),yo(t,i),jl(t),zl(t),Ul(t),Wl(t),Vl(t),ql(t),Kl(t),Gl(t),Yl(t),Un(t),So(t),Xi(t,i),Ji(t);break;case"edge":if(!sc||!vo||!e.shimEdge)return r("MS edge shim is not included in this adapter release."),a;r("adapter.js shimming edge."),a.browserShim=sc,Nl(t),Hl(t),vo(t,i),$l(t),Xi(t,i),Ji(t);break;case"safari":if(!ac||!e.shimSafari)return r("Safari shim is not included in this adapter release."),a;r("adapter.js shimming safari."),a.browserShim=ac,Wn(t,i),th(t),ih(t),Ql(t),Xl(t),Jl(t),rh(t),Zl(t),nh(t),Un(t),Xi(t,i),Ji(t),bo(t,i);break;default:r("Unsupported browser!");break}return a}const cc=ed({window:typeof window>"u"?void 0:window});function cr(t,e,r,i){Object.defineProperty(t,e,{get:r,set:i,enumerable:!0,configurable:!0})}var Us=cc.default||cc,ji=new(function(){function t(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}return t.prototype.isWebRTCSupported=function(){return typeof RTCPeerConnection<"u"},t.prototype.isBrowserSupported=function(){var e=this.getBrowser(),r=this.getVersion(),i=this.supportedBrowsers.includes(e);return i?e==="chrome"?r>=this.minChromeVersion:e==="firefox"?r>=this.minFirefoxVersion:e==="safari"?!this.isIOS&&r>=this.minSafariVersion:!1:!1},t.prototype.getBrowser=function(){return Us.browserDetails.browser},t.prototype.getVersion=function(){return Us.browserDetails.version||0},t.prototype.isUnifiedPlanSupported=function(){var e=this.getBrowser(),r=Us.browserDetails.version||0;if(e==="chrome"&&r<this.minChromeVersion)return!1;if(e==="firefox"&&r>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var i,a=!1;try{i=new RTCPeerConnection,i.addTransceiver("audio"),a=!0}catch{}finally{i&&i.close()}return a},t.prototype.toString=function(){return`Supports:
    browser:`.concat(this.getBrowser(),`
    version:`).concat(this.getVersion(),`
    isIOS:`).concat(this.isIOS,`
    isWebRTCSupported:`).concat(this.isWebRTCSupported(),`
    isBrowserSupported:`).concat(this.isBrowserSupported(),`
    isUnifiedPlanSupported:`).concat(this.isUnifiedPlanSupported())},t}()),lc={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"},td=function(){function t(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=lc,this.browser=ji.getBrowser(),this.browserVersion=ji.getVersion(),this.supports=function(){var e={browser:ji.isBrowserSupported(),webRTC:ji.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!e.webRTC)return e;var r;try{r=new RTCPeerConnection(lc),e.audioVideo=!0;var i=void 0;try{i=r.createDataChannel("_PEERJSTEST",{ordered:!0}),e.data=!0,e.reliable=!!i.ordered;try{i.binaryType="blob",e.binaryBlob=!ji.isIOS}catch{}}catch{}finally{i&&i.close()}}catch{}finally{r&&r.close()}return e}(),this.pack=Qa.pack,this.unpack=Qa.unpack,this._dataCount=1}return t.prototype.noop=function(){},t.prototype.validateId=function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(e)},t.prototype.chunk=function(e){for(var r=[],i=e.size,a=Math.ceil(i/je.chunkedMTU),f=0,y=0;y<i;){var s=Math.min(i,y+je.chunkedMTU),o=e.slice(y,s),c={__peerData:this._dataCount,n:f,data:o,total:a};r.push(c),y=s,f++}return this._dataCount++,r},t.prototype.blobToArrayBuffer=function(e,r){var i=new FileReader;return i.onload=function(a){a.target&&r(a.target.result)},i.readAsArrayBuffer(e),i},t.prototype.binaryStringToArrayBuffer=function(e){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i)&255;return r.buffer},t.prototype.randomToken=function(){return Math.random().toString(36).slice(2)},t.prototype.isSecure=function(){return location.protocol==="https:"},t}(),je=new td,sh={};cr(sh,"Peer",()=>Jn,t=>Jn=t);var cn={},rd=Object.prototype.hasOwnProperty,_t="~";function nn(){}Object.create&&(nn.prototype=Object.create(null),new nn().__proto__||(_t=!1));function id(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function oh(t,e,r,i,a){if(typeof r!="function")throw new TypeError("The listener must be a function");var f=new id(r,i||t,a),y=_t?_t+e:e;return t._events[y]?t._events[y].fn?t._events[y]=[t._events[y],f]:t._events[y].push(f):(t._events[y]=f,t._eventsCount++),t}function zn(t,e){--t._eventsCount===0?t._events=new nn:delete t._events[e]}function ct(){this._events=new nn,this._eventsCount=0}ct.prototype.eventNames=function(){var e=[],r,i;if(this._eventsCount===0)return e;for(i in r=this._events)rd.call(r,i)&&e.push(_t?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e};ct.prototype.listeners=function(e){var r=_t?_t+e:e,i=this._events[r];if(!i)return[];if(i.fn)return[i.fn];for(var a=0,f=i.length,y=new Array(f);a<f;a++)y[a]=i[a].fn;return y};ct.prototype.listenerCount=function(e){var r=_t?_t+e:e,i=this._events[r];return i?i.fn?1:i.length:0};ct.prototype.emit=function(e,r,i,a,f,y){var s=_t?_t+e:e;if(!this._events[s])return!1;var o=this._events[s],c=arguments.length,d,_;if(o.fn){switch(o.once&&this.removeListener(e,o.fn,void 0,!0),c){case 1:return o.fn.call(o.context),!0;case 2:return o.fn.call(o.context,r),!0;case 3:return o.fn.call(o.context,r,i),!0;case 4:return o.fn.call(o.context,r,i,a),!0;case 5:return o.fn.call(o.context,r,i,a,f),!0;case 6:return o.fn.call(o.context,r,i,a,f,y),!0}for(_=1,d=new Array(c-1);_<c;_++)d[_-1]=arguments[_];o.fn.apply(o.context,d)}else{var v=o.length,E;for(_=0;_<v;_++)switch(o[_].once&&this.removeListener(e,o[_].fn,void 0,!0),c){case 1:o[_].fn.call(o[_].context);break;case 2:o[_].fn.call(o[_].context,r);break;case 3:o[_].fn.call(o[_].context,r,i);break;case 4:o[_].fn.call(o[_].context,r,i,a);break;default:if(!d)for(E=1,d=new Array(c-1);E<c;E++)d[E-1]=arguments[E];o[_].fn.apply(o[_].context,d)}}return!0};ct.prototype.on=function(e,r,i){return oh(this,e,r,i,!1)};ct.prototype.once=function(e,r,i){return oh(this,e,r,i,!0)};ct.prototype.removeListener=function(e,r,i,a){var f=_t?_t+e:e;if(!this._events[f])return this;if(!r)return zn(this,f),this;var y=this._events[f];if(y.fn)y.fn===r&&(!a||y.once)&&(!i||y.context===i)&&zn(this,f);else{for(var s=0,o=[],c=y.length;s<c;s++)(y[s].fn!==r||a&&!y[s].once||i&&y[s].context!==i)&&o.push(y[s]);o.length?this._events[f]=o.length===1?o[0]:o:zn(this,f)}return this};ct.prototype.removeAllListeners=function(e){var r;return e?(r=_t?_t+e:e,this._events[r]&&zn(this,r)):(this._events=new nn,this._eventsCount=0),this};ct.prototype.off=ct.prototype.removeListener;ct.prototype.addListener=ct.prototype.on;ct.prefixed=_t;ct.EventEmitter=ct;cn=ct;var Se={};cr(Se,"LogLevel",()=>bt,t=>bt=t);cr(Se,"default",()=>hc,t=>hc=t);var zr=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),a,f=[],y;try{for(;(e===void 0||e-- >0)&&!(a=i.next()).done;)f.push(a.value)}catch(s){y={error:s}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(y)throw y.error}}return f},Vr=function(t,e,r){if(r||arguments.length===2)for(var i=0,a=e.length,f;i<a;i++)(f||!(i in e))&&(f||(f=Array.prototype.slice.call(e,0,i)),f[i]=e[i]);return t.concat(f||Array.prototype.slice.call(e))},nd="PeerJS: ",bt;(function(t){t[t.Disabled=0]="Disabled",t[t.Errors=1]="Errors",t[t.Warnings=2]="Warnings",t[t.All=3]="All"})(bt||(bt={}));var sd=function(){function t(){this._logLevel=bt.Disabled}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!1,configurable:!0}),t.prototype.log=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._logLevel>=bt.All&&this._print.apply(this,Vr([bt.All],zr(e),!1))},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._logLevel>=bt.Warnings&&this._print.apply(this,Vr([bt.Warnings],zr(e),!1))},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._logLevel>=bt.Errors&&this._print.apply(this,Vr([bt.Errors],zr(e),!1))},t.prototype.setLogFunction=function(e){this._print=e},t.prototype._print=function(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var a=Vr([nd],zr(r),!1);for(var f in a)a[f]instanceof Error&&(a[f]="("+a[f].name+") "+a[f].message);e>=bt.All?console.log.apply(console,Vr([],zr(a),!1)):e>=bt.Warnings?console.warn.apply(console,Vr(["WARNING"],zr(a),!1)):e>=bt.Errors&&console.error.apply(console,Vr(["ERROR"],zr(a),!1))},t}(),hc=new sd,ah={};cr(ah,"Socket",()=>uc,t=>uc=t);var Kt;(function(t){t.Data="data",t.Media="media"})(Kt||(Kt={}));var Xe;(function(t){t.BrowserIncompatible="browser-incompatible",t.Disconnected="disconnected",t.InvalidID="invalid-id",t.InvalidKey="invalid-key",t.Network="network",t.PeerUnavailable="peer-unavailable",t.SslUnavailable="ssl-unavailable",t.ServerError="server-error",t.SocketError="socket-error",t.SocketClosed="socket-closed",t.UnavailableID="unavailable-id",t.WebRTC="webrtc"})(Xe||(Xe={}));var dr;(function(t){t.Binary="binary",t.BinaryUTF8="binary-utf8",t.JSON="json"})(dr||(dr={}));var _r;(function(t){t.Message="message",t.Disconnected="disconnected",t.Error="error",t.Close="close"})(_r||(_r={}));var tt;(function(t){t.Heartbeat="HEARTBEAT",t.Candidate="CANDIDATE",t.Offer="OFFER",t.Answer="ANSWER",t.Open="OPEN",t.Error="ERROR",t.IdTaken="ID-TAKEN",t.InvalidKey="INVALID-KEY",t.Leave="LEAVE",t.Expire="EXPIRE"})(tt||(tt={}));var ta={};ta=JSON.parse('{"name":"peerjs","version":"1.4.7","keywords":["peerjs","webrtc","p2p","rtc"],"description":"PeerJS client","homepage":"https://peerjs.com","bugs":{"url":"https://github.com/peers/peerjs/issues"},"repository":{"type":"git","url":"https://github.com/peers/peerjs"},"license":"MIT","contributors":["Michelle Bu <michelle@michellebu.com>","afrokick <devbyru@gmail.com>","ericz <really.ez@gmail.com>","Jairo <kidandcat@gmail.com>","Jonas Gloning <34194370+jonasgloning@users.noreply.github.com>","Jairo Caro-Accino Viciana <jairo@galax.be>","Carlos Caballero <carlos.caballero.gonzalez@gmail.com>","hc <hheennrryy@gmail.com>","Muhammad Asif <capripio@gmail.com>","PrashoonB <prashoonbhattacharjee@gmail.com>","Harsh Bardhan Mishra <47351025+HarshCasper@users.noreply.github.com>","akotynski <aleksanderkotbury@gmail.com>","lmb <i@lmb.io>","Jairooo <jairocaro@msn.com>","Moritz Stckler <moritz.stueckler@gmail.com>","Simon <crydotsnakegithub@gmail.com>","Denis Lukov <denismassters@gmail.com>","Philipp Hancke <fippo@andyet.net>","Hans Oksendahl <hansoksendahl@gmail.com>","Jess <jessachandler@gmail.com>","khankuan <khankuan@gmail.com>","DUODVK <kurmanov.work@gmail.com>","XiZhao <kwang1imsa@gmail.com>","Matthias Lohr <matthias@lohr.me>","=frank tree <=frnktrb@googlemail.com>","Andre Eckardt <aeckardt@outlook.com>","Chris Cowan <agentme49@gmail.com>","Alex Chuev <alex@chuev.com>","alxnull <alxnull@e.mail.de>","Yemel Jardi <angel.jardi@gmail.com>","Ben Parnell <benjaminparnell.94@gmail.com>","Benny Lichtner <bennlich@gmail.com>","fresheneesz <bitetrudpublic@gmail.com>","bob.barstead@exaptive.com <bob.barstead@exaptive.com>","chandika <chandika@gmail.com>","emersion <contact@emersion.fr>","Christopher Van <cvan@users.noreply.github.com>","eddieherm <edhermoso@gmail.com>","Eduardo Pinho <enet4mikeenet@gmail.com>","Evandro Zanatta <ezanatta@tray.net.br>","Gardner Bickford <gardner@users.noreply.github.com>","Gian Luca <gianluca.cecchi@cynny.com>","PatrickJS <github@gdi2290.com>","jonnyf <github@jonathanfoss.co.uk>","Hizkia Felix <hizkifw@gmail.com>","Hristo Oskov <hristo.oskov@gmail.com>","Isaac Madwed <i.madwed@gmail.com>","Ilya Konanykhin <ilya.konanykhin@gmail.com>","jasonbarry <jasbarry@me.com>","Jonathan Burke <jonathan.burke.1311@googlemail.com>","Josh Hamit <josh.hamit@gmail.com>","Jordan Austin <jrax86@gmail.com>","Joel Wetzell <jwetzell@yahoo.com>","xizhao <kevin.wang@cloudera.com>","Alberto Torres <kungfoobar@gmail.com>","Jonathan Mayol <mayoljonathan@gmail.com>","Jefferson Felix <me@jsfelix.dev>","Rolf Erik Lekang <me@rolflekang.com>","Kevin Mai-Husan Chia <mhchia@users.noreply.github.com>","Pepijn de Vos <pepijndevos@gmail.com>","JooYoung <qkdlql@naver.com>","Tobias Speicher <rootcommander@gmail.com>","Steve Blaurock <sblaurock@gmail.com>","Kyrylo Shegeda <shegeda@ualberta.ca>","Diwank Singh Tomer <singh@diwank.name>","Soren Balko <Soeren.Balko@gmail.com>","Arpit Solanki <solankiarpit1997@gmail.com>","Yuki Ito <yuki@gnnk.net>","Artur Zayats <zag2art@gmail.com>"],"funding":{"type":"opencollective","url":"https://opencollective.com/peer"},"collective":{"type":"opencollective","url":"https://opencollective.com/peer"},"files":["dist/*"],"sideEffects":["lib/global.ts","lib/supports.ts"],"main":"dist/bundler.cjs","module":"dist/bundler.mjs","browser-minified":"dist/peerjs.min.js","browser-unminified":"dist/peerjs.js","types":"dist/types.d.ts","engines":{"node":">= 10"},"targets":{"types":{"source":"lib/exports.ts"},"main":{"source":"lib/exports.ts","sourceMap":{"inlineSources":true}},"module":{"source":"lib/exports.ts","includeNodeModules":["eventemitter3"],"sourceMap":{"inlineSources":true}},"browser-minified":{"context":"browser","outputFormat":"global","optimize":true,"engines":{"browsers":"cover 99%, not dead"},"source":"lib/global.ts"},"browser-unminified":{"context":"browser","outputFormat":"global","optimize":false,"engines":{"browsers":"cover 99%, not dead"},"source":"lib/global.ts"}},"scripts":{"contributors":"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\"chore(contributors): update and sort contributors list\\"","check":"tsc --noEmit","watch":"parcel watch","build":"rm -rf dist && parcel build","prepublishOnly":"npm run build","test":"mocha -r ts-node/register -r jsdom-global/register test/**/*.ts","format":"prettier --write .","semantic-release":"semantic-release"},"devDependencies":{"@parcel/config-default":"^2.5.0","@parcel/packager-ts":"^2.5.0","@parcel/transformer-typescript-tsc":"^2.5.0","@parcel/transformer-typescript-types":"^2.5.0","@semantic-release/changelog":"^6.0.1","@semantic-release/git":"^10.0.1","@types/chai":"^4.3.0","@types/mocha":"^9.1.0","@types/node":"^17.0.18","chai":"^4.3.6","git-authors-cli":"^1.0.40","jsdom":"^19.0.0","jsdom-global":"^3.0.2","mocha":"^9.2.0","mock-socket":"8.0.5","parcel":"^2.5.0","parcel-transformer-tsc-sourcemaps":"^1.0.2","prettier":"^2.6.2","semantic-release":"^19.0.2","standard":"^16.0.4","ts-node":"^10.5.0","typescript":"^4.5.5"},"dependencies":{"@swc/helpers":"^0.3.13","eventemitter3":"^4.0.7","peerjs-js-binarypack":"1.0.1","webrtc-adapter":"^7.7.1"}}');var od=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(i[f]=a[f])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}(),ad=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),a,f=[],y;try{for(;(e===void 0||e-- >0)&&!(a=i.next()).done;)f.push(a.value)}catch(s){y={error:s}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(y)throw y.error}}return f},cd=function(t,e,r){if(r||arguments.length===2)for(var i=0,a=e.length,f;i<a;i++)(f||!(i in e))&&(f||(f=Array.prototype.slice.call(e,0,i)),f[i]=e[i]);return t.concat(f||Array.prototype.slice.call(e))},ld=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},uc=function(t){od(e,t);function e(r,i,a,f,y,s){s===void 0&&(s=5e3);var o=t.call(this)||this;o.pingInterval=s,o._disconnected=!0,o._messagesQueue=[];var c=r?"wss://":"ws://";return o._baseUrl=c+i+":"+a+f+"peerjs?key="+y,o}return e.prototype.start=function(r,i){var a=this;this._id=r;var f="".concat(this._baseUrl,"&id=").concat(r,"&token=").concat(i);this._socket||!this._disconnected||(this._socket=new WebSocket(f+"&version="+ta.version),this._disconnected=!1,this._socket.onmessage=function(y){var s;try{s=JSON.parse(y.data),Se.default.log("Server message received:",s)}catch{Se.default.log("Invalid server message",y.data);return}a.emit(_r.Message,s)},this._socket.onclose=function(y){a._disconnected||(Se.default.log("Socket closed.",y),a._cleanup(),a._disconnected=!0,a.emit(_r.Disconnected))},this._socket.onopen=function(){a._disconnected||(a._sendQueuedMessages(),Se.default.log("Socket open"),a._scheduleHeartbeat())})},e.prototype._scheduleHeartbeat=function(){var r=this;this._wsPingTimer=setTimeout(function(){r._sendHeartbeat()},this.pingInterval)},e.prototype._sendHeartbeat=function(){if(!this._wsOpen()){Se.default.log("Cannot send heartbeat, because socket closed");return}var r=JSON.stringify({type:tt.Heartbeat});this._socket.send(r),this._scheduleHeartbeat()},e.prototype._wsOpen=function(){return!!this._socket&&this._socket.readyState===1},e.prototype._sendQueuedMessages=function(){var r,i,a=cd([],ad(this._messagesQueue),!1);this._messagesQueue=[];try{for(var f=ld(a),y=f.next();!y.done;y=f.next()){var s=y.value;this.send(s)}}catch(o){r={error:o}}finally{try{y&&!y.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}},e.prototype.send=function(r){if(!this._disconnected){if(!this._id){this._messagesQueue.push(r);return}if(!r.type){this.emit(_r.Error,"Invalid message");return}if(this._wsOpen()){var i=JSON.stringify(r);this._socket.send(i)}}},e.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},e.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},e}(cn.EventEmitter),Co={};cr(Co,"MediaConnection",()=>pc,t=>pc=t);var ra={};cr(ra,"Negotiator",()=>fc,t=>fc=t);var Yn=function(){return Yn=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},Yn.apply(this,arguments)},xn=function(t,e,r,i){function a(f){return f instanceof r?f:new r(function(y){y(f)})}return new(r||(r=Promise))(function(f,y){function s(d){try{c(i.next(d))}catch(_){y(_)}}function o(d){try{c(i.throw(d))}catch(_){y(_)}}function c(d){d.done?f(d.value):a(d.value).then(s,o)}c((i=i.apply(t,e||[])).next())})},Dn=function(t,e){var r={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},i,a,f,y;return y={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function s(c){return function(d){return o([c,d])}}function o(c){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,a&&(f=c[0]&2?a.return:c[0]?a.throw||((f=a.return)&&f.call(a),0):a.next)&&!(f=f.call(a,c[1])).done)return f;switch(a=0,f&&(c=[c[0]&2,f.value]),c[0]){case 0:case 1:f=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,a=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(f=r.trys,!(f=f.length>0&&f[f.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!f||c[1]>f[0]&&c[1]<f[3])){r.label=c[1];break}if(c[0]===6&&r.label<f[1]){r.label=f[1],f=c;break}if(f&&r.label<f[2]){r.label=f[2],r.ops.push(c);break}f[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(d){c=[6,d],a=0}finally{i=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},fc=function(){function t(e){this.connection=e}return t.prototype.startConnection=function(e){var r=this._startPeerConnection();if(this.connection.peerConnection=r,this.connection.type===Kt.Media&&e._stream&&this._addTracksToConnection(e._stream,r),e.originator){if(this.connection.type===Kt.Data){var i=this.connection,a={ordered:!!e.reliable},f=r.createDataChannel(i.label,a);i.initialize(f)}this._makeOffer()}else this.handleSDP("OFFER",e.sdp)},t.prototype._startPeerConnection=function(){Se.default.log("Creating RTCPeerConnection.");var e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e},t.prototype._setupListeners=function(e){var r=this,i=this.connection.peer,a=this.connection.connectionId,f=this.connection.type,y=this.connection.provider;Se.default.log("Listening for ICE candidates."),e.onicecandidate=function(s){!s.candidate||!s.candidate.candidate||(Se.default.log("Received ICE candidates for ".concat(i,":"),s.candidate),y.socket.send({type:tt.Candidate,payload:{candidate:s.candidate,type:f,connectionId:a},dst:i}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"failed":Se.default.log("iceConnectionState is failed, closing connections to "+i),r.connection.emit("error",new Error("Negotiation of connection to "+i+" failed.")),r.connection.close();break;case"closed":Se.default.log("iceConnectionState is closed, closing connections to "+i),r.connection.emit("error",new Error("Connection to "+i+" closed.")),r.connection.close();break;case"disconnected":Se.default.log("iceConnectionState changed to disconnected on the connection with "+i);break;case"completed":e.onicecandidate=je.noop;break}r.connection.emit("iceStateChanged",e.iceConnectionState)},Se.default.log("Listening for data channel"),e.ondatachannel=function(s){Se.default.log("Received data channel");var o=s.channel,c=y.getConnection(i,a);c.initialize(o)},Se.default.log("Listening for remote stream"),e.ontrack=function(s){Se.default.log("Received remote stream");var o=s.streams[0],c=y.getConnection(i,a);if(c.type===Kt.Media){var d=c;r._addStreamToMediaConnection(o,d)}}},t.prototype.cleanup=function(){Se.default.log("Cleaning up PeerConnection to "+this.connection.peer);var e=this.connection.peerConnection;if(e){this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=function(){};var r=e.signalingState!=="closed",i=!1;if(this.connection.type===Kt.Data){var a=this.connection,f=a.dataChannel;f&&(i=!!f.readyState&&f.readyState!=="closed")}(r||i)&&e.close()}},t.prototype._makeOffer=function(){return xn(this,void 0,Promise,function(){var e,r,i,a,f,y,s;return Dn(this,function(o){switch(o.label){case 0:e=this.connection.peerConnection,r=this.connection.provider,o.label=1;case 1:return o.trys.push([1,7,,8]),[4,e.createOffer(this.connection.options.constraints)];case 2:i=o.sent(),Se.default.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(i.sdp=this.connection.options.sdpTransform(i.sdp)||i.sdp),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,e.setLocalDescription(i)];case 4:return o.sent(),Se.default.log("Set localDescription:",i,"for:".concat(this.connection.peer)),a={sdp:i,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:je.browser},this.connection.type===Kt.Data&&(f=this.connection,a=Yn(Yn({},a),{label:f.label,reliable:f.reliable,serialization:f.serialization})),r.socket.send({type:tt.Offer,payload:a,dst:this.connection.peer}),[3,6];case 5:return y=o.sent(),y!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(r.emitError(Xe.WebRTC,y),Se.default.log("Failed to setLocalDescription, ",y)),[3,6];case 6:return[3,8];case 7:return s=o.sent(),r.emitError(Xe.WebRTC,s),Se.default.log("Failed to createOffer, ",s),[3,8];case 8:return[2]}})})},t.prototype._makeAnswer=function(){return xn(this,void 0,Promise,function(){var e,r,i,a,f;return Dn(this,function(y){switch(y.label){case 0:e=this.connection.peerConnection,r=this.connection.provider,y.label=1;case 1:return y.trys.push([1,7,,8]),[4,e.createAnswer()];case 2:i=y.sent(),Se.default.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(i.sdp=this.connection.options.sdpTransform(i.sdp)||i.sdp),y.label=3;case 3:return y.trys.push([3,5,,6]),[4,e.setLocalDescription(i)];case 4:return y.sent(),Se.default.log("Set localDescription:",i,"for:".concat(this.connection.peer)),r.socket.send({type:tt.Answer,payload:{sdp:i,type:this.connection.type,connectionId:this.connection.connectionId,browser:je.browser},dst:this.connection.peer}),[3,6];case 5:return a=y.sent(),r.emitError(Xe.WebRTC,a),Se.default.log("Failed to setLocalDescription, ",a),[3,6];case 6:return[3,8];case 7:return f=y.sent(),r.emitError(Xe.WebRTC,f),Se.default.log("Failed to create answer, ",f),[3,8];case 8:return[2]}})})},t.prototype.handleSDP=function(e,r){return xn(this,void 0,Promise,function(){var i,a,f,y;return Dn(this,function(s){switch(s.label){case 0:r=new RTCSessionDescription(r),i=this.connection.peerConnection,a=this.connection.provider,Se.default.log("Setting remote description",r),f=this,s.label=1;case 1:return s.trys.push([1,5,,6]),[4,i.setRemoteDescription(r)];case 2:return s.sent(),Se.default.log("Set remoteDescription:".concat(e," for:").concat(this.connection.peer)),e!=="OFFER"?[3,4]:[4,f._makeAnswer()];case 3:s.sent(),s.label=4;case 4:return[3,6];case 5:return y=s.sent(),a.emitError(Xe.WebRTC,y),Se.default.log("Failed to setRemoteDescription, ",y),[3,6];case 6:return[2]}})})},t.prototype.handleCandidate=function(e){return xn(this,void 0,Promise,function(){var r,i,a,f,y,s;return Dn(this,function(o){switch(o.label){case 0:Se.default.log("handleCandidate:",e),r=e.candidate,i=e.sdpMLineIndex,a=e.sdpMid,f=this.connection.peerConnection,y=this.connection.provider,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,f.addIceCandidate(new RTCIceCandidate({sdpMid:a,sdpMLineIndex:i,candidate:r}))];case 2:return o.sent(),Se.default.log("Added ICE candidate for:".concat(this.connection.peer)),[3,4];case 3:return s=o.sent(),y.emitError(Xe.WebRTC,s),Se.default.log("Failed to handleCandidate, ",s),[3,4];case 4:return[2]}})})},t.prototype._addTracksToConnection=function(e,r){if(Se.default.log("add tracks from stream ".concat(e.id," to peer connection")),!r.addTrack)return Se.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(function(i){r.addTrack(i,e)})},t.prototype._addStreamToMediaConnection=function(e,r){Se.default.log("add stream ".concat(e.id," to media connection ").concat(r.connectionId)),r.addStream(e)},t}(),ia={};cr(ia,"BaseConnection",()=>dc,t=>dc=t);var hd=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(i[f]=a[f])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}(),dc=function(t){hd(e,t);function e(r,i,a){var f=t.call(this)||this;return f.peer=r,f.provider=i,f.options=a,f._open=!1,f.metadata=a.metadata,f}return Object.defineProperty(e.prototype,"open",{get:function(){return this._open},enumerable:!1,configurable:!0}),e}(cn.EventEmitter),ud=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(i[f]=a[f])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}(),Xn=function(){return Xn=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},Xn.apply(this,arguments)},fd=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},pc=function(t){ud(e,t);function e(r,i,a){var f=t.call(this,r,i,a)||this;return f._localStream=f.options._stream,f.connectionId=f.options.connectionId||e.ID_PREFIX+je.randomToken(),f._negotiator=new ra.Negotiator(f),f._localStream&&f._negotiator.startConnection({_stream:f._localStream,originator:!0}),f}return Object.defineProperty(e.prototype,"type",{get:function(){return Kt.Media},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localStream",{get:function(){return this._localStream},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!1,configurable:!0}),e.prototype.addStream=function(r){Se.default.log("Receiving stream",r),this._remoteStream=r,t.prototype.emit.call(this,"stream",r)},e.prototype.handleMessage=function(r){var i=r.type,a=r.payload;switch(r.type){case tt.Answer:this._negotiator.handleSDP(i,a.sdp),this._open=!0;break;case tt.Candidate:this._negotiator.handleCandidate(a.candidate);break;default:Se.default.warn("Unrecognized message type:".concat(i," from peer:").concat(this.peer));break}},e.prototype.answer=function(r,i){var a,f;if(i===void 0&&(i={}),this._localStream){Se.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=r,i&&i.sdpTransform&&(this.options.sdpTransform=i.sdpTransform),this._negotiator.startConnection(Xn(Xn({},this.options._payload),{_stream:r}));var y=this.provider._getMessages(this.connectionId);try{for(var s=fd(y),o=s.next();!o.done;o=s.next()){var c=o.value;this.handleMessage(c)}}catch(d){a={error:d}}finally{try{o&&!o.done&&(f=s.return)&&f.call(s)}finally{if(a)throw a.error}}this._open=!0},e.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,t.prototype.emit.call(this,"close"))},e.ID_PREFIX="mc_",e}(ia.BaseConnection),Eo={};cr(Eo,"DataConnection",()=>gc,t=>gc=t);var ch={};cr(ch,"EncodingQueue",()=>_c,t=>_c=t);var dd=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(i[f]=a[f])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}(),_c=function(t){dd(e,t);function e(){var r=t.call(this)||this;return r.fileReader=new FileReader,r._queue=[],r._processing=!1,r.fileReader.onload=function(i){r._processing=!1,i.target&&r.emit("done",i.target.result),r.doNextTask()},r.fileReader.onerror=function(i){Se.default.error("EncodingQueue error:",i),r._processing=!1,r.destroy(),r.emit("error",i)},r}return Object.defineProperty(e.prototype,"queue",{get:function(){return this._queue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.queue.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"processing",{get:function(){return this._processing},enumerable:!1,configurable:!0}),e.prototype.enque=function(r){this.queue.push(r),!this.processing&&this.doNextTask()},e.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},e.prototype.doNextTask=function(){this.size!==0&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},e}(cn.EventEmitter),pd=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(i[f]=a[f])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}(),_d=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},gc=function(t){pd(e,t);function e(r,i,a){var f=t.call(this,r,i,a)||this;return f.stringify=JSON.stringify,f.parse=JSON.parse,f._buffer=[],f._bufferSize=0,f._buffering=!1,f._chunkedData={},f._encodingQueue=new ch.EncodingQueue,f.connectionId=f.options.connectionId||e.ID_PREFIX+je.randomToken(),f.label=f.options.label||f.connectionId,f.serialization=f.options.serialization||dr.Binary,f.reliable=!!f.options.reliable,f._encodingQueue.on("done",function(y){f._bufferedSend(y)}),f._encodingQueue.on("error",function(){Se.default.error("DC#".concat(f.connectionId,": Error occured in encoding from blob to arraybuffer, close DC")),f.close()}),f._negotiator=new ra.Negotiator(f),f._negotiator.startConnection(f.options._payload||{originator:!0}),f}return Object.defineProperty(e.prototype,"type",{get:function(){return Kt.Data},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!1,configurable:!0}),e.prototype.initialize=function(r){this._dc=r,this._configureDataChannel()},e.prototype._configureDataChannel=function(){var r=this;(!je.supports.binaryBlob||je.supports.reliable)&&(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){Se.default.log("DC#".concat(r.connectionId," dc connection success")),r._open=!0,r.emit("open")},this.dataChannel.onmessage=function(i){Se.default.log("DC#".concat(r.connectionId," dc onmessage:"),i.data),r._handleDataMessage(i)},this.dataChannel.onclose=function(){Se.default.log("DC#".concat(r.connectionId," dc closed for:"),r.peer),r.close()}},e.prototype._handleDataMessage=function(r){var i=this,a=r.data,f=a.constructor,y=this.serialization===dr.Binary||this.serialization===dr.BinaryUTF8,s=a;if(y){if(f===Blob){je.blobToArrayBuffer(a,function(c){var d=je.unpack(c);i.emit("data",d)});return}else if(f===ArrayBuffer)s=je.unpack(a);else if(f===String){var o=je.binaryStringToArrayBuffer(a);s=je.unpack(o)}}else this.serialization===dr.JSON&&(s=this.parse(a));if(s.__peerData){this._handleChunk(s);return}t.prototype.emit.call(this,"data",s)},e.prototype._handleChunk=function(r){var i=r.__peerData,a=this._chunkedData[i]||{data:[],count:0,total:r.total};if(a.data[r.n]=r.data,a.count++,this._chunkedData[i]=a,a.total===a.count){delete this._chunkedData[i];var f=new Blob(a.data);this._handleDataMessage({data:f})}},e.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,t.prototype.emit.call(this,"close"))},e.prototype.send=function(r,i){if(!this.open){t.prototype.emit.call(this,"error",new Error("Connection is not open. You should listen for the `open` event before sending messages."));return}if(this.serialization===dr.JSON)this._bufferedSend(this.stringify(r));else if(this.serialization===dr.Binary||this.serialization===dr.BinaryUTF8){var a=je.pack(r);if(!i&&a.size>je.chunkedMTU){this._sendChunks(a);return}je.supports.binaryBlob?this._bufferedSend(a):this._encodingQueue.enque(a)}else this._bufferedSend(r)},e.prototype._bufferedSend=function(r){(this._buffering||!this._trySend(r))&&(this._buffer.push(r),this._bufferSize=this._buffer.length)},e.prototype._trySend=function(r){var i=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>e.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(function(){i._buffering=!1,i._tryBuffer()},50),!1;try{this.dataChannel.send(r)}catch(a){return Se.default.error("DC#:".concat(this.connectionId," Error when sending:"),a),this._buffering=!0,this.close(),!1}return!0},e.prototype._tryBuffer=function(){if(this.open&&this._buffer.length!==0){var r=this._buffer[0];this._trySend(r)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}},e.prototype._sendChunks=function(r){var i,a,f=je.chunk(r);Se.default.log("DC#".concat(this.connectionId," Try to send ").concat(f.length," chunks..."));try{for(var y=_d(f),s=y.next();!s.done;s=y.next()){var o=s.value;this.send(o,!0)}}catch(c){i={error:c}}finally{try{s&&!s.done&&(a=y.return)&&a.call(y)}finally{if(i)throw i.error}}},e.prototype.handleMessage=function(r){var i=r.payload;switch(r.type){case tt.Answer:this._negotiator.handleSDP(r.type,i.sdp);break;case tt.Candidate:this._negotiator.handleCandidate(i.candidate);break;default:Se.default.warn("Unrecognized message type:",r.type,"from peer:",this.peer);break}},e.ID_PREFIX="dc_",e.MAX_BUFFERED_AMOUNT=8388608,e}(ia.BaseConnection),lh={};cr(lh,"API",()=>yc,t=>yc=t);var mc=function(t,e,r,i){function a(f){return f instanceof r?f:new r(function(y){y(f)})}return new(r||(r=Promise))(function(f,y){function s(d){try{c(i.next(d))}catch(_){y(_)}}function o(d){try{c(i.throw(d))}catch(_){y(_)}}function c(d){d.done?f(d.value):a(d.value).then(s,o)}c((i=i.apply(t,e||[])).next())})},vc=function(t,e){var r={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},i,a,f,y;return y={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function s(c){return function(d){return o([c,d])}}function o(c){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,a&&(f=c[0]&2?a.return:c[0]?a.throw||((f=a.return)&&f.call(a),0):a.next)&&!(f=f.call(a,c[1])).done)return f;switch(a=0,f&&(c=[c[0]&2,f.value]),c[0]){case 0:case 1:f=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,a=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(f=r.trys,!(f=f.length>0&&f[f.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!f||c[1]>f[0]&&c[1]<f[3])){r.label=c[1];break}if(c[0]===6&&r.label<f[1]){r.label=f[1],f=c;break}if(f&&r.label<f[2]){r.label=f[2],r.ops.push(c);break}f[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(d){c=[6,d],a=0}finally{i=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},yc=function(){function t(e){this._options=e}return t.prototype._buildRequest=function(e){var r=this._options.secure?"https":"http",i=this._options,a=i.host,f=i.port,y=i.path,s=i.key,o=new URL("".concat(r,"://").concat(a,":").concat(f).concat(y).concat(s,"/").concat(e));return o.searchParams.set("ts","".concat(Date.now()).concat(Math.random())),o.searchParams.set("version",ta.version),fetch(o.href,{referrerPolicy:this._options.referrerPolicy})},t.prototype.retrieveId=function(){return mc(this,void 0,Promise,function(){var e,r,i;return vc(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this._buildRequest("id")];case 1:if(e=a.sent(),e.status!==200)throw new Error("Error. Status:".concat(e.status));return[2,e.text()];case 2:throw r=a.sent(),Se.default.error("Error retrieving ID",r),i="",this._options.path==="/"&&this._options.host!==je.CLOUD_HOST&&(i=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+i);case 3:return[2]}})})},t.prototype.listAllPeers=function(){return mc(this,void 0,Promise,function(){var e,r,i;return vc(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this._buildRequest("peers")];case 1:if(e=a.sent(),e.status!==200)throw e.status===401?(r="",this._options.host===je.CLOUD_HOST?r="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":r="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+r)):new Error("Error. Status:".concat(e.status));return[2,e.json()];case 2:throw i=a.sent(),Se.default.error("Error retrieving list peers",i),new Error("Could not get list peers from the server."+i);case 3:return[2]}})})},t}(),gd=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(i[f]=a[f])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}(),Zi=function(){return Zi=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},Zi.apply(this,arguments)},Ui=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},md=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),a,f=[],y;try{for(;(e===void 0||e-- >0)&&!(a=i.next()).done;)f.push(a.value)}catch(s){y={error:s}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(y)throw y.error}}return f},Jn=function(t){gd(e,t);function e(r,i){var a=t.call(this)||this;a._id=null,a._lastServerId=null,a._destroyed=!1,a._disconnected=!1,a._open=!1,a._connections=new Map,a._lostMessages=new Map;var f;return r&&r.constructor==Object?i=r:r&&(f=r.toString()),i=Zi({debug:0,host:je.CLOUD_HOST,port:je.CLOUD_PORT,path:"/",key:e.DEFAULT_KEY,token:je.randomToken(),config:je.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin"},i),a._options=i,a._options.host==="/"&&(a._options.host=window.location.hostname),a._options.path&&(a._options.path[0]!=="/"&&(a._options.path="/"+a._options.path),a._options.path[a._options.path.length-1]!=="/"&&(a._options.path+="/")),a._options.secure===void 0&&a._options.host!==je.CLOUD_HOST?a._options.secure=je.isSecure():a._options.host==je.CLOUD_HOST&&(a._options.secure=!0),a._options.logFunction&&Se.default.setLogFunction(a._options.logFunction),Se.default.logLevel=a._options.debug||0,a._api=new lh.API(i),a._socket=a._createServerConnection(),!je.supports.audioVideo&&!je.supports.data?(a._delayedAbort(Xe.BrowserIncompatible,"The current browser does not support WebRTC"),a):f&&!je.validateId(f)?(a._delayedAbort(Xe.InvalidID,'ID "'.concat(f,'" is invalid')),a):(f?a._initialize(f):a._api.retrieveId().then(function(y){return a._initialize(y)}).catch(function(y){return a._abort(Xe.ServerError,y)}),a)}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"open",{get:function(){return this._open},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"socket",{get:function(){return this._socket},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connections",{get:function(){var r,i,a=Object.create(null);try{for(var f=Ui(this._connections),y=f.next();!y.done;y=f.next()){var s=md(y.value,2),o=s[0],c=s[1];a[o]=c}}catch(d){r={error:d}}finally{try{y&&!y.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}return a},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!1,configurable:!0}),e.prototype._createServerConnection=function(){var r=this,i=new ah.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return i.on(_r.Message,function(a){r._handleMessage(a)}),i.on(_r.Error,function(a){r._abort(Xe.SocketError,a)}),i.on(_r.Disconnected,function(){r.disconnected||(r.emitError(Xe.Network,"Lost connection to server."),r.disconnect())}),i.on(_r.Close,function(){r.disconnected||r._abort(Xe.SocketClosed,"Underlying socket is already closed.")}),i},e.prototype._initialize=function(r){this._id=r,this.socket.start(r,this._options.token)},e.prototype._handleMessage=function(r){var i,a,f=r.type,y=r.payload,s=r.src;switch(f){case tt.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case tt.Error:this._abort(Xe.ServerError,y.msg);break;case tt.IdTaken:this._abort(Xe.UnavailableID,'ID "'.concat(this.id,'" is taken'));break;case tt.InvalidKey:this._abort(Xe.InvalidKey,'API KEY "'.concat(this._options.key,'" is invalid'));break;case tt.Leave:Se.default.log("Received leave message from ".concat(s)),this._cleanupPeer(s),this._connections.delete(s);break;case tt.Expire:this.emitError(Xe.PeerUnavailable,"Could not connect to peer ".concat(s));break;case tt.Offer:var C=y.connectionId,S=this.getConnection(s,C);if(S&&(S.close(),Se.default.warn("Offer received for existing Connection ID:".concat(C))),y.type===Kt.Media){var o=new Co.MediaConnection(s,this,{connectionId:C,_payload:y,metadata:y.metadata});S=o,this._addConnection(s,S),this.emit("call",o)}else if(y.type===Kt.Data){var c=new Eo.DataConnection(s,this,{connectionId:C,_payload:y,metadata:y.metadata,label:y.label,serialization:y.serialization,reliable:y.reliable});S=c,this._addConnection(s,S),this.emit("connection",c)}else{Se.default.warn("Received malformed connection type:".concat(y.type));return}var d=this._getMessages(C);try{for(var _=Ui(d),v=_.next();!v.done;v=_.next()){var E=v.value;S.handleMessage(E)}}catch(h){i={error:h}}finally{try{v&&!v.done&&(a=_.return)&&a.call(_)}finally{if(i)throw i.error}}break;default:if(!y){Se.default.warn("You received a malformed message from ".concat(s," of type ").concat(f));return}var C=y.connectionId,S=this.getConnection(s,C);S&&S.peerConnection?S.handleMessage(r):C?this._storeMessage(C,r):Se.default.warn("You received an unrecognized message:",r);break}},e.prototype._storeMessage=function(r,i){this._lostMessages.has(r)||this._lostMessages.set(r,[]),this._lostMessages.get(r).push(i)},e.prototype._getMessages=function(r){var i=this._lostMessages.get(r);return i?(this._lostMessages.delete(r),i):[]},e.prototype.connect=function(r,i){if(i===void 0&&(i={}),this.disconnected){Se.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(Xe.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}var a=new Eo.DataConnection(r,this,i);return this._addConnection(r,a),a},e.prototype.call=function(r,i,a){if(a===void 0&&(a={}),this.disconnected){Se.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(Xe.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!i){Se.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}var f=new Co.MediaConnection(r,this,Zi(Zi({},a),{_stream:i}));return this._addConnection(r,f),f},e.prototype._addConnection=function(r,i){Se.default.log("add connection ".concat(i.type,":").concat(i.connectionId," to peerId:").concat(r)),this._connections.has(r)||this._connections.set(r,[]),this._connections.get(r).push(i)},e.prototype._removeConnection=function(r){var i=this._connections.get(r.peer);if(i){var a=i.indexOf(r);a!==-1&&i.splice(a,1)}this._lostMessages.delete(r.connectionId)},e.prototype.getConnection=function(r,i){var a,f,y=this._connections.get(r);if(!y)return null;try{for(var s=Ui(y),o=s.next();!o.done;o=s.next()){var c=o.value;if(c.connectionId===i)return c}}catch(d){a={error:d}}finally{try{o&&!o.done&&(f=s.return)&&f.call(s)}finally{if(a)throw a.error}}return null},e.prototype._delayedAbort=function(r,i){var a=this;setTimeout(function(){a._abort(r,i)},0)},e.prototype._abort=function(r,i){Se.default.error("Aborting!"),this.emitError(r,i),this._lastServerId?this.disconnect():this.destroy()},e.prototype.emitError=function(r,i){Se.default.error("Error:",i);var a;typeof i=="string"?a=new Error(i):a=i,a.type=r,this.emit("error",a)},e.prototype.destroy=function(){this.destroyed||(Se.default.log("Destroy peer with ID:".concat(this.id)),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))},e.prototype._cleanup=function(){var r,i;try{for(var a=Ui(this._connections.keys()),f=a.next();!f.done;f=a.next()){var y=f.value;this._cleanupPeer(y),this._connections.delete(y)}}catch(s){r={error:s}}finally{try{f&&!f.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}this.socket.removeAllListeners()},e.prototype._cleanupPeer=function(r){var i,a,f=this._connections.get(r);if(f)try{for(var y=Ui(f),s=y.next();!s.done;s=y.next()){var o=s.value;o.close()}}catch(c){i={error:c}}finally{try{s&&!s.done&&(a=y.return)&&a.call(y)}finally{if(i)throw i.error}}},e.prototype.disconnect=function(){if(!this.disconnected){var r=this.id;Se.default.log("Disconnect peer with ID:".concat(r)),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=r,this._id=null,this.emit("disconnected",r)}},e.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)Se.default.log("Attempting reconnection to server with ID ".concat(this._lastServerId)),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)Se.default.error("In a hurry? We're still trying to make the initial connection!");else throw new Error("Peer ".concat(this.id," cannot reconnect because it is not disconnected from the server!"))}},e.prototype.listAllPeers=function(r){var i=this;r===void 0&&(r=function(a){}),this._api.listAllPeers().then(function(a){return r(a)}).catch(function(a){return i._abort(Xe.ServerError,a)})},e.DEFAULT_KEY="peerjs",e}(cn.EventEmitter);sh.Peer;const vd=(t,e=document)=>e.querySelector(t),To=(t,e=document)=>[...e.querySelectorAll(t)],hh=(t,e=document)=>{const i=new XPathEvaluator().createExpression(t).evaluate(e,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE),a=[];for(let f=0,{snapshotLength:y}=i;f<y;f++)a.push(i.snapshotItem(f));return a},uh=-1,us=0,Qn=1,Zn=2,na=3,sa=4,oa=5,aa=6,fh=7,dh=8,Sc=typeof self=="object"?self:globalThis,yd=(t,e)=>{const r=(a,f)=>(t.set(f,a),a),i=a=>{if(t.has(a))return t.get(a);const[f,y]=e[a];switch(f){case us:case uh:return r(y,a);case Qn:{const s=r([],a);for(const o of y)s.push(i(o));return s}case Zn:{const s=r({},a);for(const[o,c]of y)s[i(o)]=i(c);return s}case na:return r(new Date(y),a);case sa:{const{source:s,flags:o}=y;return r(new RegExp(s,o),a)}case oa:{const s=r(new Map,a);for(const[o,c]of y)s.set(i(o),i(c));return s}case aa:{const s=r(new Set,a);for(const o of y)s.add(i(o));return s}case fh:{const{name:s,message:o}=y;return r(new Sc[s](o),a)}case dh:return r(BigInt(y),a);case"BigInt":return r(Object(BigInt(y)),a)}return r(new Sc[f](y),a)};return i},Sd=t=>yd(new Map,t)(0),hi="",{toString:bd}={},{keys:Cd}=Object,Wi=t=>{const e=typeof t;if(e!=="object"||!t)return[us,e];const r=bd.call(t).slice(8,-1);switch(r){case"Array":return[Qn,hi];case"Object":return[Zn,hi];case"Date":return[na,hi];case"RegExp":return[sa,hi];case"Map":return[oa,hi];case"Set":return[aa,hi]}return r.includes("Array")?[Qn,r]:r.includes("Error")?[fh,r]:[Zn,r]},Ln=([t,e])=>t===us&&(e==="function"||e==="symbol"),Ed=(t,e,r,i)=>{const a=(y,s)=>{const o=i.push(y)-1;return r.set(s,o),o},f=y=>{if(r.has(y))return r.get(y);let[s,o]=Wi(y);switch(s){case us:{let d=y;switch(o){case"bigint":s=dh,d=y.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+o);d=null;break;case"undefined":return a([uh],y)}return a([s,d],y)}case Qn:{if(o)return a([o,[...y]],y);const d=[],_=a([s,d],y);for(const v of y)d.push(f(v));return _}case Zn:{if(o)switch(o){case"BigInt":return a([o,y.toString()],y);case"Boolean":case"Number":case"String":return a([o,y.valueOf()],y)}if(e&&"toJSON"in y)return f(y.toJSON());const d=[],_=a([s,d],y);for(const v of Cd(y))(t||!Ln(Wi(y[v])))&&d.push([f(v),f(y[v])]);return _}case na:return a([s,y.toISOString()],y);case sa:{const{source:d,flags:_}=y;return a([s,{source:d,flags:_}],y)}case oa:{const d=[],_=a([s,d],y);for(const[v,E]of y)(t||!(Ln(Wi(v))||Ln(Wi(E))))&&d.push([f(v),f(E)]);return _}case aa:{const d=[],_=a([s,d],y);for(const v of y)(t||!Ln(Wi(v)))&&d.push(f(v));return _}}const{message:c}=y;return a([s,{name:o,message:c}],y)};return f},Td=(t,{json:e,lossy:r}={})=>{const i=[];return Ed(!(e||r),!!e,new Map,i)(t),i};/*! (c) Andrea Giammarchi - ISC */const{parse:wd,stringify:kd}=JSON,Ad={json:!0,lossy:!0},Rd=t=>Sd(wd(t)),xd=t=>kd(Td(t,Ad)),Dd=Object.freeze(Object.defineProperty({__proto__:null,parse:Rd,stringify:xd},Symbol.toStringTag,{value:"Module"})),es="0811fd41-1b6b-49f1-8344-96210ac283f1",Ld="M"+es,Od="T"+es,Pd=t=>({value:new Promise(e=>{let r=new Worker("data:application/javascript,onmessage%3D(%7Bdata%3Ab%7D)%3D%3E(Atomics.wait(b%2C0)%2CpostMessage(0))");r.onmessage=e,r.postMessage(t)})});/*! (c) Andrea Giammarchi - ISC */const{Int32Array:wo,Map:bc,SharedArrayBuffer:Cc,Uint16Array:ko}=globalThis,{BYTES_PER_ELEMENT:Ec}=wo,{BYTES_PER_ELEMENT:Md}=ko,{isArray:Id}=Array,{notify:Bd,wait:Nd,waitAsync:Hd}=Atomics,{fromCharCode:$d}=String,Tc=(t,e)=>t?(Hd||Pd)(e,0):(Nd(e,0),{value:{then:r=>r()}}),Ao=new WeakSet,Ws=new WeakMap;let Fd=0;const ca=(t,{parse:e,stringify:r,transform:i}=JSON)=>{if(!Ws.has(t)){const a=(f,...y)=>t.postMessage({[es]:y},{transfer:f});Ws.set(t,new Proxy(new bc,{has:(f,y)=>typeof y=="string"&&!y.startsWith("_"),get:(f,y)=>y==="then"?null:(...s)=>{const o=Fd++;let c=new wo(new Cc(Ec)),d=[];Ao.has(s.at(-1)||d)&&Ao.delete(d=s.pop()),a(d,o,c,y,i?s.map(i):s);const _=t!==globalThis;return Tc(_,c).value.then(()=>{const v=c[0];if(!v)return;const E=Md*v;return c=new wo(new Cc(E+E%Ec)),a([],o,c),Tc(_,c).value.then(()=>e($d(...new ko(c.buffer).slice(0,v))))})},set(f,y,s){if(!f.size){const o=new bc;t.addEventListener("message",async c=>{var _;const d=(_=c.data)==null?void 0:_[es];if(Id(d)){c.stopImmediatePropagation();const[v,E,...C]=d;if(C.length){const[S,h]=C;if(f.has(S)){const p=await f.get(S)(...h);if(p!==void 0){const g=r(p);o.set(v,g),E[0]=g.length}}else throw new Error(`Unsupported action: ${S}`)}else{const S=o.get(v);o.delete(v);for(let h=new ko(E.buffer),p=0;p<S.length;p++)h[p]=S.charCodeAt(p)}Bd(E,0)}})}return!!f.set(y,s)}}))}return Ws.get(t)};ca.transfer=(...t)=>(Ao.add(t),t);const Lr="object",nr="function",jd="boolean",la="number",ts="string",ph="undefined",Ud="bigint",fs="symbol",Wd="null",{defineProperty:Ro,getOwnPropertyDescriptor:zd,getPrototypeOf:_h,isExtensible:Vd,ownKeys:gh,preventExtensions:qd,set:Kd,setPrototypeOf:Gd}=Reflect,{assign:Yd,create:Xd}=Object,mh=_h(Int8Array),zs="isArray",vh=(t,e)=>{const{get:r,set:i,value:a}=t;return r&&(t.get=e(r)),i&&(t.set=e(i)),a&&(t.value=e(a)),t},Bt=(t,e)=>[t,e],yh=t=>e=>{const r=typeof e;switch(r){case Lr:if(e==null)return Bt(Wd,e);if(e===globalThis)return Bt(Lr,null);case nr:return t(r,e);case jd:case la:case ts:case ph:case Ud:return Bt(r,e);case fs:if(xo.has(e))return Bt(r,xo.get(e))}throw new Error(`Unable to handle this ${r} type`)},xo=new Map(gh(Symbol).filter(t=>typeof Symbol[t]===fs).map(t=>[Symbol[t],t])),Sh=t=>{for(const[e,r]of xo)if(r===t)return e};function Jd(){return this}const vi="apply",rs="construct",is="defineProperty",Do="deleteProperty",Lo="get",Oo="getOwnPropertyDescriptor",Po="getPrototypeOf",Mo="has",Io="isExtensible",Bo="ownKeys",No="preventExtensions",Ho="set",$o="setPrototypeOf",ns="delete",Qd=(t,e)=>{const r=e&&new WeakMap;if(e){const{addEventListener:a}=EventTarget.prototype;Ro(EventTarget.prototype,"addEventListener",{value(f,y,...s){var o;return(o=s.at(0))!=null&&o.invoke&&(r.has(this)||r.set(this,new Map),r.get(this).set(f,[].concat(s[0].invoke)),delete s[0].invoke),a.call(this,f,y,...s)}})}const i=e&&(a=>{var o;const{currentTarget:f,target:y,type:s}=a;for(const c of((o=r.get(f||y))==null?void 0:o.get(s))||[])a[c]()});return(a,f,y,...s)=>{let o=0;const c=new Map,d=new Map,{[y]:_}=a,v=s.length?Yd(Xd(globalThis),...s):globalThis,E=yh((p,g)=>{if(!c.has(g)){let m;for(;d.has(m=o++););c.set(g,m),d.set(m,g)}return Bt(p,c.get(g))}),C=new FinalizationRegistry(p=>{_(ns,Bt(ts,p))}),S=([p,g])=>{switch(p){case Lr:if(g==null)return v;if(typeof g===la)return d.get(g);if(!(g instanceof mh))for(const m in g)g[m]=S(g[m]);return g;case nr:if(typeof g===ts){if(!d.has(g)){const m=function(...w){return e&&w.at(0)instanceof Event&&i(...w),_(vi,Bt(nr,g),E(this),w.map(E))},T=new WeakRef(m);d.set(g,T),C.register(m,g,T)}return d.get(g).deref()}return d.get(g);case fs:return Sh(g)}return g},h={[vi]:(p,g,m)=>E(p.apply(g,m)),[rs]:(p,g)=>E(new p(...g)),[is]:(p,g,m)=>E(Ro(p,g,m)),[Do]:(p,g)=>E(delete p[g]),[Po]:p=>E(_h(p)),[Lo]:(p,g)=>E(p[g]),[Oo]:(p,g)=>{const m=zd(p,g);return m?Bt(Lr,vh(m,E)):Bt(ph,m)},[Mo]:(p,g)=>E(g in p),[Io]:p=>E(Vd(p)),[Bo]:p=>Bt(Lr,gh(p).map(E)),[No]:p=>E(qd(p)),[Ho]:(p,g,m)=>E(Kd(p,g,m)),[$o]:(p,g)=>E(Gd(p,g)),[ns](p){c.delete(d.get(p)),d.delete(p)}};return a[f]=(p,g,...m)=>{switch(p){case vi:m[0]=S(m[0]),m[1]=m[1].map(S);break;case rs:m[0]=m[0].map(S);break;case is:{const[T,w]=m;m[0]=S(T);const{get:R,set:l,value:k}=w;R&&(w.get=S(R)),l&&(w.set=S(l)),k&&(w.value=S(k));break}default:m=m.map(S);break}return h[p](S(g),...m)},{proxy:a,[t.toLowerCase()]:v,[`is${t}Proxy`]:()=>!1}}},Zd=Qd("Window",!0),ep=t=>{let e=0;const r=new Map,i=new Map,a=Symbol(),f=c=>typeof c===nr?c():c,y=c=>typeof c===Lr&&!!c&&a in c,s=Array[zs],o=yh((c,d)=>{if(a in d)return f(d[a]);if(c===nr){if(!i.has(d)){let _;for(;i.has(_=String(e++)););r.set(d,_),i.set(_,d)}return Bt(c,r.get(d))}if(!(d instanceof mh))for(const _ in d)d[_]=o(d[_]);return Bt(c,d)});return(c,d,_)=>{const{[d]:v}=c,E=new Map,C=new FinalizationRegistry(w=>{E.delete(w),v(ns,o(w))}),S=w=>{const[R,l]=w;if(!E.has(l)){const k=R===nr?Jd.bind(w):w,x=new Proxy(k,g),M=new WeakRef(x);E.set(l,M),C.register(x,l,M)}return E.get(l).deref()},h=w=>{const[R,l]=w;switch(R){case Lr:return l===null?globalThis:typeof l===la?S(w):l;case nr:return typeof l===ts?i.get(l):S(w);case fs:return Sh(l)}return l},p=(w,R,...l)=>h(v(w,f(R),...l)),g={[vi]:(w,R,l)=>p(vi,w,o(R),l.map(o)),[rs]:(w,R)=>p(rs,w,R.map(o)),[is]:(w,R,l)=>{const{get:k,set:x,value:M}=l;return typeof k===nr&&(l.get=o(k)),typeof x===nr&&(l.set=o(x)),typeof M===nr&&(l.value=o(M)),p(is,w,o(R),l)},[Do]:(w,R)=>p(Do,w,o(R)),[Po]:w=>p(Po,w),[Lo]:(w,R)=>R===a?w:p(Lo,w,o(R)),[Oo]:(w,R)=>{const l=p(Oo,w,o(R));return l&&vh(l,h)},[Mo]:(w,R)=>R===a||p(Mo,w,o(R)),[Io]:w=>p(Io,w),[Bo]:w=>p(Bo,w).map(h),[No]:w=>p(No,w),[Ho]:(w,R,l)=>p(Ho,w,o(R),o(l)),[$o]:(w,R)=>p($o,w,o(R))};c[_]=(w,R,l,k)=>{switch(w){case vi:return h(R).apply(h(l),k.map(h));case ns:{const x=h(R);r.delete(i.get(x)),i.delete(x)}}};const m=new Proxy([Lr,null],g),T=m.Array[zs];return Ro(Array,zs,{value:w=>y(w)?T(w):s(w)}),{[t.toLowerCase()]:m,[`is${t}Proxy`]:y,proxy:c}}},tp=ep("Window"),Vs=new WeakMap,bh=(t,...e)=>{const r=ca(t,...e);if(!Vs.has(r)){const i=t instanceof Worker?Zd:tp;Vs.set(r,i(r,Ld,Od))}return Vs.get(r)};bh.transfer=ca.transfer;const rp=()=>new Worker(URL.createObjectURL(new Blob(['const e="object"==typeof self?self:globalThis,t=t=>((t,r)=>{const n=(e,r)=>(t.set(r,e),e),s=o=>{if(t.has(o))return t.get(o);const[a,i]=r[o];switch(a){case 0:case-1:return n(i,o);case 1:{const e=n([],o);for(const t of i)e.push(s(t));return e}case 2:{const e=n({},o);for(const[t,r]of i)e[s(t)]=s(r);return e}case 3:return n(new Date(i),o);case 4:{const{source:e,flags:t}=i;return n(new RegExp(e,t),o)}case 5:{const e=n(new Map,o);for(const[t,r]of i)e.set(s(t),s(r));return e}case 6:{const e=n(new Set,o);for(const t of i)e.add(s(t));return e}case 7:{const{name:t,message:r}=i;return n(new e[t](r),o)}case 8:return n(BigInt(i),o);case"BigInt":return n(Object(BigInt(i)),o)}return n(new e[a](i),o)};return s})(new Map,t)(0),r="",{toString:n}={},{keys:s}=Object,o=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const s=n.call(e).slice(8,-1);switch(s){case"Array":return[1,r];case"Object":return[2,r];case"Date":return[3,r];case"RegExp":return[4,r];case"Map":return[5,r];case"Set":return[6,r]}return s.includes("Array")?[1,s]:s.includes("Error")?[7,s]:[2,s]},a=([e,t])=>0===e&&("function"===t||"symbol"===t),i=(e,{json:t,lossy:r}={})=>{const n=[];return((e,t,r,n)=>{const i=(e,t)=>{const s=n.push(e)-1;return r.set(t,s),s},c=n=>{if(r.has(n))return r.get(n);let[l,u]=o(n);switch(l){case 0:{let t=n;switch(u){case"bigint":l=8,t=n.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);t=null;break;case"undefined":return i([-1],n)}return i([l,t],n)}case 1:{if(u)return i([u,[...n]],n);const e=[],t=i([l,e],n);for(const t of n)e.push(c(t));return t}case 2:{if(u)switch(u){case"BigInt":return i([u,n.toString()],n);case"Boolean":case"Number":case"String":return i([u,n.valueOf()],n)}if(t&&"toJSON"in n)return c(n.toJSON());const r=[],f=i([l,r],n);for(const t of s(n))!e&&a(o(n[t]))||r.push([c(t),c(n[t])]);return f}case 3:return i([l,n.toISOString()],n);case 4:{const{source:e,flags:t}=n;return i([l,{source:e,flags:t}],n)}case 5:{const t=[],r=i([l,t],n);for(const[r,s]of n)(e||!a(o(r))&&!a(o(s)))&&t.push([c(r),c(s)]);return r}case 6:{const t=[],r=i([l,t],n);for(const r of n)!e&&a(o(r))||t.push(c(r));return r}}const{message:f}=n;return i([l,{name:u,message:f}],n)};return c})(!(t||r),!!t,new Map,n)(e),n},{parse:c,stringify:l}=JSON,u={json:!0,lossy:!0};var f=Object.freeze({__proto__:null,parse:e=>t(c(e)),stringify:e=>l(i(e,u))});const p="0811fd41-1b6b-49f1-8344-96210ac283f1",d="M"+p,g="T"+p;var y=e=>({value:new Promise((t=>{let r=new Worker("data:application/javascript,onmessage%3D(%7Bdata%3Ab%7D)%3D%3E(Atomics.wait(b%2C0)%2CpostMessage(0))");r.onmessage=t,r.postMessage(e)}))})\n/*! (c) Andrea Giammarchi - ISC */;const{Int32Array:w,Map:h,SharedArrayBuffer:m,Uint16Array:b}=globalThis,{BYTES_PER_ELEMENT:v}=w,{BYTES_PER_ELEMENT:S}=b,{isArray:P}=Array,{notify:A,wait:E,waitAsync:M}=Atomics,{fromCharCode:j}=String,$=(e,t)=>e?(M||y)(t,0):(E(t,0),{value:{then:e=>e()}}),_=new WeakSet,x=new WeakMap;let k=0;const T=(e,{parse:t,stringify:r,transform:n}=JSON)=>{if(!x.has(e)){const s=(t,...r)=>e.postMessage({[p]:r},{transfer:t});x.set(e,new Proxy(new h,{has:(e,t)=>"string"==typeof t&&!t.startsWith("_"),get:(r,o)=>"then"===o?null:(...r)=>{const a=k++;let i=new w(new m(v)),c=[];_.has(r.at(-1)||c)&&_.delete(c=r.pop()),s(c,a,i,o,n?r.map(n):r);const l=e!==globalThis;return $(l,i).value.then((()=>{const e=i[0];if(!e)return;const r=S*e;return i=new w(new m(r+r%v)),s([],a,i),$(l,i).value.then((()=>t(j(...new b(i.buffer).slice(0,e)))))}))},set(t,n,s){if(!t.size){const n=new h;e.addEventListener("message",(async e=>{const s=e.data?.[p];if(P(s)){e.stopImmediatePropagation();const[o,a,...i]=s;if(i.length){const[e,s]=i;if(!t.has(e))throw new Error(`Unsupported action: ${e}`);{const i=await t.get(e)(...s);if(void 0!==i){const e=r(i);n.set(o,e),a[0]=e.length}}}else{const e=n.get(o);n.delete(o);for(let t=new b(a.buffer),r=0;r<e.length;r++)t[r]=e.charCodeAt(r)}A(a,0)}}))}return!!t.set(n,s)}}))}return x.get(e)};T.transfer=(...e)=>(_.add(e),e);const O="object",F="function",W="number",R="string",B="undefined",J="symbol",{defineProperty:L,getOwnPropertyDescriptor:I,getPrototypeOf:H,isExtensible:C,ownKeys:D,preventExtensions:N,set:U,setPrototypeOf:z}=Reflect,{assign:q,create:K}=Object,Y=H(Int8Array),G="isArray",V=(e,t)=>{const{get:r,set:n,value:s}=e;return r&&(e.get=t(r)),n&&(e.set=t(n)),s&&(e.value=t(s)),e},Q=(e,t)=>[e,t],X=e=>t=>{const r=typeof t;switch(r){case O:if(null==t)return Q("null",t);if(t===globalThis)return Q(O,null);case F:return e(r,t);case"boolean":case W:case R:case B:case"bigint":return Q(r,t);case J:if(Z.has(t))return Q(r,Z.get(t))}throw new Error(`Unable to handle this ${r} type`)},Z=new Map(D(Symbol).filter((e=>typeof Symbol[e]===J)).map((e=>[Symbol[e],e]))),ee=e=>{for(const[t,r]of Z)if(r===e)return t};function te(){return this}const re="apply",ne="construct",se="defineProperty",oe="deleteProperty",ae="get",ie="getOwnPropertyDescriptor",ce="getPrototypeOf",le="has",ue="isExtensible",fe="ownKeys",pe="preventExtensions",de="set",ge="setPrototypeOf",ye="delete";var we=((e,t)=>{const r=t&&new WeakMap;if(t){const{addEventListener:e}=EventTarget.prototype;L(EventTarget.prototype,"addEventListener",{value(t,n,...s){return s.at(0)?.invoke&&(r.has(this)||r.set(this,new Map),r.get(this).set(t,[].concat(s[0].invoke)),delete s[0].invoke),e.call(this,t,n,...s)}})}const n=t&&(e=>{const{currentTarget:t,target:n,type:s}=e;for(const o of r.get(t||n)?.get(s)||[])e[o]()});return(r,s,o,...a)=>{let i=0;const c=new Map,l=new Map,{[o]:u}=r,f=a.length?q(K(globalThis),...a):globalThis,p=X(((e,t)=>{if(!c.has(t)){let e;for(;l.has(e=i++););c.set(t,e),l.set(e,t)}return Q(e,c.get(t))})),d=new FinalizationRegistry((e=>{u(ye,Q(R,e))})),g=([e,r])=>{switch(e){case O:if(null==r)return f;if(typeof r===W)return l.get(r);if(!(r instanceof Y))for(const e in r)r[e]=g(r[e]);return r;case F:if(typeof r===R){if(!l.has(r)){const e=function(...e){return t&&e.at(0)instanceof Event&&n(...e),u(re,Q(F,r),p(this),e.map(p))},s=new WeakRef(e);l.set(r,s),d.register(e,r,s)}return l.get(r).deref()}return l.get(r);case J:return ee(r)}return r},y={[re]:(e,t,r)=>p(e.apply(t,r)),[ne]:(e,t)=>p(new e(...t)),[se]:(e,t,r)=>p(L(e,t,r)),[oe]:(e,t)=>p(delete e[t]),[ce]:e=>p(H(e)),[ae]:(e,t)=>p(e[t]),[ie]:(e,t)=>{const r=I(e,t);return r?Q(O,V(r,p)):Q(B,r)},[le]:(e,t)=>p(t in e),[ue]:e=>p(C(e)),[fe]:e=>Q(O,D(e).map(p)),[pe]:e=>p(N(e)),[de]:(e,t,r)=>p(U(e,t,r)),[ge]:(e,t)=>p(z(e,t)),[ye](e){c.delete(l.get(e)),l.delete(e)}};return r[s]=(e,t,...r)=>{switch(e){case re:r[0]=g(r[0]),r[1]=r[1].map(g);break;case ne:r[0]=r[0].map(g);break;case se:{const[e,t]=r;r[0]=g(e);const{get:n,set:s,value:o}=t;n&&(t.get=g(n)),s&&(t.set=g(s)),o&&(t.value=g(o));break}default:r=r.map(g)}return y[e](g(t),...r)},{proxy:r,[e.toLowerCase()]:f,[`is${e}Proxy`]:()=>!1}}})("Window",!0),he=(e=>{let t=0;const r=new Map,n=new Map,s=Symbol(),o=e=>typeof e===F?e():e,a=e=>typeof e===O&&!!e&&s in e,i=Array[G],c=X(((e,a)=>{if(s in a)return o(a[s]);if(e===F){if(!n.has(a)){let e;for(;n.has(e=String(t++)););r.set(a,e),n.set(e,a)}return Q(e,r.get(a))}if(!(a instanceof Y))for(const e in a)a[e]=c(a[e]);return Q(e,a)}));return(t,l,u)=>{const{[l]:f}=t,p=new Map,d=new FinalizationRegistry((e=>{p.delete(e),f(ye,c(e))})),g=e=>{const[t,r]=e;if(!p.has(r)){const n=t===F?te.bind(e):e,s=new Proxy(n,h),o=new WeakRef(s);p.set(r,o),d.register(s,r,o)}return p.get(r).deref()},y=e=>{const[t,r]=e;switch(t){case O:return null===r?globalThis:typeof r===W?g(e):r;case F:return typeof r===R?n.get(r):g(e);case J:return ee(r)}return r},w=(e,t,...r)=>y(f(e,o(t),...r)),h={[re]:(e,t,r)=>w(re,e,c(t),r.map(c)),[ne]:(e,t)=>w(ne,e,t.map(c)),[se]:(e,t,r)=>{const{get:n,set:s,value:o}=r;return typeof n===F&&(r.get=c(n)),typeof s===F&&(r.set=c(s)),typeof o===F&&(r.value=c(o)),w(se,e,c(t),r)},[oe]:(e,t)=>w(oe,e,c(t)),[ce]:e=>w(ce,e),[ae]:(e,t)=>t===s?e:w(ae,e,c(t)),[ie]:(e,t)=>{const r=w(ie,e,c(t));return r&&V(r,y)},[le]:(e,t)=>t===s||w(le,e,c(t)),[ue]:e=>w(ue,e),[fe]:e=>w(fe,e).map(y),[pe]:e=>w(pe,e),[de]:(e,t,r)=>w(de,e,c(t),c(r)),[ge]:(e,t)=>w(ge,e,c(t))};t[u]=(e,t,s,o)=>{switch(e){case re:return y(t).apply(y(s),o.map(y));case ye:{const e=y(t);r.delete(n.get(e)),n.delete(e)}}};const m=new Proxy([O,null],h),b=m.Array[G];return L(Array,G,{value:e=>a(e)?b(e):i(e)}),{[e.toLowerCase()]:m,[`is${e}Proxy`]:a,proxy:t}}})("Window");const me=new WeakMap,be=(e,...t)=>{const r=T(e,...t);if(!me.has(r)){const t=e instanceof Worker?we:he;me.set(r,t(r,d,g))}return me.get(r)};be.transfer=T.transfer;const{isArray:ve}=Array,{assign:Se,create:Pe,defineProperties:Ae,defineProperty:Ee,entries:Me}=Object,{all:je,resolve:$e}=new Proxy(Promise,{get:(e,t)=>e[t].bind(e)}),_e=(e,t=location.href)=>new URL(e,t).href;Promise.withResolvers||(Promise.withResolvers=function(){var e,t,r=new this((function(r,n){e=r,t=n}));return{resolve:e,reject:t,promise:r}});const xe=e=>e.arrayBuffer(),ke=e=>e.json(),Te=e=>e.text(),Oe=e=>e.replace(/^[^\\r\\n]+$/,(e=>e.trim())),Fe=new WeakMap,We=e=>{const t=e||console,r={stderr:(t.stderr||console.error).bind(t),stdout:(t.stdout||console.log).bind(t)};return{stderr:(...e)=>r.stderr(...e),stdout:(...e)=>r.stdout(...e),async get(e){const t=await e;return Fe.set(t,r),t}}},Re=({FS:e,PATH:t,PATH_FS:r},n,s)=>{const o=r.resolve(n);return e.mkdirTree(t.dirname(o)),e.writeFile(o,new Uint8Array(s),{canOwn:!0})},Be=e=>{const t=e.split("/");return t.pop(),t.join("/")},Je=(e,t)=>{const r=[];for(const n of t.split("/"))"."!==n&&(r.push(n),n&&e.mkdir(r.join("/")))},Le=(e,t)=>{const r=[];for(const e of t.split("/"))switch(e){case"":case".":break;case"..":r.pop();break;default:r.push(e)}return[e.cwd()].concat(r).join("/").replace(/^\\/+/,"/")},Ie=e=>{const t=e.map((e=>e.trim().replace(/(^[/]*|[/]*$)/g,""))).filter((e=>""!==e&&"."!==e)).join("/");return e[0].startsWith("/")?`/${t}`:t},He=new WeakMap,Ce=(e,t,r)=>je((e=>{for(const{files:t,to_file:r,from:n=""}of e){if(void 0!==t&&void 0!==r)throw new Error("Cannot use \'to_file\' and \'files\' parameters together!");if(void 0===t&&void 0===r&&n.endsWith("/"))throw new Error(`Couldn\'t determine the filename from the path ${n}, please supply \'to_file\' parameter.`)}return e.flatMap((({from:e="",to_folder:t=".",to_file:r,files:n})=>{if(ve(n))return n.map((r=>({url:Ie([e,r]),path:Ie([t,r])})));const s=r||e.slice(1+e.lastIndexOf("/"));return[{url:e,path:Ie([t,s])}]}))})(r).map((({url:n,path:s})=>((e,t)=>fetch(_e(t,He.get(e))))(r,n).then(xe).then((r=>e.writeFile(t,s,r)))))),De=(e,t,r)=>{e.registerJsModule(t,r)},Ne=(e,t)=>e.runPython(Oe(t)),Ue=(e,t)=>e.runPythonAsync(Oe(t)),ze=async(e,t,r)=>{const[n,...s]=t.split(".");let o,a=e.globals.get(n);for(const e of s)[o,a]=[a,a[e]];await a.call(o,r)};var qe={type:"micropython",module:(e="1.20.0-297")=>`https://cdn.jsdelivr.net/npm/@micropython/micropython-webassembly-pyscript@${e}/micropython.mjs`,async engine({loadMicroPython:e},t,r){const{stderr:n,stdout:s,get:o}=We();r=r.replace(/\\.m?js$/,".wasm");const a=await o(e({stderr:n,stdout:s,url:r}));return t.fetch&&await Ce(this,a,t.fetch),a},registerJSModule:De,run:Ne,runAsync:Ue,runEvent:ze,transform:(e,t)=>t,writeFile:({FS:e,_module:{PATH:t,PATH_FS:r}},n,s)=>Re({FS:e,PATH:t,PATH_FS:r},n,s)};const Ke={dict_converter:Object.fromEntries};var Ye={type:"pyodide",module:(e="0.23.4")=>`https://cdn.jsdelivr.net/pyodide/v${e}/full/pyodide.mjs`,async engine({loadPyodide:e},t,r){const{stderr:n,stdout:s,get:o}=We(),a=r.slice(0,r.lastIndexOf("/")),i=await o(e({stderr:n,stdout:s,indexURL:a}));if(t.fetch&&await Ce(this,i,t.fetch),t.packages){await i.loadPackage("micropip");const e=await i.pyimport("micropip");await e.install(t.packages),e.destroy()}return i},registerJSModule:De,run:Ne,runAsync:Ue,runEvent:ze,transform:(e,t)=>t instanceof e.ffi.PyProxy?t.toJs(Ke):t,writeFile:({FS:e,PATH:t,_module:{PATH_FS:r}},n,s)=>Re({FS:e,PATH:t,PATH_FS:r},n,s)};const Ge="ruby-wasm-wasi",Ve=Ge.replace(/\\W+/g,"_");var Qe={type:Ge,experimental:!0,module:(e="2.0.0")=>`https://cdn.jsdelivr.net/npm/ruby-3_2-wasm-wasi@${e}/dist/browser.esm.js`,async engine({DefaultRubyVM:e},t,r){const n=await fetch(`${r.slice(0,r.lastIndexOf("/"))}/ruby.wasm`),s=await WebAssembly.compile(await n.arrayBuffer()),{vm:o}=await e(s);return t.fetch&&await Ce(this,o,t.fetch),o},registerJSModule(e,t,r){const n=[\'require "js"\'];for(const[e,t]of Me(r)){const r=`__module_${Ve}_${e}`;globalThis[r]=t,n.push(`$${e}=JS.global[:${r}]`)}this.run(e,n.join(";"))},run:(e,t)=>e.eval(Oe(t)),runAsync:(e,t)=>e.evalAsync(Oe(t)),async runEvent(e,t,r){if(/^xworker\\.(on\\w+)$/.test(t)){const{$1:t}=RegExp,n=`__module_${Ve}_event`;globalThis[n]=r,this.run(e,`require "js";$xworker.call("${t}",JS.global[:${n}])`),delete globalThis[n]}else{const n=this.run(e,`method(:${t})`);await n.call(t,e.wrap(r))}},transform:(e,t)=>t,writeFile:()=>{throw new Error(`writeFile is not supported in ${Ge}`)}};var Xe={type:"wasmoon",module:(e="1.15.0")=>`https://cdn.jsdelivr.net/npm/wasmoon@${e}/+esm`,async engine({LuaFactory:e,LuaLibraries:t},r){const{stderr:n,stdout:s,get:o}=We(),a=await o((new e).createEngine());return a.global.getTable(t.Base,(e=>{a.global.setField(e,"print",s),a.global.setField(e,"printErr",n)})),r.fetch&&await Ce(this,a,r.fetch),a},registerJSModule:(e,t,r)=>{for(const[t,n]of Me(r))e.global.set(t,n)},run:(e,t)=>e.doStringSync(Oe(t)),runAsync:(e,t)=>e.doString(Oe(t)),runEvent:async(e,t,r)=>{const[n,...s]=t.split(".");let o,a=e.global.get(n);for(const e of s)[o,a]=[a,a[e]];await a.call(o,r)},transform:(e,t)=>t,writeFile:({cmodule:{module:{FS:e}}},t,r)=>((e,t,r)=>(Je(e,Be(t)),t=Le(e,t),e.writeFile(t,new Uint8Array(r),{canOwn:!0})))(e,t,r)};const Ze=new Map,et=new Map,tt=new Proxy(new Map,{get(e,t){if(!e.has(t)){const[r,...n]=t.split("@"),s=Ze.get(r),o=/^https?:\\/\\//i.test(n)?n.join("@"):s.module(...n);e.set(t,{url:o,module:import(o),engine:s.engine.bind(s)})}const{url:r,module:n,engine:s}=e.get(t);return(e,o)=>n.then((n=>{et.set(t,e);const a=e?.fetch;return a&&He.set(a,o),s(n,e,r)}))}}),rt=e=>{for(const t of[].concat(e.type))Ze.set(t,e)};for(const e of[qe,Ye,Qe,Xe])rt(e);const nt=async e=>(await import("https://cdn.jsdelivr.net/npm/basic-toml@0.3.1/es.js")).parse(e);try{new SharedArrayBuffer(4)}catch(e){throw new Error(["Unable to use SharedArrayBuffer due insecure environment.","Please read requirements in MDN: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer#security_requirements"].join("\\n"))}let st,ot,at;const it=(e,t)=>{addEventListener(e,t||(async t=>{try{await st,ot(`xworker.on${e}`,t)}catch(e){postMessage(e)}}),!!t&&{once:!0})},{parse:ct,stringify:lt}=f,{proxy:ut,window:ft,isWindowProxy:pt}=be(self,{parse:ct,stringify:lt,transform:e=>at?at(e):e}),dt={sync:ut,window:ft,isWindowProxy:pt,onmessage:console.info,onerror:console.error,onmessageerror:console.warn,postMessage:postMessage.bind(self)};it("message",(({data:{options:e,config:t,code:r,hooks:n}})=>{st=(async()=>{try{const{type:s,version:o,config:a,async:i}=e,c=await((e,t,r={})=>{if(t)if(t.endsWith(".json"))r=fetch(t).then(ke),t=_e(t);else if(t.endsWith(".toml"))r=fetch(t).then(Te).then(nt),t=_e(t);else if(!t.endsWith(".txt")){try{r=JSON.parse(t)}catch(e){r=nt(t)}t=_e("./config.txt")}return $e(r).then((r=>tt[e](r,t)))})(((e,t="")=>`${e}@${t}`.replace(/@$/,""))(s,o),t,a),l=Pe(Ze.get(s)),u="run"+(i?"Async":"");if(n){const{beforeRun:e,beforeRunAsync:t,afterRun:r,afterRunAsync:s}=n,o=r||s,a=e||t;if(o){const e=l[u].bind(l);l[u]=(t,r)=>e(t,`${r}\\n${o}`)}if(a){const e=l[u].bind(l);l[u]=(t,r)=>e(t,`${a}\\n${r}`)}}return l.registerJSModule(c,"polyscript",{xworker:dt}),ot=l.runEvent.bind(l,c),at=l.transform.bind(l,c),await l[u](c,r),c}catch(e){postMessage(e)}})(),it("error"),it("message"),it("messageerror")}));\n'],{type:"application/javascript"})),{type:"module"}),{isArray:ip}=Array,{assign:Ch,create:Eh,defineProperties:np,defineProperty:Th,entries:wh}=Object,{all:ha,resolve:kh}=new Proxy(Promise,{get:(t,e)=>t[e].bind(t)}),en=(t,e=location.href)=>new URL(t,e).href,sp=t=>t.arrayBuffer(),op=t=>t.json(),ua=t=>t.text(),wc=[["beforeRun","codeBeforeRunWorker"],["beforeRunAsync","codeBeforeRunWorkerAsync"],["afterRun","codeAfterRunWorker"],["afterRunAsync","codeAfterRunWorkerAsync"]];class Ah{constructor(e,r){var i;this.interpreter=e,this.onWorkerReady=r.onWorkerReady;for(const[a,f]of wc)this[a]=(i=r[f])==null?void 0:i.call(r)}get stringHooks(){const e={};for(const[r]of wc)this[r]&&(e[r]=this[r]);return e}}const Rh=(...t)=>function(r,i){var c;const a=rp(),{postMessage:f}=a,y=this instanceof Ah;if(t.length){const[d,_]=t;i=Ch({},i||{type:d,version:_}),i.type||(i.type=d)}const s=en(typeof i.config=="string"?i.config:"./config.txt"),o=fetch(r).then(ua).then(d=>{const _=y?this.stringHooks:void 0;f.call(a,{options:i,config:s,code:d,hooks:_})});return np(a,{postMessage:{value:(d,..._)=>o.then(()=>f.call(a,d,..._))},sync:{value:bh(a,Dd).proxy},onerror:{writable:!0,configurable:!0,value:console.error}}),y&&((c=this.onWorkerReady)==null||c.call(this,this.interpreter,a)),a.addEventListener("message",d=>{const{data:_}=d;_ instanceof Error&&(d.stopImmediatePropagation(),a.onerror(Object.create(d,{type:{value:"error"},error:{value:_}})))}),a},ap="modulepreload",cp=function(t){return"/mpyc/"+t},kc={},xh=function(e,r,i){if(!r||r.length===0)return e();const a=document.getElementsByTagName("link");return Promise.all(r.map(f=>{if(f=cp(f),f in kc)return;kc[f]=!0;const y=f.endsWith(".css"),s=y?'[rel="stylesheet"]':"";if(!!i)for(let d=a.length-1;d>=0;d--){const _=a[d];if(_.href===f&&(!y||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${f}"]${s}`))return;const c=document.createElement("link");if(c.rel=y?"stylesheet":ap,y||(c.as="script",c.crossOrigin=""),c.href=f,document.head.appendChild(c),y)return new Promise((d,_)=>{c.addEventListener("load",d),c.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${f}`)))})})).then(()=>e()).catch(f=>{const y=new Event("vite:preloadError",{cancelable:!0});if(y.payload=f,window.dispatchEvent(y),!y.defaultPrevented)throw f})};Promise.withResolvers||(Promise.withResolvers=function(){var e,r,i=new this(function(a,f){e=a,r=f});return{resolve:e,reject:r,promise:i}});const yi=t=>t.replace(/^[^\r\n]+$/,e=>e.trim()),Dh=new WeakMap,fa=t=>{const e=t||console,r={stderr:(e.stderr||console.error).bind(e),stdout:(e.stdout||console.log).bind(e)};return{stderr:(...i)=>r.stderr(...i),stdout:(...i)=>r.stdout(...i),async get(i){const a=await i;return Dh.set(a,r),a}}},Lh=({FS:t,PATH:e,PATH_FS:r},i,a)=>{const f=r.resolve(i);return t.mkdirTree(e.dirname(f)),t.writeFile(f,new Uint8Array(a),{canOwn:!0})},lp=(t,e,r)=>(up(t,hp(e)),e=fp(t,e),t.writeFile(e,new Uint8Array(r),{canOwn:!0})),hp=t=>{const e=t.split("/");return e.pop(),e.join("/")},up=(t,e)=>{const r=[];for(const i of e.split("/"))i!=="."&&(r.push(i),i&&t.mkdir(r.join("/")))},fp=(t,e)=>{const r=[];for(const i of e.split("/"))switch(i){case"":break;case".":break;case"..":r.pop();break;default:r.push(i)}return[t.cwd()].concat(r).join("/").replace(/^\/+/,"/")},dp=t=>{for(const{files:e,to_file:r,from:i=""}of t){if(e!==void 0&&r!==void 0)throw new Error("Cannot use 'to_file' and 'files' parameters together!");if(e===void 0&&r===void 0&&i.endsWith("/"))throw new Error(`Couldn't determine the filename from the path ${i}, please supply 'to_file' parameter.`)}return t.flatMap(({from:e="",to_folder:r=".",to_file:i,files:a})=>{if(ip(a))return a.map(y=>({url:qs([e,y]),path:qs([r,y])}));const f=i||e.slice(1+e.lastIndexOf("/"));return[{url:e,path:qs([r,f])}]})},qs=t=>{const e=t.map(r=>r.trim().replace(/(^[/]*|[/]*$)/g,"")).filter(r=>r!==""&&r!==".").join("/");return t[0].startsWith("/")?`/${e}`:e},pp=(t,e)=>fetch(en(e,Oh.get(t))),Oh=new WeakMap,ds=(t,e,r)=>ha(dp(r).map(({url:i,path:a})=>pp(r,i).then(sp).then(f=>t.writeFile(e,a,f)))),Ph=(t,e,r)=>{t.registerJsModule(e,r)},Mh=(t,e)=>t.runPython(yi(e)),Ih=(t,e)=>t.runPythonAsync(yi(e)),Bh=async(t,e,r)=>{const[i,...a]=e.split(".");let f=t.globals.get(i),y;for(const s of a)[y,f]=[f,f[s]];await f.call(y,r)},_p="micropython",gp={type:_p,module:(t="1.20.0-297")=>`https://cdn.jsdelivr.net/npm/@micropython/micropython-webassembly-pyscript@${t}/micropython.mjs`,async engine({loadMicroPython:t},e,r){const{stderr:i,stdout:a,get:f}=fa();r=r.replace(/\.m?js$/,".wasm");const y=await f(t({stderr:i,stdout:a,url:r}));return e.fetch&&await ds(this,y,e.fetch),y},registerJSModule:Ph,run:Mh,runAsync:Ih,runEvent:Bh,transform:(t,e)=>e,writeFile:({FS:t,_module:{PATH:e,PATH_FS:r}},i,a)=>Lh({FS:t,PATH:e,PATH_FS:r},i,a)},mp="pyodide",vp={dict_converter:Object.fromEntries},yp={type:mp,module:(t="0.23.4")=>`https://cdn.jsdelivr.net/pyodide/v${t}/full/pyodide.mjs`,async engine({loadPyodide:t},e,r){const{stderr:i,stdout:a,get:f}=fa(),y=r.slice(0,r.lastIndexOf("/")),s=await f(t({stderr:i,stdout:a,indexURL:y}));if(e.fetch&&await ds(this,s,e.fetch),e.packages){await s.loadPackage("micropip");const o=await s.pyimport("micropip");await o.install(e.packages),o.destroy()}return s},registerJSModule:Ph,run:Mh,runAsync:Ih,runEvent:Bh,transform:(t,e)=>e instanceof t.ffi.PyProxy?e.toJs(vp):e,writeFile:({FS:t,PATH:e,_module:{PATH_FS:r}},i,a)=>Lh({FS:t,PATH:e,PATH_FS:r},i,a)},Fo="ruby-wasm-wasi",Ac=Fo.replace(/\W+/g,"_"),Sp={type:Fo,experimental:!0,module:(t="2.0.0")=>`https://cdn.jsdelivr.net/npm/ruby-3_2-wasm-wasi@${t}/dist/browser.esm.js`,async engine({DefaultRubyVM:t},e,r){const i=await fetch(`${r.slice(0,r.lastIndexOf("/"))}/ruby.wasm`),a=await WebAssembly.compile(await i.arrayBuffer()),{vm:f}=await t(a);return e.fetch&&await ds(this,f,e.fetch),f},registerJSModule(t,e,r){const i=['require "js"'];for(const[a,f]of wh(r)){const y=`__module_${Ac}_${a}`;globalThis[y]=f,i.push(`$${a}=JS.global[:${y}]`)}this.run(t,i.join(";"))},run:(t,e)=>t.eval(yi(e)),runAsync:(t,e)=>t.evalAsync(yi(e)),async runEvent(t,e,r){if(/^xworker\.(on\w+)$/.test(e)){const{$1:i}=RegExp,a=`__module_${Ac}_event`;globalThis[a]=r,this.run(t,`require "js";$xworker.call("${i}",JS.global[:${a}])`),delete globalThis[a]}else await this.run(t,`method(:${e})`).call(e,t.wrap(r))},transform:(t,e)=>e,writeFile:()=>{throw new Error(`writeFile is not supported in ${Fo}`)}},bp="wasmoon",Cp={type:bp,module:(t="1.15.0")=>`https://cdn.jsdelivr.net/npm/wasmoon@${t}/+esm`,async engine({LuaFactory:t,LuaLibraries:e},r){const{stderr:i,stdout:a,get:f}=fa(),y=await f(new t().createEngine());return y.global.getTable(e.Base,s=>{y.global.setField(s,"print",a),y.global.setField(s,"printErr",i)}),r.fetch&&await ds(this,y,r.fetch),y},registerJSModule:(t,e,r)=>{for(const[i,a]of wh(r))t.global.set(i,a)},run:(t,e)=>t.doStringSync(yi(e)),runAsync:(t,e)=>t.doString(yi(e)),runEvent:async(t,e,r)=>{const[i,...a]=e.split(".");let f=t.global.get(i),y;for(const s of a)[y,f]=[f,f[s]];await f.call(y,r)},transform:(t,e)=>e,writeFile:({cmodule:{module:{FS:t}}},e,r)=>lp(t,e,r)},ln=new Map,Nh=new Map,Hh=[],ps=[],Ep=new Proxy(new Map,{get(t,e){if(!t.has(e)){const[f,...y]=e.split("@"),s=ln.get(f),o=/^https?:\/\//i.test(y)?y.join("@"):s.module(...y);t.set(e,{url:o,module:xh(()=>import(o),[]),engine:s.engine.bind(s)})}const{url:r,module:i,engine:a}=t.get(e);return(f,y)=>i.then(s=>{Nh.set(e,f);const o=f==null?void 0:f.fetch;return o&&Oh.set(o,y),a(s,f,r)})}}),Tp=t=>{for(const e of[].concat(t.type))ln.set(e,t),Hh.push(`script[type="${e}"]`),ps.push(`${e}-`)};for(const t of[gp,yp,Sp,Cp])Tp(t);const wp="https://cdn.jsdelivr.net/npm/basic-toml@0.3.1/es.js",Rc=async t=>(await xh(()=>import(wp),[])).parse(t),kp=(t,e,r={})=>{if(e){if(e.endsWith(".json"))r=fetch(e).then(op),e=en(e);else if(e.endsWith(".toml"))r=fetch(e).then(ua).then(Rc),e=en(e);else if(!e.endsWith(".txt")){try{r=JSON.parse(e)}catch{r=Rc(e)}e=en("./config.txt")}}return kh(r).then(i=>Ep[t](i,e))},$h=(t,e="")=>`${t}@${e}`.replace(/@$/,""),Ap=t=>{let e=t;for(;e.parentNode;)e=e.parentNode;return e},Fh=(t,e)=>{const r=Ap(t);return r.getElementById(e)||vd(e,r)},Qi=new WeakMap,Rp={get(){let t=Qi.get(this);return t||(t=document.createElement(`${this.type}-script`),Qi.set(this,t),sn(this)),t},set(t){typeof t=="string"?Qi.set(this,Fh(this,t)):(Qi.set(this,t),sn(this))}},jo=new WeakMap,pr=new Map,xp=async(t,e,r,i)=>{const a=ln.get(t.type);a.experimental&&console.warn(`The ${t.type} interpreter is experimental`);const[f,y]=await ha([jo.get(t).interpreter,e]);try{return Th(document,"currentScript",{configurable:!0,get:()=>t}),a.registerJSModule(f,"polyscript",{XWorker:r}),a[i?"runAsync":"run"](f,y)}finally{delete document.currentScript}},Ks=(t,e)=>{const r=t==null?void 0:t.value;return r?e+r:""},jh=(t,e,r,i,a)=>{if(!pr.has(e)){const f={interpreter:kp(r,a),queue:kh(),XWorker:Rh(t,i)};pr.set(e,f),pr.has(t)||pr.set(t,f)}return pr.get(e)},sn=async t=>{if(jo.has(t)){const{target:e}=t;e&&(t.closest("head")?document.body.append(e):t.after(e))}else{const{attributes:{async:e,config:r,env:i,target:a,version:f},src:y,type:s}=t,o=f==null?void 0:f.value,c=$h(s,o),d=Ks(a,"");let _=Ks(r,"|");const v=Ks(i,"")||`${c}${_}`;_=_.slice(1);const E=jh(s,v,c,o,_);jo.set(Th(t,"target",Rp),E),d&&Qi.set(t,Fh(t,d));const C=y?fetch(y).then(ua):t.textContent;E.queue=E.queue.then(()=>xp(t,C,E.XWorker,!!e))}};new Proxy(Eh(null),{get:(t,e)=>Uh(e)});const Uh=async t=>{if(pr.has(t)){const{interpreter:r,queue:i}=pr.get(t);return(await ha([r,i]))[0]}const e=pr.size?`Available interpreters are: ${[...pr.keys()].map(r=>`"${r}"`).join(", ")}.`:"There are no interpreters in this page.";throw new Error(`The interpreter "${t}" was not found. ${e}`)},Wh=async t=>{const{type:e,currentTarget:r}=t;for(let{name:i,value:a,ownerElement:f}of hh(`./@*[${ps.map(y=>`name()="${y}${e}"`).join(" or ")}]`,r)){i=i.slice(0,-(e.length+1));const y=await Uh(f.getAttribute(`${i}-env`)||i);ln.get(i).runEvent(y,a,t)}},zh=t=>{for(let{name:e,ownerElement:r}of hh(`.//@*[${ps.map(i=>`starts-with(name(),"${i}")`).join(" or ")}]`,t))e=e.slice(e.lastIndexOf("-")+1),e!=="env"&&r.addEventListener(e,Wh)},Uo=[],Dp=new Map,Lp=new Map,xc=t=>{for(const e of Uo)if(t.matches(e)){const r=Dp.get(e),{resolve:i}=Lp.get(r),{options:a,known:f}=Op.get(r);if(!f.has(t)){f.add(t);const{interpreter:y,version:s,config:o,env:c,onInterpreterReady:d}=a,_=$h(y,s),v=c||`${_}${o?`|${o}`:""}`,{interpreter:E,XWorker:C}=jh(y,v,_,s,o);E.then(S=>{const h=Eh(ln.get(y)),{onBeforeRun:p,onBeforeRunAsync:g,onAfterRun:m,onAfterRunAsync:T}=a,w=new Ah(S,a),R=function(...x){return C.apply(w,x)};for(const[k,[x,M]]of[["run",[p,m]]]){const $=h[k];h[k]=function(B,N){x&&x.call(this,l,t);const ee=$.call(this,B,N);return M&&M.call(this,l,t),ee}}for(const[k,[x,M]]of[["runAsync",[g,T]]]){const $=h[k];h[k]=async function(B,N){x&&await x.call(this,l,t);const ee=await $.call(this,B,N);return M&&await M.call(this,l,t),ee}}h.registerJSModule(S,"polyscript",{XWorker:R});const l={type:r,interpreter:S,XWorker:R,io:Dh.get(S),config:structuredClone(Nh.get(_)),run:h.run.bind(h,S),runAsync:h.runAsync.bind(h,S),runEvent:h.runEvent.bind(h,S)};i(l),d==null||d(l,t)})}}},Op=new Map,Pp=Rh(),Wo=Hh.join(","),Mp=new MutationObserver(t=>{for(const{type:e,target:r,attributeName:i,addedNodes:a}of t){if(e==="attributes"){const f=i.lastIndexOf("-")+1;if(f){const y=i.slice(0,f);for(const s of ps)if(y===s){const o=i.slice(f);if(o!=="env"){const c=r.hasAttribute(i)?"add":"remove";r[`${c}EventListener`](o,Wh)}break}}continue}for(const f of a)if(f.nodeType===1)if(zh(f),f.matches(Wo))sn(f);else{if(To(Wo,f).forEach(sn),!Uo.length)continue;xc(f),To(Uo.join(","),f).forEach(xc)}}}),Vh=t=>(Mp.observe(t,{childList:!0,subtree:!0,attributes:!0}),t),{attachShadow:Ip}=Element.prototype;Ch(Element.prototype,{attachShadow(t){return Vh(Ip.call(this,t))}});zh(Vh(document));To(Wo,document).forEach(sn);class Bp{constructor(e,r){ir(this,"peer");ir(this,"conns",new Map);ir(this,"worker");ir(this,"onPeerConnectedHook",()=>{});ir(this,"onPeerDisconnectedHook",()=>{});ir(this,"onPeerJSUserDataReceivedHook",()=>{});ir(this,"onPeerIDReadyHook",()=>{});ir(this,"onPyScriptDisplayHook",()=>{});ir(this,"onRuntimeReadyHook",()=>{});this.peer=this.newPeerJS(e),this.worker=this.newWorker(this.conns,r)}getPeers(e=!1){let r=Array.from(this.conns,([i,a])=>a.peer);return e&&r.push(this.peer.id),r.sort()}broadcastMessage(e){this.conns.forEach(r=>{r.send(e)})}connectToPeer(e){let r=this.peer.connect(e,{reliable:!0});r.on("open",()=>{this.sendKnownPeers(r),this.conns.set(r.peer,r),this.onPeerConnectedHook(r.peer,this)}),this.ready(r)}runMPyCDemo(e=!1){let r=this.getPeers(!0),i=r.findIndex(a=>a===this.peer.id);console.log("peers:",r),console.log("my id:",this.peer.id),console.log("my pid:",i),this.postWorkerMessage({init:{pid:i,parties:r,is_async:e,no_async:!e}})}close(){this.peer.destroy(),this.worker.terminate()}newPeerJS(e){var r;return e?r=new Jn(e):r=new Jn,this.addPeerEvents(r),r}newWorker(e,r){let i=Pp("./py/worker.py",{async:!0,type:"pyodide",config:r});return i.sync.myFunc=function(a){console.log("myFunc",a)},i.onmessage=a=>{var y;console.log("(mpyc.js:worker:onmessage): --------------- data",a.data);let f=JSON.parse(a.data);f.display&&this.onPyScriptDisplayHook(f.display,this),f.peerJS&&(console.log("++++++++++++++ peerJS data"),(y=e.get(f.peerJS.peerID))==null||y.send({mpycMessage:f.peerJS.message}))},i}addPeerEvents(e){e.on("open",r=>{this.onPeerIDReadyHook(r,this)}),e.on("connection",r=>{r.on("open",()=>{this.sendKnownPeers(r)}),this.conns.set(r.peer,r),this.onPeerConnectedHook(r.peer,this),this.ready(r)})}sendKnownPeers(e){e.send({knownPeers:this.getPeers()})}ready(e){e.on("data",r=>{console.log("Data received"),console.log(r),this.processNewPeers(r==null?void 0:r.knownPeers),this.processMPyCMessage(e.peer,r==null?void 0:r.mpycMessage),this.onPeerJSUserDataReceivedHook(e.peer,r,this)}),e.on("close",()=>{this.conns.delete(e.peer),this.onPeerDisconnectedHook(e.peer,this)})}processNewPeers(e){e&&e.forEach(r=>{!this.conns.get(r)&&r!=this.peer.id&&this.connectToPeer(r)})}processMPyCMessage(e,r){r&&this.postWorkerMessage({peerJS:{peerID:e,message:r}})}postWorkerMessage(e){this.worker.postMessage(this.workMessage(e))}workMessage(e){return e={init:null,peerJS:null,...e},e.peerJS&&(e.peerJS.message={runtime_message:null,ready_message:null,...e.peerJS.message}),e}}var dt="top",kt="bottom",At="right",pt="left",_s="auto",Ri=[dt,kt,At,pt],Xr="start",Si="end",qh="clippingParents",da="viewport",pi="popper",Kh="reference",zo=Ri.reduce(function(t,e){return t.concat([e+"-"+Xr,e+"-"+Si])},[]),pa=[].concat(Ri,[_s]).reduce(function(t,e){return t.concat([e,e+"-"+Xr,e+"-"+Si])},[]),Gh="beforeRead",Yh="read",Xh="afterRead",Jh="beforeMain",Qh="main",Zh="afterMain",eu="beforeWrite",tu="write",ru="afterWrite",iu=[Gh,Yh,Xh,Jh,Qh,Zh,eu,tu,ru];function ar(t){return t?(t.nodeName||"").toLowerCase():null}function Rt(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Jr(t){var e=Rt(t).Element;return t instanceof e||t instanceof Element}function Nt(t){var e=Rt(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function _a(t){if(typeof ShadowRoot>"u")return!1;var e=Rt(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function Np(t){var e=t.state;Object.keys(e.elements).forEach(function(r){var i=e.styles[r]||{},a=e.attributes[r]||{},f=e.elements[r];!Nt(f)||!ar(f)||(Object.assign(f.style,i),Object.keys(a).forEach(function(y){var s=a[y];s===!1?f.removeAttribute(y):f.setAttribute(y,s===!0?"":s)}))})}function Hp(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(i){var a=e.elements[i],f=e.attributes[i]||{},y=Object.keys(e.styles.hasOwnProperty(i)?e.styles[i]:r[i]),s=y.reduce(function(o,c){return o[c]="",o},{});!Nt(a)||!ar(a)||(Object.assign(a.style,s),Object.keys(f).forEach(function(o){a.removeAttribute(o)}))})}}const ga={name:"applyStyles",enabled:!0,phase:"write",fn:Np,effect:Hp,requires:["computeStyles"]};function sr(t){return t.split("-")[0]}var Gr=Math.max,ss=Math.min,bi=Math.round;function Vo(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function nu(){return!/^((?!chrome|android).)*safari/i.test(Vo())}function Ci(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var i=t.getBoundingClientRect(),a=1,f=1;e&&Nt(t)&&(a=t.offsetWidth>0&&bi(i.width)/t.offsetWidth||1,f=t.offsetHeight>0&&bi(i.height)/t.offsetHeight||1);var y=Jr(t)?Rt(t):window,s=y.visualViewport,o=!nu()&&r,c=(i.left+(o&&s?s.offsetLeft:0))/a,d=(i.top+(o&&s?s.offsetTop:0))/f,_=i.width/a,v=i.height/f;return{width:_,height:v,top:d,right:c+_,bottom:d+v,left:c,x:c,y:d}}function ma(t){var e=Ci(t),r=t.offsetWidth,i=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-i)<=1&&(i=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:i}}function su(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&_a(r)){var i=e;do{if(i&&t.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function vr(t){return Rt(t).getComputedStyle(t)}function $p(t){return["table","td","th"].indexOf(ar(t))>=0}function Ir(t){return((Jr(t)?t.ownerDocument:t.document)||window.document).documentElement}function gs(t){return ar(t)==="html"?t:t.assignedSlot||t.parentNode||(_a(t)?t.host:null)||Ir(t)}function Dc(t){return!Nt(t)||vr(t).position==="fixed"?null:t.offsetParent}function Fp(t){var e=/firefox/i.test(Vo()),r=/Trident/i.test(Vo());if(r&&Nt(t)){var i=vr(t);if(i.position==="fixed")return null}var a=gs(t);for(_a(a)&&(a=a.host);Nt(a)&&["html","body"].indexOf(ar(a))<0;){var f=vr(a);if(f.transform!=="none"||f.perspective!=="none"||f.contain==="paint"||["transform","perspective"].indexOf(f.willChange)!==-1||e&&f.willChange==="filter"||e&&f.filter&&f.filter!=="none")return a;a=a.parentNode}return null}function hn(t){for(var e=Rt(t),r=Dc(t);r&&$p(r)&&vr(r).position==="static";)r=Dc(r);return r&&(ar(r)==="html"||ar(r)==="body"&&vr(r).position==="static")?e:r||Fp(t)||e}function va(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function tn(t,e,r){return Gr(t,ss(e,r))}function jp(t,e,r){var i=tn(t,e,r);return i>r?r:i}function ou(){return{top:0,right:0,bottom:0,left:0}}function au(t){return Object.assign({},ou(),t)}function cu(t,e){return e.reduce(function(r,i){return r[i]=t,r},{})}var Up=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,au(typeof e!="number"?e:cu(e,Ri))};function Wp(t){var e,r=t.state,i=t.name,a=t.options,f=r.elements.arrow,y=r.modifiersData.popperOffsets,s=sr(r.placement),o=va(s),c=[pt,At].indexOf(s)>=0,d=c?"height":"width";if(!(!f||!y)){var _=Up(a.padding,r),v=ma(f),E=o==="y"?dt:pt,C=o==="y"?kt:At,S=r.rects.reference[d]+r.rects.reference[o]-y[o]-r.rects.popper[d],h=y[o]-r.rects.reference[o],p=hn(f),g=p?o==="y"?p.clientHeight||0:p.clientWidth||0:0,m=S/2-h/2,T=_[E],w=g-v[d]-_[C],R=g/2-v[d]/2+m,l=tn(T,R,w),k=o;r.modifiersData[i]=(e={},e[k]=l,e.centerOffset=l-R,e)}}function zp(t){var e=t.state,r=t.options,i=r.element,a=i===void 0?"[data-popper-arrow]":i;a!=null&&(typeof a=="string"&&(a=e.elements.popper.querySelector(a),!a)||su(e.elements.popper,a)&&(e.elements.arrow=a))}const lu={name:"arrow",enabled:!0,phase:"main",fn:Wp,effect:zp,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ei(t){return t.split("-")[1]}var Vp={top:"auto",right:"auto",bottom:"auto",left:"auto"};function qp(t,e){var r=t.x,i=t.y,a=e.devicePixelRatio||1;return{x:bi(r*a)/a||0,y:bi(i*a)/a||0}}function Lc(t){var e,r=t.popper,i=t.popperRect,a=t.placement,f=t.variation,y=t.offsets,s=t.position,o=t.gpuAcceleration,c=t.adaptive,d=t.roundOffsets,_=t.isFixed,v=y.x,E=v===void 0?0:v,C=y.y,S=C===void 0?0:C,h=typeof d=="function"?d({x:E,y:S}):{x:E,y:S};E=h.x,S=h.y;var p=y.hasOwnProperty("x"),g=y.hasOwnProperty("y"),m=pt,T=dt,w=window;if(c){var R=hn(r),l="clientHeight",k="clientWidth";if(R===Rt(r)&&(R=Ir(r),vr(R).position!=="static"&&s==="absolute"&&(l="scrollHeight",k="scrollWidth")),R=R,a===dt||(a===pt||a===At)&&f===Si){T=kt;var x=_&&R===w&&w.visualViewport?w.visualViewport.height:R[l];S-=x-i.height,S*=o?1:-1}if(a===pt||(a===dt||a===kt)&&f===Si){m=At;var M=_&&R===w&&w.visualViewport?w.visualViewport.width:R[k];E-=M-i.width,E*=o?1:-1}}var $=Object.assign({position:s},c&&Vp),B=d===!0?qp({x:E,y:S},Rt(r)):{x:E,y:S};if(E=B.x,S=B.y,o){var N;return Object.assign({},$,(N={},N[T]=g?"0":"",N[m]=p?"0":"",N.transform=(w.devicePixelRatio||1)<=1?"translate("+E+"px, "+S+"px)":"translate3d("+E+"px, "+S+"px, 0)",N))}return Object.assign({},$,(e={},e[T]=g?S+"px":"",e[m]=p?E+"px":"",e.transform="",e))}function Kp(t){var e=t.state,r=t.options,i=r.gpuAcceleration,a=i===void 0?!0:i,f=r.adaptive,y=f===void 0?!0:f,s=r.roundOffsets,o=s===void 0?!0:s,c={placement:sr(e.placement),variation:Ei(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:a,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Lc(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:y,roundOffsets:o})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Lc(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:o})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const ya={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Kp,data:{}};var On={passive:!0};function Gp(t){var e=t.state,r=t.instance,i=t.options,a=i.scroll,f=a===void 0?!0:a,y=i.resize,s=y===void 0?!0:y,o=Rt(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return f&&c.forEach(function(d){d.addEventListener("scroll",r.update,On)}),s&&o.addEventListener("resize",r.update,On),function(){f&&c.forEach(function(d){d.removeEventListener("scroll",r.update,On)}),s&&o.removeEventListener("resize",r.update,On)}}const Sa={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Gp,data:{}};var Yp={left:"right",right:"left",bottom:"top",top:"bottom"};function Vn(t){return t.replace(/left|right|bottom|top/g,function(e){return Yp[e]})}var Xp={start:"end",end:"start"};function Oc(t){return t.replace(/start|end/g,function(e){return Xp[e]})}function ba(t){var e=Rt(t),r=e.pageXOffset,i=e.pageYOffset;return{scrollLeft:r,scrollTop:i}}function Ca(t){return Ci(Ir(t)).left+ba(t).scrollLeft}function Jp(t,e){var r=Rt(t),i=Ir(t),a=r.visualViewport,f=i.clientWidth,y=i.clientHeight,s=0,o=0;if(a){f=a.width,y=a.height;var c=nu();(c||!c&&e==="fixed")&&(s=a.offsetLeft,o=a.offsetTop)}return{width:f,height:y,x:s+Ca(t),y:o}}function Qp(t){var e,r=Ir(t),i=ba(t),a=(e=t.ownerDocument)==null?void 0:e.body,f=Gr(r.scrollWidth,r.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),y=Gr(r.scrollHeight,r.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),s=-i.scrollLeft+Ca(t),o=-i.scrollTop;return vr(a||r).direction==="rtl"&&(s+=Gr(r.clientWidth,a?a.clientWidth:0)-f),{width:f,height:y,x:s,y:o}}function Ea(t){var e=vr(t),r=e.overflow,i=e.overflowX,a=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+a+i)}function hu(t){return["html","body","#document"].indexOf(ar(t))>=0?t.ownerDocument.body:Nt(t)&&Ea(t)?t:hu(gs(t))}function rn(t,e){var r;e===void 0&&(e=[]);var i=hu(t),a=i===((r=t.ownerDocument)==null?void 0:r.body),f=Rt(i),y=a?[f].concat(f.visualViewport||[],Ea(i)?i:[]):i,s=e.concat(y);return a?s:s.concat(rn(gs(y)))}function qo(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function Zp(t,e){var r=Ci(t,!1,e==="fixed");return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function Pc(t,e,r){return e===da?qo(Jp(t,r)):Jr(e)?Zp(e,r):qo(Qp(Ir(t)))}function e_(t){var e=rn(gs(t)),r=["absolute","fixed"].indexOf(vr(t).position)>=0,i=r&&Nt(t)?hn(t):t;return Jr(i)?e.filter(function(a){return Jr(a)&&su(a,i)&&ar(a)!=="body"}):[]}function t_(t,e,r,i){var a=e==="clippingParents"?e_(t):[].concat(e),f=[].concat(a,[r]),y=f[0],s=f.reduce(function(o,c){var d=Pc(t,c,i);return o.top=Gr(d.top,o.top),o.right=ss(d.right,o.right),o.bottom=ss(d.bottom,o.bottom),o.left=Gr(d.left,o.left),o},Pc(t,y,i));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function uu(t){var e=t.reference,r=t.element,i=t.placement,a=i?sr(i):null,f=i?Ei(i):null,y=e.x+e.width/2-r.width/2,s=e.y+e.height/2-r.height/2,o;switch(a){case dt:o={x:y,y:e.y-r.height};break;case kt:o={x:y,y:e.y+e.height};break;case At:o={x:e.x+e.width,y:s};break;case pt:o={x:e.x-r.width,y:s};break;default:o={x:e.x,y:e.y}}var c=a?va(a):null;if(c!=null){var d=c==="y"?"height":"width";switch(f){case Xr:o[c]=o[c]-(e[d]/2-r[d]/2);break;case Si:o[c]=o[c]+(e[d]/2-r[d]/2);break}}return o}function Ti(t,e){e===void 0&&(e={});var r=e,i=r.placement,a=i===void 0?t.placement:i,f=r.strategy,y=f===void 0?t.strategy:f,s=r.boundary,o=s===void 0?qh:s,c=r.rootBoundary,d=c===void 0?da:c,_=r.elementContext,v=_===void 0?pi:_,E=r.altBoundary,C=E===void 0?!1:E,S=r.padding,h=S===void 0?0:S,p=au(typeof h!="number"?h:cu(h,Ri)),g=v===pi?Kh:pi,m=t.rects.popper,T=t.elements[C?g:v],w=t_(Jr(T)?T:T.contextElement||Ir(t.elements.popper),o,d,y),R=Ci(t.elements.reference),l=uu({reference:R,element:m,strategy:"absolute",placement:a}),k=qo(Object.assign({},m,l)),x=v===pi?k:R,M={top:w.top-x.top+p.top,bottom:x.bottom-w.bottom+p.bottom,left:w.left-x.left+p.left,right:x.right-w.right+p.right},$=t.modifiersData.offset;if(v===pi&&$){var B=$[a];Object.keys(M).forEach(function(N){var ee=[At,kt].indexOf(N)>=0?1:-1,ue=[dt,kt].indexOf(N)>=0?"y":"x";M[N]+=B[ue]*ee})}return M}function r_(t,e){e===void 0&&(e={});var r=e,i=r.placement,a=r.boundary,f=r.rootBoundary,y=r.padding,s=r.flipVariations,o=r.allowedAutoPlacements,c=o===void 0?pa:o,d=Ei(i),_=d?s?zo:zo.filter(function(C){return Ei(C)===d}):Ri,v=_.filter(function(C){return c.indexOf(C)>=0});v.length===0&&(v=_);var E=v.reduce(function(C,S){return C[S]=Ti(t,{placement:S,boundary:a,rootBoundary:f,padding:y})[sr(S)],C},{});return Object.keys(E).sort(function(C,S){return E[C]-E[S]})}function i_(t){if(sr(t)===_s)return[];var e=Vn(t);return[Oc(t),e,Oc(e)]}function n_(t){var e=t.state,r=t.options,i=t.name;if(!e.modifiersData[i]._skip){for(var a=r.mainAxis,f=a===void 0?!0:a,y=r.altAxis,s=y===void 0?!0:y,o=r.fallbackPlacements,c=r.padding,d=r.boundary,_=r.rootBoundary,v=r.altBoundary,E=r.flipVariations,C=E===void 0?!0:E,S=r.allowedAutoPlacements,h=e.options.placement,p=sr(h),g=p===h,m=o||(g||!C?[Vn(h)]:i_(h)),T=[h].concat(m).reduce(function(oe,pe){return oe.concat(sr(pe)===_s?r_(e,{placement:pe,boundary:d,rootBoundary:_,padding:c,flipVariations:C,allowedAutoPlacements:S}):pe)},[]),w=e.rects.reference,R=e.rects.popper,l=new Map,k=!0,x=T[0],M=0;M<T.length;M++){var $=T[M],B=sr($),N=Ei($)===Xr,ee=[dt,kt].indexOf(B)>=0,ue=ee?"width":"height",se=Ti(e,{placement:$,boundary:d,rootBoundary:_,altBoundary:v,padding:c}),P=ee?N?At:pt:N?kt:dt;w[ue]>R[ue]&&(P=Vn(P));var F=Vn(P),j=[];if(f&&j.push(se[B]<=0),s&&j.push(se[P]<=0,se[F]<=0),j.every(function(oe){return oe})){x=$,k=!1;break}l.set($,j)}if(k)for(var q=C?3:1,te=function(pe){var z=T.find(function(W){var Y=l.get(W);if(Y)return Y.slice(0,pe).every(function(re){return re})});if(z)return x=z,"break"},ge=q;ge>0;ge--){var me=te(ge);if(me==="break")break}e.placement!==x&&(e.modifiersData[i]._skip=!0,e.placement=x,e.reset=!0)}}const fu={name:"flip",enabled:!0,phase:"main",fn:n_,requiresIfExists:["offset"],data:{_skip:!1}};function Mc(t,e,r){return r===void 0&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function Ic(t){return[dt,At,kt,pt].some(function(e){return t[e]>=0})}function s_(t){var e=t.state,r=t.name,i=e.rects.reference,a=e.rects.popper,f=e.modifiersData.preventOverflow,y=Ti(e,{elementContext:"reference"}),s=Ti(e,{altBoundary:!0}),o=Mc(y,i),c=Mc(s,a,f),d=Ic(o),_=Ic(c);e.modifiersData[r]={referenceClippingOffsets:o,popperEscapeOffsets:c,isReferenceHidden:d,hasPopperEscaped:_},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":_})}const du={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:s_};function o_(t,e,r){var i=sr(t),a=[pt,dt].indexOf(i)>=0?-1:1,f=typeof r=="function"?r(Object.assign({},e,{placement:t})):r,y=f[0],s=f[1];return y=y||0,s=(s||0)*a,[pt,At].indexOf(i)>=0?{x:s,y}:{x:y,y:s}}function a_(t){var e=t.state,r=t.options,i=t.name,a=r.offset,f=a===void 0?[0,0]:a,y=pa.reduce(function(d,_){return d[_]=o_(_,e.rects,f),d},{}),s=y[e.placement],o=s.x,c=s.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=o,e.modifiersData.popperOffsets.y+=c),e.modifiersData[i]=y}const pu={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:a_};function c_(t){var e=t.state,r=t.name;e.modifiersData[r]=uu({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const Ta={name:"popperOffsets",enabled:!0,phase:"read",fn:c_,data:{}};function l_(t){return t==="x"?"y":"x"}function h_(t){var e=t.state,r=t.options,i=t.name,a=r.mainAxis,f=a===void 0?!0:a,y=r.altAxis,s=y===void 0?!1:y,o=r.boundary,c=r.rootBoundary,d=r.altBoundary,_=r.padding,v=r.tether,E=v===void 0?!0:v,C=r.tetherOffset,S=C===void 0?0:C,h=Ti(e,{boundary:o,rootBoundary:c,padding:_,altBoundary:d}),p=sr(e.placement),g=Ei(e.placement),m=!g,T=va(p),w=l_(T),R=e.modifiersData.popperOffsets,l=e.rects.reference,k=e.rects.popper,x=typeof S=="function"?S(Object.assign({},e.rects,{placement:e.placement})):S,M=typeof x=="number"?{mainAxis:x,altAxis:x}:Object.assign({mainAxis:0,altAxis:0},x),$=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,B={x:0,y:0};if(R){if(f){var N,ee=T==="y"?dt:pt,ue=T==="y"?kt:At,se=T==="y"?"height":"width",P=R[T],F=P+h[ee],j=P-h[ue],q=E?-k[se]/2:0,te=g===Xr?l[se]:k[se],ge=g===Xr?-k[se]:-l[se],me=e.elements.arrow,oe=E&&me?ma(me):{width:0,height:0},pe=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:ou(),z=pe[ee],W=pe[ue],Y=tn(0,l[se],oe[se]),re=m?l[se]/2-q-Y-z-M.mainAxis:te-Y-z-M.mainAxis,ae=m?-l[se]/2+q+Y+W+M.mainAxis:ge+Y+W+M.mainAxis,Oe=e.elements.arrow&&hn(e.elements.arrow),de=Oe?T==="y"?Oe.clientTop||0:Oe.clientLeft||0:0,Fe=(N=$==null?void 0:$[T])!=null?N:0,Ue=P+re-Fe-de,ze=P+ae-Fe,Pe=tn(E?ss(F,Ue):F,P,E?Gr(j,ze):j);R[T]=Pe,B[T]=Pe-P}if(s){var xt,mt=T==="x"?dt:pt,Li=T==="x"?kt:At,Et=R[w],Dt=w==="y"?"height":"width",Je=Et+h[mt],lt=Et-h[Li],Lt=[dt,pt].indexOf(p)!==-1,be=(xt=$==null?void 0:$[w])!=null?xt:0,Qe=Lt?Je:Et-l[Dt]-k[Dt]-be+M.altAxis,br=Lt?Et+l[Dt]+k[Dt]-be-M.altAxis:lt,Hr=E&&Lt?jp(Qe,Et,br):tn(E?Qe:Je,Et,E?br:lt);R[w]=Hr,B[w]=Hr-Et}e.modifiersData[i]=B}}const _u={name:"preventOverflow",enabled:!0,phase:"main",fn:h_,requiresIfExists:["offset"]};function u_(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function f_(t){return t===Rt(t)||!Nt(t)?ba(t):u_(t)}function d_(t){var e=t.getBoundingClientRect(),r=bi(e.width)/t.offsetWidth||1,i=bi(e.height)/t.offsetHeight||1;return r!==1||i!==1}function p_(t,e,r){r===void 0&&(r=!1);var i=Nt(e),a=Nt(e)&&d_(e),f=Ir(e),y=Ci(t,a,r),s={scrollLeft:0,scrollTop:0},o={x:0,y:0};return(i||!i&&!r)&&((ar(e)!=="body"||Ea(f))&&(s=f_(e)),Nt(e)?(o=Ci(e,!0),o.x+=e.clientLeft,o.y+=e.clientTop):f&&(o.x=Ca(f))),{x:y.left+s.scrollLeft-o.x,y:y.top+s.scrollTop-o.y,width:y.width,height:y.height}}function __(t){var e=new Map,r=new Set,i=[];t.forEach(function(f){e.set(f.name,f)});function a(f){r.add(f.name);var y=[].concat(f.requires||[],f.requiresIfExists||[]);y.forEach(function(s){if(!r.has(s)){var o=e.get(s);o&&a(o)}}),i.push(f)}return t.forEach(function(f){r.has(f.name)||a(f)}),i}function g_(t){var e=__(t);return iu.reduce(function(r,i){return r.concat(e.filter(function(a){return a.phase===i}))},[])}function m_(t){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(t())})})),e}}function v_(t){var e=t.reduce(function(r,i){var a=r[i.name];return r[i.name]=a?Object.assign({},a,i,{options:Object.assign({},a.options,i.options),data:Object.assign({},a.data,i.data)}):i,r},{});return Object.keys(e).map(function(r){return e[r]})}var Bc={placement:"bottom",modifiers:[],strategy:"absolute"};function Nc(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function ms(t){t===void 0&&(t={});var e=t,r=e.defaultModifiers,i=r===void 0?[]:r,a=e.defaultOptions,f=a===void 0?Bc:a;return function(s,o,c){c===void 0&&(c=f);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},Bc,f),modifiersData:{},elements:{reference:s,popper:o},attributes:{},styles:{}},_=[],v=!1,E={state:d,setOptions:function(p){var g=typeof p=="function"?p(d.options):p;S(),d.options=Object.assign({},f,d.options,g),d.scrollParents={reference:Jr(s)?rn(s):s.contextElement?rn(s.contextElement):[],popper:rn(o)};var m=g_(v_([].concat(i,d.options.modifiers)));return d.orderedModifiers=m.filter(function(T){return T.enabled}),C(),E.update()},forceUpdate:function(){if(!v){var p=d.elements,g=p.reference,m=p.popper;if(Nc(g,m)){d.rects={reference:p_(g,hn(m),d.options.strategy==="fixed"),popper:ma(m)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(M){return d.modifiersData[M.name]=Object.assign({},M.data)});for(var T=0;T<d.orderedModifiers.length;T++){if(d.reset===!0){d.reset=!1,T=-1;continue}var w=d.orderedModifiers[T],R=w.fn,l=w.options,k=l===void 0?{}:l,x=w.name;typeof R=="function"&&(d=R({state:d,options:k,name:x,instance:E})||d)}}}},update:m_(function(){return new Promise(function(h){E.forceUpdate(),h(d)})}),destroy:function(){S(),v=!0}};if(!Nc(s,o))return E;E.setOptions(c).then(function(h){!v&&c.onFirstUpdate&&c.onFirstUpdate(h)});function C(){d.orderedModifiers.forEach(function(h){var p=h.name,g=h.options,m=g===void 0?{}:g,T=h.effect;if(typeof T=="function"){var w=T({state:d,name:p,instance:E,options:m}),R=function(){};_.push(w||R)}})}function S(){_.forEach(function(h){return h()}),_=[]}return E}}var y_=ms(),S_=[Sa,Ta,ya,ga],b_=ms({defaultModifiers:S_}),C_=[Sa,Ta,ya,ga,pu,fu,_u,lu,du],wa=ms({defaultModifiers:C_});const gu=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Zh,afterRead:Xh,afterWrite:ru,applyStyles:ga,arrow:lu,auto:_s,basePlacements:Ri,beforeMain:Jh,beforeRead:Gh,beforeWrite:eu,bottom:kt,clippingParents:qh,computeStyles:ya,createPopper:wa,createPopperBase:y_,createPopperLite:b_,detectOverflow:Ti,end:Si,eventListeners:Sa,flip:fu,hide:du,left:pt,main:Qh,modifierPhases:iu,offset:pu,placements:pa,popper:pi,popperGenerator:ms,popperOffsets:Ta,preventOverflow:_u,read:Yh,reference:Kh,right:At,start:Xr,top:dt,variationPlacements:zo,viewport:da,write:tu},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.3.1 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const Dr=new Map,Gs={set(t,e,r){Dr.has(t)||Dr.set(t,new Map);const i=Dr.get(t);if(!i.has(e)&&i.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(i.keys())[0]}.`);return}i.set(e,r)},get(t,e){return Dr.has(t)&&Dr.get(t).get(e)||null},remove(t,e){if(!Dr.has(t))return;const r=Dr.get(t);r.delete(e),r.size===0&&Dr.delete(t)}},E_=1e6,T_=1e3,Ko="transitionend",mu=t=>(t&&window.CSS&&window.CSS.escape&&(t=t.replace(/#([^\s"#']+)/g,(e,r)=>`#${CSS.escape(r)}`)),t),w_=t=>t==null?`${t}`:Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase(),k_=t=>{do t+=Math.floor(Math.random()*E_);while(document.getElementById(t));return t},A_=t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:r}=window.getComputedStyle(t);const i=Number.parseFloat(e),a=Number.parseFloat(r);return!i&&!a?0:(e=e.split(",")[0],r=r.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(r))*T_)},vu=t=>{t.dispatchEvent(new Event(Ko))},gr=t=>!t||typeof t!="object"?!1:(typeof t.jquery<"u"&&(t=t[0]),typeof t.nodeType<"u"),Or=t=>gr(t)?t.jquery?t[0]:t:typeof t=="string"&&t.length>0?document.querySelector(mu(t)):null,xi=t=>{if(!gr(t)||t.getClientRects().length===0)return!1;const e=getComputedStyle(t).getPropertyValue("visibility")==="visible",r=t.closest("details:not([open])");if(!r)return e;if(r!==t){const i=t.closest("summary");if(i&&i.parentNode!==r||i===null)return!1}return e},Pr=t=>!t||t.nodeType!==Node.ELEMENT_NODE||t.classList.contains("disabled")?!0:typeof t.disabled<"u"?t.disabled:t.hasAttribute("disabled")&&t.getAttribute("disabled")!=="false",yu=t=>{if(!document.documentElement.attachShadow)return null;if(typeof t.getRootNode=="function"){const e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?yu(t.parentNode):null},os=()=>{},un=t=>{t.offsetHeight},Su=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Ys=[],R_=t=>{document.readyState==="loading"?(Ys.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Ys)e()}),Ys.push(t)):t()},Ht=()=>document.documentElement.dir==="rtl",jt=t=>{R_(()=>{const e=Su();if(e){const r=t.NAME,i=e.fn[r];e.fn[r]=t.jQueryInterface,e.fn[r].Constructor=t,e.fn[r].noConflict=()=>(e.fn[r]=i,t.jQueryInterface)}})},Ct=(t,e=[],r=t)=>typeof t=="function"?t(...e):r,bu=(t,e,r=!0)=>{if(!r){Ct(t);return}const i=5,a=A_(e)+i;let f=!1;const y=({target:s})=>{s===e&&(f=!0,e.removeEventListener(Ko,y),Ct(t))};e.addEventListener(Ko,y),setTimeout(()=>{f||vu(e)},a)},ka=(t,e,r,i)=>{const a=t.length;let f=t.indexOf(e);return f===-1?!r&&i?t[a-1]:t[0]:(f+=r?1:-1,i&&(f=(f+a)%a),t[Math.max(0,Math.min(f,a-1))])},x_=/[^.]*(?=\..*)\.|.*/,D_=/\..*/,L_=/::\d+$/,Xs={};let Hc=1;const Cu={mouseenter:"mouseover",mouseleave:"mouseout"},O_=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Eu(t,e){return e&&`${e}::${Hc++}`||t.uidEvent||Hc++}function Tu(t){const e=Eu(t);return t.uidEvent=e,Xs[e]=Xs[e]||{},Xs[e]}function P_(t,e){return function r(i){return Aa(i,{delegateTarget:t}),r.oneOff&&ce.off(t,i.type,e),e.apply(t,[i])}}function M_(t,e,r){return function i(a){const f=t.querySelectorAll(e);for(let{target:y}=a;y&&y!==this;y=y.parentNode)for(const s of f)if(s===y)return Aa(a,{delegateTarget:y}),i.oneOff&&ce.off(t,a.type,e,r),r.apply(y,[a])}}function wu(t,e,r=null){return Object.values(t).find(i=>i.callable===e&&i.delegationSelector===r)}function ku(t,e,r){const i=typeof e=="string",a=i?r:e||r;let f=Au(t);return O_.has(f)||(f=t),[i,a,f]}function $c(t,e,r,i,a){if(typeof e!="string"||!t)return;let[f,y,s]=ku(e,r,i);e in Cu&&(y=(C=>function(S){if(!S.relatedTarget||S.relatedTarget!==S.delegateTarget&&!S.delegateTarget.contains(S.relatedTarget))return C.call(this,S)})(y));const o=Tu(t),c=o[s]||(o[s]={}),d=wu(c,y,f?r:null);if(d){d.oneOff=d.oneOff&&a;return}const _=Eu(y,e.replace(x_,"")),v=f?M_(t,r,y):P_(t,y);v.delegationSelector=f?r:null,v.callable=y,v.oneOff=a,v.uidEvent=_,c[_]=v,t.addEventListener(s,v,f)}function Go(t,e,r,i,a){const f=wu(e[r],i,a);f&&(t.removeEventListener(r,f,!!a),delete e[r][f.uidEvent])}function I_(t,e,r,i){const a=e[r]||{};for(const[f,y]of Object.entries(a))f.includes(i)&&Go(t,e,r,y.callable,y.delegationSelector)}function Au(t){return t=t.replace(D_,""),Cu[t]||t}const ce={on(t,e,r,i){$c(t,e,r,i,!1)},one(t,e,r,i){$c(t,e,r,i,!0)},off(t,e,r,i){if(typeof e!="string"||!t)return;const[a,f,y]=ku(e,r,i),s=y!==e,o=Tu(t),c=o[y]||{},d=e.startsWith(".");if(typeof f<"u"){if(!Object.keys(c).length)return;Go(t,o,y,f,a?r:null);return}if(d)for(const _ of Object.keys(o))I_(t,o,_,e.slice(1));for(const[_,v]of Object.entries(c)){const E=_.replace(L_,"");(!s||e.includes(E))&&Go(t,o,y,v.callable,v.delegationSelector)}},trigger(t,e,r){if(typeof e!="string"||!t)return null;const i=Su(),a=Au(e),f=e!==a;let y=null,s=!0,o=!0,c=!1;f&&i&&(y=i.Event(e,r),i(t).trigger(y),s=!y.isPropagationStopped(),o=!y.isImmediatePropagationStopped(),c=y.isDefaultPrevented());const d=Aa(new Event(e,{bubbles:s,cancelable:!0}),r);return c&&d.preventDefault(),o&&t.dispatchEvent(d),d.defaultPrevented&&y&&y.preventDefault(),d}};function Aa(t,e={}){for(const[r,i]of Object.entries(e))try{t[r]=i}catch{Object.defineProperty(t,r,{configurable:!0,get(){return i}})}return t}function Fc(t){if(t==="true")return!0;if(t==="false")return!1;if(t===Number(t).toString())return Number(t);if(t===""||t==="null")return null;if(typeof t!="string")return t;try{return JSON.parse(decodeURIComponent(t))}catch{return t}}function Js(t){return t.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const mr={setDataAttribute(t,e,r){t.setAttribute(`data-bs-${Js(e)}`,r)},removeDataAttribute(t,e){t.removeAttribute(`data-bs-${Js(e)}`)},getDataAttributes(t){if(!t)return{};const e={},r=Object.keys(t.dataset).filter(i=>i.startsWith("bs")&&!i.startsWith("bsConfig"));for(const i of r){let a=i.replace(/^bs/,"");a=a.charAt(0).toLowerCase()+a.slice(1,a.length),e[a]=Fc(t.dataset[i])}return e},getDataAttribute(t,e){return Fc(t.getAttribute(`data-bs-${Js(e)}`))}};class fn{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,r){const i=gr(r)?mr.getDataAttribute(r,"config"):{};return{...this.constructor.Default,...typeof i=="object"?i:{},...gr(r)?mr.getDataAttributes(r):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,r=this.constructor.DefaultType){for(const[i,a]of Object.entries(r)){const f=e[i],y=gr(f)?"element":w_(f);if(!new RegExp(a).test(y))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${i}" provided type "${y}" but expected type "${a}".`)}}}const B_="5.3.1";class Yt extends fn{constructor(e,r){super(),e=Or(e),e&&(this._element=e,this._config=this._getConfig(r),Gs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Gs.remove(this._element,this.constructor.DATA_KEY),ce.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,r,i=!0){bu(e,r,i)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Gs.get(Or(e),this.DATA_KEY)}static getOrCreateInstance(e,r={}){return this.getInstance(e)||new this(e,typeof r=="object"?r:null)}static get VERSION(){return B_}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Qs=t=>{let e=t.getAttribute("data-bs-target");if(!e||e==="#"){let r=t.getAttribute("href");if(!r||!r.includes("#")&&!r.startsWith("."))return null;r.includes("#")&&!r.startsWith("#")&&(r=`#${r.split("#")[1]}`),e=r&&r!=="#"?r.trim():null}return mu(e)},Te={find(t,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,t))},findOne(t,e=document.documentElement){return Element.prototype.querySelector.call(e,t)},children(t,e){return[].concat(...t.children).filter(r=>r.matches(e))},parents(t,e){const r=[];let i=t.parentNode.closest(e);for(;i;)r.push(i),i=i.parentNode.closest(e);return r},prev(t,e){let r=t.previousElementSibling;for(;r;){if(r.matches(e))return[r];r=r.previousElementSibling}return[]},next(t,e){let r=t.nextElementSibling;for(;r;){if(r.matches(e))return[r];r=r.nextElementSibling}return[]},focusableChildren(t){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(r=>`${r}:not([tabindex^="-"])`).join(",");return this.find(e,t).filter(r=>!Pr(r)&&xi(r))},getSelectorFromElement(t){const e=Qs(t);return e&&Te.findOne(e)?e:null},getElementFromSelector(t){const e=Qs(t);return e?Te.findOne(e):null},getMultipleElementsFromSelector(t){const e=Qs(t);return e?Te.find(e):[]}},vs=(t,e="hide")=>{const r=`click.dismiss${t.EVENT_KEY}`,i=t.NAME;ce.on(document,r,`[data-bs-dismiss="${i}"]`,function(a){if(["A","AREA"].includes(this.tagName)&&a.preventDefault(),Pr(this))return;const f=Te.getElementFromSelector(this)||this.closest(`.${i}`);t.getOrCreateInstance(f)[e]()})},N_="alert",H_="bs.alert",Ru=`.${H_}`,$_=`close${Ru}`,F_=`closed${Ru}`,j_="fade",U_="show";class ys extends Yt{static get NAME(){return N_}close(){if(ce.trigger(this._element,$_).defaultPrevented)return;this._element.classList.remove(U_);const r=this._element.classList.contains(j_);this._queueCallback(()=>this._destroyElement(),this._element,r)}_destroyElement(){this._element.remove(),ce.trigger(this._element,F_),this.dispose()}static jQueryInterface(e){return this.each(function(){const r=ys.getOrCreateInstance(this);if(typeof e=="string"){if(r[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);r[e](this)}})}}vs(ys,"close");jt(ys);const W_="button",z_="bs.button",V_=`.${z_}`,q_=".data-api",K_="active",jc='[data-bs-toggle="button"]',G_=`click${V_}${q_}`;class Ss extends Yt{static get NAME(){return W_}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(K_))}static jQueryInterface(e){return this.each(function(){const r=Ss.getOrCreateInstance(this);e==="toggle"&&r[e]()})}}ce.on(document,G_,jc,t=>{t.preventDefault();const e=t.target.closest(jc);Ss.getOrCreateInstance(e).toggle()});jt(Ss);const Y_="swipe",Di=".bs.swipe",X_=`touchstart${Di}`,J_=`touchmove${Di}`,Q_=`touchend${Di}`,Z_=`pointerdown${Di}`,eg=`pointerup${Di}`,tg="touch",rg="pen",ig="pointer-event",ng=40,sg={endCallback:null,leftCallback:null,rightCallback:null},og={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class as extends fn{constructor(e,r){super(),this._element=e,!(!e||!as.isSupported())&&(this._config=this._getConfig(r),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return sg}static get DefaultType(){return og}static get NAME(){return Y_}dispose(){ce.off(this._element,Di)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ct(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=ng)return;const r=e/this._deltaX;this._deltaX=0,r&&Ct(r>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(ce.on(this._element,Z_,e=>this._start(e)),ce.on(this._element,eg,e=>this._end(e)),this._element.classList.add(ig)):(ce.on(this._element,X_,e=>this._start(e)),ce.on(this._element,J_,e=>this._move(e)),ce.on(this._element,Q_,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===rg||e.pointerType===tg)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const ag="carousel",cg="bs.carousel",Br=`.${cg}`,xu=".data-api",lg="ArrowLeft",hg="ArrowRight",ug=500,zi="next",ui="prev",_i="left",qn="right",fg=`slide${Br}`,Zs=`slid${Br}`,dg=`keydown${Br}`,pg=`mouseenter${Br}`,_g=`mouseleave${Br}`,gg=`dragstart${Br}`,mg=`load${Br}${xu}`,vg=`click${Br}${xu}`,Du="carousel",Pn="active",yg="slide",Sg="carousel-item-end",bg="carousel-item-start",Cg="carousel-item-next",Eg="carousel-item-prev",Lu=".active",Ou=".carousel-item",Tg=Lu+Ou,wg=".carousel-item img",kg=".carousel-indicators",Ag="[data-bs-slide], [data-bs-slide-to]",Rg='[data-bs-ride="carousel"]',xg={[lg]:qn,[hg]:_i},Dg={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Lg={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class dn extends Yt{constructor(e,r){super(e,r),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Te.findOne(kg,this._element),this._addEventListeners(),this._config.ride===Du&&this.cycle()}static get Default(){return Dg}static get DefaultType(){return Lg}static get NAME(){return ag}next(){this._slide(zi)}nextWhenVisible(){!document.hidden&&xi(this._element)&&this.next()}prev(){this._slide(ui)}pause(){this._isSliding&&vu(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){ce.one(this._element,Zs,()=>this.cycle());return}this.cycle()}}to(e){const r=this._getItems();if(e>r.length-1||e<0)return;if(this._isSliding){ce.one(this._element,Zs,()=>this.to(e));return}const i=this._getItemIndex(this._getActive());if(i===e)return;const a=e>i?zi:ui;this._slide(a,r[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&ce.on(this._element,dg,e=>this._keydown(e)),this._config.pause==="hover"&&(ce.on(this._element,pg,()=>this.pause()),ce.on(this._element,_g,()=>this._maybeEnableCycle())),this._config.touch&&as.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const i of Te.find(wg,this._element))ce.on(i,gg,a=>a.preventDefault());const r={leftCallback:()=>this._slide(this._directionToOrder(_i)),rightCallback:()=>this._slide(this._directionToOrder(qn)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),ug+this._config.interval))}};this._swipeHelper=new as(this._element,r)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const r=xg[e.key];r&&(e.preventDefault(),this._slide(this._directionToOrder(r)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const r=Te.findOne(Lu,this._indicatorsElement);r.classList.remove(Pn),r.removeAttribute("aria-current");const i=Te.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);i&&(i.classList.add(Pn),i.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const r=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=r||this._config.defaultInterval}_slide(e,r=null){if(this._isSliding)return;const i=this._getActive(),a=e===zi,f=r||ka(this._getItems(),i,a,this._config.wrap);if(f===i)return;const y=this._getItemIndex(f),s=E=>ce.trigger(this._element,E,{relatedTarget:f,direction:this._orderToDirection(e),from:this._getItemIndex(i),to:y});if(s(fg).defaultPrevented||!i||!f)return;const c=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(y),this._activeElement=f;const d=a?bg:Sg,_=a?Cg:Eg;f.classList.add(_),un(f),i.classList.add(d),f.classList.add(d);const v=()=>{f.classList.remove(d,_),f.classList.add(Pn),i.classList.remove(Pn,_,d),this._isSliding=!1,s(Zs)};this._queueCallback(v,i,this._isAnimated()),c&&this.cycle()}_isAnimated(){return this._element.classList.contains(yg)}_getActive(){return Te.findOne(Tg,this._element)}_getItems(){return Te.find(Ou,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Ht()?e===_i?ui:zi:e===_i?zi:ui}_orderToDirection(e){return Ht()?e===ui?_i:qn:e===ui?qn:_i}static jQueryInterface(e){return this.each(function(){const r=dn.getOrCreateInstance(this,e);if(typeof e=="number"){r.to(e);return}if(typeof e=="string"){if(r[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);r[e]()}})}}ce.on(document,vg,Ag,function(t){const e=Te.getElementFromSelector(this);if(!e||!e.classList.contains(Du))return;t.preventDefault();const r=dn.getOrCreateInstance(e),i=this.getAttribute("data-bs-slide-to");if(i){r.to(i),r._maybeEnableCycle();return}if(mr.getDataAttribute(this,"slide")==="next"){r.next(),r._maybeEnableCycle();return}r.prev(),r._maybeEnableCycle()});ce.on(window,mg,()=>{const t=Te.find(Rg);for(const e of t)dn.getOrCreateInstance(e)});jt(dn);const Og="collapse",Pg="bs.collapse",pn=`.${Pg}`,Mg=".data-api",Ig=`show${pn}`,Bg=`shown${pn}`,Ng=`hide${pn}`,Hg=`hidden${pn}`,$g=`click${pn}${Mg}`,eo="show",mi="collapse",Mn="collapsing",Fg="collapsed",jg=`:scope .${mi} .${mi}`,Ug="collapse-horizontal",Wg="width",zg="height",Vg=".collapse.show, .collapse.collapsing",Yo='[data-bs-toggle="collapse"]',qg={parent:null,toggle:!0},Kg={parent:"(null|element)",toggle:"boolean"};class on extends Yt{constructor(e,r){super(e,r),this._isTransitioning=!1,this._triggerArray=[];const i=Te.find(Yo);for(const a of i){const f=Te.getSelectorFromElement(a),y=Te.find(f).filter(s=>s===this._element);f!==null&&y.length&&this._triggerArray.push(a)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return qg}static get DefaultType(){return Kg}static get NAME(){return Og}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Vg).filter(s=>s!==this._element).map(s=>on.getOrCreateInstance(s,{toggle:!1}))),e.length&&e[0]._isTransitioning||ce.trigger(this._element,Ig).defaultPrevented)return;for(const s of e)s.hide();const i=this._getDimension();this._element.classList.remove(mi),this._element.classList.add(Mn),this._element.style[i]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const a=()=>{this._isTransitioning=!1,this._element.classList.remove(Mn),this._element.classList.add(mi,eo),this._element.style[i]="",ce.trigger(this._element,Bg)},y=`scroll${i[0].toUpperCase()+i.slice(1)}`;this._queueCallback(a,this._element,!0),this._element.style[i]=`${this._element[y]}px`}hide(){if(this._isTransitioning||!this._isShown()||ce.trigger(this._element,Ng).defaultPrevented)return;const r=this._getDimension();this._element.style[r]=`${this._element.getBoundingClientRect()[r]}px`,un(this._element),this._element.classList.add(Mn),this._element.classList.remove(mi,eo);for(const a of this._triggerArray){const f=Te.getElementFromSelector(a);f&&!this._isShown(f)&&this._addAriaAndCollapsedClass([a],!1)}this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Mn),this._element.classList.add(mi),ce.trigger(this._element,Hg)};this._element.style[r]="",this._queueCallback(i,this._element,!0)}_isShown(e=this._element){return e.classList.contains(eo)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Or(e.parent),e}_getDimension(){return this._element.classList.contains(Ug)?Wg:zg}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Yo);for(const r of e){const i=Te.getElementFromSelector(r);i&&this._addAriaAndCollapsedClass([r],this._isShown(i))}}_getFirstLevelChildren(e){const r=Te.find(jg,this._config.parent);return Te.find(e,this._config.parent).filter(i=>!r.includes(i))}_addAriaAndCollapsedClass(e,r){if(e.length)for(const i of e)i.classList.toggle(Fg,!r),i.setAttribute("aria-expanded",r)}static jQueryInterface(e){const r={};return typeof e=="string"&&/show|hide/.test(e)&&(r.toggle=!1),this.each(function(){const i=on.getOrCreateInstance(this,r);if(typeof e=="string"){if(typeof i[e]>"u")throw new TypeError(`No method named "${e}"`);i[e]()}})}}ce.on(document,$g,Yo,function(t){(t.target.tagName==="A"||t.delegateTarget&&t.delegateTarget.tagName==="A")&&t.preventDefault();for(const e of Te.getMultipleElementsFromSelector(this))on.getOrCreateInstance(e,{toggle:!1}).toggle()});jt(on);const Uc="dropdown",Gg="bs.dropdown",Qr=`.${Gg}`,Ra=".data-api",Yg="Escape",Wc="Tab",Xg="ArrowUp",zc="ArrowDown",Jg=2,Qg=`hide${Qr}`,Zg=`hidden${Qr}`,em=`show${Qr}`,tm=`shown${Qr}`,Pu=`click${Qr}${Ra}`,Mu=`keydown${Qr}${Ra}`,rm=`keyup${Qr}${Ra}`,gi="show",im="dropup",nm="dropend",sm="dropstart",om="dropup-center",am="dropdown-center",qr='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',cm=`${qr}.${gi}`,Kn=".dropdown-menu",lm=".navbar",hm=".navbar-nav",um=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",fm=Ht()?"top-end":"top-start",dm=Ht()?"top-start":"top-end",pm=Ht()?"bottom-end":"bottom-start",_m=Ht()?"bottom-start":"bottom-end",gm=Ht()?"left-start":"right-start",mm=Ht()?"right-start":"left-start",vm="top",ym="bottom",Sm={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},bm={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class or extends Yt{constructor(e,r){super(e,r),this._popper=null,this._parent=this._element.parentNode,this._menu=Te.next(this._element,Kn)[0]||Te.prev(this._element,Kn)[0]||Te.findOne(Kn,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Sm}static get DefaultType(){return bm}static get NAME(){return Uc}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Pr(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!ce.trigger(this._element,em,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(hm))for(const i of[].concat(...document.body.children))ce.on(i,"mouseover",os);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(gi),this._element.classList.add(gi),ce.trigger(this._element,tm,e)}}hide(){if(Pr(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!ce.trigger(this._element,Qg,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))ce.off(i,"mouseover",os);this._popper&&this._popper.destroy(),this._menu.classList.remove(gi),this._element.classList.remove(gi),this._element.setAttribute("aria-expanded","false"),mr.removeDataAttribute(this._menu,"popper"),ce.trigger(this._element,Zg,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!gr(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Uc.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof gu>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let e=this._element;this._config.reference==="parent"?e=this._parent:gr(this._config.reference)?e=Or(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const r=this._getPopperConfig();this._popper=wa(e,this._menu,r)}_isShown(){return this._menu.classList.contains(gi)}_getPlacement(){const e=this._parent;if(e.classList.contains(nm))return gm;if(e.classList.contains(sm))return mm;if(e.classList.contains(om))return vm;if(e.classList.contains(am))return ym;const r=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(im)?r?dm:fm:r?_m:pm}_detectNavbar(){return this._element.closest(lm)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(r=>Number.parseInt(r,10)):typeof e=="function"?r=>e(r,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(mr.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ct(this._config.popperConfig,[e])}}_selectMenuItem({key:e,target:r}){const i=Te.find(um,this._menu).filter(a=>xi(a));i.length&&ka(i,r,e===zc,!i.includes(r)).focus()}static jQueryInterface(e){return this.each(function(){const r=or.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof r[e]>"u")throw new TypeError(`No method named "${e}"`);r[e]()}})}static clearMenus(e){if(e.button===Jg||e.type==="keyup"&&e.key!==Wc)return;const r=Te.find(cm);for(const i of r){const a=or.getInstance(i);if(!a||a._config.autoClose===!1)continue;const f=e.composedPath(),y=f.includes(a._menu);if(f.includes(a._element)||a._config.autoClose==="inside"&&!y||a._config.autoClose==="outside"&&y||a._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Wc||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const s={relatedTarget:a._element};e.type==="click"&&(s.clickEvent=e),a._completeHide(s)}}static dataApiKeydownHandler(e){const r=/input|textarea/i.test(e.target.tagName),i=e.key===Yg,a=[Xg,zc].includes(e.key);if(!a&&!i||r&&!i)return;e.preventDefault();const f=this.matches(qr)?this:Te.prev(this,qr)[0]||Te.next(this,qr)[0]||Te.findOne(qr,e.delegateTarget.parentNode),y=or.getOrCreateInstance(f);if(a){e.stopPropagation(),y.show(),y._selectMenuItem(e);return}y._isShown()&&(e.stopPropagation(),y.hide(),f.focus())}}ce.on(document,Mu,qr,or.dataApiKeydownHandler);ce.on(document,Mu,Kn,or.dataApiKeydownHandler);ce.on(document,Pu,or.clearMenus);ce.on(document,rm,or.clearMenus);ce.on(document,Pu,qr,function(t){t.preventDefault(),or.getOrCreateInstance(this).toggle()});jt(or);const Iu="backdrop",Cm="fade",Vc="show",qc=`mousedown.bs.${Iu}`,Em={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Tm={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Bu extends fn{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Em}static get DefaultType(){return Tm}static get NAME(){return Iu}show(e){if(!this._config.isVisible){Ct(e);return}this._append();const r=this._getElement();this._config.isAnimated&&un(r),r.classList.add(Vc),this._emulateAnimation(()=>{Ct(e)})}hide(e){if(!this._config.isVisible){Ct(e);return}this._getElement().classList.remove(Vc),this._emulateAnimation(()=>{this.dispose(),Ct(e)})}dispose(){this._isAppended&&(ce.off(this._element,qc),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Cm),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Or(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),ce.on(e,qc,()=>{Ct(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){bu(e,this._getElement(),this._config.isAnimated)}}const wm="focustrap",km="bs.focustrap",cs=`.${km}`,Am=`focusin${cs}`,Rm=`keydown.tab${cs}`,xm="Tab",Dm="forward",Kc="backward",Lm={autofocus:!0,trapElement:null},Om={autofocus:"boolean",trapElement:"element"};class Nu extends fn{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Lm}static get DefaultType(){return Om}static get NAME(){return wm}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),ce.off(document,cs),ce.on(document,Am,e=>this._handleFocusin(e)),ce.on(document,Rm,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,ce.off(document,cs))}_handleFocusin(e){const{trapElement:r}=this._config;if(e.target===document||e.target===r||r.contains(e.target))return;const i=Te.focusableChildren(r);i.length===0?r.focus():this._lastTabNavDirection===Kc?i[i.length-1].focus():i[0].focus()}_handleKeydown(e){e.key===xm&&(this._lastTabNavDirection=e.shiftKey?Kc:Dm)}}const Gc=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Yc=".sticky-top",In="padding-right",Xc="margin-right";class Xo{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,In,r=>r+e),this._setElementAttributes(Gc,In,r=>r+e),this._setElementAttributes(Yc,Xc,r=>r-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,In),this._resetElementAttributes(Gc,In),this._resetElementAttributes(Yc,Xc)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,r,i){const a=this.getWidth(),f=y=>{if(y!==this._element&&window.innerWidth>y.clientWidth+a)return;this._saveInitialAttribute(y,r);const s=window.getComputedStyle(y).getPropertyValue(r);y.style.setProperty(r,`${i(Number.parseFloat(s))}px`)};this._applyManipulationCallback(e,f)}_saveInitialAttribute(e,r){const i=e.style.getPropertyValue(r);i&&mr.setDataAttribute(e,r,i)}_resetElementAttributes(e,r){const i=a=>{const f=mr.getDataAttribute(a,r);if(f===null){a.style.removeProperty(r);return}mr.removeDataAttribute(a,r),a.style.setProperty(r,f)};this._applyManipulationCallback(e,i)}_applyManipulationCallback(e,r){if(gr(e)){r(e);return}for(const i of Te.find(e,this._element))r(i)}}const Pm="modal",Mm="bs.modal",$t=`.${Mm}`,Im=".data-api",Bm="Escape",Nm=`hide${$t}`,Hm=`hidePrevented${$t}`,Hu=`hidden${$t}`,$u=`show${$t}`,$m=`shown${$t}`,Fm=`resize${$t}`,jm=`click.dismiss${$t}`,Um=`mousedown.dismiss${$t}`,Wm=`keydown.dismiss${$t}`,zm=`click${$t}${Im}`,Jc="modal-open",Vm="fade",Qc="show",to="modal-static",qm=".modal.show",Km=".modal-dialog",Gm=".modal-body",Ym='[data-bs-toggle="modal"]',Xm={backdrop:!0,focus:!0,keyboard:!0},Jm={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class wi extends Yt{constructor(e,r){super(e,r),this._dialog=Te.findOne(Km,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Xo,this._addEventListeners()}static get Default(){return Xm}static get DefaultType(){return Jm}static get NAME(){return Pm}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||ce.trigger(this._element,$u,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Jc),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||ce.trigger(this._element,Nm).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Qc),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){ce.off(window,$t),ce.off(this._dialog,$t),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Bu({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Nu({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const r=Te.findOne(Gm,this._dialog);r&&(r.scrollTop=0),un(this._element),this._element.classList.add(Qc);const i=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,ce.trigger(this._element,$m,{relatedTarget:e})};this._queueCallback(i,this._dialog,this._isAnimated())}_addEventListeners(){ce.on(this._element,Wm,e=>{if(e.key===Bm){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),ce.on(window,Fm,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),ce.on(this._element,Um,e=>{ce.one(this._element,jm,r=>{if(!(this._element!==e.target||this._element!==r.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Jc),this._resetAdjustments(),this._scrollBar.reset(),ce.trigger(this._element,Hu)})}_isAnimated(){return this._element.classList.contains(Vm)}_triggerBackdropTransition(){if(ce.trigger(this._element,Hm).defaultPrevented)return;const r=this._element.scrollHeight>document.documentElement.clientHeight,i=this._element.style.overflowY;i==="hidden"||this._element.classList.contains(to)||(r||(this._element.style.overflowY="hidden"),this._element.classList.add(to),this._queueCallback(()=>{this._element.classList.remove(to),this._queueCallback(()=>{this._element.style.overflowY=i},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,r=this._scrollBar.getWidth(),i=r>0;if(i&&!e){const a=Ht()?"paddingLeft":"paddingRight";this._element.style[a]=`${r}px`}if(!i&&e){const a=Ht()?"paddingRight":"paddingLeft";this._element.style[a]=`${r}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,r){return this.each(function(){const i=wi.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof i[e]>"u")throw new TypeError(`No method named "${e}"`);i[e](r)}})}}ce.on(document,zm,Ym,function(t){const e=Te.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&t.preventDefault(),ce.one(e,$u,a=>{a.defaultPrevented||ce.one(e,Hu,()=>{xi(this)&&this.focus()})});const r=Te.findOne(qm);r&&wi.getInstance(r).hide(),wi.getOrCreateInstance(e).toggle(this)});vs(wi);jt(wi);const Qm="offcanvas",Zm="bs.offcanvas",Sr=`.${Zm}`,Fu=".data-api",ev=`load${Sr}${Fu}`,tv="Escape",Zc="show",el="showing",tl="hiding",rv="offcanvas-backdrop",ju=".offcanvas.show",iv=`show${Sr}`,nv=`shown${Sr}`,sv=`hide${Sr}`,rl=`hidePrevented${Sr}`,Uu=`hidden${Sr}`,ov=`resize${Sr}`,av=`click${Sr}${Fu}`,cv=`keydown.dismiss${Sr}`,lv='[data-bs-toggle="offcanvas"]',hv={backdrop:!0,keyboard:!0,scroll:!1},uv={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Mr extends Yt{constructor(e,r){super(e,r),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return hv}static get DefaultType(){return uv}static get NAME(){return Qm}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||ce.trigger(this._element,iv,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Xo().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(el);const i=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Zc),this._element.classList.remove(el),ce.trigger(this._element,nv,{relatedTarget:e})};this._queueCallback(i,this._element,!0)}hide(){if(!this._isShown||ce.trigger(this._element,sv).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(tl),this._backdrop.hide();const r=()=>{this._element.classList.remove(Zc,tl),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Xo().reset(),ce.trigger(this._element,Uu)};this._queueCallback(r,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){ce.trigger(this._element,rl);return}this.hide()},r=!!this._config.backdrop;return new Bu({className:rv,isVisible:r,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:r?e:null})}_initializeFocusTrap(){return new Nu({trapElement:this._element})}_addEventListeners(){ce.on(this._element,cv,e=>{if(e.key===tv){if(this._config.keyboard){this.hide();return}ce.trigger(this._element,rl)}})}static jQueryInterface(e){return this.each(function(){const r=Mr.getOrCreateInstance(this,e);if(typeof e=="string"){if(r[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);r[e](this)}})}}ce.on(document,av,lv,function(t){const e=Te.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&t.preventDefault(),Pr(this))return;ce.one(e,Uu,()=>{xi(this)&&this.focus()});const r=Te.findOne(ju);r&&r!==e&&Mr.getInstance(r).hide(),Mr.getOrCreateInstance(e).toggle(this)});ce.on(window,ev,()=>{for(const t of Te.find(ju))Mr.getOrCreateInstance(t).show()});ce.on(window,ov,()=>{for(const t of Te.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(t).position!=="fixed"&&Mr.getOrCreateInstance(t).hide()});vs(Mr);jt(Mr);const fv=/^aria-[\w-]*$/i,Wu={"*":["class","dir","id","lang","role",fv],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},dv=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),pv=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,_v=(t,e)=>{const r=t.nodeName.toLowerCase();return e.includes(r)?dv.has(r)?!!pv.test(t.nodeValue):!0:e.filter(i=>i instanceof RegExp).some(i=>i.test(r))};function gv(t,e,r){if(!t.length)return t;if(r&&typeof r=="function")return r(t);const a=new window.DOMParser().parseFromString(t,"text/html"),f=[].concat(...a.body.querySelectorAll("*"));for(const y of f){const s=y.nodeName.toLowerCase();if(!Object.keys(e).includes(s)){y.remove();continue}const o=[].concat(...y.attributes),c=[].concat(e["*"]||[],e[s]||[]);for(const d of o)_v(d,c)||y.removeAttribute(d.nodeName)}return a.body.innerHTML}const mv="TemplateFactory",vv={allowList:Wu,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},yv={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Sv={entry:"(string|element|function|null)",selector:"(string|element)"};class bv extends fn{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return vv}static get DefaultType(){return yv}static get NAME(){return mv}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[a,f]of Object.entries(this._config.content))this._setContent(e,f,a);const r=e.children[0],i=this._resolvePossibleFunction(this._config.extraClass);return i&&r.classList.add(...i.split(" ")),r}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[r,i]of Object.entries(e))super._typeCheckConfig({selector:r,entry:i},Sv)}_setContent(e,r,i){const a=Te.findOne(i,e);if(a){if(r=this._resolvePossibleFunction(r),!r){a.remove();return}if(gr(r)){this._putElementInTemplate(Or(r),a);return}if(this._config.html){a.innerHTML=this._maybeSanitize(r);return}a.textContent=r}}_maybeSanitize(e){return this._config.sanitize?gv(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ct(e,[this])}_putElementInTemplate(e,r){if(this._config.html){r.innerHTML="",r.append(e);return}r.textContent=e.textContent}}const Cv="tooltip",Ev=new Set(["sanitize","allowList","sanitizeFn"]),ro="fade",Tv="modal",Bn="show",wv=".tooltip-inner",il=`.${Tv}`,nl="hide.bs.modal",Vi="hover",io="focus",kv="click",Av="manual",Rv="hide",xv="hidden",Dv="show",Lv="shown",Ov="inserted",Pv="click",Mv="focusin",Iv="focusout",Bv="mouseenter",Nv="mouseleave",Hv={AUTO:"auto",TOP:"top",RIGHT:Ht()?"left":"right",BOTTOM:"bottom",LEFT:Ht()?"right":"left"},$v={allowList:Wu,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Fv={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class yr extends Yt{constructor(e,r){if(typeof gu>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(e,r),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return $v}static get DefaultType(){return Fv}static get NAME(){return Cv}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),ce.off(this._element.closest(il),nl,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=ce.trigger(this._element,this.constructor.eventName(Dv)),i=(yu(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!i)return;this._disposePopper();const a=this._getTipElement();this._element.setAttribute("aria-describedby",a.getAttribute("id"));const{container:f}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(f.append(a),ce.trigger(this._element,this.constructor.eventName(Ov))),this._popper=this._createPopper(a),a.classList.add(Bn),"ontouchstart"in document.documentElement)for(const s of[].concat(...document.body.children))ce.on(s,"mouseover",os);const y=()=>{ce.trigger(this._element,this.constructor.eventName(Lv)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(y,this.tip,this._isAnimated())}hide(){if(!this._isShown()||ce.trigger(this._element,this.constructor.eventName(Rv)).defaultPrevented)return;if(this._getTipElement().classList.remove(Bn),"ontouchstart"in document.documentElement)for(const a of[].concat(...document.body.children))ce.off(a,"mouseover",os);this._activeTrigger[kv]=!1,this._activeTrigger[io]=!1,this._activeTrigger[Vi]=!1,this._isHovered=null;const i=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),ce.trigger(this._element,this.constructor.eventName(xv)))};this._queueCallback(i,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const r=this._getTemplateFactory(e).toHtml();if(!r)return null;r.classList.remove(ro,Bn),r.classList.add(`bs-${this.constructor.NAME}-auto`);const i=k_(this.constructor.NAME).toString();return r.setAttribute("id",i),this._isAnimated()&&r.classList.add(ro),r}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new bv({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[wv]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(ro)}_isShown(){return this.tip&&this.tip.classList.contains(Bn)}_createPopper(e){const r=Ct(this._config.placement,[this,e,this._element]),i=Hv[r.toUpperCase()];return wa(this._element,e,this._getPopperConfig(i))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(r=>Number.parseInt(r,10)):typeof e=="function"?r=>e(r,this._element):e}_resolvePossibleFunction(e){return Ct(e,[this._element])}_getPopperConfig(e){const r={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:i=>{this._getTipElement().setAttribute("data-popper-placement",i.state.placement)}}]};return{...r,...Ct(this._config.popperConfig,[r])}}_setListeners(){const e=this._config.trigger.split(" ");for(const r of e)if(r==="click")ce.on(this._element,this.constructor.eventName(Pv),this._config.selector,i=>{this._initializeOnDelegatedTarget(i).toggle()});else if(r!==Av){const i=r===Vi?this.constructor.eventName(Bv):this.constructor.eventName(Mv),a=r===Vi?this.constructor.eventName(Nv):this.constructor.eventName(Iv);ce.on(this._element,i,this._config.selector,f=>{const y=this._initializeOnDelegatedTarget(f);y._activeTrigger[f.type==="focusin"?io:Vi]=!0,y._enter()}),ce.on(this._element,a,this._config.selector,f=>{const y=this._initializeOnDelegatedTarget(f);y._activeTrigger[f.type==="focusout"?io:Vi]=y._element.contains(f.relatedTarget),y._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},ce.on(this._element.closest(il),nl,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,r){clearTimeout(this._timeout),this._timeout=setTimeout(e,r)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const r=mr.getDataAttributes(this._element);for(const i of Object.keys(r))Ev.has(i)&&delete r[i];return e={...r,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Or(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[r,i]of Object.entries(this._config))this.constructor.Default[r]!==i&&(e[r]=i);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const r=yr.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof r[e]>"u")throw new TypeError(`No method named "${e}"`);r[e]()}})}}jt(yr);const jv="popover",Uv=".popover-header",Wv=".popover-body",zv={...yr.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Vv={...yr.DefaultType,content:"(null|string|element|function)"};class xa extends yr{static get Default(){return zv}static get DefaultType(){return Vv}static get NAME(){return jv}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Uv]:this._getTitle(),[Wv]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const r=xa.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof r[e]>"u")throw new TypeError(`No method named "${e}"`);r[e]()}})}}jt(xa);const qv="scrollspy",Kv="bs.scrollspy",Da=`.${Kv}`,Gv=".data-api",Yv=`activate${Da}`,sl=`click${Da}`,Xv=`load${Da}${Gv}`,Jv="dropdown-item",fi="active",Qv='[data-bs-spy="scroll"]',no="[href]",Zv=".nav, .list-group",ol=".nav-link",ey=".nav-item",ty=".list-group-item",ry=`${ol}, ${ey} > ${ol}, ${ty}`,iy=".dropdown",ny=".dropdown-toggle",sy={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},oy={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class bs extends Yt{constructor(e,r){super(e,r),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return sy}static get DefaultType(){return oy}static get NAME(){return qv}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Or(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(r=>Number.parseFloat(r))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(ce.off(this._config.target,sl),ce.on(this._config.target,sl,no,e=>{const r=this._observableSections.get(e.target.hash);if(r){e.preventDefault();const i=this._rootElement||window,a=r.offsetTop-this._element.offsetTop;if(i.scrollTo){i.scrollTo({top:a,behavior:"smooth"});return}i.scrollTop=a}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(r=>this._observerCallback(r),e)}_observerCallback(e){const r=y=>this._targetLinks.get(`#${y.target.id}`),i=y=>{this._previousScrollData.visibleEntryTop=y.target.offsetTop,this._process(r(y))},a=(this._rootElement||document.documentElement).scrollTop,f=a>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=a;for(const y of e){if(!y.isIntersecting){this._activeTarget=null,this._clearActiveClass(r(y));continue}const s=y.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(f&&s){if(i(y),!a)return;continue}!f&&!s&&i(y)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=Te.find(no,this._config.target);for(const r of e){if(!r.hash||Pr(r))continue;const i=Te.findOne(decodeURI(r.hash),this._element);xi(i)&&(this._targetLinks.set(decodeURI(r.hash),r),this._observableSections.set(r.hash,i))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(fi),this._activateParents(e),ce.trigger(this._element,Yv,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Jv)){Te.findOne(ny,e.closest(iy)).classList.add(fi);return}for(const r of Te.parents(e,Zv))for(const i of Te.prev(r,ry))i.classList.add(fi)}_clearActiveClass(e){e.classList.remove(fi);const r=Te.find(`${no}.${fi}`,e);for(const i of r)i.classList.remove(fi)}static jQueryInterface(e){return this.each(function(){const r=bs.getOrCreateInstance(this,e);if(typeof e=="string"){if(r[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);r[e]()}})}}ce.on(window,Xv,()=>{for(const t of Te.find(Qv))bs.getOrCreateInstance(t)});jt(bs);const ay="tab",cy="bs.tab",Zr=`.${cy}`,ly=`hide${Zr}`,hy=`hidden${Zr}`,uy=`show${Zr}`,fy=`shown${Zr}`,dy=`click${Zr}`,py=`keydown${Zr}`,_y=`load${Zr}`,gy="ArrowLeft",al="ArrowRight",my="ArrowUp",cl="ArrowDown",so="Home",ll="End",Kr="active",hl="fade",oo="show",vy="dropdown",yy=".dropdown-toggle",Sy=".dropdown-menu",ao=":not(.dropdown-toggle)",by='.list-group, .nav, [role="tablist"]',Cy=".nav-item, .list-group-item",Ey=`.nav-link${ao}, .list-group-item${ao}, [role="tab"]${ao}`,zu='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',co=`${Ey}, ${zu}`,Ty=`.${Kr}[data-bs-toggle="tab"], .${Kr}[data-bs-toggle="pill"], .${Kr}[data-bs-toggle="list"]`;class ki extends Yt{constructor(e){super(e),this._parent=this._element.closest(by),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),ce.on(this._element,py,r=>this._keydown(r)))}static get NAME(){return ay}show(){const e=this._element;if(this._elemIsActive(e))return;const r=this._getActiveElem(),i=r?ce.trigger(r,ly,{relatedTarget:e}):null;ce.trigger(e,uy,{relatedTarget:r}).defaultPrevented||i&&i.defaultPrevented||(this._deactivate(r,e),this._activate(e,r))}_activate(e,r){if(!e)return;e.classList.add(Kr),this._activate(Te.getElementFromSelector(e));const i=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(oo);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),ce.trigger(e,fy,{relatedTarget:r})};this._queueCallback(i,e,e.classList.contains(hl))}_deactivate(e,r){if(!e)return;e.classList.remove(Kr),e.blur(),this._deactivate(Te.getElementFromSelector(e));const i=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(oo);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),ce.trigger(e,hy,{relatedTarget:r})};this._queueCallback(i,e,e.classList.contains(hl))}_keydown(e){if(![gy,al,my,cl,so,ll].includes(e.key))return;e.stopPropagation(),e.preventDefault();const r=this._getChildren().filter(a=>!Pr(a));let i;if([so,ll].includes(e.key))i=r[e.key===so?0:r.length-1];else{const a=[al,cl].includes(e.key);i=ka(r,e.target,a,!0)}i&&(i.focus({preventScroll:!0}),ki.getOrCreateInstance(i).show())}_getChildren(){return Te.find(co,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,r){this._setAttributeIfNotExists(e,"role","tablist");for(const i of r)this._setInitialAttributesOnChild(i)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const r=this._elemIsActive(e),i=this._getOuterElement(e);e.setAttribute("aria-selected",r),i!==e&&this._setAttributeIfNotExists(i,"role","presentation"),r||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const r=Te.getElementFromSelector(e);r&&(this._setAttributeIfNotExists(r,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(r,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,r){const i=this._getOuterElement(e);if(!i.classList.contains(vy))return;const a=(f,y)=>{const s=Te.findOne(f,i);s&&s.classList.toggle(y,r)};a(yy,Kr),a(Sy,oo),i.setAttribute("aria-expanded",r)}_setAttributeIfNotExists(e,r,i){e.hasAttribute(r)||e.setAttribute(r,i)}_elemIsActive(e){return e.classList.contains(Kr)}_getInnerElement(e){return e.matches(co)?e:Te.findOne(co,e)}_getOuterElement(e){return e.closest(Cy)||e}static jQueryInterface(e){return this.each(function(){const r=ki.getOrCreateInstance(this);if(typeof e=="string"){if(r[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);r[e]()}})}}ce.on(document,dy,zu,function(t){["A","AREA"].includes(this.tagName)&&t.preventDefault(),!Pr(this)&&ki.getOrCreateInstance(this).show()});ce.on(window,_y,()=>{for(const t of Te.find(Ty))ki.getOrCreateInstance(t)});jt(ki);const wy="toast",ky="bs.toast",Nr=`.${ky}`,Ay=`mouseover${Nr}`,Ry=`mouseout${Nr}`,xy=`focusin${Nr}`,Dy=`focusout${Nr}`,Ly=`hide${Nr}`,Oy=`hidden${Nr}`,Py=`show${Nr}`,My=`shown${Nr}`,Iy="fade",ul="hide",Nn="show",Hn="showing",By={animation:"boolean",autohide:"boolean",delay:"number"},Ny={animation:!0,autohide:!0,delay:5e3};class Cs extends Yt{constructor(e,r){super(e,r),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Ny}static get DefaultType(){return By}static get NAME(){return wy}show(){if(ce.trigger(this._element,Py).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Iy);const r=()=>{this._element.classList.remove(Hn),ce.trigger(this._element,My),this._maybeScheduleHide()};this._element.classList.remove(ul),un(this._element),this._element.classList.add(Nn,Hn),this._queueCallback(r,this._element,this._config.animation)}hide(){if(!this.isShown()||ce.trigger(this._element,Ly).defaultPrevented)return;const r=()=>{this._element.classList.add(ul),this._element.classList.remove(Hn,Nn),ce.trigger(this._element,Oy)};this._element.classList.add(Hn),this._queueCallback(r,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Nn),super.dispose()}isShown(){return this._element.classList.contains(Nn)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,r){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=r;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=r;break}}if(r){this._clearTimeout();return}const i=e.relatedTarget;this._element===i||this._element.contains(i)||this._maybeScheduleHide()}_setListeners(){ce.on(this._element,Ay,e=>this._onInteraction(e,!0)),ce.on(this._element,Ry,e=>this._onInteraction(e,!1)),ce.on(this._element,xy,e=>this._onInteraction(e,!0)),ce.on(this._element,Dy,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const r=Cs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof r[e]>"u")throw new TypeError(`No method named "${e}"`);r[e](this)}})}}vs(Cs);jt(Cs);var Vu={exports:{}};/*!
 * jQuery JavaScript Library v3.7.0
 * https://jquery.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2023-05-11T18:29Z
 */(function(t){(function(e,r){t.exports=e.document?r(e,!0):function(i){if(!i.document)throw new Error("jQuery requires a window with a document");return r(i)}})(typeof window<"u"?window:Nf,function(e,r){var i=[],a=Object.getPrototypeOf,f=i.slice,y=i.flat?function(n){return i.flat.call(n)}:function(n){return i.concat.apply([],n)},s=i.push,o=i.indexOf,c={},d=c.toString,_=c.hasOwnProperty,v=_.toString,E=v.call(Object),C={},S=function(u){return typeof u=="function"&&typeof u.nodeType!="number"&&typeof u.item!="function"},h=function(u){return u!=null&&u===u.window},p=e.document,g={type:!0,src:!0,nonce:!0,noModule:!0};function m(n,u,b){b=b||p;var A,D,L=b.createElement("script");if(L.text=n,u)for(A in g)D=u[A]||u.getAttribute&&u.getAttribute(A),D&&L.setAttribute(A,D);b.head.appendChild(L).parentNode.removeChild(L)}function T(n){return n==null?n+"":typeof n=="object"||typeof n=="function"?c[d.call(n)]||"object":typeof n}var w="3.7.0",R=/HTML$/i,l=function(n,u){return new l.fn.init(n,u)};l.fn=l.prototype={jquery:w,constructor:l,length:0,toArray:function(){return f.call(this)},get:function(n){return n==null?f.call(this):n<0?this[n+this.length]:this[n]},pushStack:function(n){var u=l.merge(this.constructor(),n);return u.prevObject=this,u},each:function(n){return l.each(this,n)},map:function(n){return this.pushStack(l.map(this,function(u,b){return n.call(u,b,u)}))},slice:function(){return this.pushStack(f.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(l.grep(this,function(n,u){return(u+1)%2}))},odd:function(){return this.pushStack(l.grep(this,function(n,u){return u%2}))},eq:function(n){var u=this.length,b=+n+(n<0?u:0);return this.pushStack(b>=0&&b<u?[this[b]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:i.sort,splice:i.splice},l.extend=l.fn.extend=function(){var n,u,b,A,D,L,O=arguments[0]||{},U=1,H=arguments.length,G=!1;for(typeof O=="boolean"&&(G=O,O=arguments[U]||{},U++),typeof O!="object"&&!S(O)&&(O={}),U===H&&(O=this,U--);U<H;U++)if((n=arguments[U])!=null)for(u in n)A=n[u],!(u==="__proto__"||O===A)&&(G&&A&&(l.isPlainObject(A)||(D=Array.isArray(A)))?(b=O[u],D&&!Array.isArray(b)?L=[]:!D&&!l.isPlainObject(b)?L={}:L=b,D=!1,O[u]=l.extend(G,L,A)):A!==void 0&&(O[u]=A));return O},l.extend({expando:"jQuery"+(w+Math.random()).replace(/\D/g,""),isReady:!0,error:function(n){throw new Error(n)},noop:function(){},isPlainObject:function(n){var u,b;return!n||d.call(n)!=="[object Object]"?!1:(u=a(n),u?(b=_.call(u,"constructor")&&u.constructor,typeof b=="function"&&v.call(b)===E):!0)},isEmptyObject:function(n){var u;for(u in n)return!1;return!0},globalEval:function(n,u,b){m(n,{nonce:u&&u.nonce},b)},each:function(n,u){var b,A=0;if(k(n))for(b=n.length;A<b&&u.call(n[A],A,n[A])!==!1;A++);else for(A in n)if(u.call(n[A],A,n[A])===!1)break;return n},text:function(n){var u,b="",A=0,D=n.nodeType;if(D){if(D===1||D===9||D===11)return n.textContent;if(D===3||D===4)return n.nodeValue}else for(;u=n[A++];)b+=l.text(u);return b},makeArray:function(n,u){var b=u||[];return n!=null&&(k(Object(n))?l.merge(b,typeof n=="string"?[n]:n):s.call(b,n)),b},inArray:function(n,u,b){return u==null?-1:o.call(u,n,b)},isXMLDoc:function(n){var u=n&&n.namespaceURI,b=n&&(n.ownerDocument||n).documentElement;return!R.test(u||b&&b.nodeName||"HTML")},merge:function(n,u){for(var b=+u.length,A=0,D=n.length;A<b;A++)n[D++]=u[A];return n.length=D,n},grep:function(n,u,b){for(var A,D=[],L=0,O=n.length,U=!b;L<O;L++)A=!u(n[L],L),A!==U&&D.push(n[L]);return D},map:function(n,u,b){var A,D,L=0,O=[];if(k(n))for(A=n.length;L<A;L++)D=u(n[L],L,b),D!=null&&O.push(D);else for(L in n)D=u(n[L],L,b),D!=null&&O.push(D);return y(O)},guid:1,support:C}),typeof Symbol=="function"&&(l.fn[Symbol.iterator]=i[Symbol.iterator]),l.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(n,u){c["[object "+u+"]"]=u.toLowerCase()});function k(n){var u=!!n&&"length"in n&&n.length,b=T(n);return S(n)||h(n)?!1:b==="array"||u===0||typeof u=="number"&&u>0&&u-1 in n}function x(n,u){return n.nodeName&&n.nodeName.toLowerCase()===u.toLowerCase()}var M=i.pop,$=i.sort,B=i.splice,N="[\\x20\\t\\r\\n\\f]",ee=new RegExp("^"+N+"+|((?:^|[^\\\\])(?:\\\\.)*)"+N+"+$","g");l.contains=function(n,u){var b=u&&u.parentNode;return n===b||!!(b&&b.nodeType===1&&(n.contains?n.contains(b):n.compareDocumentPosition&&n.compareDocumentPosition(b)&16))};var ue=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function se(n,u){return u?n==="\0"?"":n.slice(0,-1)+"\\"+n.charCodeAt(n.length-1).toString(16)+" ":"\\"+n}l.escapeSelector=function(n){return(n+"").replace(ue,se)};var P=p,F=s;(function(){var n,u,b,A,D,L=F,O,U,H,G,Z,ne=l.expando,J=0,le=0,Re=En(),Ne=En(),De=En(),et=En(),Ze=function(I,V){return I===V&&(D=!0),0},Qt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Zt="(?:\\\\[\\da-fA-F]{1,6}"+N+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",Be="\\["+N+"*("+Zt+")(?:"+N+"*([*^$|!~]?=)"+N+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+Zt+"))|)"+N+"*\\]",Ur=":("+Zt+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Be+")*)|.*)\\)|)",He=new RegExp(N+"+","g"),Ge=new RegExp("^"+N+"*,"+N+"*"),$i=new RegExp("^"+N+"*([>+~]|"+N+")"+N+"*"),Ms=new RegExp(N+"|>"),er=new RegExp(Ur),Fi=new RegExp("^"+Zt+"$"),tr={ID:new RegExp("^#("+Zt+")"),CLASS:new RegExp("^\\.("+Zt+")"),TAG:new RegExp("^("+Zt+"|[*])"),ATTR:new RegExp("^"+Be),PSEUDO:new RegExp("^"+Ur),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+N+"*(even|odd|(([+-]|)(\\d*)n|)"+N+"*(?:([+-]|)"+N+"*(\\d+)|))"+N+"*\\)|)","i"),bool:new RegExp("^(?:"+Qt+")$","i"),needsContext:new RegExp("^"+N+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+N+"*((?:-\\d)?\\d*)"+N+"*\\)|)(?=[^-]|$)","i")},Ar=/^(?:input|select|textarea|button)$/i,Rr=/^h\d$/i,Mt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Is=/[+~]/,ur=new RegExp("\\\\[\\da-fA-F]{1,6}"+N+"?|\\\\([^\\r\\n\\f])","g"),fr=function(I,V){var X="0x"+I.slice(1)-65536;return V||(X<0?String.fromCharCode(X+65536):String.fromCharCode(X>>10|55296,X&1023|56320))},Rf=function(){xr()},xf=kn(function(I){return I.disabled===!0&&x(I,"fieldset")},{dir:"parentNode",next:"legend"});function Df(){try{return O.activeElement}catch{}}try{L.apply(i=f.call(P.childNodes),P.childNodes),i[P.childNodes.length].nodeType}catch{L={apply:function(V,X){F.apply(V,f.call(X))},call:function(V){F.apply(V,f.call(arguments,1))}}}function We(I,V,X,Q){var ie,fe,ve,Ce,ye,Me,Ae,xe=V&&V.ownerDocument,Ie=V?V.nodeType:9;if(X=X||[],typeof I!="string"||!I||Ie!==1&&Ie!==9&&Ie!==11)return X;if(!Q&&(xr(V),V=V||O,H)){if(Ie!==11&&(ye=Mt.exec(I)))if(ie=ye[1]){if(Ie===9)if(ve=V.getElementById(ie)){if(ve.id===ie)return L.call(X,ve),X}else return X;else if(xe&&(ve=xe.getElementById(ie))&&We.contains(V,ve)&&ve.id===ie)return L.call(X,ve),X}else{if(ye[2])return L.apply(X,V.getElementsByTagName(I)),X;if((ie=ye[3])&&V.getElementsByClassName)return L.apply(X,V.getElementsByClassName(ie)),X}if(!et[I+" "]&&(!G||!G.test(I))){if(Ae=I,xe=V,Ie===1&&(Ms.test(I)||$i.test(I))){for(xe=Is.test(I)&&Bs(V.parentNode)||V,(xe!=V||!C.scope)&&((Ce=V.getAttribute("id"))?Ce=l.escapeSelector(Ce):V.setAttribute("id",Ce=ne)),Me=Tn(I),fe=Me.length;fe--;)Me[fe]=(Ce?"#"+Ce:":scope")+" "+wn(Me[fe]);Ae=Me.join(",")}try{return L.apply(X,xe.querySelectorAll(Ae)),X}catch{et(I,!0)}finally{Ce===ne&&V.removeAttribute("id")}}}return Xa(I.replace(ee,"$1"),V,X,Q)}function En(){var I=[];function V(X,Q){return I.push(X+" ")>u.cacheLength&&delete V[I.shift()],V[X+" "]=Q}return V}function Vt(I){return I[ne]=!0,I}function ci(I){var V=O.createElement("fieldset");try{return!!I(V)}catch{return!1}finally{V.parentNode&&V.parentNode.removeChild(V),V=null}}function Lf(I){return function(V){return x(V,"input")&&V.type===I}}function Of(I){return function(V){return(x(V,"input")||x(V,"button"))&&V.type===I}}function Ga(I){return function(V){return"form"in V?V.parentNode&&V.disabled===!1?"label"in V?"label"in V.parentNode?V.parentNode.disabled===I:V.disabled===I:V.isDisabled===I||V.isDisabled!==!I&&xf(V)===I:V.disabled===I:"label"in V?V.disabled===I:!1}}function Wr(I){return Vt(function(V){return V=+V,Vt(function(X,Q){for(var ie,fe=I([],X.length,V),ve=fe.length;ve--;)X[ie=fe[ve]]&&(X[ie]=!(Q[ie]=X[ie]))})})}function Bs(I){return I&&typeof I.getElementsByTagName<"u"&&I}function xr(I){var V,X=I?I.ownerDocument||I:P;return X==O||X.nodeType!==9||!X.documentElement||(O=X,U=O.documentElement,H=!l.isXMLDoc(O),Z=U.matches||U.webkitMatchesSelector||U.msMatchesSelector,P!=O&&(V=O.defaultView)&&V.top!==V&&V.addEventListener("unload",Rf),C.getById=ci(function(Q){return U.appendChild(Q).id=l.expando,!O.getElementsByName||!O.getElementsByName(l.expando).length}),C.disconnectedMatch=ci(function(Q){return Z.call(Q,"*")}),C.scope=ci(function(){return O.querySelectorAll(":scope")}),C.cssHas=ci(function(){try{return O.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),C.getById?(u.filter.ID=function(Q){var ie=Q.replace(ur,fr);return function(fe){return fe.getAttribute("id")===ie}},u.find.ID=function(Q,ie){if(typeof ie.getElementById<"u"&&H){var fe=ie.getElementById(Q);return fe?[fe]:[]}}):(u.filter.ID=function(Q){var ie=Q.replace(ur,fr);return function(fe){var ve=typeof fe.getAttributeNode<"u"&&fe.getAttributeNode("id");return ve&&ve.value===ie}},u.find.ID=function(Q,ie){if(typeof ie.getElementById<"u"&&H){var fe,ve,Ce,ye=ie.getElementById(Q);if(ye){if(fe=ye.getAttributeNode("id"),fe&&fe.value===Q)return[ye];for(Ce=ie.getElementsByName(Q),ve=0;ye=Ce[ve++];)if(fe=ye.getAttributeNode("id"),fe&&fe.value===Q)return[ye]}return[]}}),u.find.TAG=function(Q,ie){return typeof ie.getElementsByTagName<"u"?ie.getElementsByTagName(Q):ie.querySelectorAll(Q)},u.find.CLASS=function(Q,ie){if(typeof ie.getElementsByClassName<"u"&&H)return ie.getElementsByClassName(Q)},G=[],ci(function(Q){var ie;U.appendChild(Q).innerHTML="<a id='"+ne+"' href='' disabled='disabled'></a><select id='"+ne+"-\r\\' disabled='disabled'><option selected=''></option></select>",Q.querySelectorAll("[selected]").length||G.push("\\["+N+"*(?:value|"+Qt+")"),Q.querySelectorAll("[id~="+ne+"-]").length||G.push("~="),Q.querySelectorAll("a#"+ne+"+*").length||G.push(".#.+[+~]"),Q.querySelectorAll(":checked").length||G.push(":checked"),ie=O.createElement("input"),ie.setAttribute("type","hidden"),Q.appendChild(ie).setAttribute("name","D"),U.appendChild(Q).disabled=!0,Q.querySelectorAll(":disabled").length!==2&&G.push(":enabled",":disabled"),ie=O.createElement("input"),ie.setAttribute("name",""),Q.appendChild(ie),Q.querySelectorAll("[name='']").length||G.push("\\["+N+"*name"+N+"*="+N+`*(?:''|"")`)}),C.cssHas||G.push(":has"),G=G.length&&new RegExp(G.join("|")),Ze=function(Q,ie){if(Q===ie)return D=!0,0;var fe=!Q.compareDocumentPosition-!ie.compareDocumentPosition;return fe||(fe=(Q.ownerDocument||Q)==(ie.ownerDocument||ie)?Q.compareDocumentPosition(ie):1,fe&1||!C.sortDetached&&ie.compareDocumentPosition(Q)===fe?Q===O||Q.ownerDocument==P&&We.contains(P,Q)?-1:ie===O||ie.ownerDocument==P&&We.contains(P,ie)?1:A?o.call(A,Q)-o.call(A,ie):0:fe&4?-1:1)}),O}We.matches=function(I,V){return We(I,null,null,V)},We.matchesSelector=function(I,V){if(xr(I),H&&!et[V+" "]&&(!G||!G.test(V)))try{var X=Z.call(I,V);if(X||C.disconnectedMatch||I.document&&I.document.nodeType!==11)return X}catch{et(V,!0)}return We(V,O,null,[I]).length>0},We.contains=function(I,V){return(I.ownerDocument||I)!=O&&xr(I),l.contains(I,V)},We.attr=function(I,V){(I.ownerDocument||I)!=O&&xr(I);var X=u.attrHandle[V.toLowerCase()],Q=X&&_.call(u.attrHandle,V.toLowerCase())?X(I,V,!H):void 0;return Q!==void 0?Q:I.getAttribute(V)},We.error=function(I){throw new Error("Syntax error, unrecognized expression: "+I)},l.uniqueSort=function(I){var V,X=[],Q=0,ie=0;if(D=!C.sortStable,A=!C.sortStable&&f.call(I,0),$.call(I,Ze),D){for(;V=I[ie++];)V===I[ie]&&(Q=X.push(ie));for(;Q--;)B.call(I,X[Q],1)}return A=null,I},l.fn.uniqueSort=function(){return this.pushStack(l.uniqueSort(f.apply(this)))},u=l.expr={cacheLength:50,createPseudo:Vt,match:tr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(I){return I[1]=I[1].replace(ur,fr),I[3]=(I[3]||I[4]||I[5]||"").replace(ur,fr),I[2]==="~="&&(I[3]=" "+I[3]+" "),I.slice(0,4)},CHILD:function(I){return I[1]=I[1].toLowerCase(),I[1].slice(0,3)==="nth"?(I[3]||We.error(I[0]),I[4]=+(I[4]?I[5]+(I[6]||1):2*(I[3]==="even"||I[3]==="odd")),I[5]=+(I[7]+I[8]||I[3]==="odd")):I[3]&&We.error(I[0]),I},PSEUDO:function(I){var V,X=!I[6]&&I[2];return tr.CHILD.test(I[0])?null:(I[3]?I[2]=I[4]||I[5]||"":X&&er.test(X)&&(V=Tn(X,!0))&&(V=X.indexOf(")",X.length-V)-X.length)&&(I[0]=I[0].slice(0,V),I[2]=X.slice(0,V)),I.slice(0,3))}},filter:{TAG:function(I){var V=I.replace(ur,fr).toLowerCase();return I==="*"?function(){return!0}:function(X){return x(X,V)}},CLASS:function(I){var V=Re[I+" "];return V||(V=new RegExp("(^|"+N+")"+I+"("+N+"|$)"))&&Re(I,function(X){return V.test(typeof X.className=="string"&&X.className||typeof X.getAttribute<"u"&&X.getAttribute("class")||"")})},ATTR:function(I,V,X){return function(Q){var ie=We.attr(Q,I);return ie==null?V==="!=":V?(ie+="",V==="="?ie===X:V==="!="?ie!==X:V==="^="?X&&ie.indexOf(X)===0:V==="*="?X&&ie.indexOf(X)>-1:V==="$="?X&&ie.slice(-X.length)===X:V==="~="?(" "+ie.replace(He," ")+" ").indexOf(X)>-1:V==="|="?ie===X||ie.slice(0,X.length+1)===X+"-":!1):!0}},CHILD:function(I,V,X,Q,ie){var fe=I.slice(0,3)!=="nth",ve=I.slice(-4)!=="last",Ce=V==="of-type";return Q===1&&ie===0?function(ye){return!!ye.parentNode}:function(ye,Me,Ae){var xe,Ie,we,Ve,yt,ot=fe!==ve?"nextSibling":"previousSibling",It=ye.parentNode,rr=Ce&&ye.nodeName.toLowerCase(),li=!Ae&&!Ce,ft=!1;if(It){if(fe){for(;ot;){for(we=ye;we=we[ot];)if(Ce?x(we,rr):we.nodeType===1)return!1;yt=ot=I==="only"&&!yt&&"nextSibling"}return!0}if(yt=[ve?It.firstChild:It.lastChild],ve&&li){for(Ie=It[ne]||(It[ne]={}),xe=Ie[I]||[],Ve=xe[0]===J&&xe[1],ft=Ve&&xe[2],we=Ve&&It.childNodes[Ve];we=++Ve&&we&&we[ot]||(ft=Ve=0)||yt.pop();)if(we.nodeType===1&&++ft&&we===ye){Ie[I]=[J,Ve,ft];break}}else if(li&&(Ie=ye[ne]||(ye[ne]={}),xe=Ie[I]||[],Ve=xe[0]===J&&xe[1],ft=Ve),ft===!1)for(;(we=++Ve&&we&&we[ot]||(ft=Ve=0)||yt.pop())&&!((Ce?x(we,rr):we.nodeType===1)&&++ft&&(li&&(Ie=we[ne]||(we[ne]={}),Ie[I]=[J,ft]),we===ye)););return ft-=ie,ft===Q||ft%Q===0&&ft/Q>=0}}},PSEUDO:function(I,V){var X,Q=u.pseudos[I]||u.setFilters[I.toLowerCase()]||We.error("unsupported pseudo: "+I);return Q[ne]?Q(V):Q.length>1?(X=[I,I,"",V],u.setFilters.hasOwnProperty(I.toLowerCase())?Vt(function(ie,fe){for(var ve,Ce=Q(ie,V),ye=Ce.length;ye--;)ve=o.call(ie,Ce[ye]),ie[ve]=!(fe[ve]=Ce[ye])}):function(ie){return Q(ie,0,X)}):Q}},pseudos:{not:Vt(function(I){var V=[],X=[],Q=Fs(I.replace(ee,"$1"));return Q[ne]?Vt(function(ie,fe,ve,Ce){for(var ye,Me=Q(ie,null,Ce,[]),Ae=ie.length;Ae--;)(ye=Me[Ae])&&(ie[Ae]=!(fe[Ae]=ye))}):function(ie,fe,ve){return V[0]=ie,Q(V,null,ve,X),V[0]=null,!X.pop()}}),has:Vt(function(I){return function(V){return We(I,V).length>0}}),contains:Vt(function(I){return I=I.replace(ur,fr),function(V){return(V.textContent||l.text(V)).indexOf(I)>-1}}),lang:Vt(function(I){return Fi.test(I||"")||We.error("unsupported lang: "+I),I=I.replace(ur,fr).toLowerCase(),function(V){var X;do if(X=H?V.lang:V.getAttribute("xml:lang")||V.getAttribute("lang"))return X=X.toLowerCase(),X===I||X.indexOf(I+"-")===0;while((V=V.parentNode)&&V.nodeType===1);return!1}}),target:function(I){var V=e.location&&e.location.hash;return V&&V.slice(1)===I.id},root:function(I){return I===U},focus:function(I){return I===Df()&&O.hasFocus()&&!!(I.type||I.href||~I.tabIndex)},enabled:Ga(!1),disabled:Ga(!0),checked:function(I){return x(I,"input")&&!!I.checked||x(I,"option")&&!!I.selected},selected:function(I){return I.parentNode&&I.parentNode.selectedIndex,I.selected===!0},empty:function(I){for(I=I.firstChild;I;I=I.nextSibling)if(I.nodeType<6)return!1;return!0},parent:function(I){return!u.pseudos.empty(I)},header:function(I){return Rr.test(I.nodeName)},input:function(I){return Ar.test(I.nodeName)},button:function(I){return x(I,"input")&&I.type==="button"||x(I,"button")},text:function(I){var V;return x(I,"input")&&I.type==="text"&&((V=I.getAttribute("type"))==null||V.toLowerCase()==="text")},first:Wr(function(){return[0]}),last:Wr(function(I,V){return[V-1]}),eq:Wr(function(I,V,X){return[X<0?X+V:X]}),even:Wr(function(I,V){for(var X=0;X<V;X+=2)I.push(X);return I}),odd:Wr(function(I,V){for(var X=1;X<V;X+=2)I.push(X);return I}),lt:Wr(function(I,V,X){var Q;for(X<0?Q=X+V:X>V?Q=V:Q=X;--Q>=0;)I.push(Q);return I}),gt:Wr(function(I,V,X){for(var Q=X<0?X+V:X;++Q<V;)I.push(Q);return I})}},u.pseudos.nth=u.pseudos.eq;for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})u.pseudos[n]=Lf(n);for(n in{submit:!0,reset:!0})u.pseudos[n]=Of(n);function Ya(){}Ya.prototype=u.filters=u.pseudos,u.setFilters=new Ya;function Tn(I,V){var X,Q,ie,fe,ve,Ce,ye,Me=Ne[I+" "];if(Me)return V?0:Me.slice(0);for(ve=I,Ce=[],ye=u.preFilter;ve;){(!X||(Q=Ge.exec(ve)))&&(Q&&(ve=ve.slice(Q[0].length)||ve),Ce.push(ie=[])),X=!1,(Q=$i.exec(ve))&&(X=Q.shift(),ie.push({value:X,type:Q[0].replace(ee," ")}),ve=ve.slice(X.length));for(fe in u.filter)(Q=tr[fe].exec(ve))&&(!ye[fe]||(Q=ye[fe](Q)))&&(X=Q.shift(),ie.push({value:X,type:fe,matches:Q}),ve=ve.slice(X.length));if(!X)break}return V?ve.length:ve?We.error(I):Ne(I,Ce).slice(0)}function wn(I){for(var V=0,X=I.length,Q="";V<X;V++)Q+=I[V].value;return Q}function kn(I,V,X){var Q=V.dir,ie=V.next,fe=ie||Q,ve=X&&fe==="parentNode",Ce=le++;return V.first?function(ye,Me,Ae){for(;ye=ye[Q];)if(ye.nodeType===1||ve)return I(ye,Me,Ae);return!1}:function(ye,Me,Ae){var xe,Ie,we=[J,Ce];if(Ae){for(;ye=ye[Q];)if((ye.nodeType===1||ve)&&I(ye,Me,Ae))return!0}else for(;ye=ye[Q];)if(ye.nodeType===1||ve)if(Ie=ye[ne]||(ye[ne]={}),ie&&x(ye,ie))ye=ye[Q]||ye;else{if((xe=Ie[fe])&&xe[0]===J&&xe[1]===Ce)return we[2]=xe[2];if(Ie[fe]=we,we[2]=I(ye,Me,Ae))return!0}return!1}}function Ns(I){return I.length>1?function(V,X,Q){for(var ie=I.length;ie--;)if(!I[ie](V,X,Q))return!1;return!0}:I[0]}function Pf(I,V,X){for(var Q=0,ie=V.length;Q<ie;Q++)We(I,V[Q],X);return X}function An(I,V,X,Q,ie){for(var fe,ve=[],Ce=0,ye=I.length,Me=V!=null;Ce<ye;Ce++)(fe=I[Ce])&&(!X||X(fe,Q,ie))&&(ve.push(fe),Me&&V.push(Ce));return ve}function Hs(I,V,X,Q,ie,fe){return Q&&!Q[ne]&&(Q=Hs(Q)),ie&&!ie[ne]&&(ie=Hs(ie,fe)),Vt(function(ve,Ce,ye,Me){var Ae,xe,Ie,we,Ve=[],yt=[],ot=Ce.length,It=ve||Pf(V||"*",ye.nodeType?[ye]:ye,[]),rr=I&&(ve||!V)?An(It,Ve,I,ye,Me):It;if(X?(we=ie||(ve?I:ot||Q)?[]:Ce,X(rr,we,ye,Me)):we=rr,Q)for(Ae=An(we,yt),Q(Ae,[],ye,Me),xe=Ae.length;xe--;)(Ie=Ae[xe])&&(we[yt[xe]]=!(rr[yt[xe]]=Ie));if(ve){if(ie||I){if(ie){for(Ae=[],xe=we.length;xe--;)(Ie=we[xe])&&Ae.push(rr[xe]=Ie);ie(null,we=[],Ae,Me)}for(xe=we.length;xe--;)(Ie=we[xe])&&(Ae=ie?o.call(ve,Ie):Ve[xe])>-1&&(ve[Ae]=!(Ce[Ae]=Ie))}}else we=An(we===Ce?we.splice(ot,we.length):we),ie?ie(null,Ce,we,Me):L.apply(Ce,we)})}function $s(I){for(var V,X,Q,ie=I.length,fe=u.relative[I[0].type],ve=fe||u.relative[" "],Ce=fe?1:0,ye=kn(function(xe){return xe===V},ve,!0),Me=kn(function(xe){return o.call(V,xe)>-1},ve,!0),Ae=[function(xe,Ie,we){var Ve=!fe&&(we||Ie!=b)||((V=Ie).nodeType?ye(xe,Ie,we):Me(xe,Ie,we));return V=null,Ve}];Ce<ie;Ce++)if(X=u.relative[I[Ce].type])Ae=[kn(Ns(Ae),X)];else{if(X=u.filter[I[Ce].type].apply(null,I[Ce].matches),X[ne]){for(Q=++Ce;Q<ie&&!u.relative[I[Q].type];Q++);return Hs(Ce>1&&Ns(Ae),Ce>1&&wn(I.slice(0,Ce-1).concat({value:I[Ce-2].type===" "?"*":""})).replace(ee,"$1"),X,Ce<Q&&$s(I.slice(Ce,Q)),Q<ie&&$s(I=I.slice(Q)),Q<ie&&wn(I))}Ae.push(X)}return Ns(Ae)}function Mf(I,V){var X=V.length>0,Q=I.length>0,ie=function(fe,ve,Ce,ye,Me){var Ae,xe,Ie,we=0,Ve="0",yt=fe&&[],ot=[],It=b,rr=fe||Q&&u.find.TAG("*",Me),li=J+=It==null?1:Math.random()||.1,ft=rr.length;for(Me&&(b=ve==O||ve||Me);Ve!==ft&&(Ae=rr[Ve])!=null;Ve++){if(Q&&Ae){for(xe=0,!ve&&Ae.ownerDocument!=O&&(xr(Ae),Ce=!H);Ie=I[xe++];)if(Ie(Ae,ve||O,Ce)){L.call(ye,Ae);break}Me&&(J=li)}X&&((Ae=!Ie&&Ae)&&we--,fe&&yt.push(Ae))}if(we+=Ve,X&&Ve!==we){for(xe=0;Ie=V[xe++];)Ie(yt,ot,ve,Ce);if(fe){if(we>0)for(;Ve--;)yt[Ve]||ot[Ve]||(ot[Ve]=M.call(ye));ot=An(ot)}L.apply(ye,ot),Me&&!fe&&ot.length>0&&we+V.length>1&&l.uniqueSort(ye)}return Me&&(J=li,b=It),yt};return X?Vt(ie):ie}function Fs(I,V){var X,Q=[],ie=[],fe=De[I+" "];if(!fe){for(V||(V=Tn(I)),X=V.length;X--;)fe=$s(V[X]),fe[ne]?Q.push(fe):ie.push(fe);fe=De(I,Mf(ie,Q)),fe.selector=I}return fe}function Xa(I,V,X,Q){var ie,fe,ve,Ce,ye,Me=typeof I=="function"&&I,Ae=!Q&&Tn(I=Me.selector||I);if(X=X||[],Ae.length===1){if(fe=Ae[0]=Ae[0].slice(0),fe.length>2&&(ve=fe[0]).type==="ID"&&V.nodeType===9&&H&&u.relative[fe[1].type]){if(V=(u.find.ID(ve.matches[0].replace(ur,fr),V)||[])[0],V)Me&&(V=V.parentNode);else return X;I=I.slice(fe.shift().value.length)}for(ie=tr.needsContext.test(I)?0:fe.length;ie--&&(ve=fe[ie],!u.relative[Ce=ve.type]);)if((ye=u.find[Ce])&&(Q=ye(ve.matches[0].replace(ur,fr),Is.test(fe[0].type)&&Bs(V.parentNode)||V))){if(fe.splice(ie,1),I=Q.length&&wn(fe),!I)return L.apply(X,Q),X;break}}return(Me||Fs(I,Ae))(Q,V,!H,X,!V||Is.test(I)&&Bs(V.parentNode)||V),X}C.sortStable=ne.split("").sort(Ze).join("")===ne,xr(),C.sortDetached=ci(function(I){return I.compareDocumentPosition(O.createElement("fieldset"))&1}),l.find=We,l.expr[":"]=l.expr.pseudos,l.unique=l.uniqueSort,We.compile=Fs,We.select=Xa,We.setDocument=xr,We.escape=l.escapeSelector,We.getText=l.text,We.isXML=l.isXMLDoc,We.selectors=l.expr,We.support=l.support,We.uniqueSort=l.uniqueSort})();var j=function(n,u,b){for(var A=[],D=b!==void 0;(n=n[u])&&n.nodeType!==9;)if(n.nodeType===1){if(D&&l(n).is(b))break;A.push(n)}return A},q=function(n,u){for(var b=[];n;n=n.nextSibling)n.nodeType===1&&n!==u&&b.push(n);return b},te=l.expr.match.needsContext,ge=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function me(n,u,b){return S(u)?l.grep(n,function(A,D){return!!u.call(A,D,A)!==b}):u.nodeType?l.grep(n,function(A){return A===u!==b}):typeof u!="string"?l.grep(n,function(A){return o.call(u,A)>-1!==b}):l.filter(u,n,b)}l.filter=function(n,u,b){var A=u[0];return b&&(n=":not("+n+")"),u.length===1&&A.nodeType===1?l.find.matchesSelector(A,n)?[A]:[]:l.find.matches(n,l.grep(u,function(D){return D.nodeType===1}))},l.fn.extend({find:function(n){var u,b,A=this.length,D=this;if(typeof n!="string")return this.pushStack(l(n).filter(function(){for(u=0;u<A;u++)if(l.contains(D[u],this))return!0}));for(b=this.pushStack([]),u=0;u<A;u++)l.find(n,D[u],b);return A>1?l.uniqueSort(b):b},filter:function(n){return this.pushStack(me(this,n||[],!1))},not:function(n){return this.pushStack(me(this,n||[],!0))},is:function(n){return!!me(this,typeof n=="string"&&te.test(n)?l(n):n||[],!1).length}});var oe,pe=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,z=l.fn.init=function(n,u,b){var A,D;if(!n)return this;if(b=b||oe,typeof n=="string")if(n[0]==="<"&&n[n.length-1]===">"&&n.length>=3?A=[null,n,null]:A=pe.exec(n),A&&(A[1]||!u))if(A[1]){if(u=u instanceof l?u[0]:u,l.merge(this,l.parseHTML(A[1],u&&u.nodeType?u.ownerDocument||u:p,!0)),ge.test(A[1])&&l.isPlainObject(u))for(A in u)S(this[A])?this[A](u[A]):this.attr(A,u[A]);return this}else return D=p.getElementById(A[2]),D&&(this[0]=D,this.length=1),this;else return!u||u.jquery?(u||b).find(n):this.constructor(u).find(n);else{if(n.nodeType)return this[0]=n,this.length=1,this;if(S(n))return b.ready!==void 0?b.ready(n):n(l)}return l.makeArray(n,this)};z.prototype=l.fn,oe=l(p);var W=/^(?:parents|prev(?:Until|All))/,Y={children:!0,contents:!0,next:!0,prev:!0};l.fn.extend({has:function(n){var u=l(n,this),b=u.length;return this.filter(function(){for(var A=0;A<b;A++)if(l.contains(this,u[A]))return!0})},closest:function(n,u){var b,A=0,D=this.length,L=[],O=typeof n!="string"&&l(n);if(!te.test(n)){for(;A<D;A++)for(b=this[A];b&&b!==u;b=b.parentNode)if(b.nodeType<11&&(O?O.index(b)>-1:b.nodeType===1&&l.find.matchesSelector(b,n))){L.push(b);break}}return this.pushStack(L.length>1?l.uniqueSort(L):L)},index:function(n){return n?typeof n=="string"?o.call(l(n),this[0]):o.call(this,n.jquery?n[0]:n):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(n,u){return this.pushStack(l.uniqueSort(l.merge(this.get(),l(n,u))))},addBack:function(n){return this.add(n==null?this.prevObject:this.prevObject.filter(n))}});function re(n,u){for(;(n=n[u])&&n.nodeType!==1;);return n}l.each({parent:function(n){var u=n.parentNode;return u&&u.nodeType!==11?u:null},parents:function(n){return j(n,"parentNode")},parentsUntil:function(n,u,b){return j(n,"parentNode",b)},next:function(n){return re(n,"nextSibling")},prev:function(n){return re(n,"previousSibling")},nextAll:function(n){return j(n,"nextSibling")},prevAll:function(n){return j(n,"previousSibling")},nextUntil:function(n,u,b){return j(n,"nextSibling",b)},prevUntil:function(n,u,b){return j(n,"previousSibling",b)},siblings:function(n){return q((n.parentNode||{}).firstChild,n)},children:function(n){return q(n.firstChild)},contents:function(n){return n.contentDocument!=null&&a(n.contentDocument)?n.contentDocument:(x(n,"template")&&(n=n.content||n),l.merge([],n.childNodes))}},function(n,u){l.fn[n]=function(b,A){var D=l.map(this,u,b);return n.slice(-5)!=="Until"&&(A=b),A&&typeof A=="string"&&(D=l.filter(A,D)),this.length>1&&(Y[n]||l.uniqueSort(D),W.test(n)&&D.reverse()),this.pushStack(D)}});var ae=/[^\x20\t\r\n\f]+/g;function Oe(n){var u={};return l.each(n.match(ae)||[],function(b,A){u[A]=!0}),u}l.Callbacks=function(n){n=typeof n=="string"?Oe(n):l.extend({},n);var u,b,A,D,L=[],O=[],U=-1,H=function(){for(D=D||n.once,A=u=!0;O.length;U=-1)for(b=O.shift();++U<L.length;)L[U].apply(b[0],b[1])===!1&&n.stopOnFalse&&(U=L.length,b=!1);n.memory||(b=!1),u=!1,D&&(b?L=[]:L="")},G={add:function(){return L&&(b&&!u&&(U=L.length-1,O.push(b)),function Z(ne){l.each(ne,function(J,le){S(le)?(!n.unique||!G.has(le))&&L.push(le):le&&le.length&&T(le)!=="string"&&Z(le)})}(arguments),b&&!u&&H()),this},remove:function(){return l.each(arguments,function(Z,ne){for(var J;(J=l.inArray(ne,L,J))>-1;)L.splice(J,1),J<=U&&U--}),this},has:function(Z){return Z?l.inArray(Z,L)>-1:L.length>0},empty:function(){return L&&(L=[]),this},disable:function(){return D=O=[],L=b="",this},disabled:function(){return!L},lock:function(){return D=O=[],!b&&!u&&(L=b=""),this},locked:function(){return!!D},fireWith:function(Z,ne){return D||(ne=ne||[],ne=[Z,ne.slice?ne.slice():ne],O.push(ne),u||H()),this},fire:function(){return G.fireWith(this,arguments),this},fired:function(){return!!A}};return G};function de(n){return n}function Fe(n){throw n}function Ue(n,u,b,A){var D;try{n&&S(D=n.promise)?D.call(n).done(u).fail(b):n&&S(D=n.then)?D.call(n,u,b):u.apply(void 0,[n].slice(A))}catch(L){b.apply(void 0,[L])}}l.extend({Deferred:function(n){var u=[["notify","progress",l.Callbacks("memory"),l.Callbacks("memory"),2],["resolve","done",l.Callbacks("once memory"),l.Callbacks("once memory"),0,"resolved"],["reject","fail",l.Callbacks("once memory"),l.Callbacks("once memory"),1,"rejected"]],b="pending",A={state:function(){return b},always:function(){return D.done(arguments).fail(arguments),this},catch:function(L){return A.then(null,L)},pipe:function(){var L=arguments;return l.Deferred(function(O){l.each(u,function(U,H){var G=S(L[H[4]])&&L[H[4]];D[H[1]](function(){var Z=G&&G.apply(this,arguments);Z&&S(Z.promise)?Z.promise().progress(O.notify).done(O.resolve).fail(O.reject):O[H[0]+"With"](this,G?[Z]:arguments)})}),L=null}).promise()},then:function(L,O,U){var H=0;function G(Z,ne,J,le){return function(){var Re=this,Ne=arguments,De=function(){var Ze,Qt;if(!(Z<H)){if(Ze=J.apply(Re,Ne),Ze===ne.promise())throw new TypeError("Thenable self-resolution");Qt=Ze&&(typeof Ze=="object"||typeof Ze=="function")&&Ze.then,S(Qt)?le?Qt.call(Ze,G(H,ne,de,le),G(H,ne,Fe,le)):(H++,Qt.call(Ze,G(H,ne,de,le),G(H,ne,Fe,le),G(H,ne,de,ne.notifyWith))):(J!==de&&(Re=void 0,Ne=[Ze]),(le||ne.resolveWith)(Re,Ne))}},et=le?De:function(){try{De()}catch(Ze){l.Deferred.exceptionHook&&l.Deferred.exceptionHook(Ze,et.error),Z+1>=H&&(J!==Fe&&(Re=void 0,Ne=[Ze]),ne.rejectWith(Re,Ne))}};Z?et():(l.Deferred.getErrorHook?et.error=l.Deferred.getErrorHook():l.Deferred.getStackHook&&(et.error=l.Deferred.getStackHook()),e.setTimeout(et))}}return l.Deferred(function(Z){u[0][3].add(G(0,Z,S(U)?U:de,Z.notifyWith)),u[1][3].add(G(0,Z,S(L)?L:de)),u[2][3].add(G(0,Z,S(O)?O:Fe))}).promise()},promise:function(L){return L!=null?l.extend(L,A):A}},D={};return l.each(u,function(L,O){var U=O[2],H=O[5];A[O[1]]=U.add,H&&U.add(function(){b=H},u[3-L][2].disable,u[3-L][3].disable,u[0][2].lock,u[0][3].lock),U.add(O[3].fire),D[O[0]]=function(){return D[O[0]+"With"](this===D?void 0:this,arguments),this},D[O[0]+"With"]=U.fireWith}),A.promise(D),n&&n.call(D,D),D},when:function(n){var u=arguments.length,b=u,A=Array(b),D=f.call(arguments),L=l.Deferred(),O=function(U){return function(H){A[U]=this,D[U]=arguments.length>1?f.call(arguments):H,--u||L.resolveWith(A,D)}};if(u<=1&&(Ue(n,L.done(O(b)).resolve,L.reject,!u),L.state()==="pending"||S(D[b]&&D[b].then)))return L.then();for(;b--;)Ue(D[b],O(b),L.reject);return L.promise()}});var ze=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;l.Deferred.exceptionHook=function(n,u){e.console&&e.console.warn&&n&&ze.test(n.name)&&e.console.warn("jQuery.Deferred exception: "+n.message,n.stack,u)},l.readyException=function(n){e.setTimeout(function(){throw n})};var Pe=l.Deferred();l.fn.ready=function(n){return Pe.then(n).catch(function(u){l.readyException(u)}),this},l.extend({isReady:!1,readyWait:1,ready:function(n){(n===!0?--l.readyWait:l.isReady)||(l.isReady=!0,!(n!==!0&&--l.readyWait>0)&&Pe.resolveWith(p,[l]))}}),l.ready.then=Pe.then;function xt(){p.removeEventListener("DOMContentLoaded",xt),e.removeEventListener("load",xt),l.ready()}p.readyState==="complete"||p.readyState!=="loading"&&!p.documentElement.doScroll?e.setTimeout(l.ready):(p.addEventListener("DOMContentLoaded",xt),e.addEventListener("load",xt));var mt=function(n,u,b,A,D,L,O){var U=0,H=n.length,G=b==null;if(T(b)==="object"){D=!0;for(U in b)mt(n,u,U,b[U],!0,L,O)}else if(A!==void 0&&(D=!0,S(A)||(O=!0),G&&(O?(u.call(n,A),u=null):(G=u,u=function(Z,ne,J){return G.call(l(Z),J)})),u))for(;U<H;U++)u(n[U],b,O?A:A.call(n[U],U,u(n[U],b)));return D?n:G?u.call(n):H?u(n[0],b):L},Li=/^-ms-/,Et=/-([a-z])/g;function Dt(n,u){return u.toUpperCase()}function Je(n){return n.replace(Li,"ms-").replace(Et,Dt)}var lt=function(n){return n.nodeType===1||n.nodeType===9||!+n.nodeType};function Lt(){this.expando=l.expando+Lt.uid++}Lt.uid=1,Lt.prototype={cache:function(n){var u=n[this.expando];return u||(u={},lt(n)&&(n.nodeType?n[this.expando]=u:Object.defineProperty(n,this.expando,{value:u,configurable:!0}))),u},set:function(n,u,b){var A,D=this.cache(n);if(typeof u=="string")D[Je(u)]=b;else for(A in u)D[Je(A)]=u[A];return D},get:function(n,u){return u===void 0?this.cache(n):n[this.expando]&&n[this.expando][Je(u)]},access:function(n,u,b){return u===void 0||u&&typeof u=="string"&&b===void 0?this.get(n,u):(this.set(n,u,b),b!==void 0?b:u)},remove:function(n,u){var b,A=n[this.expando];if(A!==void 0){if(u!==void 0)for(Array.isArray(u)?u=u.map(Je):(u=Je(u),u=u in A?[u]:u.match(ae)||[]),b=u.length;b--;)delete A[u[b]];(u===void 0||l.isEmptyObject(A))&&(n.nodeType?n[this.expando]=void 0:delete n[this.expando])}},hasData:function(n){var u=n[this.expando];return u!==void 0&&!l.isEmptyObject(u)}};var be=new Lt,Qe=new Lt,br=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Hr=/[A-Z]/g;function ei(n){return n==="true"?!0:n==="false"?!1:n==="null"?null:n===+n+""?+n:br.test(n)?JSON.parse(n):n}function $r(n,u,b){var A;if(b===void 0&&n.nodeType===1)if(A="data-"+u.replace(Hr,"-$&").toLowerCase(),b=n.getAttribute(A),typeof b=="string"){try{b=ei(b)}catch{}Qe.set(n,u,b)}else b=void 0;return b}l.extend({hasData:function(n){return Qe.hasData(n)||be.hasData(n)},data:function(n,u,b){return Qe.access(n,u,b)},removeData:function(n,u){Qe.remove(n,u)},_data:function(n,u,b){return be.access(n,u,b)},_removeData:function(n,u){be.remove(n,u)}}),l.fn.extend({data:function(n,u){var b,A,D,L=this[0],O=L&&L.attributes;if(n===void 0){if(this.length&&(D=Qe.get(L),L.nodeType===1&&!be.get(L,"hasDataAttrs"))){for(b=O.length;b--;)O[b]&&(A=O[b].name,A.indexOf("data-")===0&&(A=Je(A.slice(5)),$r(L,A,D[A])));be.set(L,"hasDataAttrs",!0)}return D}return typeof n=="object"?this.each(function(){Qe.set(this,n)}):mt(this,function(U){var H;if(L&&U===void 0)return H=Qe.get(L,n),H!==void 0||(H=$r(L,n),H!==void 0)?H:void 0;this.each(function(){Qe.set(this,n,U)})},null,u,arguments.length>1,null,!0)},removeData:function(n){return this.each(function(){Qe.remove(this,n)})}}),l.extend({queue:function(n,u,b){var A;if(n)return u=(u||"fx")+"queue",A=be.get(n,u),b&&(!A||Array.isArray(b)?A=be.access(n,u,l.makeArray(b)):A.push(b)),A||[]},dequeue:function(n,u){u=u||"fx";var b=l.queue(n,u),A=b.length,D=b.shift(),L=l._queueHooks(n,u),O=function(){l.dequeue(n,u)};D==="inprogress"&&(D=b.shift(),A--),D&&(u==="fx"&&b.unshift("inprogress"),delete L.stop,D.call(n,O,L)),!A&&L&&L.empty.fire()},_queueHooks:function(n,u){var b=u+"queueHooks";return be.get(n,b)||be.access(n,b,{empty:l.Callbacks("once memory").add(function(){be.remove(n,[u+"queue",b])})})}}),l.fn.extend({queue:function(n,u){var b=2;return typeof n!="string"&&(u=n,n="fx",b--),arguments.length<b?l.queue(this[0],n):u===void 0?this:this.each(function(){var A=l.queue(this,n,u);l._queueHooks(this,n),n==="fx"&&A[0]!=="inprogress"&&l.dequeue(this,n)})},dequeue:function(n){return this.each(function(){l.dequeue(this,n)})},clearQueue:function(n){return this.queue(n||"fx",[])},promise:function(n,u){var b,A=1,D=l.Deferred(),L=this,O=this.length,U=function(){--A||D.resolveWith(L,[L])};for(typeof n!="string"&&(u=n,n=void 0),n=n||"fx";O--;)b=be.get(L[O],n+"queueHooks"),b&&b.empty&&(A++,b.empty.add(U));return U(),D.promise(u)}});var Ot=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Pt=new RegExp("^(?:([+-])=|)("+Ot+")([a-z%]*)$","i"),Tt=["Top","Right","Bottom","Left"],Ut=p.documentElement,Cr=function(n){return l.contains(n.ownerDocument,n)},lr={composed:!0};Ut.getRootNode&&(Cr=function(n){return l.contains(n.ownerDocument,n)||n.getRootNode(lr)===n.ownerDocument});var ti=function(n,u){return n=u||n,n.style.display==="none"||n.style.display===""&&Cr(n)&&l.css(n,"display")==="none"};function _n(n,u,b,A){var D,L,O=20,U=A?function(){return A.cur()}:function(){return l.css(n,u,"")},H=U(),G=b&&b[3]||(l.cssNumber[u]?"":"px"),Z=n.nodeType&&(l.cssNumber[u]||G!=="px"&&+H)&&Pt.exec(l.css(n,u));if(Z&&Z[3]!==G){for(H=H/2,G=G||Z[3],Z=+H||1;O--;)l.style(n,u,Z+G),(1-L)*(1-(L=U()/H||.5))<=0&&(O=0),Z=Z/L;Z=Z*2,l.style(n,u,Z+G),b=b||[]}return b&&(Z=+Z||+H||0,D=b[1]?Z+(b[1]+1)*b[2]:+b[2],A&&(A.unit=G,A.start=Z,A.end=D)),D}var Ye={};function Er(n){var u,b=n.ownerDocument,A=n.nodeName,D=Ye[A];return D||(u=b.body.appendChild(b.createElement(A)),D=l.css(u,"display"),u.parentNode.removeChild(u),D==="none"&&(D="block"),Ye[A]=D,D)}function Tr(n,u){for(var b,A,D=[],L=0,O=n.length;L<O;L++)A=n[L],A.style&&(b=A.style.display,u?(b==="none"&&(D[L]=be.get(A,"display")||null,D[L]||(A.style.display="")),A.style.display===""&&ti(A)&&(D[L]=Er(A))):b!=="none"&&(D[L]="none",be.set(A,"display",b)));for(L=0;L<O;L++)D[L]!=null&&(n[L].style.display=D[L]);return n}l.fn.extend({show:function(){return Tr(this,!0)},hide:function(){return Tr(this)},toggle:function(n){return typeof n=="boolean"?n?this.show():this.hide():this.each(function(){ti(this)?l(this).show():l(this).hide()})}});var wr=/^(?:checkbox|radio)$/i,ri=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Oi=/^$|^module$|\/(?:java|ecma)script/i;(function(){var n=p.createDocumentFragment(),u=n.appendChild(p.createElement("div")),b=p.createElement("input");b.setAttribute("type","radio"),b.setAttribute("checked","checked"),b.setAttribute("name","t"),u.appendChild(b),C.checkClone=u.cloneNode(!0).cloneNode(!0).lastChild.checked,u.innerHTML="<textarea>x</textarea>",C.noCloneChecked=!!u.cloneNode(!0).lastChild.defaultValue,u.innerHTML="<option></option>",C.option=!!u.lastChild})();var ht={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ht.tbody=ht.tfoot=ht.colgroup=ht.caption=ht.thead,ht.th=ht.td,C.option||(ht.optgroup=ht.option=[1,"<select multiple='multiple'>","</select>"]);function nt(n,u){var b;return typeof n.getElementsByTagName<"u"?b=n.getElementsByTagName(u||"*"):typeof n.querySelectorAll<"u"?b=n.querySelectorAll(u||"*"):b=[],u===void 0||u&&x(n,u)?l.merge([n],b):b}function kr(n,u){for(var b=0,A=n.length;b<A;b++)be.set(n[b],"globalEval",!u||be.get(u[b],"globalEval"))}var Pi=/<|&#?\w+;/;function gn(n,u,b,A,D){for(var L,O,U,H,G,Z,ne=u.createDocumentFragment(),J=[],le=0,Re=n.length;le<Re;le++)if(L=n[le],L||L===0)if(T(L)==="object")l.merge(J,L.nodeType?[L]:L);else if(!Pi.test(L))J.push(u.createTextNode(L));else{for(O=O||ne.appendChild(u.createElement("div")),U=(ri.exec(L)||["",""])[1].toLowerCase(),H=ht[U]||ht._default,O.innerHTML=H[1]+l.htmlPrefilter(L)+H[2],Z=H[0];Z--;)O=O.lastChild;l.merge(J,O.childNodes),O=ne.firstChild,O.textContent=""}for(ne.textContent="",le=0;L=J[le++];){if(A&&l.inArray(L,A)>-1){D&&D.push(L);continue}if(G=Cr(L),O=nt(ne.appendChild(L),"script"),G&&kr(O),b)for(Z=0;L=O[Z++];)Oi.test(L.type||"")&&b.push(L)}return ne}var Xt=/^([^.]*)(?:\.(.+)|)/;function Jt(){return!0}function hr(){return!1}function ii(n,u,b,A,D,L){var O,U;if(typeof u=="object"){typeof b!="string"&&(A=A||b,b=void 0);for(U in u)ii(n,U,b,A,u[U],L);return n}if(A==null&&D==null?(D=b,A=b=void 0):D==null&&(typeof b=="string"?(D=A,A=void 0):(D=A,A=b,b=void 0)),D===!1)D=hr;else if(!D)return n;return L===1&&(O=D,D=function(H){return l().off(H),O.apply(this,arguments)},D.guid=O.guid||(O.guid=l.guid++)),n.each(function(){l.event.add(this,u,D,A,b)})}l.event={global:{},add:function(n,u,b,A,D){var L,O,U,H,G,Z,ne,J,le,Re,Ne,De=be.get(n);if(lt(n))for(b.handler&&(L=b,b=L.handler,D=L.selector),D&&l.find.matchesSelector(Ut,D),b.guid||(b.guid=l.guid++),(H=De.events)||(H=De.events=Object.create(null)),(O=De.handle)||(O=De.handle=function(et){return typeof l<"u"&&l.event.triggered!==et.type?l.event.dispatch.apply(n,arguments):void 0}),u=(u||"").match(ae)||[""],G=u.length;G--;)U=Xt.exec(u[G])||[],le=Ne=U[1],Re=(U[2]||"").split(".").sort(),le&&(ne=l.event.special[le]||{},le=(D?ne.delegateType:ne.bindType)||le,ne=l.event.special[le]||{},Z=l.extend({type:le,origType:Ne,data:A,handler:b,guid:b.guid,selector:D,needsContext:D&&l.expr.match.needsContext.test(D),namespace:Re.join(".")},L),(J=H[le])||(J=H[le]=[],J.delegateCount=0,(!ne.setup||ne.setup.call(n,A,Re,O)===!1)&&n.addEventListener&&n.addEventListener(le,O)),ne.add&&(ne.add.call(n,Z),Z.handler.guid||(Z.handler.guid=b.guid)),D?J.splice(J.delegateCount++,0,Z):J.push(Z),l.event.global[le]=!0)},remove:function(n,u,b,A,D){var L,O,U,H,G,Z,ne,J,le,Re,Ne,De=be.hasData(n)&&be.get(n);if(!(!De||!(H=De.events))){for(u=(u||"").match(ae)||[""],G=u.length;G--;){if(U=Xt.exec(u[G])||[],le=Ne=U[1],Re=(U[2]||"").split(".").sort(),!le){for(le in H)l.event.remove(n,le+u[G],b,A,!0);continue}for(ne=l.event.special[le]||{},le=(A?ne.delegateType:ne.bindType)||le,J=H[le]||[],U=U[2]&&new RegExp("(^|\\.)"+Re.join("\\.(?:.*\\.|)")+"(\\.|$)"),O=L=J.length;L--;)Z=J[L],(D||Ne===Z.origType)&&(!b||b.guid===Z.guid)&&(!U||U.test(Z.namespace))&&(!A||A===Z.selector||A==="**"&&Z.selector)&&(J.splice(L,1),Z.selector&&J.delegateCount--,ne.remove&&ne.remove.call(n,Z));O&&!J.length&&((!ne.teardown||ne.teardown.call(n,Re,De.handle)===!1)&&l.removeEvent(n,le,De.handle),delete H[le])}l.isEmptyObject(H)&&be.remove(n,"handle events")}},dispatch:function(n){var u,b,A,D,L,O,U=new Array(arguments.length),H=l.event.fix(n),G=(be.get(this,"events")||Object.create(null))[H.type]||[],Z=l.event.special[H.type]||{};for(U[0]=H,u=1;u<arguments.length;u++)U[u]=arguments[u];if(H.delegateTarget=this,!(Z.preDispatch&&Z.preDispatch.call(this,H)===!1)){for(O=l.event.handlers.call(this,H,G),u=0;(D=O[u++])&&!H.isPropagationStopped();)for(H.currentTarget=D.elem,b=0;(L=D.handlers[b++])&&!H.isImmediatePropagationStopped();)(!H.rnamespace||L.namespace===!1||H.rnamespace.test(L.namespace))&&(H.handleObj=L,H.data=L.data,A=((l.event.special[L.origType]||{}).handle||L.handler).apply(D.elem,U),A!==void 0&&(H.result=A)===!1&&(H.preventDefault(),H.stopPropagation()));return Z.postDispatch&&Z.postDispatch.call(this,H),H.result}},handlers:function(n,u){var b,A,D,L,O,U=[],H=u.delegateCount,G=n.target;if(H&&G.nodeType&&!(n.type==="click"&&n.button>=1)){for(;G!==this;G=G.parentNode||this)if(G.nodeType===1&&!(n.type==="click"&&G.disabled===!0)){for(L=[],O={},b=0;b<H;b++)A=u[b],D=A.selector+" ",O[D]===void 0&&(O[D]=A.needsContext?l(D,this).index(G)>-1:l.find(D,this,null,[G]).length),O[D]&&L.push(A);L.length&&U.push({elem:G,handlers:L})}}return G=this,H<u.length&&U.push({elem:G,handlers:u.slice(H)}),U},addProp:function(n,u){Object.defineProperty(l.Event.prototype,n,{enumerable:!0,configurable:!0,get:S(u)?function(){if(this.originalEvent)return u(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[n]},set:function(b){Object.defineProperty(this,n,{enumerable:!0,configurable:!0,writable:!0,value:b})}})},fix:function(n){return n[l.expando]?n:new l.Event(n)},special:{load:{noBubble:!0},click:{setup:function(n){var u=this||n;return wr.test(u.type)&&u.click&&x(u,"input")&&ni(u,"click",!0),!1},trigger:function(n){var u=this||n;return wr.test(u.type)&&u.click&&x(u,"input")&&ni(u,"click"),!0},_default:function(n){var u=n.target;return wr.test(u.type)&&u.click&&x(u,"input")&&be.get(u,"click")||x(u,"a")}},beforeunload:{postDispatch:function(n){n.result!==void 0&&n.originalEvent&&(n.originalEvent.returnValue=n.result)}}}};function ni(n,u,b){if(!b){be.get(n,u)===void 0&&l.event.add(n,u,Jt);return}be.set(n,u,!1),l.event.add(n,u,{namespace:!1,handler:function(A){var D,L=be.get(this,u);if(A.isTrigger&1&&this[u]){if(L)(l.event.special[u]||{}).delegateType&&A.stopPropagation();else if(L=f.call(arguments),be.set(this,u,L),this[u](),D=be.get(this,u),be.set(this,u,!1),L!==D)return A.stopImmediatePropagation(),A.preventDefault(),D}else L&&(be.set(this,u,l.event.trigger(L[0],L.slice(1),this)),A.stopPropagation(),A.isImmediatePropagationStopped=Jt)}})}l.removeEvent=function(n,u,b){n.removeEventListener&&n.removeEventListener(u,b)},l.Event=function(n,u){if(!(this instanceof l.Event))return new l.Event(n,u);n&&n.type?(this.originalEvent=n,this.type=n.type,this.isDefaultPrevented=n.defaultPrevented||n.defaultPrevented===void 0&&n.returnValue===!1?Jt:hr,this.target=n.target&&n.target.nodeType===3?n.target.parentNode:n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget):this.type=n,u&&l.extend(this,u),this.timeStamp=n&&n.timeStamp||Date.now(),this[l.expando]=!0},l.Event.prototype={constructor:l.Event,isDefaultPrevented:hr,isPropagationStopped:hr,isImmediatePropagationStopped:hr,isSimulated:!1,preventDefault:function(){var n=this.originalEvent;this.isDefaultPrevented=Jt,n&&!this.isSimulated&&n.preventDefault()},stopPropagation:function(){var n=this.originalEvent;this.isPropagationStopped=Jt,n&&!this.isSimulated&&n.stopPropagation()},stopImmediatePropagation:function(){var n=this.originalEvent;this.isImmediatePropagationStopped=Jt,n&&!this.isSimulated&&n.stopImmediatePropagation(),this.stopPropagation()}},l.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},l.event.addProp),l.each({focus:"focusin",blur:"focusout"},function(n,u){function b(A){if(p.documentMode){var D=be.get(this,"handle"),L=l.event.fix(A);L.type=A.type==="focusin"?"focus":"blur",L.isSimulated=!0,D(A),L.target===L.currentTarget&&D(L)}else l.event.simulate(u,A.target,l.event.fix(A))}l.event.special[n]={setup:function(){var A;if(ni(this,n,!0),p.documentMode)A=be.get(this,u),A||this.addEventListener(u,b),be.set(this,u,(A||0)+1);else return!1},trigger:function(){return ni(this,n),!0},teardown:function(){var A;if(p.documentMode)A=be.get(this,u)-1,A?be.set(this,u,A):(this.removeEventListener(u,b),be.remove(this,u));else return!1},_default:function(A){return be.get(A.target,n)},delegateType:u},l.event.special[u]={setup:function(){var A=this.ownerDocument||this.document||this,D=p.documentMode?this:A,L=be.get(D,u);L||(p.documentMode?this.addEventListener(u,b):A.addEventListener(n,b,!0)),be.set(D,u,(L||0)+1)},teardown:function(){var A=this.ownerDocument||this.document||this,D=p.documentMode?this:A,L=be.get(D,u)-1;L?be.set(D,u,L):(p.documentMode?this.removeEventListener(u,b):A.removeEventListener(n,b,!0),be.remove(D,u))}}}),l.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(n,u){l.event.special[n]={delegateType:u,bindType:u,handle:function(b){var A,D=this,L=b.relatedTarget,O=b.handleObj;return(!L||L!==D&&!l.contains(D,L))&&(b.type=O.origType,A=O.handler.apply(this,arguments),b.type=u),A}}}),l.fn.extend({on:function(n,u,b,A){return ii(this,n,u,b,A)},one:function(n,u,b,A){return ii(this,n,u,b,A,1)},off:function(n,u,b){var A,D;if(n&&n.preventDefault&&n.handleObj)return A=n.handleObj,l(n.delegateTarget).off(A.namespace?A.origType+"."+A.namespace:A.origType,A.selector,A.handler),this;if(typeof n=="object"){for(D in n)this.off(D,u,n[D]);return this}return(u===!1||typeof u=="function")&&(b=u,u=void 0),b===!1&&(b=hr),this.each(function(){l.event.remove(this,n,b,u)})}});var si=/<script|<style|<link/i,Wt=/checked\s*(?:[^=]|=\s*.checked.)/i,mn=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Mi(n,u){return x(n,"table")&&x(u.nodeType!==11?u:u.firstChild,"tr")&&l(n).children("tbody")[0]||n}function vn(n){return n.type=(n.getAttribute("type")!==null)+"/"+n.type,n}function yn(n){return(n.type||"").slice(0,5)==="true/"?n.type=n.type.slice(5):n.removeAttribute("type"),n}function Sn(n,u){var b,A,D,L,O,U,H;if(u.nodeType===1){if(be.hasData(n)&&(L=be.get(n),H=L.events,H)){be.remove(u,"handle events");for(D in H)for(b=0,A=H[D].length;b<A;b++)l.event.add(u,D,H[D][b])}Qe.hasData(n)&&(O=Qe.access(n),U=l.extend({},O),Qe.set(u,U))}}function Ee(n,u){var b=u.nodeName.toLowerCase();b==="input"&&wr.test(n.type)?u.checked=n.checked:(b==="input"||b==="textarea")&&(u.defaultValue=n.defaultValue)}function K(n,u,b,A){u=y(u);var D,L,O,U,H,G,Z=0,ne=n.length,J=ne-1,le=u[0],Re=S(le);if(Re||ne>1&&typeof le=="string"&&!C.checkClone&&Wt.test(le))return n.each(function(Ne){var De=n.eq(Ne);Re&&(u[0]=le.call(this,Ne,De.html())),K(De,u,b,A)});if(ne&&(D=gn(u,n[0].ownerDocument,!1,n,A),L=D.firstChild,D.childNodes.length===1&&(D=L),L||A)){for(O=l.map(nt(D,"script"),vn),U=O.length;Z<ne;Z++)H=D,Z!==J&&(H=l.clone(H,!0,!0),U&&l.merge(O,nt(H,"script"))),b.call(n[Z],H,Z);if(U)for(G=O[O.length-1].ownerDocument,l.map(O,yn),Z=0;Z<U;Z++)H=O[Z],Oi.test(H.type||"")&&!be.access(H,"globalEval")&&l.contains(G,H)&&(H.src&&(H.type||"").toLowerCase()!=="module"?l._evalUrl&&!H.noModule&&l._evalUrl(H.src,{nonce:H.nonce||H.getAttribute("nonce")},G):m(H.textContent.replace(mn,""),H,G))}return n}function he(n,u,b){for(var A,D=u?l.filter(u,n):n,L=0;(A=D[L])!=null;L++)!b&&A.nodeType===1&&l.cleanData(nt(A)),A.parentNode&&(b&&Cr(A)&&kr(nt(A,"script")),A.parentNode.removeChild(A));return n}l.extend({htmlPrefilter:function(n){return n},clone:function(n,u,b){var A,D,L,O,U=n.cloneNode(!0),H=Cr(n);if(!C.noCloneChecked&&(n.nodeType===1||n.nodeType===11)&&!l.isXMLDoc(n))for(O=nt(U),L=nt(n),A=0,D=L.length;A<D;A++)Ee(L[A],O[A]);if(u)if(b)for(L=L||nt(n),O=O||nt(U),A=0,D=L.length;A<D;A++)Sn(L[A],O[A]);else Sn(n,U);return O=nt(U,"script"),O.length>0&&kr(O,!H&&nt(n,"script")),U},cleanData:function(n){for(var u,b,A,D=l.event.special,L=0;(b=n[L])!==void 0;L++)if(lt(b)){if(u=b[be.expando]){if(u.events)for(A in u.events)D[A]?l.event.remove(b,A):l.removeEvent(b,A,u.handle);b[be.expando]=void 0}b[Qe.expando]&&(b[Qe.expando]=void 0)}}}),l.fn.extend({detach:function(n){return he(this,n,!0)},remove:function(n){return he(this,n)},text:function(n){return mt(this,function(u){return u===void 0?l.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=u)})},null,n,arguments.length)},append:function(){return K(this,arguments,function(n){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var u=Mi(this,n);u.appendChild(n)}})},prepend:function(){return K(this,arguments,function(n){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var u=Mi(this,n);u.insertBefore(n,u.firstChild)}})},before:function(){return K(this,arguments,function(n){this.parentNode&&this.parentNode.insertBefore(n,this)})},after:function(){return K(this,arguments,function(n){this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling)})},empty:function(){for(var n,u=0;(n=this[u])!=null;u++)n.nodeType===1&&(l.cleanData(nt(n,!1)),n.textContent="");return this},clone:function(n,u){return n=n??!1,u=u??n,this.map(function(){return l.clone(this,n,u)})},html:function(n){return mt(this,function(u){var b=this[0]||{},A=0,D=this.length;if(u===void 0&&b.nodeType===1)return b.innerHTML;if(typeof u=="string"&&!si.test(u)&&!ht[(ri.exec(u)||["",""])[1].toLowerCase()]){u=l.htmlPrefilter(u);try{for(;A<D;A++)b=this[A]||{},b.nodeType===1&&(l.cleanData(nt(b,!1)),b.innerHTML=u);b=0}catch{}}b&&this.empty().append(u)},null,n,arguments.length)},replaceWith:function(){var n=[];return K(this,arguments,function(u){var b=this.parentNode;l.inArray(this,n)<0&&(l.cleanData(nt(this)),b&&b.replaceChild(u,this))},n)}}),l.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(n,u){l.fn[n]=function(b){for(var A,D=[],L=l(b),O=L.length-1,U=0;U<=O;U++)A=U===O?this:this.clone(!0),l(L[U])[u](A),s.apply(D,A.get());return this.pushStack(D)}});var _e=new RegExp("^("+Ot+")(?!px)[a-z%]+$","i"),$e=/^--/,Ke=function(n){var u=n.ownerDocument.defaultView;return(!u||!u.opener)&&(u=e),u.getComputedStyle(n)},ut=function(n,u,b){var A,D,L={};for(D in u)L[D]=n.style[D],n.style[D]=u[D];A=b.call(n);for(D in u)n.style[D]=L[D];return A},qe=new RegExp(Tt.join("|"),"i");(function(){function n(){if(G){H.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",G.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Ut.appendChild(H).appendChild(G);var Z=e.getComputedStyle(G);b=Z.top!=="1%",U=u(Z.marginLeft)===12,G.style.right="60%",L=u(Z.right)===36,A=u(Z.width)===36,G.style.position="absolute",D=u(G.offsetWidth/3)===12,Ut.removeChild(H),G=null}}function u(Z){return Math.round(parseFloat(Z))}var b,A,D,L,O,U,H=p.createElement("div"),G=p.createElement("div");G.style&&(G.style.backgroundClip="content-box",G.cloneNode(!0).style.backgroundClip="",C.clearCloneStyle=G.style.backgroundClip==="content-box",l.extend(C,{boxSizingReliable:function(){return n(),A},pixelBoxStyles:function(){return n(),L},pixelPosition:function(){return n(),b},reliableMarginLeft:function(){return n(),U},scrollboxSize:function(){return n(),D},reliableTrDimensions:function(){var Z,ne,J,le;return O==null&&(Z=p.createElement("table"),ne=p.createElement("tr"),J=p.createElement("div"),Z.style.cssText="position:absolute;left:-11111px;border-collapse:separate",ne.style.cssText="border:1px solid",ne.style.height="1px",J.style.height="9px",J.style.display="block",Ut.appendChild(Z).appendChild(ne).appendChild(J),le=e.getComputedStyle(ne),O=parseInt(le.height,10)+parseInt(le.borderTopWidth,10)+parseInt(le.borderBottomWidth,10)===ne.offsetHeight,Ut.removeChild(Z)),O}}))})();function st(n,u,b){var A,D,L,O,U=$e.test(u),H=n.style;return b=b||Ke(n),b&&(O=b.getPropertyValue(u)||b[u],U&&O&&(O=O.replace(ee,"$1")||void 0),O===""&&!Cr(n)&&(O=l.style(n,u)),!C.pixelBoxStyles()&&_e.test(O)&&qe.test(u)&&(A=H.width,D=H.minWidth,L=H.maxWidth,H.minWidth=H.maxWidth=H.width=O,O=b.width,H.width=A,H.minWidth=D,H.maxWidth=L)),O!==void 0?O+"":O}function oi(n,u){return{get:function(){if(n()){delete this.get;return}return(this.get=u).apply(this,arguments)}}}var Ii=["Webkit","Moz","ms"],Es=p.createElement("div").style,Oa={};function tf(n){for(var u=n[0].toUpperCase()+n.slice(1),b=Ii.length;b--;)if(n=Ii[b]+u,n in Es)return n}function Ts(n){var u=l.cssProps[n]||Oa[n];return u||(n in Es?n:Oa[n]=tf(n)||n)}var rf=/^(none|table(?!-c[ea]).+)/,nf={position:"absolute",visibility:"hidden",display:"block"},Pa={letterSpacing:"0",fontWeight:"400"};function Ma(n,u,b){var A=Pt.exec(u);return A?Math.max(0,A[2]-(b||0))+(A[3]||"px"):u}function ws(n,u,b,A,D,L){var O=u==="width"?1:0,U=0,H=0,G=0;if(b===(A?"border":"content"))return 0;for(;O<4;O+=2)b==="margin"&&(G+=l.css(n,b+Tt[O],!0,D)),A?(b==="content"&&(H-=l.css(n,"padding"+Tt[O],!0,D)),b!=="margin"&&(H-=l.css(n,"border"+Tt[O]+"Width",!0,D))):(H+=l.css(n,"padding"+Tt[O],!0,D),b!=="padding"?H+=l.css(n,"border"+Tt[O]+"Width",!0,D):U+=l.css(n,"border"+Tt[O]+"Width",!0,D));return!A&&L>=0&&(H+=Math.max(0,Math.ceil(n["offset"+u[0].toUpperCase()+u.slice(1)]-L-H-U-.5))||0),H+G}function Ia(n,u,b){var A=Ke(n),D=!C.boxSizingReliable()||b,L=D&&l.css(n,"boxSizing",!1,A)==="border-box",O=L,U=st(n,u,A),H="offset"+u[0].toUpperCase()+u.slice(1);if(_e.test(U)){if(!b)return U;U="auto"}return(!C.boxSizingReliable()&&L||!C.reliableTrDimensions()&&x(n,"tr")||U==="auto"||!parseFloat(U)&&l.css(n,"display",!1,A)==="inline")&&n.getClientRects().length&&(L=l.css(n,"boxSizing",!1,A)==="border-box",O=H in n,O&&(U=n[H])),U=parseFloat(U)||0,U+ws(n,u,b||(L?"border":"content"),O,A,U)+"px"}l.extend({cssHooks:{opacity:{get:function(n,u){if(u){var b=st(n,"opacity");return b===""?"1":b}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(n,u,b,A){if(!(!n||n.nodeType===3||n.nodeType===8||!n.style)){var D,L,O,U=Je(u),H=$e.test(u),G=n.style;if(H||(u=Ts(U)),O=l.cssHooks[u]||l.cssHooks[U],b!==void 0){if(L=typeof b,L==="string"&&(D=Pt.exec(b))&&D[1]&&(b=_n(n,u,D),L="number"),b==null||b!==b)return;L==="number"&&!H&&(b+=D&&D[3]||(l.cssNumber[U]?"":"px")),!C.clearCloneStyle&&b===""&&u.indexOf("background")===0&&(G[u]="inherit"),(!O||!("set"in O)||(b=O.set(n,b,A))!==void 0)&&(H?G.setProperty(u,b):G[u]=b)}else return O&&"get"in O&&(D=O.get(n,!1,A))!==void 0?D:G[u]}},css:function(n,u,b,A){var D,L,O,U=Je(u),H=$e.test(u);return H||(u=Ts(U)),O=l.cssHooks[u]||l.cssHooks[U],O&&"get"in O&&(D=O.get(n,!0,b)),D===void 0&&(D=st(n,u,A)),D==="normal"&&u in Pa&&(D=Pa[u]),b===""||b?(L=parseFloat(D),b===!0||isFinite(L)?L||0:D):D}}),l.each(["height","width"],function(n,u){l.cssHooks[u]={get:function(b,A,D){if(A)return rf.test(l.css(b,"display"))&&(!b.getClientRects().length||!b.getBoundingClientRect().width)?ut(b,nf,function(){return Ia(b,u,D)}):Ia(b,u,D)},set:function(b,A,D){var L,O=Ke(b),U=!C.scrollboxSize()&&O.position==="absolute",H=U||D,G=H&&l.css(b,"boxSizing",!1,O)==="border-box",Z=D?ws(b,u,D,G,O):0;return G&&U&&(Z-=Math.ceil(b["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(O[u])-ws(b,u,"border",!1,O)-.5)),Z&&(L=Pt.exec(A))&&(L[3]||"px")!=="px"&&(b.style[u]=A,A=l.css(b,u)),Ma(b,A,Z)}}}),l.cssHooks.marginLeft=oi(C.reliableMarginLeft,function(n,u){if(u)return(parseFloat(st(n,"marginLeft"))||n.getBoundingClientRect().left-ut(n,{marginLeft:0},function(){return n.getBoundingClientRect().left}))+"px"}),l.each({margin:"",padding:"",border:"Width"},function(n,u){l.cssHooks[n+u]={expand:function(b){for(var A=0,D={},L=typeof b=="string"?b.split(" "):[b];A<4;A++)D[n+Tt[A]+u]=L[A]||L[A-2]||L[0];return D}},n!=="margin"&&(l.cssHooks[n+u].set=Ma)}),l.fn.extend({css:function(n,u){return mt(this,function(b,A,D){var L,O,U={},H=0;if(Array.isArray(A)){for(L=Ke(b),O=A.length;H<O;H++)U[A[H]]=l.css(b,A[H],!1,L);return U}return D!==void 0?l.style(b,A,D):l.css(b,A)},n,u,arguments.length>1)}});function vt(n,u,b,A,D){return new vt.prototype.init(n,u,b,A,D)}l.Tween=vt,vt.prototype={constructor:vt,init:function(n,u,b,A,D,L){this.elem=n,this.prop=b,this.easing=D||l.easing._default,this.options=u,this.start=this.now=this.cur(),this.end=A,this.unit=L||(l.cssNumber[b]?"":"px")},cur:function(){var n=vt.propHooks[this.prop];return n&&n.get?n.get(this):vt.propHooks._default.get(this)},run:function(n){var u,b=vt.propHooks[this.prop];return this.options.duration?this.pos=u=l.easing[this.easing](n,this.options.duration*n,0,1,this.options.duration):this.pos=u=n,this.now=(this.end-this.start)*u+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),b&&b.set?b.set(this):vt.propHooks._default.set(this),this}},vt.prototype.init.prototype=vt.prototype,vt.propHooks={_default:{get:function(n){var u;return n.elem.nodeType!==1||n.elem[n.prop]!=null&&n.elem.style[n.prop]==null?n.elem[n.prop]:(u=l.css(n.elem,n.prop,""),!u||u==="auto"?0:u)},set:function(n){l.fx.step[n.prop]?l.fx.step[n.prop](n):n.elem.nodeType===1&&(l.cssHooks[n.prop]||n.elem.style[Ts(n.prop)]!=null)?l.style(n.elem,n.prop,n.now+n.unit):n.elem[n.prop]=n.now}}},vt.propHooks.scrollTop=vt.propHooks.scrollLeft={set:function(n){n.elem.nodeType&&n.elem.parentNode&&(n.elem[n.prop]=n.now)}},l.easing={linear:function(n){return n},swing:function(n){return .5-Math.cos(n*Math.PI)/2},_default:"swing"},l.fx=vt.prototype.init,l.fx.step={};var ai,bn,sf=/^(?:toggle|show|hide)$/,of=/queueHooks$/;function ks(){bn&&(p.hidden===!1&&e.requestAnimationFrame?e.requestAnimationFrame(ks):e.setTimeout(ks,l.fx.interval),l.fx.tick())}function Ba(){return e.setTimeout(function(){ai=void 0}),ai=Date.now()}function Cn(n,u){var b,A=0,D={height:n};for(u=u?1:0;A<4;A+=2-u)b=Tt[A],D["margin"+b]=D["padding"+b]=n;return u&&(D.opacity=D.width=n),D}function Na(n,u,b){for(var A,D=(zt.tweeners[u]||[]).concat(zt.tweeners["*"]),L=0,O=D.length;L<O;L++)if(A=D[L].call(b,u,n))return A}function af(n,u,b){var A,D,L,O,U,H,G,Z,ne="width"in u||"height"in u,J=this,le={},Re=n.style,Ne=n.nodeType&&ti(n),De=be.get(n,"fxshow");b.queue||(O=l._queueHooks(n,"fx"),O.unqueued==null&&(O.unqueued=0,U=O.empty.fire,O.empty.fire=function(){O.unqueued||U()}),O.unqueued++,J.always(function(){J.always(function(){O.unqueued--,l.queue(n,"fx").length||O.empty.fire()})}));for(A in u)if(D=u[A],sf.test(D)){if(delete u[A],L=L||D==="toggle",D===(Ne?"hide":"show"))if(D==="show"&&De&&De[A]!==void 0)Ne=!0;else continue;le[A]=De&&De[A]||l.style(n,A)}if(H=!l.isEmptyObject(u),!(!H&&l.isEmptyObject(le))){ne&&n.nodeType===1&&(b.overflow=[Re.overflow,Re.overflowX,Re.overflowY],G=De&&De.display,G==null&&(G=be.get(n,"display")),Z=l.css(n,"display"),Z==="none"&&(G?Z=G:(Tr([n],!0),G=n.style.display||G,Z=l.css(n,"display"),Tr([n]))),(Z==="inline"||Z==="inline-block"&&G!=null)&&l.css(n,"float")==="none"&&(H||(J.done(function(){Re.display=G}),G==null&&(Z=Re.display,G=Z==="none"?"":Z)),Re.display="inline-block")),b.overflow&&(Re.overflow="hidden",J.always(function(){Re.overflow=b.overflow[0],Re.overflowX=b.overflow[1],Re.overflowY=b.overflow[2]})),H=!1;for(A in le)H||(De?"hidden"in De&&(Ne=De.hidden):De=be.access(n,"fxshow",{display:G}),L&&(De.hidden=!Ne),Ne&&Tr([n],!0),J.done(function(){Ne||Tr([n]),be.remove(n,"fxshow");for(A in le)l.style(n,A,le[A])})),H=Na(Ne?De[A]:0,A,J),A in De||(De[A]=H.start,Ne&&(H.end=H.start,H.start=0))}}function cf(n,u){var b,A,D,L,O;for(b in n)if(A=Je(b),D=u[A],L=n[b],Array.isArray(L)&&(D=L[1],L=n[b]=L[0]),b!==A&&(n[A]=L,delete n[b]),O=l.cssHooks[A],O&&"expand"in O){L=O.expand(L),delete n[A];for(b in L)b in n||(n[b]=L[b],u[b]=D)}else u[A]=D}function zt(n,u,b){var A,D,L=0,O=zt.prefilters.length,U=l.Deferred().always(function(){delete H.elem}),H=function(){if(D)return!1;for(var ne=ai||Ba(),J=Math.max(0,G.startTime+G.duration-ne),le=J/G.duration||0,Re=1-le,Ne=0,De=G.tweens.length;Ne<De;Ne++)G.tweens[Ne].run(Re);return U.notifyWith(n,[G,Re,J]),Re<1&&De?J:(De||U.notifyWith(n,[G,1,0]),U.resolveWith(n,[G]),!1)},G=U.promise({elem:n,props:l.extend({},u),opts:l.extend(!0,{specialEasing:{},easing:l.easing._default},b),originalProperties:u,originalOptions:b,startTime:ai||Ba(),duration:b.duration,tweens:[],createTween:function(ne,J){var le=l.Tween(n,G.opts,ne,J,G.opts.specialEasing[ne]||G.opts.easing);return G.tweens.push(le),le},stop:function(ne){var J=0,le=ne?G.tweens.length:0;if(D)return this;for(D=!0;J<le;J++)G.tweens[J].run(1);return ne?(U.notifyWith(n,[G,1,0]),U.resolveWith(n,[G,ne])):U.rejectWith(n,[G,ne]),this}}),Z=G.props;for(cf(Z,G.opts.specialEasing);L<O;L++)if(A=zt.prefilters[L].call(G,n,Z,G.opts),A)return S(A.stop)&&(l._queueHooks(G.elem,G.opts.queue).stop=A.stop.bind(A)),A;return l.map(Z,Na,G),S(G.opts.start)&&G.opts.start.call(n,G),G.progress(G.opts.progress).done(G.opts.done,G.opts.complete).fail(G.opts.fail).always(G.opts.always),l.fx.timer(l.extend(H,{elem:n,anim:G,queue:G.opts.queue})),G}l.Animation=l.extend(zt,{tweeners:{"*":[function(n,u){var b=this.createTween(n,u);return _n(b.elem,n,Pt.exec(u),b),b}]},tweener:function(n,u){S(n)?(u=n,n=["*"]):n=n.match(ae);for(var b,A=0,D=n.length;A<D;A++)b=n[A],zt.tweeners[b]=zt.tweeners[b]||[],zt.tweeners[b].unshift(u)},prefilters:[af],prefilter:function(n,u){u?zt.prefilters.unshift(n):zt.prefilters.push(n)}}),l.speed=function(n,u,b){var A=n&&typeof n=="object"?l.extend({},n):{complete:b||!b&&u||S(n)&&n,duration:n,easing:b&&u||u&&!S(u)&&u};return l.fx.off?A.duration=0:typeof A.duration!="number"&&(A.duration in l.fx.speeds?A.duration=l.fx.speeds[A.duration]:A.duration=l.fx.speeds._default),(A.queue==null||A.queue===!0)&&(A.queue="fx"),A.old=A.complete,A.complete=function(){S(A.old)&&A.old.call(this),A.queue&&l.dequeue(this,A.queue)},A},l.fn.extend({fadeTo:function(n,u,b,A){return this.filter(ti).css("opacity",0).show().end().animate({opacity:u},n,b,A)},animate:function(n,u,b,A){var D=l.isEmptyObject(n),L=l.speed(u,b,A),O=function(){var U=zt(this,l.extend({},n),L);(D||be.get(this,"finish"))&&U.stop(!0)};return O.finish=O,D||L.queue===!1?this.each(O):this.queue(L.queue,O)},stop:function(n,u,b){var A=function(D){var L=D.stop;delete D.stop,L(b)};return typeof n!="string"&&(b=u,u=n,n=void 0),u&&this.queue(n||"fx",[]),this.each(function(){var D=!0,L=n!=null&&n+"queueHooks",O=l.timers,U=be.get(this);if(L)U[L]&&U[L].stop&&A(U[L]);else for(L in U)U[L]&&U[L].stop&&of.test(L)&&A(U[L]);for(L=O.length;L--;)O[L].elem===this&&(n==null||O[L].queue===n)&&(O[L].anim.stop(b),D=!1,O.splice(L,1));(D||!b)&&l.dequeue(this,n)})},finish:function(n){return n!==!1&&(n=n||"fx"),this.each(function(){var u,b=be.get(this),A=b[n+"queue"],D=b[n+"queueHooks"],L=l.timers,O=A?A.length:0;for(b.finish=!0,l.queue(this,n,[]),D&&D.stop&&D.stop.call(this,!0),u=L.length;u--;)L[u].elem===this&&L[u].queue===n&&(L[u].anim.stop(!0),L.splice(u,1));for(u=0;u<O;u++)A[u]&&A[u].finish&&A[u].finish.call(this);delete b.finish})}}),l.each(["toggle","show","hide"],function(n,u){var b=l.fn[u];l.fn[u]=function(A,D,L){return A==null||typeof A=="boolean"?b.apply(this,arguments):this.animate(Cn(u,!0),A,D,L)}}),l.each({slideDown:Cn("show"),slideUp:Cn("hide"),slideToggle:Cn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(n,u){l.fn[n]=function(b,A,D){return this.animate(u,b,A,D)}}),l.timers=[],l.fx.tick=function(){var n,u=0,b=l.timers;for(ai=Date.now();u<b.length;u++)n=b[u],!n()&&b[u]===n&&b.splice(u--,1);b.length||l.fx.stop(),ai=void 0},l.fx.timer=function(n){l.timers.push(n),l.fx.start()},l.fx.interval=13,l.fx.start=function(){bn||(bn=!0,ks())},l.fx.stop=function(){bn=null},l.fx.speeds={slow:600,fast:200,_default:400},l.fn.delay=function(n,u){return n=l.fx&&l.fx.speeds[n]||n,u=u||"fx",this.queue(u,function(b,A){var D=e.setTimeout(b,n);A.stop=function(){e.clearTimeout(D)}})},function(){var n=p.createElement("input"),u=p.createElement("select"),b=u.appendChild(p.createElement("option"));n.type="checkbox",C.checkOn=n.value!=="",C.optSelected=b.selected,n=p.createElement("input"),n.value="t",n.type="radio",C.radioValue=n.value==="t"}();var Ha,Bi=l.expr.attrHandle;l.fn.extend({attr:function(n,u){return mt(this,l.attr,n,u,arguments.length>1)},removeAttr:function(n){return this.each(function(){l.removeAttr(this,n)})}}),l.extend({attr:function(n,u,b){var A,D,L=n.nodeType;if(!(L===3||L===8||L===2)){if(typeof n.getAttribute>"u")return l.prop(n,u,b);if((L!==1||!l.isXMLDoc(n))&&(D=l.attrHooks[u.toLowerCase()]||(l.expr.match.bool.test(u)?Ha:void 0)),b!==void 0){if(b===null){l.removeAttr(n,u);return}return D&&"set"in D&&(A=D.set(n,b,u))!==void 0?A:(n.setAttribute(u,b+""),b)}return D&&"get"in D&&(A=D.get(n,u))!==null?A:(A=l.find.attr(n,u),A??void 0)}},attrHooks:{type:{set:function(n,u){if(!C.radioValue&&u==="radio"&&x(n,"input")){var b=n.value;return n.setAttribute("type",u),b&&(n.value=b),u}}}},removeAttr:function(n,u){var b,A=0,D=u&&u.match(ae);if(D&&n.nodeType===1)for(;b=D[A++];)n.removeAttribute(b)}}),Ha={set:function(n,u,b){return u===!1?l.removeAttr(n,b):n.setAttribute(b,b),b}},l.each(l.expr.match.bool.source.match(/\w+/g),function(n,u){var b=Bi[u]||l.find.attr;Bi[u]=function(A,D,L){var O,U,H=D.toLowerCase();return L||(U=Bi[H],Bi[H]=O,O=b(A,D,L)!=null?H:null,Bi[H]=U),O}});var lf=/^(?:input|select|textarea|button)$/i,hf=/^(?:a|area)$/i;l.fn.extend({prop:function(n,u){return mt(this,l.prop,n,u,arguments.length>1)},removeProp:function(n){return this.each(function(){delete this[l.propFix[n]||n]})}}),l.extend({prop:function(n,u,b){var A,D,L=n.nodeType;if(!(L===3||L===8||L===2))return(L!==1||!l.isXMLDoc(n))&&(u=l.propFix[u]||u,D=l.propHooks[u]),b!==void 0?D&&"set"in D&&(A=D.set(n,b,u))!==void 0?A:n[u]=b:D&&"get"in D&&(A=D.get(n,u))!==null?A:n[u]},propHooks:{tabIndex:{get:function(n){var u=l.find.attr(n,"tabindex");return u?parseInt(u,10):lf.test(n.nodeName)||hf.test(n.nodeName)&&n.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),C.optSelected||(l.propHooks.selected={get:function(n){var u=n.parentNode;return u&&u.parentNode&&u.parentNode.selectedIndex,null},set:function(n){var u=n.parentNode;u&&(u.selectedIndex,u.parentNode&&u.parentNode.selectedIndex)}}),l.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){l.propFix[this.toLowerCase()]=this});function Fr(n){var u=n.match(ae)||[];return u.join(" ")}function jr(n){return n.getAttribute&&n.getAttribute("class")||""}function As(n){return Array.isArray(n)?n:typeof n=="string"?n.match(ae)||[]:[]}l.fn.extend({addClass:function(n){var u,b,A,D,L,O;return S(n)?this.each(function(U){l(this).addClass(n.call(this,U,jr(this)))}):(u=As(n),u.length?this.each(function(){if(A=jr(this),b=this.nodeType===1&&" "+Fr(A)+" ",b){for(L=0;L<u.length;L++)D=u[L],b.indexOf(" "+D+" ")<0&&(b+=D+" ");O=Fr(b),A!==O&&this.setAttribute("class",O)}}):this)},removeClass:function(n){var u,b,A,D,L,O;return S(n)?this.each(function(U){l(this).removeClass(n.call(this,U,jr(this)))}):arguments.length?(u=As(n),u.length?this.each(function(){if(A=jr(this),b=this.nodeType===1&&" "+Fr(A)+" ",b){for(L=0;L<u.length;L++)for(D=u[L];b.indexOf(" "+D+" ")>-1;)b=b.replace(" "+D+" "," ");O=Fr(b),A!==O&&this.setAttribute("class",O)}}):this):this.attr("class","")},toggleClass:function(n,u){var b,A,D,L,O=typeof n,U=O==="string"||Array.isArray(n);return S(n)?this.each(function(H){l(this).toggleClass(n.call(this,H,jr(this),u),u)}):typeof u=="boolean"&&U?u?this.addClass(n):this.removeClass(n):(b=As(n),this.each(function(){if(U)for(L=l(this),D=0;D<b.length;D++)A=b[D],L.hasClass(A)?L.removeClass(A):L.addClass(A);else(n===void 0||O==="boolean")&&(A=jr(this),A&&be.set(this,"__className__",A),this.setAttribute&&this.setAttribute("class",A||n===!1?"":be.get(this,"__className__")||""))}))},hasClass:function(n){var u,b,A=0;for(u=" "+n+" ";b=this[A++];)if(b.nodeType===1&&(" "+Fr(jr(b))+" ").indexOf(u)>-1)return!0;return!1}});var uf=/\r/g;l.fn.extend({val:function(n){var u,b,A,D=this[0];return arguments.length?(A=S(n),this.each(function(L){var O;this.nodeType===1&&(A?O=n.call(this,L,l(this).val()):O=n,O==null?O="":typeof O=="number"?O+="":Array.isArray(O)&&(O=l.map(O,function(U){return U==null?"":U+""})),u=l.valHooks[this.type]||l.valHooks[this.nodeName.toLowerCase()],(!u||!("set"in u)||u.set(this,O,"value")===void 0)&&(this.value=O))})):D?(u=l.valHooks[D.type]||l.valHooks[D.nodeName.toLowerCase()],u&&"get"in u&&(b=u.get(D,"value"))!==void 0?b:(b=D.value,typeof b=="string"?b.replace(uf,""):b??"")):void 0}}),l.extend({valHooks:{option:{get:function(n){var u=l.find.attr(n,"value");return u??Fr(l.text(n))}},select:{get:function(n){var u,b,A,D=n.options,L=n.selectedIndex,O=n.type==="select-one",U=O?null:[],H=O?L+1:D.length;for(L<0?A=H:A=O?L:0;A<H;A++)if(b=D[A],(b.selected||A===L)&&!b.disabled&&(!b.parentNode.disabled||!x(b.parentNode,"optgroup"))){if(u=l(b).val(),O)return u;U.push(u)}return U},set:function(n,u){for(var b,A,D=n.options,L=l.makeArray(u),O=D.length;O--;)A=D[O],(A.selected=l.inArray(l.valHooks.option.get(A),L)>-1)&&(b=!0);return b||(n.selectedIndex=-1),L}}}}),l.each(["radio","checkbox"],function(){l.valHooks[this]={set:function(n,u){if(Array.isArray(u))return n.checked=l.inArray(l(n).val(),u)>-1}},C.checkOn||(l.valHooks[this].get=function(n){return n.getAttribute("value")===null?"on":n.value})});var Ni=e.location,$a={guid:Date.now()},Rs=/\?/;l.parseXML=function(n){var u,b;if(!n||typeof n!="string")return null;try{u=new e.DOMParser().parseFromString(n,"text/xml")}catch{}return b=u&&u.getElementsByTagName("parsererror")[0],(!u||b)&&l.error("Invalid XML: "+(b?l.map(b.childNodes,function(A){return A.textContent}).join(`
`):n)),u};var Fa=/^(?:focusinfocus|focusoutblur)$/,ja=function(n){n.stopPropagation()};l.extend(l.event,{trigger:function(n,u,b,A){var D,L,O,U,H,G,Z,ne,J=[b||p],le=_.call(n,"type")?n.type:n,Re=_.call(n,"namespace")?n.namespace.split("."):[];if(L=ne=O=b=b||p,!(b.nodeType===3||b.nodeType===8)&&!Fa.test(le+l.event.triggered)&&(le.indexOf(".")>-1&&(Re=le.split("."),le=Re.shift(),Re.sort()),H=le.indexOf(":")<0&&"on"+le,n=n[l.expando]?n:new l.Event(le,typeof n=="object"&&n),n.isTrigger=A?2:3,n.namespace=Re.join("."),n.rnamespace=n.namespace?new RegExp("(^|\\.)"+Re.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=void 0,n.target||(n.target=b),u=u==null?[n]:l.makeArray(u,[n]),Z=l.event.special[le]||{},!(!A&&Z.trigger&&Z.trigger.apply(b,u)===!1))){if(!A&&!Z.noBubble&&!h(b)){for(U=Z.delegateType||le,Fa.test(U+le)||(L=L.parentNode);L;L=L.parentNode)J.push(L),O=L;O===(b.ownerDocument||p)&&J.push(O.defaultView||O.parentWindow||e)}for(D=0;(L=J[D++])&&!n.isPropagationStopped();)ne=L,n.type=D>1?U:Z.bindType||le,G=(be.get(L,"events")||Object.create(null))[n.type]&&be.get(L,"handle"),G&&G.apply(L,u),G=H&&L[H],G&&G.apply&&lt(L)&&(n.result=G.apply(L,u),n.result===!1&&n.preventDefault());return n.type=le,!A&&!n.isDefaultPrevented()&&(!Z._default||Z._default.apply(J.pop(),u)===!1)&&lt(b)&&H&&S(b[le])&&!h(b)&&(O=b[H],O&&(b[H]=null),l.event.triggered=le,n.isPropagationStopped()&&ne.addEventListener(le,ja),b[le](),n.isPropagationStopped()&&ne.removeEventListener(le,ja),l.event.triggered=void 0,O&&(b[H]=O)),n.result}},simulate:function(n,u,b){var A=l.extend(new l.Event,b,{type:n,isSimulated:!0});l.event.trigger(A,null,u)}}),l.fn.extend({trigger:function(n,u){return this.each(function(){l.event.trigger(n,u,this)})},triggerHandler:function(n,u){var b=this[0];if(b)return l.event.trigger(n,u,b,!0)}});var ff=/\[\]$/,Ua=/\r?\n/g,df=/^(?:submit|button|image|reset|file)$/i,pf=/^(?:input|select|textarea|keygen)/i;function xs(n,u,b,A){var D;if(Array.isArray(u))l.each(u,function(L,O){b||ff.test(n)?A(n,O):xs(n+"["+(typeof O=="object"&&O!=null?L:"")+"]",O,b,A)});else if(!b&&T(u)==="object")for(D in u)xs(n+"["+D+"]",u[D],b,A);else A(n,u)}l.param=function(n,u){var b,A=[],D=function(L,O){var U=S(O)?O():O;A[A.length]=encodeURIComponent(L)+"="+encodeURIComponent(U??"")};if(n==null)return"";if(Array.isArray(n)||n.jquery&&!l.isPlainObject(n))l.each(n,function(){D(this.name,this.value)});else for(b in n)xs(b,n[b],u,D);return A.join("&")},l.fn.extend({serialize:function(){return l.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var n=l.prop(this,"elements");return n?l.makeArray(n):this}).filter(function(){var n=this.type;return this.name&&!l(this).is(":disabled")&&pf.test(this.nodeName)&&!df.test(n)&&(this.checked||!wr.test(n))}).map(function(n,u){var b=l(this).val();return b==null?null:Array.isArray(b)?l.map(b,function(A){return{name:u.name,value:A.replace(Ua,`\r
`)}}):{name:u.name,value:b.replace(Ua,`\r
`)}}).get()}});var _f=/%20/g,gf=/#.*$/,mf=/([?&])_=[^&]*/,vf=/^(.*?):[ \t]*([^\r\n]*)$/mg,yf=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Sf=/^(?:GET|HEAD)$/,bf=/^\/\//,Wa={},Ds={},za="*/".concat("*"),Ls=p.createElement("a");Ls.href=Ni.href;function Va(n){return function(u,b){typeof u!="string"&&(b=u,u="*");var A,D=0,L=u.toLowerCase().match(ae)||[];if(S(b))for(;A=L[D++];)A[0]==="+"?(A=A.slice(1)||"*",(n[A]=n[A]||[]).unshift(b)):(n[A]=n[A]||[]).push(b)}}function qa(n,u,b,A){var D={},L=n===Ds;function O(U){var H;return D[U]=!0,l.each(n[U]||[],function(G,Z){var ne=Z(u,b,A);if(typeof ne=="string"&&!L&&!D[ne])return u.dataTypes.unshift(ne),O(ne),!1;if(L)return!(H=ne)}),H}return O(u.dataTypes[0])||!D["*"]&&O("*")}function Os(n,u){var b,A,D=l.ajaxSettings.flatOptions||{};for(b in u)u[b]!==void 0&&((D[b]?n:A||(A={}))[b]=u[b]);return A&&l.extend(!0,n,A),n}function Cf(n,u,b){for(var A,D,L,O,U=n.contents,H=n.dataTypes;H[0]==="*";)H.shift(),A===void 0&&(A=n.mimeType||u.getResponseHeader("Content-Type"));if(A){for(D in U)if(U[D]&&U[D].test(A)){H.unshift(D);break}}if(H[0]in b)L=H[0];else{for(D in b){if(!H[0]||n.converters[D+" "+H[0]]){L=D;break}O||(O=D)}L=L||O}if(L)return L!==H[0]&&H.unshift(L),b[L]}function Ef(n,u,b,A){var D,L,O,U,H,G={},Z=n.dataTypes.slice();if(Z[1])for(O in n.converters)G[O.toLowerCase()]=n.converters[O];for(L=Z.shift();L;)if(n.responseFields[L]&&(b[n.responseFields[L]]=u),!H&&A&&n.dataFilter&&(u=n.dataFilter(u,n.dataType)),H=L,L=Z.shift(),L){if(L==="*")L=H;else if(H!=="*"&&H!==L){if(O=G[H+" "+L]||G["* "+L],!O){for(D in G)if(U=D.split(" "),U[1]===L&&(O=G[H+" "+U[0]]||G["* "+U[0]],O)){O===!0?O=G[D]:G[D]!==!0&&(L=U[0],Z.unshift(U[1]));break}}if(O!==!0)if(O&&n.throws)u=O(u);else try{u=O(u)}catch(ne){return{state:"parsererror",error:O?ne:"No conversion from "+H+" to "+L}}}}return{state:"success",data:u}}l.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ni.href,type:"GET",isLocal:yf.test(Ni.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":za,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":l.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(n,u){return u?Os(Os(n,l.ajaxSettings),u):Os(l.ajaxSettings,n)},ajaxPrefilter:Va(Wa),ajaxTransport:Va(Ds),ajax:function(n,u){typeof n=="object"&&(u=n,n=void 0),u=u||{};var b,A,D,L,O,U,H,G,Z,ne,J=l.ajaxSetup({},u),le=J.context||J,Re=J.context&&(le.nodeType||le.jquery)?l(le):l.event,Ne=l.Deferred(),De=l.Callbacks("once memory"),et=J.statusCode||{},Ze={},Qt={},Zt="canceled",Be={readyState:0,getResponseHeader:function(He){var Ge;if(H){if(!L)for(L={};Ge=vf.exec(D);)L[Ge[1].toLowerCase()+" "]=(L[Ge[1].toLowerCase()+" "]||[]).concat(Ge[2]);Ge=L[He.toLowerCase()+" "]}return Ge==null?null:Ge.join(", ")},getAllResponseHeaders:function(){return H?D:null},setRequestHeader:function(He,Ge){return H==null&&(He=Qt[He.toLowerCase()]=Qt[He.toLowerCase()]||He,Ze[He]=Ge),this},overrideMimeType:function(He){return H==null&&(J.mimeType=He),this},statusCode:function(He){var Ge;if(He)if(H)Be.always(He[Be.status]);else for(Ge in He)et[Ge]=[et[Ge],He[Ge]];return this},abort:function(He){var Ge=He||Zt;return b&&b.abort(Ge),Ur(0,Ge),this}};if(Ne.promise(Be),J.url=((n||J.url||Ni.href)+"").replace(bf,Ni.protocol+"//"),J.type=u.method||u.type||J.method||J.type,J.dataTypes=(J.dataType||"*").toLowerCase().match(ae)||[""],J.crossDomain==null){U=p.createElement("a");try{U.href=J.url,U.href=U.href,J.crossDomain=Ls.protocol+"//"+Ls.host!=U.protocol+"//"+U.host}catch{J.crossDomain=!0}}if(J.data&&J.processData&&typeof J.data!="string"&&(J.data=l.param(J.data,J.traditional)),qa(Wa,J,u,Be),H)return Be;G=l.event&&J.global,G&&l.active++===0&&l.event.trigger("ajaxStart"),J.type=J.type.toUpperCase(),J.hasContent=!Sf.test(J.type),A=J.url.replace(gf,""),J.hasContent?J.data&&J.processData&&(J.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(J.data=J.data.replace(_f,"+")):(ne=J.url.slice(A.length),J.data&&(J.processData||typeof J.data=="string")&&(A+=(Rs.test(A)?"&":"?")+J.data,delete J.data),J.cache===!1&&(A=A.replace(mf,"$1"),ne=(Rs.test(A)?"&":"?")+"_="+$a.guid+++ne),J.url=A+ne),J.ifModified&&(l.lastModified[A]&&Be.setRequestHeader("If-Modified-Since",l.lastModified[A]),l.etag[A]&&Be.setRequestHeader("If-None-Match",l.etag[A])),(J.data&&J.hasContent&&J.contentType!==!1||u.contentType)&&Be.setRequestHeader("Content-Type",J.contentType),Be.setRequestHeader("Accept",J.dataTypes[0]&&J.accepts[J.dataTypes[0]]?J.accepts[J.dataTypes[0]]+(J.dataTypes[0]!=="*"?", "+za+"; q=0.01":""):J.accepts["*"]);for(Z in J.headers)Be.setRequestHeader(Z,J.headers[Z]);if(J.beforeSend&&(J.beforeSend.call(le,Be,J)===!1||H))return Be.abort();if(Zt="abort",De.add(J.complete),Be.done(J.success),Be.fail(J.error),b=qa(Ds,J,u,Be),!b)Ur(-1,"No Transport");else{if(Be.readyState=1,G&&Re.trigger("ajaxSend",[Be,J]),H)return Be;J.async&&J.timeout>0&&(O=e.setTimeout(function(){Be.abort("timeout")},J.timeout));try{H=!1,b.send(Ze,Ur)}catch(He){if(H)throw He;Ur(-1,He)}}function Ur(He,Ge,$i,Ms){var er,Fi,tr,Ar,Rr,Mt=Ge;H||(H=!0,O&&e.clearTimeout(O),b=void 0,D=Ms||"",Be.readyState=He>0?4:0,er=He>=200&&He<300||He===304,$i&&(Ar=Cf(J,Be,$i)),!er&&l.inArray("script",J.dataTypes)>-1&&l.inArray("json",J.dataTypes)<0&&(J.converters["text script"]=function(){}),Ar=Ef(J,Ar,Be,er),er?(J.ifModified&&(Rr=Be.getResponseHeader("Last-Modified"),Rr&&(l.lastModified[A]=Rr),Rr=Be.getResponseHeader("etag"),Rr&&(l.etag[A]=Rr)),He===204||J.type==="HEAD"?Mt="nocontent":He===304?Mt="notmodified":(Mt=Ar.state,Fi=Ar.data,tr=Ar.error,er=!tr)):(tr=Mt,(He||!Mt)&&(Mt="error",He<0&&(He=0))),Be.status=He,Be.statusText=(Ge||Mt)+"",er?Ne.resolveWith(le,[Fi,Mt,Be]):Ne.rejectWith(le,[Be,Mt,tr]),Be.statusCode(et),et=void 0,G&&Re.trigger(er?"ajaxSuccess":"ajaxError",[Be,J,er?Fi:tr]),De.fireWith(le,[Be,Mt]),G&&(Re.trigger("ajaxComplete",[Be,J]),--l.active||l.event.trigger("ajaxStop")))}return Be},getJSON:function(n,u,b){return l.get(n,u,b,"json")},getScript:function(n,u){return l.get(n,void 0,u,"script")}}),l.each(["get","post"],function(n,u){l[u]=function(b,A,D,L){return S(A)&&(L=L||D,D=A,A=void 0),l.ajax(l.extend({url:b,type:u,dataType:L,data:A,success:D},l.isPlainObject(b)&&b))}}),l.ajaxPrefilter(function(n){var u;for(u in n.headers)u.toLowerCase()==="content-type"&&(n.contentType=n.headers[u]||"")}),l._evalUrl=function(n,u,b){return l.ajax({url:n,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(A){l.globalEval(A,u,b)}})},l.fn.extend({wrapAll:function(n){var u;return this[0]&&(S(n)&&(n=n.call(this[0])),u=l(n,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&u.insertBefore(this[0]),u.map(function(){for(var b=this;b.firstElementChild;)b=b.firstElementChild;return b}).append(this)),this},wrapInner:function(n){return S(n)?this.each(function(u){l(this).wrapInner(n.call(this,u))}):this.each(function(){var u=l(this),b=u.contents();b.length?b.wrapAll(n):u.append(n)})},wrap:function(n){var u=S(n);return this.each(function(b){l(this).wrapAll(u?n.call(this,b):n)})},unwrap:function(n){return this.parent(n).not("body").each(function(){l(this).replaceWith(this.childNodes)}),this}}),l.expr.pseudos.hidden=function(n){return!l.expr.pseudos.visible(n)},l.expr.pseudos.visible=function(n){return!!(n.offsetWidth||n.offsetHeight||n.getClientRects().length)},l.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch{}};var Tf={0:200,1223:204},Hi=l.ajaxSettings.xhr();C.cors=!!Hi&&"withCredentials"in Hi,C.ajax=Hi=!!Hi,l.ajaxTransport(function(n){var u,b;if(C.cors||Hi&&!n.crossDomain)return{send:function(A,D){var L,O=n.xhr();if(O.open(n.type,n.url,n.async,n.username,n.password),n.xhrFields)for(L in n.xhrFields)O[L]=n.xhrFields[L];n.mimeType&&O.overrideMimeType&&O.overrideMimeType(n.mimeType),!n.crossDomain&&!A["X-Requested-With"]&&(A["X-Requested-With"]="XMLHttpRequest");for(L in A)O.setRequestHeader(L,A[L]);u=function(U){return function(){u&&(u=b=O.onload=O.onerror=O.onabort=O.ontimeout=O.onreadystatechange=null,U==="abort"?O.abort():U==="error"?typeof O.status!="number"?D(0,"error"):D(O.status,O.statusText):D(Tf[O.status]||O.status,O.statusText,(O.responseType||"text")!=="text"||typeof O.responseText!="string"?{binary:O.response}:{text:O.responseText},O.getAllResponseHeaders()))}},O.onload=u(),b=O.onerror=O.ontimeout=u("error"),O.onabort!==void 0?O.onabort=b:O.onreadystatechange=function(){O.readyState===4&&e.setTimeout(function(){u&&b()})},u=u("abort");try{O.send(n.hasContent&&n.data||null)}catch(U){if(u)throw U}},abort:function(){u&&u()}}}),l.ajaxPrefilter(function(n){n.crossDomain&&(n.contents.script=!1)}),l.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(n){return l.globalEval(n),n}}}),l.ajaxPrefilter("script",function(n){n.cache===void 0&&(n.cache=!1),n.crossDomain&&(n.type="GET")}),l.ajaxTransport("script",function(n){if(n.crossDomain||n.scriptAttrs){var u,b;return{send:function(A,D){u=l("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",b=function(L){u.remove(),b=null,L&&D(L.type==="error"?404:200,L.type)}),p.head.appendChild(u[0])},abort:function(){b&&b()}}}});var Ka=[],Ps=/(=)\?(?=&|$)|\?\?/;l.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var n=Ka.pop()||l.expando+"_"+$a.guid++;return this[n]=!0,n}}),l.ajaxPrefilter("json jsonp",function(n,u,b){var A,D,L,O=n.jsonp!==!1&&(Ps.test(n.url)?"url":typeof n.data=="string"&&(n.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Ps.test(n.data)&&"data");if(O||n.dataTypes[0]==="jsonp")return A=n.jsonpCallback=S(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,O?n[O]=n[O].replace(Ps,"$1"+A):n.jsonp!==!1&&(n.url+=(Rs.test(n.url)?"&":"?")+n.jsonp+"="+A),n.converters["script json"]=function(){return L||l.error(A+" was not called"),L[0]},n.dataTypes[0]="json",D=e[A],e[A]=function(){L=arguments},b.always(function(){D===void 0?l(e).removeProp(A):e[A]=D,n[A]&&(n.jsonpCallback=u.jsonpCallback,Ka.push(A)),L&&S(D)&&D(L[0]),L=D=void 0}),"script"}),C.createHTMLDocument=function(){var n=p.implementation.createHTMLDocument("").body;return n.innerHTML="<form></form><form></form>",n.childNodes.length===2}(),l.parseHTML=function(n,u,b){if(typeof n!="string")return[];typeof u=="boolean"&&(b=u,u=!1);var A,D,L;return u||(C.createHTMLDocument?(u=p.implementation.createHTMLDocument(""),A=u.createElement("base"),A.href=p.location.href,u.head.appendChild(A)):u=p),D=ge.exec(n),L=!b&&[],D?[u.createElement(D[1])]:(D=gn([n],u,L),L&&L.length&&l(L).remove(),l.merge([],D.childNodes))},l.fn.load=function(n,u,b){var A,D,L,O=this,U=n.indexOf(" ");return U>-1&&(A=Fr(n.slice(U)),n=n.slice(0,U)),S(u)?(b=u,u=void 0):u&&typeof u=="object"&&(D="POST"),O.length>0&&l.ajax({url:n,type:D||"GET",dataType:"html",data:u}).done(function(H){L=arguments,O.html(A?l("<div>").append(l.parseHTML(H)).find(A):H)}).always(b&&function(H,G){O.each(function(){b.apply(this,L||[H.responseText,G,H])})}),this},l.expr.pseudos.animated=function(n){return l.grep(l.timers,function(u){return n===u.elem}).length},l.offset={setOffset:function(n,u,b){var A,D,L,O,U,H,G,Z=l.css(n,"position"),ne=l(n),J={};Z==="static"&&(n.style.position="relative"),U=ne.offset(),L=l.css(n,"top"),H=l.css(n,"left"),G=(Z==="absolute"||Z==="fixed")&&(L+H).indexOf("auto")>-1,G?(A=ne.position(),O=A.top,D=A.left):(O=parseFloat(L)||0,D=parseFloat(H)||0),S(u)&&(u=u.call(n,b,l.extend({},U))),u.top!=null&&(J.top=u.top-U.top+O),u.left!=null&&(J.left=u.left-U.left+D),"using"in u?u.using.call(n,J):ne.css(J)}},l.fn.extend({offset:function(n){if(arguments.length)return n===void 0?this:this.each(function(D){l.offset.setOffset(this,n,D)});var u,b,A=this[0];if(A)return A.getClientRects().length?(u=A.getBoundingClientRect(),b=A.ownerDocument.defaultView,{top:u.top+b.pageYOffset,left:u.left+b.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var n,u,b,A=this[0],D={top:0,left:0};if(l.css(A,"position")==="fixed")u=A.getBoundingClientRect();else{for(u=this.offset(),b=A.ownerDocument,n=A.offsetParent||b.documentElement;n&&(n===b.body||n===b.documentElement)&&l.css(n,"position")==="static";)n=n.parentNode;n&&n!==A&&n.nodeType===1&&(D=l(n).offset(),D.top+=l.css(n,"borderTopWidth",!0),D.left+=l.css(n,"borderLeftWidth",!0))}return{top:u.top-D.top-l.css(A,"marginTop",!0),left:u.left-D.left-l.css(A,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var n=this.offsetParent;n&&l.css(n,"position")==="static";)n=n.offsetParent;return n||Ut})}}),l.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(n,u){var b=u==="pageYOffset";l.fn[n]=function(A){return mt(this,function(D,L,O){var U;if(h(D)?U=D:D.nodeType===9&&(U=D.defaultView),O===void 0)return U?U[u]:D[L];U?U.scrollTo(b?U.pageXOffset:O,b?O:U.pageYOffset):D[L]=O},n,A,arguments.length)}}),l.each(["top","left"],function(n,u){l.cssHooks[u]=oi(C.pixelPosition,function(b,A){if(A)return A=st(b,u),_e.test(A)?l(b).position()[u]+"px":A})}),l.each({Height:"height",Width:"width"},function(n,u){l.each({padding:"inner"+n,content:u,"":"outer"+n},function(b,A){l.fn[A]=function(D,L){var O=arguments.length&&(b||typeof D!="boolean"),U=b||(D===!0||L===!0?"margin":"border");return mt(this,function(H,G,Z){var ne;return h(H)?A.indexOf("outer")===0?H["inner"+n]:H.document.documentElement["client"+n]:H.nodeType===9?(ne=H.documentElement,Math.max(H.body["scroll"+n],ne["scroll"+n],H.body["offset"+n],ne["offset"+n],ne["client"+n])):Z===void 0?l.css(H,G,U):l.style(H,G,Z,U)},u,O?D:void 0,O)}})}),l.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(n,u){l.fn[u]=function(b){return this.on(u,b)}}),l.fn.extend({bind:function(n,u,b){return this.on(n,null,u,b)},unbind:function(n,u){return this.off(n,null,u)},delegate:function(n,u,b,A){return this.on(u,n,b,A)},undelegate:function(n,u,b){return arguments.length===1?this.off(n,"**"):this.off(u,n||"**",b)},hover:function(n,u){return this.mouseenter(n).mouseleave(u||n)}}),l.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(n,u){l.fn[u]=function(b,A){return arguments.length>0?this.on(u,null,b,A):this.trigger(u)}});var wf=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;l.proxy=function(n,u){var b,A,D;if(typeof u=="string"&&(b=n[u],u=n,n=b),!!S(n))return A=f.call(arguments,2),D=function(){return n.apply(u||this,A.concat(f.call(arguments)))},D.guid=n.guid=n.guid||l.guid++,D},l.holdReady=function(n){n?l.readyWait++:l.ready(!0)},l.isArray=Array.isArray,l.parseJSON=JSON.parse,l.nodeName=x,l.isFunction=S,l.isWindow=h,l.camelCase=Je,l.type=T,l.now=Date.now,l.isNumeric=function(n){var u=l.type(n);return(u==="number"||u==="string")&&!isNaN(n-parseFloat(n))},l.trim=function(n){return n==null?"":(n+"").replace(wf,"$1")};var kf=e.jQuery,Af=e.$;return l.noConflict=function(n){return e.$===l&&(e.$=Af),n&&e.jQuery===l&&(e.jQuery=kf),l},typeof r>"u"&&(e.jQuery=e.$=l),l})})(Vu);var Hy=Vu.exports;const qi=ls(Hy);function $y(t,e){let r=document.querySelector(t);var i;qi(`${e}`).on("click",function(){navigator.clipboard.writeText(r.value).then(()=>{yr.getInstance(e).setContent({".tooltip-inner":"Copied!"}),qi(`${e}.btn-primary`).hide(),qi(`${e}.btn-success`).show(),i&&clearTimeout(i),i=setTimeout(()=>{qi(`${e}.btn-primary`).show(),qi(`${e}.btn-success`).hide(),yr.getInstance(e).setContent({".tooltip-inner":"Copy to clipboard"})},2e3)},function(a){console.error("Async: Could not copy text: ",a)})})}var qu={exports:{}};(function(t,e){(function(r,i){t.exports=i()})(self,function(){return(()=>{var r={};return(()=>{var i=r;Object.defineProperty(i,"__esModule",{value:!0}),i.FitAddon=void 0,i.FitAddon=class{constructor(){}activate(a){this._terminal=a}dispose(){}fit(){const a=this.proposeDimensions();if(!a||!this._terminal||isNaN(a.cols)||isNaN(a.rows))return;const f=this._terminal._core;this._terminal.rows===a.rows&&this._terminal.cols===a.cols||(f._renderService.clear(),this._terminal.resize(a.cols,a.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const a=this._terminal._core,f=a._renderService.dimensions;if(f.css.cell.width===0||f.css.cell.height===0)return;const y=this._terminal.options.scrollback===0?0:a.viewport.scrollBarWidth,s=window.getComputedStyle(this._terminal.element.parentElement),o=parseInt(s.getPropertyValue("height")),c=Math.max(0,parseInt(s.getPropertyValue("width"))),d=window.getComputedStyle(this._terminal.element),_=o-(parseInt(d.getPropertyValue("padding-top"))+parseInt(d.getPropertyValue("padding-bottom"))),v=c-(parseInt(d.getPropertyValue("padding-right"))+parseInt(d.getPropertyValue("padding-left")))-y;return{cols:Math.max(2,Math.floor(v/f.css.cell.width)),rows:Math.max(1,Math.floor(_/f.css.cell.height))}}}})(),r})()})})(qu);var Fy=qu.exports,Ku={exports:{}};(function(t,e){(function(r,i){t.exports=i()})(self,()=>(()=>{var r={345:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.forwardEvent=s.EventEmitter=void 0,s.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=o=>(this._listeners.push(o),{dispose:()=>{if(!this._disposed){for(let c=0;c<this._listeners.length;c++)if(this._listeners[c]===o)return void this._listeners.splice(c,1)}}})),this._event}fire(o,c){const d=[];for(let _=0;_<this._listeners.length;_++)d.push(this._listeners[_]);for(let _=0;_<d.length;_++)d[_].call(void 0,o,c)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},s.forwardEvent=function(o,c){return o(d=>c.fire(d))}},859:(y,s)=>{function o(c){for(const d of c)d.dispose();c.length=0}Object.defineProperty(s,"__esModule",{value:!0}),s.getDisposeArrayDisposable=s.disposeArray=s.toDisposable=s.Disposable=void 0,s.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const c of this._disposables)c.dispose();this._disposables.length=0}register(c){return this._disposables.push(c),c}unregister(c){const d=this._disposables.indexOf(c);d!==-1&&this._disposables.splice(d,1)}},s.toDisposable=function(c){return{dispose:c}},s.disposeArray=o,s.getDisposeArrayDisposable=function(c){return{dispose:()=>o(c)}}}},i={};function a(y){var s=i[y];if(s!==void 0)return s.exports;var o=i[y]={exports:{}};return r[y](o,o.exports,a),o.exports}var f={};return(()=>{var y=f;Object.defineProperty(y,"__esModule",{value:!0}),y.SearchAddon=void 0;const s=a(345),o=a(859),c=" ~!@#$%^&*()+`-=[]{}|\\;:\"',./<>?";class d extends o.Disposable{constructor(v){var E;super(),this._highlightedLines=new Set,this._highlightDecorations=[],this._linesCacheTimeoutId=0,this._onDidChangeResults=this.register(new s.EventEmitter),this.onDidChangeResults=this._onDidChangeResults.event,this._highlightLimit=(E=v==null?void 0:v.highlightLimit)!==null&&E!==void 0?E:1e3}activate(v){this._terminal=v,this._onDataDisposable=this.register(this._terminal.onWriteParsed(()=>this._updateMatches())),this._onResizeDisposable=this.register(this._terminal.onResize(()=>this._updateMatches())),this.register((0,o.toDisposable)(()=>{var E,C;this.clearDecorations(),(E=this._onDataDisposable)===null||E===void 0||E.dispose(),(C=this._onResizeDisposable)===null||C===void 0||C.dispose()}))}_updateMatches(){var v;this._highlightTimeout&&window.clearTimeout(this._highlightTimeout),this._cachedSearchTerm&&(!((v=this._lastSearchOptions)===null||v===void 0)&&v.decorations)&&(this._highlightTimeout=setTimeout(()=>{const E=this._cachedSearchTerm;this._cachedSearchTerm=void 0,this.findPrevious(E,Object.assign(Object.assign({},this._lastSearchOptions),{incremental:!0,noScroll:!0}))},200))}clearDecorations(v){this.clearActiveDecoration(),(0,o.disposeArray)(this._highlightDecorations),this._highlightDecorations=[],this._highlightedLines.clear(),v||(this._cachedSearchTerm=void 0)}clearActiveDecoration(){var v;(v=this._selectedDecoration)===null||v===void 0||v.dispose(),this._selectedDecoration=void 0}findNext(v,E){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");this._lastSearchOptions=E,E!=null&&E.decorations&&(this._cachedSearchTerm!==void 0&&v===this._cachedSearchTerm||this._highlightAllMatches(v,E));const C=this._findNextAndSelect(v,E);return this._fireResults(E),this._cachedSearchTerm=v,C}_highlightAllMatches(v,E){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");if(!v||v.length===0)return void this.clearDecorations();E=E||{},this.clearDecorations(!0);const C=[];let S,h=this._find(v,0,0,E);for(;h&&((S==null?void 0:S.row)!==h.row||(S==null?void 0:S.col)!==h.col)&&!(C.length>=this._highlightLimit);)S=h,C.push(S),h=this._find(v,S.col+S.term.length>=this._terminal.cols?S.row+1:S.row,S.col+S.term.length>=this._terminal.cols?0:S.col+1,E);for(const p of C){const g=this._createResultDecoration(p,E.decorations);g&&(this._highlightedLines.add(g.marker.line),this._highlightDecorations.push({decoration:g,match:p,dispose(){g.dispose()}}))}}_find(v,E,C,S){var h;if(!this._terminal||!v||v.length===0)return(h=this._terminal)===null||h===void 0||h.clearSelection(),void this.clearDecorations();if(C>this._terminal.cols)throw new Error(`Invalid col: ${C} to search in terminal of ${this._terminal.cols} cols`);let p;this._initLinesCache();const g={startRow:E,startCol:C};if(p=this._findInLine(v,g,S),!p)for(let m=E+1;m<this._terminal.buffer.active.baseY+this._terminal.rows&&(g.startRow=m,g.startCol=0,p=this._findInLine(v,g,S),!p);m++);return p}_findNextAndSelect(v,E){var C;if(!this._terminal||!v||v.length===0)return(C=this._terminal)===null||C===void 0||C.clearSelection(),this.clearDecorations(),!1;const S=this._terminal.getSelectionPosition();this._terminal.clearSelection();let h=0,p=0;S&&(this._cachedSearchTerm===v?(h=S.end.x,p=S.end.y):(h=S.start.x,p=S.start.y)),this._initLinesCache();const g={startRow:p,startCol:h};let m=this._findInLine(v,g,E);if(!m)for(let T=p+1;T<this._terminal.buffer.active.baseY+this._terminal.rows&&(g.startRow=T,g.startCol=0,m=this._findInLine(v,g,E),!m);T++);if(!m&&p!==0)for(let T=0;T<p&&(g.startRow=T,g.startCol=0,m=this._findInLine(v,g,E),!m);T++);return!m&&S&&(g.startRow=S.start.y,g.startCol=0,m=this._findInLine(v,g,E)),this._selectResult(m,E==null?void 0:E.decorations,E==null?void 0:E.noScroll)}findPrevious(v,E){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");this._lastSearchOptions=E,E!=null&&E.decorations&&(this._cachedSearchTerm!==void 0&&v===this._cachedSearchTerm||this._highlightAllMatches(v,E));const C=this._findPreviousAndSelect(v,E);return this._fireResults(E),this._cachedSearchTerm=v,C}_fireResults(v){if(v!=null&&v.decorations){let E=-1;if(this._selectedDecoration){const C=this._selectedDecoration.match;for(let S=0;S<this._highlightDecorations.length;S++){const h=this._highlightDecorations[S].match;if(h.row===C.row&&h.col===C.col&&h.size===C.size){E=S;break}}}this._onDidChangeResults.fire({resultIndex:E,resultCount:this._highlightDecorations.length})}}_findPreviousAndSelect(v,E){var C;if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");if(!this._terminal||!v||v.length===0)return(C=this._terminal)===null||C===void 0||C.clearSelection(),this.clearDecorations(),!1;const S=this._terminal.getSelectionPosition();this._terminal.clearSelection();let h=this._terminal.buffer.active.baseY+this._terminal.rows-1,p=this._terminal.cols;const g=!0;this._initLinesCache();const m={startRow:h,startCol:p};let T;if(S&&(m.startRow=h=S.start.y,m.startCol=p=S.start.x,this._cachedSearchTerm!==v&&(T=this._findInLine(v,m,E,!1),T||(m.startRow=h=S.end.y,m.startCol=p=S.end.x))),T||(T=this._findInLine(v,m,E,g)),!T){m.startCol=Math.max(m.startCol,this._terminal.cols);for(let w=h-1;w>=0&&(m.startRow=w,T=this._findInLine(v,m,E,g),!T);w--);}if(!T&&h!==this._terminal.buffer.active.baseY+this._terminal.rows-1)for(let w=this._terminal.buffer.active.baseY+this._terminal.rows-1;w>=h&&(m.startRow=w,T=this._findInLine(v,m,E,g),!T);w--);return this._selectResult(T,E==null?void 0:E.decorations,E==null?void 0:E.noScroll)}_initLinesCache(){const v=this._terminal;this._linesCache||(this._linesCache=new Array(v.buffer.active.length),this._cursorMoveListener=v.onCursorMove(()=>this._destroyLinesCache()),this._resizeListener=v.onResize(()=>this._destroyLinesCache())),window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=window.setTimeout(()=>this._destroyLinesCache(),15e3)}_destroyLinesCache(){this._linesCache=void 0,this._cursorMoveListener&&(this._cursorMoveListener.dispose(),this._cursorMoveListener=void 0),this._resizeListener&&(this._resizeListener.dispose(),this._resizeListener=void 0),this._linesCacheTimeoutId&&(window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=0)}_isWholeWord(v,E,C){return(v===0||c.includes(E[v-1]))&&(v+C.length===E.length||c.includes(E[v+C.length]))}_findInLine(v,E,C={},S=!1){var h;const p=this._terminal,g=E.startRow,m=E.startCol,T=p.buffer.active.getLine(g);if(T!=null&&T.isWrapped)return S?void(E.startCol+=p.cols):(E.startRow--,E.startCol+=p.cols,this._findInLine(v,E,C));let w=(h=this._linesCache)===null||h===void 0?void 0:h[g];w||(w=this._translateBufferLineToStringWithWrap(g,!0),this._linesCache&&(this._linesCache[g]=w));const[R,l]=w,k=this._bufferColsToStringOffset(g,m),x=C.caseSensitive?v:v.toLowerCase(),M=C.caseSensitive?R:R.toLowerCase();let $=-1;if(C.regex){const B=RegExp(x,"g");let N;if(S)for(;N=B.exec(M.slice(0,k));)$=B.lastIndex-N[0].length,v=N[0],B.lastIndex-=v.length-1;else N=B.exec(M.slice(k)),N&&N[0].length>0&&($=k+(B.lastIndex-N[0].length),v=N[0])}else S?k-x.length>=0&&($=M.lastIndexOf(x,k-x.length)):$=M.indexOf(x,k);if($>=0){if(C.wholeWord&&!this._isWholeWord($,M,v))return;let B=0;for(;B<l.length-1&&$>=l[B+1];)B++;let N=B;for(;N<l.length-1&&$+v.length>=l[N+1];)N++;const ee=$-l[B],ue=$+v.length-l[N],se=this._stringLengthToBufferSize(g+B,ee);return{term:v,col:se,row:g+B,size:this._stringLengthToBufferSize(g+N,ue)-se+p.cols*(N-B)}}}_stringLengthToBufferSize(v,E){const C=this._terminal.buffer.active.getLine(v);if(!C)return 0;for(let S=0;S<E;S++){const h=C.getCell(S);if(!h)break;const p=h.getChars();p.length>1&&(E-=p.length-1);const g=C.getCell(S+1);g&&g.getWidth()===0&&E++}return E}_bufferColsToStringOffset(v,E){const C=this._terminal;let S=v,h=0,p=C.buffer.active.getLine(S);for(;E>0&&p;){for(let g=0;g<E&&g<C.cols;g++){const m=p.getCell(g);if(!m)break;m.getWidth()&&(h+=m.getCode()===0?1:m.getChars().length)}if(S++,p=C.buffer.active.getLine(S),p&&!p.isWrapped)break;E-=C.cols}return h}_translateBufferLineToStringWithWrap(v,E){var C;const S=this._terminal,h=[],p=[0];let g=S.buffer.active.getLine(v);for(;g;){const m=S.buffer.active.getLine(v+1),T=!!m&&m.isWrapped;let w=g.translateToString(!T&&E);if(T&&m){const R=g.getCell(g.length-1);R&&R.getCode()===0&&R.getWidth()===1&&((C=m.getCell(0))===null||C===void 0?void 0:C.getWidth())===2&&(w=w.slice(0,-1))}if(h.push(w),!T)break;p.push(p[p.length-1]+w.length),v++,g=m}return[h.join(""),p]}_selectResult(v,E,C){const S=this._terminal;if(this.clearActiveDecoration(),!v)return S.clearSelection(),!1;if(S.select(v.col,v.row,v.size),E){const h=S.registerMarker(-S.buffer.active.baseY-S.buffer.active.cursorY+v.row);if(h){const p=S.registerDecoration({marker:h,x:v.col,width:v.size,backgroundColor:E.activeMatchBackground,layer:"top",overviewRulerOptions:{color:E.activeMatchColorOverviewRuler}});if(p){const g=[];g.push(h),g.push(p.onRender(m=>this._applyStyles(m,E.activeMatchBorder,!0))),g.push(p.onDispose(()=>(0,o.disposeArray)(g))),this._selectedDecoration={decoration:p,match:v,dispose(){p.dispose()}}}}}if(!C&&(v.row>=S.buffer.active.viewportY+S.rows||v.row<S.buffer.active.viewportY)){let h=v.row-S.buffer.active.viewportY;h-=Math.floor(S.rows/2),S.scrollLines(h)}return!0}_applyStyles(v,E,C){v.classList.contains("xterm-find-result-decoration")||(v.classList.add("xterm-find-result-decoration"),E&&(v.style.outline=`1px solid ${E}`)),C&&v.classList.add("xterm-find-active-result-decoration")}_createResultDecoration(v,E){const C=this._terminal,S=C.registerMarker(-C.buffer.active.baseY-C.buffer.active.cursorY+v.row);if(!S)return;const h=C.registerDecoration({marker:S,x:v.col,width:v.size,backgroundColor:E.matchBackground,overviewRulerOptions:this._highlightedLines.has(S.line)?void 0:{color:E.matchOverviewRuler,position:"center"}});if(h){const p=[];p.push(S),p.push(h.onRender(g=>this._applyStyles(g,E.matchBorder,!1))),p.push(h.onDispose(()=>(0,o.disposeArray)(p)))}return h}}y.SearchAddon=d})(),f})())})(Ku);var jy=Ku.exports,Gu={exports:{}};(function(t,e){(function(r,i){t.exports=i()})(self,()=>(()=>{var r={4567:function(y,s,o){var c=this&&this.__decorate||function(m,T,w,R){var l,k=arguments.length,x=k<3?T:R===null?R=Object.getOwnPropertyDescriptor(T,w):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(m,T,w,R);else for(var M=m.length-1;M>=0;M--)(l=m[M])&&(x=(k<3?l(x):k>3?l(T,w,x):l(T,w))||x);return k>3&&x&&Object.defineProperty(T,w,x),x},d=this&&this.__param||function(m,T){return function(w,R){T(w,R,m)}};Object.defineProperty(s,"__esModule",{value:!0}),s.AccessibilityManager=void 0;const _=o(9042),v=o(6114),E=o(9924),C=o(844),S=o(5596),h=o(4725),p=o(3656);let g=class extends C.Disposable{constructor(m,T){super(),this._terminal=m,this._renderService=T,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let w=0;w<this._terminal.rows;w++)this._rowElements[w]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[w]);if(this._topBoundaryFocusListener=w=>this._handleBoundaryFocus(w,0),this._bottomBoundaryFocusListener=w=>this._handleBoundaryFocus(w,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new E.TimeBasedDebouncer(this._announceCharacters.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._liveRegionDebouncer),this.register(this._terminal.onResize(w=>this._handleResize(w.rows))),this.register(this._terminal.onRender(w=>this._refreshRows(w.start,w.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(w=>this._handleChar(w))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(w=>this._handleTab(w))),this.register(this._terminal.onKey(w=>this._handleKey(w.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new S.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,p.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,C.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(m){for(let T=0;T<m;T++)this._handleChar(" ")}_handleChar(m){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==m&&(this._charsToAnnounce+=m):this._charsToAnnounce+=m,m===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=_.tooMuchOutput)),v.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,v.isMac&&this._liveRegion.remove()}_handleKey(m){this._clearLiveRegion(),/\p{Control}/u.test(m)||this._charsToConsume.push(m)}_refreshRows(m,T){this._liveRegionDebouncer.refresh(m,T,this._terminal.rows)}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(m,T){const w=m.target,R=this._rowElements[T===0?1:this._rowElements.length-2];if(w.getAttribute("aria-posinset")===(T===0?"1":`${this._terminal.buffer.lines.length}`)||m.relatedTarget!==R)return;let l,k;if(T===0?(l=w,k=this._rowElements.pop(),this._rowContainer.removeChild(k)):(l=this._rowElements.shift(),k=w,this._rowContainer.removeChild(l)),l.removeEventListener("focus",this._topBoundaryFocusListener),k.removeEventListener("focus",this._bottomBoundaryFocusListener),T===0){const x=this._createAccessibilityTreeNode();this._rowElements.unshift(x),this._rowContainer.insertAdjacentElement("afterbegin",x)}else{const x=this._createAccessibilityTreeNode();this._rowElements.push(x),this._rowContainer.appendChild(x)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(T===0?-1:1),this._rowElements[T===0?1:this._rowElements.length-2].focus(),m.preventDefault(),m.stopImmediatePropagation()}_handleResize(m){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let T=this._rowContainer.children.length;T<this._terminal.rows;T++)this._rowElements[T]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[T]);for(;this._rowElements.length>m;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const m=document.createElement("div");return m.setAttribute("role","listitem"),m.tabIndex=-1,this._refreshRowDimensions(m),m}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let m=0;m<this._terminal.rows;m++)this._refreshRowDimensions(this._rowElements[m])}}_refreshRowDimensions(m){m.style.height=`${this._renderService.dimensions.css.cell.height}px`}};g=c([d(1,h.IRenderService)],g),s.AccessibilityManager=g},3614:(y,s)=>{function o(v){return v.replace(/\r?\n/g,"\r")}function c(v,E){return E?"\x1B[200~"+v+"\x1B[201~":v}function d(v,E,C){v=c(v=o(v),C.decPrivateModes.bracketedPasteMode),C.triggerDataEvent(v,!0),E.value=""}function _(v,E,C){const S=C.getBoundingClientRect(),h=v.clientX-S.left-10,p=v.clientY-S.top-10;E.style.width="20px",E.style.height="20px",E.style.left=`${h}px`,E.style.top=`${p}px`,E.style.zIndex="1000",E.focus()}Object.defineProperty(s,"__esModule",{value:!0}),s.rightClickHandler=s.moveTextAreaUnderMouseCursor=s.paste=s.handlePasteEvent=s.copyHandler=s.bracketTextForPaste=s.prepareTextForTerminal=void 0,s.prepareTextForTerminal=o,s.bracketTextForPaste=c,s.copyHandler=function(v,E){v.clipboardData&&v.clipboardData.setData("text/plain",E.selectionText),v.preventDefault()},s.handlePasteEvent=function(v,E,C){v.stopPropagation(),v.clipboardData&&d(v.clipboardData.getData("text/plain"),E,C)},s.paste=d,s.moveTextAreaUnderMouseCursor=_,s.rightClickHandler=function(v,E,C,S,h){_(v,E,C),h&&S.rightClickSelect(v),E.value=S.selectionText,E.select()}},7239:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ColorContrastCache=void 0;const c=o(1505);s.ColorContrastCache=class{constructor(){this._color=new c.TwoKeyMap,this._css=new c.TwoKeyMap}setCss(d,_,v){this._css.set(d,_,v)}getCss(d,_){return this._css.get(d,_)}setColor(d,_,v){this._color.set(d,_,v)}getColor(d,_){return this._color.get(d,_)}clear(){this._color.clear(),this._css.clear()}}},3656:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.addDisposableDomListener=void 0,s.addDisposableDomListener=function(o,c,d,_){o.addEventListener(c,d,_);let v=!1;return{dispose:()=>{v||(v=!0,o.removeEventListener(c,d,_))}}}},6465:function(y,s,o){var c=this&&this.__decorate||function(h,p,g,m){var T,w=arguments.length,R=w<3?p:m===null?m=Object.getOwnPropertyDescriptor(p,g):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(h,p,g,m);else for(var l=h.length-1;l>=0;l--)(T=h[l])&&(R=(w<3?T(R):w>3?T(p,g,R):T(p,g))||R);return w>3&&R&&Object.defineProperty(p,g,R),R},d=this&&this.__param||function(h,p){return function(g,m){p(g,m,h)}};Object.defineProperty(s,"__esModule",{value:!0}),s.Linkifier2=void 0;const _=o(2585),v=o(8460),E=o(844),C=o(3656);let S=class extends E.Disposable{constructor(h){super(),this._bufferService=h,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new v.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new v.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,E.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,E.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}get currentLink(){return this._currentLink}registerLinkProvider(h){return this._linkProviders.push(h),{dispose:()=>{const p=this._linkProviders.indexOf(h);p!==-1&&this._linkProviders.splice(p,1)}}}attachToDom(h,p,g){this._element=h,this._mouseService=p,this._renderService=g,this.register((0,C.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,C.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,C.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,C.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(h){if(this._lastMouseEvent=h,!this._element||!this._mouseService)return;const p=this._positionFromMouseEvent(h,this._element,this._mouseService);if(!p)return;this._isMouseOut=!1;const g=h.composedPath();for(let m=0;m<g.length;m++){const T=g[m];if(T.classList.contains("xterm"))break;if(T.classList.contains("xterm-hover"))return}this._lastBufferCell&&p.x===this._lastBufferCell.x&&p.y===this._lastBufferCell.y||(this._handleHover(p),this._lastBufferCell=p)}_handleHover(h){if(this._activeLine!==h.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(h,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,h)||(this._clearCurrentLink(),this._askForLink(h,!0))}_askForLink(h,p){var g,m;this._activeProviderReplies&&p||((g=this._activeProviderReplies)===null||g===void 0||g.forEach(w=>{w==null||w.forEach(R=>{R.link.dispose&&R.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=h.y);let T=!1;for(const[w,R]of this._linkProviders.entries())p?!((m=this._activeProviderReplies)===null||m===void 0)&&m.get(w)&&(T=this._checkLinkProviderResult(w,h,T)):R.provideLinks(h.y,l=>{var k,x;if(this._isMouseOut)return;const M=l==null?void 0:l.map($=>({link:$}));(k=this._activeProviderReplies)===null||k===void 0||k.set(w,M),T=this._checkLinkProviderResult(w,h,T),((x=this._activeProviderReplies)===null||x===void 0?void 0:x.size)===this._linkProviders.length&&this._removeIntersectingLinks(h.y,this._activeProviderReplies)})}_removeIntersectingLinks(h,p){const g=new Set;for(let m=0;m<p.size;m++){const T=p.get(m);if(T)for(let w=0;w<T.length;w++){const R=T[w],l=R.link.range.start.y<h?0:R.link.range.start.x,k=R.link.range.end.y>h?this._bufferService.cols:R.link.range.end.x;for(let x=l;x<=k;x++){if(g.has(x)){T.splice(w--,1);break}g.add(x)}}}}_checkLinkProviderResult(h,p,g){var m;if(!this._activeProviderReplies)return g;const T=this._activeProviderReplies.get(h);let w=!1;for(let R=0;R<h;R++)this._activeProviderReplies.has(R)&&!this._activeProviderReplies.get(R)||(w=!0);if(!w&&T){const R=T.find(l=>this._linkAtPosition(l.link,p));R&&(g=!0,this._handleNewLink(R))}if(this._activeProviderReplies.size===this._linkProviders.length&&!g)for(let R=0;R<this._activeProviderReplies.size;R++){const l=(m=this._activeProviderReplies.get(R))===null||m===void 0?void 0:m.find(k=>this._linkAtPosition(k.link,p));if(l){g=!0,this._handleNewLink(l);break}}return g}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(h){if(!this._element||!this._mouseService||!this._currentLink)return;const p=this._positionFromMouseEvent(h,this._element,this._mouseService);p&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,p)&&this._currentLink.link.activate(h,this._currentLink.link.text)}_clearCurrentLink(h,p){this._element&&this._currentLink&&this._lastMouseEvent&&(!h||!p||this._currentLink.link.range.start.y>=h&&this._currentLink.link.range.end.y<=p)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,E.disposeArray)(this._linkCacheDisposables))}_handleNewLink(h){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const p=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);p&&this._linkAtPosition(h.link,p)&&(this._currentLink=h,this._currentLink.state={decorations:{underline:h.link.decorations===void 0||h.link.decorations.underline,pointerCursor:h.link.decorations===void 0||h.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,h.link,this._lastMouseEvent),h.link.decorations={},Object.defineProperties(h.link.decorations,{pointerCursor:{get:()=>{var g,m;return(m=(g=this._currentLink)===null||g===void 0?void 0:g.state)===null||m===void 0?void 0:m.decorations.pointerCursor},set:g=>{var m,T;!((m=this._currentLink)===null||m===void 0)&&m.state&&this._currentLink.state.decorations.pointerCursor!==g&&(this._currentLink.state.decorations.pointerCursor=g,this._currentLink.state.isHovered&&((T=this._element)===null||T===void 0||T.classList.toggle("xterm-cursor-pointer",g)))}},underline:{get:()=>{var g,m;return(m=(g=this._currentLink)===null||g===void 0?void 0:g.state)===null||m===void 0?void 0:m.decorations.underline},set:g=>{var m,T,w;!((m=this._currentLink)===null||m===void 0)&&m.state&&((w=(T=this._currentLink)===null||T===void 0?void 0:T.state)===null||w===void 0?void 0:w.decorations.underline)!==g&&(this._currentLink.state.decorations.underline=g,this._currentLink.state.isHovered&&this._fireUnderlineEvent(h.link,g))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(g=>{if(!this._currentLink)return;const m=g.start===0?0:g.start+1+this._bufferService.buffer.ydisp,T=this._bufferService.buffer.ydisp+1+g.end;if(this._currentLink.link.range.start.y>=m&&this._currentLink.link.range.end.y<=T&&(this._clearCurrentLink(m,T),this._lastMouseEvent&&this._element)){const w=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);w&&this._askForLink(w,!1)}})))}_linkHover(h,p,g){var m;!((m=this._currentLink)===null||m===void 0)&&m.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(p,!0),this._currentLink.state.decorations.pointerCursor&&h.classList.add("xterm-cursor-pointer")),p.hover&&p.hover(g,p.text)}_fireUnderlineEvent(h,p){const g=h.range,m=this._bufferService.buffer.ydisp,T=this._createLinkUnderlineEvent(g.start.x-1,g.start.y-m-1,g.end.x,g.end.y-m-1,void 0);(p?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(T)}_linkLeave(h,p,g){var m;!((m=this._currentLink)===null||m===void 0)&&m.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(p,!1),this._currentLink.state.decorations.pointerCursor&&h.classList.remove("xterm-cursor-pointer")),p.leave&&p.leave(g,p.text)}_linkAtPosition(h,p){const g=h.range.start.y*this._bufferService.cols+h.range.start.x,m=h.range.end.y*this._bufferService.cols+h.range.end.x,T=p.y*this._bufferService.cols+p.x;return g<=T&&T<=m}_positionFromMouseEvent(h,p,g){const m=g.getCoords(h,p,this._bufferService.cols,this._bufferService.rows);if(m)return{x:m[0],y:m[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(h,p,g,m,T){return{x1:h,y1:p,x2:g,y2:m,cols:this._bufferService.cols,fg:T}}};S=c([d(0,_.IBufferService)],S),s.Linkifier2=S},9042:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.tooMuchOutput=s.promptLabel=void 0,s.promptLabel="Terminal input",s.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(y,s,o){var c=this&&this.__decorate||function(S,h,p,g){var m,T=arguments.length,w=T<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,p):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(S,h,p,g);else for(var R=S.length-1;R>=0;R--)(m=S[R])&&(w=(T<3?m(w):T>3?m(h,p,w):m(h,p))||w);return T>3&&w&&Object.defineProperty(h,p,w),w},d=this&&this.__param||function(S,h){return function(p,g){h(p,g,S)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OscLinkProvider=void 0;const _=o(511),v=o(2585);let E=class{constructor(S,h,p){this._bufferService=S,this._optionsService=h,this._oscLinkService=p}provideLinks(S,h){var p;const g=this._bufferService.buffer.lines.get(S-1);if(!g)return void h(void 0);const m=[],T=this._optionsService.rawOptions.linkHandler,w=new _.CellData,R=g.getTrimmedLength();let l=-1,k=-1,x=!1;for(let M=0;M<R;M++)if(k!==-1||g.hasContent(M)){if(g.loadCell(M,w),w.hasExtendedAttrs()&&w.extended.urlId){if(k===-1){k=M,l=w.extended.urlId;continue}x=w.extended.urlId!==l}else k!==-1&&(x=!0);if(x||k!==-1&&M===R-1){const $=(p=this._oscLinkService.getLinkData(l))===null||p===void 0?void 0:p.uri;if($){const B={start:{x:k+1,y:S},end:{x:M+(x||M!==R-1?0:1),y:S}};let N=!1;if(!(T!=null&&T.allowNonHttpProtocols))try{const ee=new URL($);["http:","https:"].includes(ee.protocol)||(N=!0)}catch{N=!0}N||m.push({text:$,range:B,activate:(ee,ue)=>T?T.activate(ee,ue,B):C(0,ue),hover:(ee,ue)=>{var se;return(se=T==null?void 0:T.hover)===null||se===void 0?void 0:se.call(T,ee,ue,B)},leave:(ee,ue)=>{var se;return(se=T==null?void 0:T.leave)===null||se===void 0?void 0:se.call(T,ee,ue,B)}})}x=!1,w.hasExtendedAttrs()&&w.extended.urlId?(k=M,l=w.extended.urlId):(k=-1,l=-1)}}h(m)}};function C(S,h){if(confirm(`Do you want to navigate to ${h}?

WARNING: This link could potentially be dangerous`)){const p=window.open();if(p){try{p.opener=null}catch{}p.location.href=h}else console.warn("Opening link blocked as opener could not be cleared")}}E=c([d(0,v.IBufferService),d(1,v.IOptionsService),d(2,v.IOscLinkService)],E),s.OscLinkProvider=E},6193:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.RenderDebouncer=void 0,s.RenderDebouncer=class{constructor(o,c){this._parentWindow=o,this._renderCallback=c,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(o){return this._refreshCallbacks.push(o),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(o,c,d){this._rowCount=d,o=o!==void 0?o:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,o):o,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const o=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(o,c),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const o of this._refreshCallbacks)o(0);this._refreshCallbacks=[]}}},5596:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ScreenDprMonitor=void 0;const c=o(844);class d extends c.Disposable{constructor(v){super(),this._parentWindow=v,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,c.toDisposable)(()=>{this.clearListener()}))}setListener(v){this._listener&&this.clearListener(),this._listener=v,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var v;this._outerListener&&((v=this._resolutionMediaMatchList)===null||v===void 0||v.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}s.ScreenDprMonitor=d},3236:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Terminal=void 0;const c=o(2950),d=o(1680),_=o(3614),v=o(2584),E=o(5435),C=o(9312),S=o(6114),h=o(3656),p=o(9042),g=o(4567),m=o(1296),T=o(7399),w=o(8460),R=o(8437),l=o(3230),k=o(4725),x=o(428),M=o(8934),$=o(6465),B=o(5114),N=o(8969),ee=o(8055),ue=o(4269),se=o(5941),P=o(3107),F=o(5744),j=o(9074),q=o(2585),te=o(3730),ge=o(844),me=o(6731),oe=typeof window<"u"?window.document:null;class pe extends N.CoreTerminal{constructor(W={}){super(W),this.browser=S,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._onCursorMove=this.register(new w.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new w.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new w.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new w.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new w.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new w.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new w.EventEmitter),this._onBlur=this.register(new w.EventEmitter),this._onA11yCharEmitter=this.register(new w.EventEmitter),this._onA11yTabEmitter=this.register(new w.EventEmitter),this._onWillOpen=this.register(new w.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance($.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(te.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(j.DecorationService),this._instantiationService.setService(q.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((Y,re)=>this.refresh(Y,re))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(Y=>this._reportWindowsOptions(Y))),this.register(this._inputHandler.onColor(Y=>this._handleColorEvent(Y))),this.register((0,w.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,w.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,w.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,w.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(Y=>this._afterResize(Y.cols,Y.rows))),this.register((0,ge.toDisposable)(()=>{var Y,re;this._customKeyEventHandler=void 0,(re=(Y=this.element)===null||Y===void 0?void 0:Y.parentNode)===null||re===void 0||re.removeChild(this.element)}))}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(W){if(this._themeService)for(const Y of W){let re,ae="";switch(Y.index){case 256:re="foreground",ae="10";break;case 257:re="background",ae="11";break;case 258:re="cursor",ae="12";break;default:re="ansi",ae="4;"+Y.index}switch(Y.type){case 0:const Oe=ee.color.toColorRGB(re==="ansi"?this._themeService.colors.ansi[Y.index]:this._themeService.colors[re]);this.coreService.triggerDataEvent(`${v.C0.ESC}]${ae};${(0,se.toRgbString)(Oe)}${v.C1_ESCAPED.ST}`);break;case 1:if(re==="ansi")this._themeService.modifyColors(de=>de.ansi[Y.index]=ee.rgba.toColor(...Y.color));else{const de=re;this._themeService.modifyColors(Fe=>Fe[de]=ee.rgba.toColor(...Y.color))}break;case 2:this._themeService.restoreColor(Y.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(W){var Y;W?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=this._instantiationService.createInstance(g.AccessibilityManager,this)):((Y=this._accessibilityManager)===null||Y===void 0||Y.dispose(),this._accessibilityManager=void 0)}_handleTextAreaFocus(W){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(v.C0.ESC+"[I"),this.updateCursorStyle(W),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var W;return(W=this.textarea)===null||W===void 0?void 0:W.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(v.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const W=this.buffer.ybase+this.buffer.y,Y=this.buffer.lines.get(W);if(!Y)return;const re=Math.min(this.buffer.x,this.cols-1),ae=this._renderService.dimensions.css.cell.height,Oe=Y.getWidth(re),de=this._renderService.dimensions.css.cell.width*Oe,Fe=this.buffer.y*this._renderService.dimensions.css.cell.height,Ue=re*this._renderService.dimensions.css.cell.width;this.textarea.style.left=Ue+"px",this.textarea.style.top=Fe+"px",this.textarea.style.width=de+"px",this.textarea.style.height=ae+"px",this.textarea.style.lineHeight=ae+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,h.addDisposableDomListener)(this.element,"copy",Y=>{this.hasSelection()&&(0,_.copyHandler)(Y,this._selectionService)}));const W=Y=>(0,_.handlePasteEvent)(Y,this.textarea,this.coreService);this.register((0,h.addDisposableDomListener)(this.textarea,"paste",W)),this.register((0,h.addDisposableDomListener)(this.element,"paste",W)),S.isFirefox?this.register((0,h.addDisposableDomListener)(this.element,"mousedown",Y=>{Y.button===2&&(0,_.rightClickHandler)(Y,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,h.addDisposableDomListener)(this.element,"contextmenu",Y=>{(0,_.rightClickHandler)(Y,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),S.isLinux&&this.register((0,h.addDisposableDomListener)(this.element,"auxclick",Y=>{Y.button===1&&(0,_.moveTextAreaUnderMouseCursor)(Y,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,h.addDisposableDomListener)(this.textarea,"keyup",W=>this._keyUp(W),!0)),this.register((0,h.addDisposableDomListener)(this.textarea,"keydown",W=>this._keyDown(W),!0)),this.register((0,h.addDisposableDomListener)(this.textarea,"keypress",W=>this._keyPress(W),!0)),this.register((0,h.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,h.addDisposableDomListener)(this.textarea,"compositionupdate",W=>this._compositionHelper.compositionupdate(W))),this.register((0,h.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,h.addDisposableDomListener)(this.textarea,"input",W=>this._inputEvent(W),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(W){var Y;if(!W)throw new Error("Terminal requires a parent element.");W.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=W.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),W.appendChild(this.element);const re=oe.createDocumentFragment();this._viewportElement=oe.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),re.appendChild(this._viewportElement),this._viewportScrollArea=oe.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=oe.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=oe.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),re.appendChild(this.screenElement),this.textarea=oe.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",p.promptLabel),S.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(B.CoreBrowserService,this.textarea,(Y=this._document.defaultView)!==null&&Y!==void 0?Y:window),this._instantiationService.setService(k.ICoreBrowserService,this._coreBrowserService),this.register((0,h.addDisposableDomListener)(this.textarea,"focus",ae=>this._handleTextAreaFocus(ae))),this.register((0,h.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(x.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(k.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(me.ThemeService),this._instantiationService.setService(k.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(ue.CharacterJoinerService),this._instantiationService.setService(k.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(l.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(k.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(ae=>this._onRender.fire(ae))),this.onResize(ae=>this._renderService.resize(ae.cols,ae.rows)),this._compositionView=oe.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(c.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(re);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(M.MouseService),this._instantiationService.setService(k.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(d.Viewport,ae=>this.scrollLines(ae,!0,1),this._viewportElement,this._viewportScrollArea),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(C.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(k.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(ae=>this.scrollLines(ae.amount,ae.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(ae=>this._renderService.handleSelectionChanged(ae.start,ae.end,ae.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(ae=>{this.textarea.value=ae,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(ae=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,h.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(P.BufferDecorationRenderer,this.screenElement)),this.register((0,h.addDisposableDomListener)(this.element,"mousedown",ae=>this._selectionService.handleMouseDown(ae))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=this._instantiationService.createInstance(g.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",ae=>this._handleScreenReaderModeOptionChange(ae))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(F.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",ae=>{!this._overviewRulerRenderer&&ae&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(F.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(m.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const W=this,Y=this.element;function re(de){const Fe=W._mouseService.getMouseReportCoords(de,W.screenElement);if(!Fe)return!1;let Ue,ze;switch(de.overrideType||de.type){case"mousemove":ze=32,de.buttons===void 0?(Ue=3,de.button!==void 0&&(Ue=de.button<3?de.button:3)):Ue=1&de.buttons?0:4&de.buttons?1:2&de.buttons?2:3;break;case"mouseup":ze=0,Ue=de.button<3?de.button:3;break;case"mousedown":ze=1,Ue=de.button<3?de.button:3;break;case"wheel":if(W.viewport.getLinesScrolled(de)===0)return!1;ze=de.deltaY<0?0:1,Ue=4;break;default:return!1}return!(ze===void 0||Ue===void 0||Ue>4)&&W.coreMouseService.triggerMouseEvent({col:Fe.col,row:Fe.row,x:Fe.x,y:Fe.y,button:Ue,action:ze,ctrl:de.ctrlKey,alt:de.altKey,shift:de.shiftKey})}const ae={mouseup:null,wheel:null,mousedrag:null,mousemove:null},Oe={mouseup:de=>(re(de),de.buttons||(this._document.removeEventListener("mouseup",ae.mouseup),ae.mousedrag&&this._document.removeEventListener("mousemove",ae.mousedrag)),this.cancel(de)),wheel:de=>(re(de),this.cancel(de,!0)),mousedrag:de=>{de.buttons&&re(de)},mousemove:de=>{de.buttons||re(de)}};this.register(this.coreMouseService.onProtocolChange(de=>{de?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(de)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&de?ae.mousemove||(Y.addEventListener("mousemove",Oe.mousemove),ae.mousemove=Oe.mousemove):(Y.removeEventListener("mousemove",ae.mousemove),ae.mousemove=null),16&de?ae.wheel||(Y.addEventListener("wheel",Oe.wheel,{passive:!1}),ae.wheel=Oe.wheel):(Y.removeEventListener("wheel",ae.wheel),ae.wheel=null),2&de?ae.mouseup||(ae.mouseup=Oe.mouseup):(this._document.removeEventListener("mouseup",ae.mouseup),ae.mouseup=null),4&de?ae.mousedrag||(ae.mousedrag=Oe.mousedrag):(this._document.removeEventListener("mousemove",ae.mousedrag),ae.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,h.addDisposableDomListener)(Y,"mousedown",de=>{if(de.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(de))return re(de),ae.mouseup&&this._document.addEventListener("mouseup",ae.mouseup),ae.mousedrag&&this._document.addEventListener("mousemove",ae.mousedrag),this.cancel(de)})),this.register((0,h.addDisposableDomListener)(Y,"wheel",de=>{if(!ae.wheel){if(!this.buffer.hasScrollback){const Fe=this.viewport.getLinesScrolled(de);if(Fe===0)return;const Ue=v.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(de.deltaY<0?"A":"B");let ze="";for(let Pe=0;Pe<Math.abs(Fe);Pe++)ze+=Ue;return this.coreService.triggerDataEvent(ze,!0),this.cancel(de,!0)}return this.viewport.handleWheel(de)?this.cancel(de):void 0}},{passive:!1})),this.register((0,h.addDisposableDomListener)(Y,"touchstart",de=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(de),this.cancel(de)},{passive:!0})),this.register((0,h.addDisposableDomListener)(Y,"touchmove",de=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(de)?void 0:this.cancel(de)},{passive:!1}))}refresh(W,Y){var re;(re=this._renderService)===null||re===void 0||re.refreshRows(W,Y)}updateCursorStyle(W){var Y;!((Y=this._selectionService)===null||Y===void 0)&&Y.shouldColumnSelect(W)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(W,Y,re=0){super.scrollLines(W,Y,re),this.refresh(0,this.rows-1)}paste(W){(0,_.paste)(W,this.textarea,this.coreService)}attachCustomKeyEventHandler(W){this._customKeyEventHandler=W}registerLinkProvider(W){return this.linkifier2.registerLinkProvider(W)}registerCharacterJoiner(W){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const Y=this._characterJoinerService.register(W);return this.refresh(0,this.rows-1),Y}deregisterCharacterJoiner(W){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(W)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}addMarker(W){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+W)}registerDecoration(W){return this._decorationService.registerDecoration(W)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(W,Y,re){this._selectionService.setSelection(W,Y,re)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var W;(W=this._selectionService)===null||W===void 0||W.clearSelection()}selectAll(){var W;(W=this._selectionService)===null||W===void 0||W.selectAll()}selectLines(W,Y){var re;(re=this._selectionService)===null||re===void 0||re.selectLines(W,Y)}_keyDown(W){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(W)===!1)return!1;const Y=this.browser.isMac&&this.options.macOptionIsMeta&&W.altKey;if(!Y&&!this._compositionHelper.keydown(W))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;Y||W.key!=="Dead"&&W.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const re=(0,T.evaluateKeyboardEvent)(W,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(W),re.type===3||re.type===2){const ae=this.rows-1;return this.scrollLines(re.type===2?-ae:ae),this.cancel(W,!0)}return re.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,W)||(re.cancel&&this.cancel(W,!0),!re.key||!!(W.key&&!W.ctrlKey&&!W.altKey&&!W.metaKey&&W.key.length===1&&W.key.charCodeAt(0)>=65&&W.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(re.key!==v.C0.ETX&&re.key!==v.C0.CR||(this.textarea.value=""),this._onKey.fire({key:re.key,domEvent:W}),this._showCursor(),this.coreService.triggerDataEvent(re.key,!0),!this.optionsService.rawOptions.screenReaderMode||W.altKey||W.ctrlKey?this.cancel(W,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(W,Y){const re=W.isMac&&!this.options.macOptionIsMeta&&Y.altKey&&!Y.ctrlKey&&!Y.metaKey||W.isWindows&&Y.altKey&&Y.ctrlKey&&!Y.metaKey||W.isWindows&&Y.getModifierState("AltGraph");return Y.type==="keypress"?re:re&&(!Y.keyCode||Y.keyCode>47)}_keyUp(W){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(W)===!1||(function(Y){return Y.keyCode===16||Y.keyCode===17||Y.keyCode===18}(W)||this.focus(),this.updateCursorStyle(W),this._keyPressHandled=!1)}_keyPress(W){let Y;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(W)===!1)return!1;if(this.cancel(W),W.charCode)Y=W.charCode;else if(W.which===null||W.which===void 0)Y=W.keyCode;else{if(W.which===0||W.charCode===0)return!1;Y=W.which}return!(!Y||(W.altKey||W.ctrlKey||W.metaKey)&&!this._isThirdLevelShift(this.browser,W)||(Y=String.fromCharCode(Y),this._onKey.fire({key:Y,domEvent:W}),this._showCursor(),this.coreService.triggerDataEvent(Y,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(W){if(W.data&&W.inputType==="insertText"&&(!W.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const Y=W.data;return this.coreService.triggerDataEvent(Y,!0),this.cancel(W),!0}return!1}resize(W,Y){W!==this.cols||Y!==this.rows?super.resize(W,Y):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(W,Y){var re,ae;(re=this._charSizeService)===null||re===void 0||re.measure(),(ae=this.viewport)===null||ae===void 0||ae.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let W=1;W<this.rows;W++)this.buffer.lines.push(this.buffer.getBlankLine(R.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}}reset(){var W,Y;this.options.rows=this.rows,this.options.cols=this.cols;const re=this._customKeyEventHandler;this._setup(),super.reset(),(W=this._selectionService)===null||W===void 0||W.reset(),this._decorationService.reset(),this._customKeyEventHandler=re,this.refresh(0,this.rows-1),(Y=this.viewport)===null||Y===void 0||Y.syncScrollArea()}clearTextureAtlas(){var W;(W=this._renderService)===null||W===void 0||W.clearTextureAtlas()}_reportFocus(){var W;!((W=this.element)===null||W===void 0)&&W.classList.contains("focus")?this.coreService.triggerDataEvent(v.C0.ESC+"[I"):this.coreService.triggerDataEvent(v.C0.ESC+"[O")}_reportWindowsOptions(W){if(this._renderService)switch(W){case E.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const Y=this._renderService.dimensions.css.canvas.width.toFixed(0),re=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${v.C0.ESC}[4;${re};${Y}t`);break;case E.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const ae=this._renderService.dimensions.css.cell.width.toFixed(0),Oe=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${v.C0.ESC}[6;${Oe};${ae}t`)}}cancel(W,Y){if(this.options.cancelEvents||Y)return W.preventDefault(),W.stopPropagation(),!1}}s.Terminal=pe},9924:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TimeBasedDebouncer=void 0,s.TimeBasedDebouncer=class{constructor(o,c=1e3){this._renderCallback=o,this._debounceThresholdMS=c,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(o,c,d){this._rowCount=d,o=o!==void 0?o:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,o):o,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c;const _=Date.now();if(_-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=_,this._innerRefresh();else if(!this._additionalRefreshRequested){const v=_-this._lastRefreshMs,E=this._debounceThresholdMS-v;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},E)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const o=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(o,c)}}},1680:function(y,s,o){var c=this&&this.__decorate||function(h,p,g,m){var T,w=arguments.length,R=w<3?p:m===null?m=Object.getOwnPropertyDescriptor(p,g):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(h,p,g,m);else for(var l=h.length-1;l>=0;l--)(T=h[l])&&(R=(w<3?T(R):w>3?T(p,g,R):T(p,g))||R);return w>3&&R&&Object.defineProperty(p,g,R),R},d=this&&this.__param||function(h,p){return function(g,m){p(g,m,h)}};Object.defineProperty(s,"__esModule",{value:!0}),s.Viewport=void 0;const _=o(844),v=o(3656),E=o(4725),C=o(2585);let S=class extends _.Disposable{constructor(h,p,g,m,T,w,R,l,k){super(),this._scrollLines=h,this._viewportElement=p,this._scrollArea=g,this._bufferService=m,this._optionsService=T,this._charSizeService=w,this._renderService=R,this._coreBrowserService=l,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,v.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(x=>this._activeBuffer=x.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(x=>this._renderDimensions=x)),this._handleThemeChange(k.colors),this.register(k.onChangeColors(x=>this._handleThemeChange(x))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea(),0)}_handleThemeChange(h){this._viewportElement.style.backgroundColor=h.background.css}_refresh(h){if(h)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const p=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==p&&(this._lastRecordedBufferHeight=p,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const h=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==h&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=h),this._refreshAnimationFrame=null}syncScrollArea(h=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(h);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(h)}_handleScroll(h){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);const p=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(p)}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const h=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(h*(this._smoothScrollState.target-this._smoothScrollState.origin)),h<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(h,p){const g=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(p<0&&this._viewportElement.scrollTop!==0||p>0&&g<this._lastRecordedBufferHeight)||(h.cancelable&&h.preventDefault(),!1)}handleWheel(h){const p=this._getPixelsScrolled(h);return p!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+p:this._smoothScrollState.target+=p,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=p,this._bubbleScroll(h,p))}_getPixelsScrolled(h){if(h.deltaY===0||h.shiftKey)return 0;let p=this._applyScrollModifier(h.deltaY,h);return h.deltaMode===WheelEvent.DOM_DELTA_LINE?p*=this._currentRowHeight:h.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(p*=this._currentRowHeight*this._bufferService.rows),p}getBufferElements(h,p){var g;let m,T="";const w=[],R=p??this._bufferService.buffer.lines.length,l=this._bufferService.buffer.lines;for(let k=h;k<R;k++){const x=l.get(k);if(!x)continue;const M=(g=l.get(k+1))===null||g===void 0?void 0:g.isWrapped;if(T+=x.translateToString(!M),!M||k===l.length-1){const $=document.createElement("div");$.textContent=T,w.push($),T.length>0&&(m=$),T=""}}return{bufferElements:w,cursorElement:m}}getLinesScrolled(h){if(h.deltaY===0||h.shiftKey)return 0;let p=this._applyScrollModifier(h.deltaY,h);return h.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(p/=this._currentRowHeight+0,this._wheelPartialScroll+=p,p=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):h.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(p*=this._bufferService.rows),p}_applyScrollModifier(h,p){const g=this._optionsService.rawOptions.fastScrollModifier;return g==="alt"&&p.altKey||g==="ctrl"&&p.ctrlKey||g==="shift"&&p.shiftKey?h*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:h*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(h){this._lastTouchY=h.touches[0].pageY}handleTouchMove(h){const p=this._lastTouchY-h.touches[0].pageY;return this._lastTouchY=h.touches[0].pageY,p!==0&&(this._viewportElement.scrollTop+=p,this._bubbleScroll(h,p))}};S=c([d(3,C.IBufferService),d(4,C.IOptionsService),d(5,E.ICharSizeService),d(6,E.IRenderService),d(7,E.ICoreBrowserService),d(8,E.IThemeService)],S),s.Viewport=S},3107:function(y,s,o){var c=this&&this.__decorate||function(h,p,g,m){var T,w=arguments.length,R=w<3?p:m===null?m=Object.getOwnPropertyDescriptor(p,g):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(h,p,g,m);else for(var l=h.length-1;l>=0;l--)(T=h[l])&&(R=(w<3?T(R):w>3?T(p,g,R):T(p,g))||R);return w>3&&R&&Object.defineProperty(p,g,R),R},d=this&&this.__param||function(h,p){return function(g,m){p(g,m,h)}};Object.defineProperty(s,"__esModule",{value:!0}),s.BufferDecorationRenderer=void 0;const _=o(3656),v=o(4725),E=o(844),C=o(2585);let S=class extends E.Disposable{constructor(h,p,g,m){super(),this._screenElement=h,this._bufferService=p,this._decorationService=g,this._renderService=m,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,_.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(T=>this._removeDecoration(T))),this.register((0,E.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const h of this._decorationService.decorations)this._renderDecoration(h);this._dimensionsChanged=!1}_renderDecoration(h){this._refreshStyle(h),this._dimensionsChanged&&this._refreshXPosition(h)}_createElement(h){var p,g;const m=document.createElement("div");m.classList.add("xterm-decoration"),m.classList.toggle("xterm-decoration-top-layer",((p=h==null?void 0:h.options)===null||p===void 0?void 0:p.layer)==="top"),m.style.width=`${Math.round((h.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,m.style.height=(h.options.height||1)*this._renderService.dimensions.css.cell.height+"px",m.style.top=(h.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",m.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const T=(g=h.options.x)!==null&&g!==void 0?g:0;return T&&T>this._bufferService.cols&&(m.style.display="none"),this._refreshXPosition(h,m),m}_refreshStyle(h){const p=h.marker.line-this._bufferService.buffers.active.ydisp;if(p<0||p>=this._bufferService.rows)h.element&&(h.element.style.display="none",h.onRenderEmitter.fire(h.element));else{let g=this._decorationElements.get(h);g||(g=this._createElement(h),h.element=g,this._decorationElements.set(h,g),this._container.appendChild(g)),g.style.top=p*this._renderService.dimensions.css.cell.height+"px",g.style.display=this._altBufferIsActive?"none":"block",h.onRenderEmitter.fire(g)}}_refreshXPosition(h,p=h.element){var g;if(!p)return;const m=(g=h.options.x)!==null&&g!==void 0?g:0;(h.options.anchor||"left")==="right"?p.style.right=m?m*this._renderService.dimensions.css.cell.width+"px":"":p.style.left=m?m*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(h){var p;(p=this._decorationElements.get(h))===null||p===void 0||p.remove(),this._decorationElements.delete(h),h.dispose()}};S=c([d(1,C.IBufferService),d(2,C.IDecorationService),d(3,v.IRenderService)],S),s.BufferDecorationRenderer=S},5871:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ColorZoneStore=void 0,s.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(o){if(o.options.overviewRulerOptions){for(const c of this._zones)if(c.color===o.options.overviewRulerOptions.color&&c.position===o.options.overviewRulerOptions.position){if(this._lineIntersectsZone(c,o.marker.line))return;if(this._lineAdjacentToZone(c,o.marker.line,o.options.overviewRulerOptions.position))return void this._addLineToZone(c,o.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=o.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=o.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=o.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=o.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:o.options.overviewRulerOptions.color,position:o.options.overviewRulerOptions.position,startBufferLine:o.marker.line,endBufferLine:o.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(o){this._linePadding=o}_lineIntersectsZone(o,c){return c>=o.startBufferLine&&c<=o.endBufferLine}_lineAdjacentToZone(o,c,d){return c>=o.startBufferLine-this._linePadding[d||"full"]&&c<=o.endBufferLine+this._linePadding[d||"full"]}_addLineToZone(o,c){o.startBufferLine=Math.min(o.startBufferLine,c),o.endBufferLine=Math.max(o.endBufferLine,c)}}},5744:function(y,s,o){var c=this&&this.__decorate||function(T,w,R,l){var k,x=arguments.length,M=x<3?w:l===null?l=Object.getOwnPropertyDescriptor(w,R):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(T,w,R,l);else for(var $=T.length-1;$>=0;$--)(k=T[$])&&(M=(x<3?k(M):x>3?k(w,R,M):k(w,R))||M);return x>3&&M&&Object.defineProperty(w,R,M),M},d=this&&this.__param||function(T,w){return function(R,l){w(R,l,T)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OverviewRulerRenderer=void 0;const _=o(5871),v=o(3656),E=o(4725),C=o(844),S=o(2585),h={full:0,left:0,center:0,right:0},p={full:0,left:0,center:0,right:0},g={full:0,left:0,center:0,right:0};let m=class extends C.Disposable{constructor(T,w,R,l,k,x,M){var $;super(),this._viewportElement=T,this._screenElement=w,this._bufferService=R,this._decorationService=l,this._renderService=k,this._optionsService=x,this._coreBrowseService=M,this._colorZoneStore=new _.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),($=this._viewportElement.parentElement)===null||$===void 0||$.insertBefore(this._canvas,this._viewportElement);const B=this._canvas.getContext("2d");if(!B)throw new Error("Ctx cannot be null");this._ctx=B,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,C.toDisposable)(()=>{var N;(N=this._canvas)===null||N===void 0||N.remove()}))}get _width(){return this._optionsService.options.overviewRulerWidth||0}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,v.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const T=Math.floor(this._canvas.width/3),w=Math.ceil(this._canvas.width/3);p.full=this._canvas.width,p.left=T,p.center=w,p.right=T,this._refreshDrawHeightConstants(),g.full=0,g.left=0,g.center=p.left,g.right=p.left+p.center}_refreshDrawHeightConstants(){h.full=Math.round(2*this._coreBrowseService.dpr);const T=this._canvas.height/this._bufferService.buffer.lines.length,w=Math.round(Math.max(Math.min(T,12),6)*this._coreBrowseService.dpr);h.left=w,h.center=w,h.right=w}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const w of this._decorationService.decorations)this._colorZoneStore.addDecoration(w);this._ctx.lineWidth=1;const T=this._colorZoneStore.zones;for(const w of T)w.position!=="full"&&this._renderColorZone(w);for(const w of T)w.position==="full"&&this._renderColorZone(w);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(T){this._ctx.fillStyle=T.color,this._ctx.fillRect(g[T.position||"full"],Math.round((this._canvas.height-1)*(T.startBufferLine/this._bufferService.buffers.active.lines.length)-h[T.position||"full"]/2),p[T.position||"full"],Math.round((this._canvas.height-1)*((T.endBufferLine-T.startBufferLine)/this._bufferService.buffers.active.lines.length)+h[T.position||"full"]))}_queueRefresh(T,w){this._shouldUpdateDimensions=T||this._shouldUpdateDimensions,this._shouldUpdateAnchor=w||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};m=c([d(2,S.IBufferService),d(3,S.IDecorationService),d(4,E.IRenderService),d(5,S.IOptionsService),d(6,E.ICoreBrowserService)],m),s.OverviewRulerRenderer=m},2950:function(y,s,o){var c=this&&this.__decorate||function(S,h,p,g){var m,T=arguments.length,w=T<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,p):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(S,h,p,g);else for(var R=S.length-1;R>=0;R--)(m=S[R])&&(w=(T<3?m(w):T>3?m(h,p,w):m(h,p))||w);return T>3&&w&&Object.defineProperty(h,p,w),w},d=this&&this.__param||function(S,h){return function(p,g){h(p,g,S)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CompositionHelper=void 0;const _=o(4725),v=o(2585),E=o(2584);let C=class{constructor(S,h,p,g,m,T){this._textarea=S,this._compositionView=h,this._bufferService=p,this._optionsService=g,this._coreService=m,this._renderService=T,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(S){this._compositionView.textContent=S.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(S){if(this._isComposing||this._isSendingComposition){if(S.keyCode===229||S.keyCode===16||S.keyCode===17||S.keyCode===18)return!1;this._finalizeComposition(!1)}return S.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(S){if(this._compositionView.classList.remove("active"),this._isComposing=!1,S){const h={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let p;this._isSendingComposition=!1,h.start+=this._dataAlreadySent.length,p=this._isComposing?this._textarea.value.substring(h.start,h.end):this._textarea.value.substring(h.start),p.length>0&&this._coreService.triggerDataEvent(p,!0)}},0)}else{this._isSendingComposition=!1;const h=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(h,!0)}}_handleAnyTextareaChanges(){const S=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const h=this._textarea.value,p=h.replace(S,"");this._dataAlreadySent=p,h.length>S.length?this._coreService.triggerDataEvent(p,!0):h.length<S.length?this._coreService.triggerDataEvent(`${E.C0.DEL}`,!0):h.length===S.length&&h!==S&&this._coreService.triggerDataEvent(h,!0)}},0)}updateCompositionElements(S){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const h=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),p=this._renderService.dimensions.css.cell.height,g=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,m=h*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=m+"px",this._compositionView.style.top=g+"px",this._compositionView.style.height=p+"px",this._compositionView.style.lineHeight=p+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const T=this._compositionView.getBoundingClientRect();this._textarea.style.left=m+"px",this._textarea.style.top=g+"px",this._textarea.style.width=Math.max(T.width,1)+"px",this._textarea.style.height=Math.max(T.height,1)+"px",this._textarea.style.lineHeight=T.height+"px"}S||setTimeout(()=>this.updateCompositionElements(!0),0)}}};C=c([d(2,v.IBufferService),d(3,v.IOptionsService),d(4,v.ICoreService),d(5,_.IRenderService)],C),s.CompositionHelper=C},9806:(y,s)=>{function o(c,d,_){const v=_.getBoundingClientRect(),E=c.getComputedStyle(_),C=parseInt(E.getPropertyValue("padding-left")),S=parseInt(E.getPropertyValue("padding-top"));return[d.clientX-v.left-C,d.clientY-v.top-S]}Object.defineProperty(s,"__esModule",{value:!0}),s.getCoords=s.getCoordsRelativeToElement=void 0,s.getCoordsRelativeToElement=o,s.getCoords=function(c,d,_,v,E,C,S,h,p){if(!C)return;const g=o(c,d,_);return g?(g[0]=Math.ceil((g[0]+(p?S/2:0))/S),g[1]=Math.ceil(g[1]/h),g[0]=Math.min(Math.max(g[0],1),v+(p?1:0)),g[1]=Math.min(Math.max(g[1],1),E),g):void 0}},9504:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.moveToCellSequence=void 0;const c=o(2584);function d(h,p,g,m){const T=h-_(h,g),w=p-_(p,g),R=Math.abs(T-w)-function(l,k,x){let M=0;const $=l-_(l,x),B=k-_(k,x);for(let N=0;N<Math.abs($-B);N++){const ee=v(l,k)==="A"?-1:1,ue=x.buffer.lines.get($+ee*N);ue!=null&&ue.isWrapped&&M++}return M}(h,p,g);return S(R,C(v(h,p),m))}function _(h,p){let g=0,m=p.buffer.lines.get(h),T=m==null?void 0:m.isWrapped;for(;T&&h>=0&&h<p.rows;)g++,m=p.buffer.lines.get(--h),T=m==null?void 0:m.isWrapped;return g}function v(h,p){return h>p?"A":"B"}function E(h,p,g,m,T,w){let R=h,l=p,k="";for(;R!==g||l!==m;)R+=T?1:-1,T&&R>w.cols-1?(k+=w.buffer.translateBufferLineToString(l,!1,h,R),R=0,h=0,l++):!T&&R<0&&(k+=w.buffer.translateBufferLineToString(l,!1,0,h+1),R=w.cols-1,h=R,l--);return k+w.buffer.translateBufferLineToString(l,!1,h,R)}function C(h,p){const g=p?"O":"[";return c.C0.ESC+g+h}function S(h,p){h=Math.floor(h);let g="";for(let m=0;m<h;m++)g+=p;return g}s.moveToCellSequence=function(h,p,g,m){const T=g.buffer.x,w=g.buffer.y;if(!g.buffer.hasScrollback)return function(k,x,M,$,B,N){return d(x,$,B,N).length===0?"":S(E(k,x,k,x-_(x,B),!1,B).length,C("D",N))}(T,w,0,p,g,m)+d(w,p,g,m)+function(k,x,M,$,B,N){let ee;ee=d(x,$,B,N).length>0?$-_($,B):x;const ue=$,se=function(P,F,j,q,te,ge){let me;return me=d(j,q,te,ge).length>0?q-_(q,te):F,P<j&&me<=q||P>=j&&me<q?"C":"D"}(k,x,M,$,B,N);return S(E(k,ee,M,ue,se==="C",B).length,C(se,N))}(T,w,h,p,g,m);let R;if(w===p)return R=T>h?"D":"C",S(Math.abs(T-h),C(R,m));R=w>p?"D":"C";const l=Math.abs(w-p);return S(function(k,x){return x.cols-k}(w>p?h:T,g)+(l-1)*g.cols+1+((w>p?T:h)-1),C(R,m))}},1296:function(y,s,o){var c=this&&this.__decorate||function(l,k,x,M){var $,B=arguments.length,N=B<3?k:M===null?M=Object.getOwnPropertyDescriptor(k,x):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")N=Reflect.decorate(l,k,x,M);else for(var ee=l.length-1;ee>=0;ee--)($=l[ee])&&(N=(B<3?$(N):B>3?$(k,x,N):$(k,x))||N);return B>3&&N&&Object.defineProperty(k,x,N),N},d=this&&this.__param||function(l,k){return function(x,M){k(x,M,l)}};Object.defineProperty(s,"__esModule",{value:!0}),s.DomRenderer=void 0;const _=o(3787),v=o(2223),E=o(6171),C=o(4725),S=o(8055),h=o(8460),p=o(844),g=o(2585),m="xterm-dom-renderer-owner-",T="xterm-focus";let w=1,R=class extends p.Disposable{constructor(l,k,x,M,$,B,N,ee,ue,se){super(),this._element=l,this._screenElement=k,this._viewportElement=x,this._linkifier2=M,this._charSizeService=B,this._optionsService=N,this._bufferService=ee,this._coreBrowserService=ue,this._themeService=se,this._terminalClass=w++,this._rowElements=[],this._cellToRowElements=[],this.onRequestRedraw=this.register(new h.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add("xterm-rows"),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add("xterm-selection"),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,E.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(P=>this._injectCss(P))),this._injectCss(this._themeService.colors),this._rowFactory=$.createInstance(_.DomRendererRowFactory,document),this._element.classList.add(m+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(P=>this._handleLinkHover(P))),this.register(this._linkifier2.onHideLinkUnderline(P=>this._handleLinkLeave(P))),this.register((0,p.toDisposable)(()=>{this._element.classList.remove(m+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()}))}_updateDimensions(){const l=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*l,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*l),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/l),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/l),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const x of this._rowElements)x.style.width=`${this.dimensions.css.canvas.width}px`,x.style.height=`${this.dimensions.css.cell.height}px`,x.style.lineHeight=`${this.dimensions.css.cell.height}px`,x.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const k=`${this._terminalSelector} .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: ${this.dimensions.css.cell.width}px}`;this._dimensionsStyleElement.textContent=k,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(l){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let k=`${this._terminalSelector} .xterm-rows { color: ${l.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px;}`;k+=`${this._terminalSelector} .xterm-rows .xterm-dim { color: ${S.color.multiplyOpacity(l.foreground,.5).css};}`,k+=`${this._terminalSelector} span:not(.${_.BOLD_CLASS}) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.${_.BOLD_CLASS} { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.${_.ITALIC_CLASS} { font-style: italic;}`,k+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",k+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${l.cursor.css};  color: ${l.cursorAccent.css}; } 50% {  background-color: ${l.cursorAccent.css};  color: ${l.cursor.css}; }}`,k+=`${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${_.CURSOR_CLASS}.${_.CURSOR_STYLE_BLOCK_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${_.CURSOR_CLASS}.${_.CURSOR_STYLE_BAR_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${_.CURSOR_CLASS}.${_.CURSOR_STYLE_UNDERLINE_CLASS} { outline: 1px solid ${l.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .xterm-rows.xterm-focus .${_.CURSOR_CLASS}.${_.CURSOR_BLINK_CLASS}:not(.${_.CURSOR_STYLE_BLOCK_CLASS}) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${_.CURSOR_CLASS}.${_.CURSOR_BLINK_CLASS}.${_.CURSOR_STYLE_BLOCK_CLASS} { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${_.CURSOR_CLASS}.${_.CURSOR_STYLE_BLOCK_CLASS} { background-color: ${l.cursor.css}; color: ${l.cursorAccent.css};}${this._terminalSelector} .xterm-rows .${_.CURSOR_CLASS}.${_.CURSOR_STYLE_BAR_CLASS} { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${l.cursor.css} inset;}${this._terminalSelector} .xterm-rows .${_.CURSOR_CLASS}.${_.CURSOR_STYLE_UNDERLINE_CLASS} { box-shadow: 0 -1px 0 ${l.cursor.css} inset;}`,k+=`${this._terminalSelector} .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .xterm-selection div { position: absolute; background-color: ${l.selectionBackgroundOpaque.css};}${this._terminalSelector} .xterm-selection div { position: absolute; background-color: ${l.selectionInactiveBackgroundOpaque.css};}`;for(const[x,M]of l.ansi.entries())k+=`${this._terminalSelector} .xterm-fg-${x} { color: ${M.css}; }${this._terminalSelector} .xterm-fg-${x}.${_.DIM_CLASS} { color: ${S.color.multiplyOpacity(M,.5).css}; }${this._terminalSelector} .xterm-bg-${x} { background-color: ${M.css}; }`;k+=`${this._terminalSelector} .xterm-fg-${v.INVERTED_DEFAULT_COLOR} { color: ${S.color.opaque(l.background).css}; }${this._terminalSelector} .xterm-fg-${v.INVERTED_DEFAULT_COLOR}.${_.DIM_CLASS} { color: ${S.color.multiplyOpacity(S.color.opaque(l.background),.5).css}; }${this._terminalSelector} .xterm-bg-${v.INVERTED_DEFAULT_COLOR} { background-color: ${l.foreground.css}; }`,this._themeStyleElement.textContent=k}handleDevicePixelRatioChange(){this._updateDimensions()}_refreshRowElements(l,k){for(let x=this._rowElements.length;x<=k;x++){const M=document.createElement("div");this._rowContainer.appendChild(M),this._rowElements.push(M)}for(;this._rowElements.length>k;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(l,k){this._refreshRowElements(l,k),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions()}handleBlur(){this._rowContainer.classList.remove(T)}handleFocus(){this._rowContainer.classList.add(T)}handleSelectionChanged(l,k,x){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(this._rowFactory.handleSelectionChanged(l,k,x),this.renderRows(0,this._bufferService.rows-1),!l||!k)return;const M=l[1]-this._bufferService.buffer.ydisp,$=k[1]-this._bufferService.buffer.ydisp,B=Math.max(M,0),N=Math.min($,this._bufferService.rows-1);if(B>=this._bufferService.rows||N<0)return;const ee=document.createDocumentFragment();if(x){const ue=l[0]>k[0];ee.appendChild(this._createSelectionElement(B,ue?k[0]:l[0],ue?l[0]:k[0],N-B+1))}else{const ue=M===B?l[0]:0,se=B===$?k[0]:this._bufferService.cols;ee.appendChild(this._createSelectionElement(B,ue,se));const P=N-B-1;if(ee.appendChild(this._createSelectionElement(B+1,0,this._bufferService.cols,P)),B!==N){const F=$===N?k[0]:this._bufferService.cols;ee.appendChild(this._createSelectionElement(N,0,F))}}this._selectionContainer.appendChild(ee)}_createSelectionElement(l,k,x,M=1){const $=document.createElement("div");return $.style.height=M*this.dimensions.css.cell.height+"px",$.style.top=l*this.dimensions.css.cell.height+"px",$.style.left=k*this.dimensions.css.cell.width+"px",$.style.width=this.dimensions.css.cell.width*(x-k)+"px",$}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors)}clear(){for(const l of this._rowElements)l.replaceChildren()}renderRows(l,k){const x=this._bufferService.buffer.ybase+this._bufferService.buffer.y,M=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),$=this._optionsService.rawOptions.cursorBlink;for(let B=l;B<=k;B++){const N=this._rowElements[B],ee=B+this._bufferService.buffer.ydisp,ue=this._bufferService.buffer.lines.get(ee),se=this._optionsService.rawOptions.cursorStyle;this._cellToRowElements[B]&&this._cellToRowElements[B].length===this._bufferService.cols||(this._cellToRowElements[B]=new Int16Array(this._bufferService.cols)),N.replaceChildren(this._rowFactory.createRow(ue,ee,ee===x,se,M,$,this.dimensions.css.cell.width,this._bufferService.cols,this._cellToRowElements[B]))}}get _terminalSelector(){return`.${m}${this._terminalClass}`}_handleLinkHover(l){this._setCellUnderline(l.x1,l.x2,l.y1,l.y2,l.cols,!0)}_handleLinkLeave(l){this._setCellUnderline(l.x1,l.x2,l.y1,l.y2,l.cols,!1)}_setCellUnderline(l,k,x,M,$,B){x<0&&(l=0),M<0&&(k=0);const N=this._cellToRowElements.length-1;x=Math.max(Math.min(x,N),0),M=Math.max(Math.min(M,N),0);const ee=this._cellToRowElements[x],ue=this._cellToRowElements[M];if(!(l>=ee.length||k>=ue.length)&&(l=ee[l],k=ue[k],l!==-1&&k!==-1))for(;l!==k||x!==M;){const se=this._rowElements[x];if(!se)return;const P=se.children[l];P&&(P.style.textDecoration=B?"underline":"none"),++l>=$&&(l=0,x++)}}};R=c([d(4,g.IInstantiationService),d(5,C.ICharSizeService),d(6,g.IOptionsService),d(7,g.IBufferService),d(8,C.ICoreBrowserService),d(9,C.IThemeService)],R),s.DomRenderer=R},3787:function(y,s,o){var c=this&&this.__decorate||function(R,l,k,x){var M,$=arguments.length,B=$<3?l:x===null?x=Object.getOwnPropertyDescriptor(l,k):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(R,l,k,x);else for(var N=R.length-1;N>=0;N--)(M=R[N])&&(B=($<3?M(B):$>3?M(l,k,B):M(l,k))||B);return $>3&&B&&Object.defineProperty(l,k,B),B},d=this&&this.__param||function(R,l){return function(k,x){l(k,x,R)}};Object.defineProperty(s,"__esModule",{value:!0}),s.DomRendererRowFactory=s.CURSOR_STYLE_UNDERLINE_CLASS=s.CURSOR_STYLE_BAR_CLASS=s.CURSOR_STYLE_BLOCK_CLASS=s.CURSOR_BLINK_CLASS=s.CURSOR_CLASS=s.STRIKETHROUGH_CLASS=s.OVERLINE_CLASS=s.UNDERLINE_CLASS=s.ITALIC_CLASS=s.DIM_CLASS=s.BOLD_CLASS=void 0;const _=o(2223),v=o(643),E=o(511),C=o(2585),S=o(8055),h=o(4725),p=o(4269),g=o(6171),m=o(3734);s.BOLD_CLASS="xterm-bold",s.DIM_CLASS="xterm-dim",s.ITALIC_CLASS="xterm-italic",s.UNDERLINE_CLASS="xterm-underline",s.OVERLINE_CLASS="xterm-overline",s.STRIKETHROUGH_CLASS="xterm-strikethrough",s.CURSOR_CLASS="xterm-cursor",s.CURSOR_BLINK_CLASS="xterm-cursor-blink",s.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",s.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",s.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";let T=class{constructor(R,l,k,x,M,$,B){this._document=R,this._characterJoinerService=l,this._optionsService=k,this._coreBrowserService=x,this._coreService=M,this._decorationService=$,this._themeService=B,this._workCell=new E.CellData,this._columnSelectMode=!1}handleSelectionChanged(R,l,k){this._selectionStart=R,this._selectionEnd=l,this._columnSelectMode=k}createRow(R,l,k,x,M,$,B,N,ee){const ue=this._document.createDocumentFragment(),se=this._characterJoinerService.getJoinedCharacters(l);let P=0;for(let te=Math.min(R.length,N)-1;te>=0;te--)if(R.loadCell(te,this._workCell).getCode()!==v.NULL_CELL_CODE||k&&te===M){P=te+1;break}const F=this._themeService.colors;let j=-1,q=0;for(;q<P;q++){R.loadCell(q,this._workCell);let te=this._workCell.getWidth();if(te===0){ee[q]=j;continue}let ge=!1,me=q,oe=this._workCell;if(se.length>0&&q===se[0][0]){ge=!0;const Pe=se.shift();oe=new p.JoinedCellData(this._workCell,R.translateToString(!0,Pe[0],Pe[1]),Pe[1]-Pe[0]),me=Pe[1]-1,te=oe.getWidth()}const pe=this._document.createElement("span");if(te>1&&(pe.style.width=B*te+"px"),ge&&(pe.style.display="inline",M>=q&&M<=me&&(M=q)),!this._coreService.isCursorHidden&&k&&q===M)switch(pe.classList.add(s.CURSOR_CLASS),$&&pe.classList.add(s.CURSOR_BLINK_CLASS),x){case"bar":pe.classList.add(s.CURSOR_STYLE_BAR_CLASS);break;case"underline":pe.classList.add(s.CURSOR_STYLE_UNDERLINE_CLASS);break;default:pe.classList.add(s.CURSOR_STYLE_BLOCK_CLASS)}if(oe.isBold()&&pe.classList.add(s.BOLD_CLASS),oe.isItalic()&&pe.classList.add(s.ITALIC_CLASS),oe.isDim()&&pe.classList.add(s.DIM_CLASS),oe.isInvisible()?pe.textContent=v.WHITESPACE_CELL_CHAR:pe.textContent=oe.getChars()||v.WHITESPACE_CELL_CHAR,oe.isUnderline()&&(pe.classList.add(`${s.UNDERLINE_CLASS}-${oe.extended.underlineStyle}`),pe.textContent===" "&&(pe.textContent=""),!oe.isUnderlineColorDefault()))if(oe.isUnderlineColorRGB())pe.style.textDecorationColor=`rgb(${m.AttributeData.toColorRGB(oe.getUnderlineColor()).join(",")})`;else{let Pe=oe.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&oe.isBold()&&Pe<8&&(Pe+=8),pe.style.textDecorationColor=F.ansi[Pe].css}oe.isOverline()&&(pe.classList.add(s.OVERLINE_CLASS),pe.textContent===" "&&(pe.textContent="")),oe.isStrikethrough()&&pe.classList.add(s.STRIKETHROUGH_CLASS);let z=oe.getFgColor(),W=oe.getFgColorMode(),Y=oe.getBgColor(),re=oe.getBgColorMode();const ae=!!oe.isInverse();if(ae){const Pe=z;z=Y,Y=Pe;const xt=W;W=re,re=xt}let Oe,de,Fe=!1;this._decorationService.forEachDecorationAtCell(q,l,void 0,Pe=>{Pe.options.layer!=="top"&&Fe||(Pe.backgroundColorRGB&&(re=50331648,Y=Pe.backgroundColorRGB.rgba>>8&16777215,Oe=Pe.backgroundColorRGB),Pe.foregroundColorRGB&&(W=50331648,z=Pe.foregroundColorRGB.rgba>>8&16777215,de=Pe.foregroundColorRGB),Fe=Pe.options.layer==="top")});const Ue=this._isCellInSelection(q,l);let ze;switch(Fe||F.selectionForeground&&Ue&&(W=50331648,z=F.selectionForeground.rgba>>8&16777215,de=F.selectionForeground),Ue&&(Oe=this._coreBrowserService.isFocused?F.selectionBackgroundOpaque:F.selectionInactiveBackgroundOpaque,Fe=!0),Fe&&pe.classList.add("xterm-decoration-top"),re){case 16777216:case 33554432:ze=F.ansi[Y],pe.classList.add(`xterm-bg-${Y}`);break;case 50331648:ze=S.rgba.toColor(Y>>16,Y>>8&255,255&Y),this._addStyle(pe,`background-color:#${w((Y>>>0).toString(16),"0",6)}`);break;default:ae?(ze=F.foreground,pe.classList.add(`xterm-bg-${_.INVERTED_DEFAULT_COLOR}`)):ze=F.background}switch(Oe||oe.isDim()&&(Oe=S.color.multiplyOpacity(ze,.5)),W){case 16777216:case 33554432:oe.isBold()&&z<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(z+=8),this._applyMinimumContrast(pe,ze,F.ansi[z],oe,Oe,void 0)||pe.classList.add(`xterm-fg-${z}`);break;case 50331648:const Pe=S.rgba.toColor(z>>16&255,z>>8&255,255&z);this._applyMinimumContrast(pe,ze,Pe,oe,Oe,de)||this._addStyle(pe,`color:#${w(z.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(pe,ze,F.foreground,oe,Oe,void 0)||ae&&pe.classList.add(`xterm-fg-${_.INVERTED_DEFAULT_COLOR}`)}ue.appendChild(pe),ee[q]=++j,q=me}return q<N-1&&ee.subarray(q).fill(++j),ue}_applyMinimumContrast(R,l,k,x,M,$){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,g.excludeFromContrastRatioDemands)(x.getCode()))return!1;let B;return M||$||(B=this._themeService.colors.contrastCache.getColor(l.rgba,k.rgba)),B===void 0&&(B=S.color.ensureContrastRatio(M||l,$||k,this._optionsService.rawOptions.minimumContrastRatio),this._themeService.colors.contrastCache.setColor((M||l).rgba,($||k).rgba,B??null)),!!B&&(this._addStyle(R,`color:${B.css}`),!0)}_addStyle(R,l){R.setAttribute("style",`${R.getAttribute("style")||""}${l};`)}_isCellInSelection(R,l){const k=this._selectionStart,x=this._selectionEnd;return!(!k||!x)&&(this._columnSelectMode?k[0]<=x[0]?R>=k[0]&&l>=k[1]&&R<x[0]&&l<=x[1]:R<k[0]&&l>=k[1]&&R>=x[0]&&l<=x[1]:l>k[1]&&l<x[1]||k[1]===x[1]&&l===k[1]&&R>=k[0]&&R<x[0]||k[1]<x[1]&&l===x[1]&&R<x[0]||k[1]<x[1]&&l===k[1]&&R>=k[0])}};function w(R,l,k){for(;R.length<k;)R=l+R;return R}T=c([d(1,h.ICharacterJoinerService),d(2,C.IOptionsService),d(3,h.ICoreBrowserService),d(4,C.ICoreService),d(5,C.IDecorationService),d(6,h.IThemeService)],T),s.DomRendererRowFactory=T},2223:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TEXT_BASELINE=s.DIM_OPACITY=s.INVERTED_DEFAULT_COLOR=void 0;const c=o(6114);s.INVERTED_DEFAULT_COLOR=257,s.DIM_OPACITY=.5,s.TEXT_BASELINE=c.isFirefox||c.isLegacyEdge?"bottom":"ideographic"},6171:(y,s)=>{function o(c){return 57508<=c&&c<=57558}Object.defineProperty(s,"__esModule",{value:!0}),s.createRenderDimensions=s.excludeFromContrastRatioDemands=s.isRestrictedPowerlineGlyph=s.isPowerlineGlyph=s.throwIfFalsy=void 0,s.throwIfFalsy=function(c){if(!c)throw new Error("value must not be falsy");return c},s.isPowerlineGlyph=o,s.isRestrictedPowerlineGlyph=function(c){return 57520<=c&&c<=57527},s.excludeFromContrastRatioDemands=function(c){return o(c)||function(d){return 9472<=d&&d<=9631}(c)},s.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SelectionModel=void 0,s.SelectionModel=class{constructor(o){this._bufferService=o,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const o=this.selectionStart[0]+this.selectionStartLength;return o>this._bufferService.cols?o%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(o/this._bufferService.cols)-1]:[o%this._bufferService.cols,this.selectionStart[1]+Math.floor(o/this._bufferService.cols)]:[o,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const o=this.selectionStart[0]+this.selectionStartLength;return o>this._bufferService.cols?[o%this._bufferService.cols,this.selectionStart[1]+Math.floor(o/this._bufferService.cols)]:[Math.max(o,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const o=this.selectionStart,c=this.selectionEnd;return!(!o||!c)&&(o[1]>c[1]||o[1]===c[1]&&o[0]>c[0])}handleTrim(o){return this.selectionStart&&(this.selectionStart[1]-=o),this.selectionEnd&&(this.selectionEnd[1]-=o),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(y,s,o){var c=this&&this.__decorate||function(h,p,g,m){var T,w=arguments.length,R=w<3?p:m===null?m=Object.getOwnPropertyDescriptor(p,g):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(h,p,g,m);else for(var l=h.length-1;l>=0;l--)(T=h[l])&&(R=(w<3?T(R):w>3?T(p,g,R):T(p,g))||R);return w>3&&R&&Object.defineProperty(p,g,R),R},d=this&&this.__param||function(h,p){return function(g,m){p(g,m,h)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CharSizeService=void 0;const _=o(2585),v=o(8460),E=o(844);let C=class extends E.Disposable{constructor(h,p,g){super(),this._optionsService=g,this.width=0,this.height=0,this._onCharSizeChange=this.register(new v.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new S(h,p,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){const h=this._measureStrategy.measure();h.width===this.width&&h.height===this.height||(this.width=h.width,this.height=h.height,this._onCharSizeChange.fire())}};C=c([d(2,_.IOptionsService)],C),s.CharSizeService=C;class S{constructor(p,g,m){this._document=p,this._parentElement=g,this._optionsService=m,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const p=this._measureElement.getBoundingClientRect();return p.width!==0&&p.height!==0&&(this._result.width=p.width,this._result.height=Math.ceil(p.height)),this._result}}},4269:function(y,s,o){var c=this&&this.__decorate||function(p,g,m,T){var w,R=arguments.length,l=R<3?g:T===null?T=Object.getOwnPropertyDescriptor(g,m):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(p,g,m,T);else for(var k=p.length-1;k>=0;k--)(w=p[k])&&(l=(R<3?w(l):R>3?w(g,m,l):w(g,m))||l);return R>3&&l&&Object.defineProperty(g,m,l),l},d=this&&this.__param||function(p,g){return function(m,T){g(m,T,p)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CharacterJoinerService=s.JoinedCellData=void 0;const _=o(3734),v=o(643),E=o(511),C=o(2585);class S extends _.AttributeData{constructor(g,m,T){super(),this.content=0,this.combinedData="",this.fg=g.fg,this.bg=g.bg,this.combinedData=m,this._width=T}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(g){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}s.JoinedCellData=S;let h=class Yu{constructor(g){this._bufferService=g,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new E.CellData}register(g){const m={id:this._nextCharacterJoinerId++,handler:g};return this._characterJoiners.push(m),m.id}deregister(g){for(let m=0;m<this._characterJoiners.length;m++)if(this._characterJoiners[m].id===g)return this._characterJoiners.splice(m,1),!0;return!1}getJoinedCharacters(g){if(this._characterJoiners.length===0)return[];const m=this._bufferService.buffer.lines.get(g);if(!m||m.length===0)return[];const T=[],w=m.translateToString(!0);let R=0,l=0,k=0,x=m.getFg(0),M=m.getBg(0);for(let $=0;$<m.getTrimmedLength();$++)if(m.loadCell($,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==x||this._workCell.bg!==M){if($-R>1){const B=this._getJoinedRanges(w,k,l,m,R);for(let N=0;N<B.length;N++)T.push(B[N])}R=$,k=l,x=this._workCell.fg,M=this._workCell.bg}l+=this._workCell.getChars().length||v.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-R>1){const $=this._getJoinedRanges(w,k,l,m,R);for(let B=0;B<$.length;B++)T.push($[B])}return T}_getJoinedRanges(g,m,T,w,R){const l=g.substring(m,T);let k=[];try{k=this._characterJoiners[0].handler(l)}catch(x){console.error(x)}for(let x=1;x<this._characterJoiners.length;x++)try{const M=this._characterJoiners[x].handler(l);for(let $=0;$<M.length;$++)Yu._mergeRanges(k,M[$])}catch(M){console.error(M)}return this._stringRangesToCellRanges(k,w,R),k}_stringRangesToCellRanges(g,m,T){let w=0,R=!1,l=0,k=g[w];if(k){for(let x=T;x<this._bufferService.cols;x++){const M=m.getWidth(x),$=m.getString(x).length||v.WHITESPACE_CELL_CHAR.length;if(M!==0){if(!R&&k[0]<=l&&(k[0]=x,R=!0),k[1]<=l){if(k[1]=x,k=g[++w],!k)break;k[0]<=l?(k[0]=x,R=!0):R=!1}l+=$}}k&&(k[1]=this._bufferService.cols)}}static _mergeRanges(g,m){let T=!1;for(let w=0;w<g.length;w++){const R=g[w];if(T){if(m[1]<=R[0])return g[w-1][1]=m[1],g;if(m[1]<=R[1])return g[w-1][1]=Math.max(m[1],R[1]),g.splice(w,1),g;g.splice(w,1),w--}else{if(m[1]<=R[0])return g.splice(w,0,m),g;if(m[1]<=R[1])return R[0]=Math.min(m[0],R[0]),g;m[0]<R[1]&&(R[0]=Math.min(m[0],R[0]),T=!0)}}return T?g[g.length-1][1]=m[1]:g.push(m),g}};h=c([d(0,C.IBufferService)],h),s.CharacterJoinerService=h},5114:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CoreBrowserService=void 0,s.CoreBrowserService=class{constructor(o,c){this._textarea=o,this.window=c,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(y,s,o){var c=this&&this.__decorate||function(C,S,h,p){var g,m=arguments.length,T=m<3?S:p===null?p=Object.getOwnPropertyDescriptor(S,h):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(C,S,h,p);else for(var w=C.length-1;w>=0;w--)(g=C[w])&&(T=(m<3?g(T):m>3?g(S,h,T):g(S,h))||T);return m>3&&T&&Object.defineProperty(S,h,T),T},d=this&&this.__param||function(C,S){return function(h,p){S(h,p,C)}};Object.defineProperty(s,"__esModule",{value:!0}),s.MouseService=void 0;const _=o(4725),v=o(9806);let E=class{constructor(C,S){this._renderService=C,this._charSizeService=S}getCoords(C,S,h,p,g){return(0,v.getCoords)(window,C,S,h,p,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,g)}getMouseReportCoords(C,S){const h=(0,v.getCoordsRelativeToElement)(window,C,S);if(!(!this._charSizeService.hasValidSize||h[0]<0||h[1]<0||h[0]>=this._renderService.dimensions.css.canvas.width||h[1]>=this._renderService.dimensions.css.canvas.height))return{col:Math.floor(h[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(h[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(h[0]),y:Math.floor(h[1])}}};E=c([d(0,_.IRenderService),d(1,_.ICharSizeService)],E),s.MouseService=E},3230:function(y,s,o){var c=this&&this.__decorate||function(T,w,R,l){var k,x=arguments.length,M=x<3?w:l===null?l=Object.getOwnPropertyDescriptor(w,R):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(T,w,R,l);else for(var $=T.length-1;$>=0;$--)(k=T[$])&&(M=(x<3?k(M):x>3?k(w,R,M):k(w,R))||M);return x>3&&M&&Object.defineProperty(w,R,M),M},d=this&&this.__param||function(T,w){return function(R,l){w(R,l,T)}};Object.defineProperty(s,"__esModule",{value:!0}),s.RenderService=void 0;const _=o(6193),v=o(8460),E=o(844),C=o(5596),S=o(3656),h=o(2585),p=o(4725),g=o(7226);let m=class extends E.Disposable{constructor(T,w,R,l,k,x,M,$){if(super(),this._rowCount=T,this._charSizeService=l,this._pausedResizeTask=new g.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new v.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new v.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new v.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new v.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this.register({dispose:()=>{var B;return(B=this._renderer)===null||B===void 0?void 0:B.dispose()}}),this._renderDebouncer=new _.RenderDebouncer(M.window,(B,N)=>this._renderRows(B,N)),this.register(this._renderDebouncer),this._screenDprMonitor=new C.ScreenDprMonitor(M.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(x.onResize(()=>this._fullRefresh())),this.register(x.buffers.onBufferActivate(()=>{var B;return(B=this._renderer)===null||B===void 0?void 0:B.clear()})),this.register(R.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(k.onDecorationRegistered(()=>this._fullRefresh())),this.register(k.onDecorationRemoved(()=>this._fullRefresh())),this.register(R.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(x.cols,x.rows),this._fullRefresh()})),this.register(R.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(x.buffer.y,x.buffer.y,!0))),this.register((0,S.addDisposableDomListener)(M.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register($.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in M.window){const B=new M.window.IntersectionObserver(N=>this._handleIntersectionChange(N[N.length-1]),{threshold:0});B.observe(w),this.register({dispose:()=>B.disconnect()})}}get dimensions(){return this._renderer.dimensions}_handleIntersectionChange(T){this._isPaused=T.isIntersecting===void 0?T.intersectionRatio===0:!T.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(T,w,R=!1){this._isPaused?this._needsFullRefresh=!0:(R||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(T,w,this._rowCount))}_renderRows(T,w){this._renderer&&(T=Math.min(T,this._rowCount-1),w=Math.min(w,this._rowCount-1),this._renderer.renderRows(T,w),this._needsSelectionRefresh&&(this._renderer.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:T,end:w}),this._onRender.fire({start:T,end:w}),this._isNextRenderRedrawOnly=!0)}resize(T,w){this._rowCount=w,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer&&(this._renderer.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions))}hasRenderer(){return!!this._renderer}setRenderer(T){var w;(w=this._renderer)===null||w===void 0||w.dispose(),this._renderer=T,this._renderer.onRequestRedraw(R=>this.refreshRows(R.start,R.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(T){return this._renderDebouncer.addRefreshCallback(T)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var T,w;this._renderer&&((w=(T=this._renderer).clearTextureAtlas)===null||w===void 0||w.call(T),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer&&(this._renderer.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(T,w){this._renderer&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.handleResize(T,w)):this._renderer.handleResize(T,w),this._fullRefresh())}handleCharSizeChanged(){var T;(T=this._renderer)===null||T===void 0||T.handleCharSizeChanged()}handleBlur(){var T;(T=this._renderer)===null||T===void 0||T.handleBlur()}handleFocus(){var T;(T=this._renderer)===null||T===void 0||T.handleFocus()}handleSelectionChanged(T,w,R){var l;this._selectionState.start=T,this._selectionState.end=w,this._selectionState.columnSelectMode=R,(l=this._renderer)===null||l===void 0||l.handleSelectionChanged(T,w,R)}handleCursorMove(){var T;(T=this._renderer)===null||T===void 0||T.handleCursorMove()}clear(){var T;(T=this._renderer)===null||T===void 0||T.clear()}};m=c([d(2,h.IOptionsService),d(3,p.ICharSizeService),d(4,h.IDecorationService),d(5,h.IBufferService),d(6,p.ICoreBrowserService),d(7,p.IThemeService)],m),s.RenderService=m},9312:function(y,s,o){var c=this&&this.__decorate||function(k,x,M,$){var B,N=arguments.length,ee=N<3?x:$===null?$=Object.getOwnPropertyDescriptor(x,M):$;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")ee=Reflect.decorate(k,x,M,$);else for(var ue=k.length-1;ue>=0;ue--)(B=k[ue])&&(ee=(N<3?B(ee):N>3?B(x,M,ee):B(x,M))||ee);return N>3&&ee&&Object.defineProperty(x,M,ee),ee},d=this&&this.__param||function(k,x){return function(M,$){x(M,$,k)}};Object.defineProperty(s,"__esModule",{value:!0}),s.SelectionService=void 0;const _=o(6114),v=o(456),E=o(511),C=o(8460),S=o(4725),h=o(2585),p=o(9806),g=o(9504),m=o(844),T=o(4841),w=String.fromCharCode(160),R=new RegExp(w,"g");let l=class extends m.Disposable{constructor(k,x,M,$,B,N,ee,ue,se){super(),this._element=k,this._screenElement=x,this._linkifier=M,this._bufferService=$,this._coreService=B,this._mouseService=N,this._optionsService=ee,this._renderService=ue,this._coreBrowserService=se,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new E.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new C.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new C.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new C.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new C.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=P=>this._handleMouseMove(P),this._mouseUpListener=P=>this._handleMouseUp(P),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(P=>this._handleTrim(P)),this.register(this._bufferService.buffers.onBufferActivate(P=>this._handleBufferActivate(P))),this.enable(),this._model=new v.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,m.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const k=this._model.finalSelectionStart,x=this._model.finalSelectionEnd;return!(!k||!x||k[0]===x[0]&&k[1]===x[1])}get selectionText(){const k=this._model.finalSelectionStart,x=this._model.finalSelectionEnd;if(!k||!x)return"";const M=this._bufferService.buffer,$=[];if(this._activeSelectionMode===3){if(k[0]===x[0])return"";const B=k[0]<x[0]?k[0]:x[0],N=k[0]<x[0]?x[0]:k[0];for(let ee=k[1];ee<=x[1];ee++){const ue=M.translateBufferLineToString(ee,!0,B,N);$.push(ue)}}else{const B=k[1]===x[1]?x[0]:void 0;$.push(M.translateBufferLineToString(k[1],!0,k[0],B));for(let N=k[1]+1;N<=x[1]-1;N++){const ee=M.lines.get(N),ue=M.translateBufferLineToString(N,!0);ee!=null&&ee.isWrapped?$[$.length-1]+=ue:$.push(ue)}if(k[1]!==x[1]){const N=M.lines.get(x[1]),ee=M.translateBufferLineToString(x[1],!0,0,x[0]);N&&N.isWrapped?$[$.length-1]+=ee:$.push(ee)}}return $.map(B=>B.replace(R," ")).join(_.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(k){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),_.isLinux&&k&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(k){const x=this._getMouseBufferCoords(k),M=this._model.finalSelectionStart,$=this._model.finalSelectionEnd;return!!(M&&$&&x)&&this._areCoordsInSelection(x,M,$)}isCellInSelection(k,x){const M=this._model.finalSelectionStart,$=this._model.finalSelectionEnd;return!(!M||!$)&&this._areCoordsInSelection([k,x],M,$)}_areCoordsInSelection(k,x,M){return k[1]>x[1]&&k[1]<M[1]||x[1]===M[1]&&k[1]===x[1]&&k[0]>=x[0]&&k[0]<M[0]||x[1]<M[1]&&k[1]===M[1]&&k[0]<M[0]||x[1]<M[1]&&k[1]===x[1]&&k[0]>=x[0]}_selectWordAtCursor(k,x){var M,$;const B=($=(M=this._linkifier.currentLink)===null||M===void 0?void 0:M.link)===null||$===void 0?void 0:$.range;if(B)return this._model.selectionStart=[B.start.x-1,B.start.y-1],this._model.selectionStartLength=(0,T.getRangeLength)(B,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const N=this._getMouseBufferCoords(k);return!!N&&(this._selectWordAt(N,x),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(k,x){this._model.clearSelection(),k=Math.max(k,0),x=Math.min(x,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,k],this._model.selectionEnd=[this._bufferService.cols,x],this.refresh(),this._onSelectionChange.fire()}_handleTrim(k){this._model.handleTrim(k)&&this.refresh()}_getMouseBufferCoords(k){const x=this._mouseService.getCoords(k,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(x)return x[0]--,x[1]--,x[1]+=this._bufferService.buffer.ydisp,x}_getMouseEventScrollAmount(k){let x=(0,p.getCoordsRelativeToElement)(this._coreBrowserService.window,k,this._screenElement)[1];const M=this._renderService.dimensions.css.canvas.height;return x>=0&&x<=M?0:(x>M&&(x-=M),x=Math.min(Math.max(x,-50),50),x/=50,x/Math.abs(x)+Math.round(14*x))}shouldForceSelection(k){return _.isMac?k.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:k.shiftKey}handleMouseDown(k){if(this._mouseDownTimeStamp=k.timeStamp,(k.button!==2||!this.hasSelection)&&k.button===0){if(!this._enabled){if(!this.shouldForceSelection(k))return;k.stopPropagation()}k.preventDefault(),this._dragScrollAmount=0,this._enabled&&k.shiftKey?this._handleIncrementalClick(k):k.detail===1?this._handleSingleClick(k):k.detail===2?this._handleDoubleClick(k):k.detail===3&&this._handleTripleClick(k),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(k){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(k))}_handleSingleClick(k){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(k)?3:0,this._model.selectionStart=this._getMouseBufferCoords(k),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const x=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);x&&x.length!==this._model.selectionStart[0]&&x.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(k){this._selectWordAtCursor(k,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(k){const x=this._getMouseBufferCoords(k);x&&(this._activeSelectionMode=2,this._selectLineAt(x[1]))}shouldColumnSelect(k){return k.altKey&&!(_.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(k){if(k.stopImmediatePropagation(),!this._model.selectionStart)return;const x=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(k),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(k),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const M=this._bufferService.buffer;if(this._model.selectionEnd[1]<M.lines.length){const $=M.lines.get(this._model.selectionEnd[1]);$&&$.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}x&&x[0]===this._model.selectionEnd[0]&&x[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const k=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(k.ydisp+this._bufferService.rows,k.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=k.ydisp),this.refresh()}}_handleMouseUp(k){const x=k.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&x<500&&k.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const M=this._mouseService.getCoords(k,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(M&&M[0]!==void 0&&M[1]!==void 0){const $=(0,g.moveToCellSequence)(M[0]-1,M[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent($,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const k=this._model.finalSelectionStart,x=this._model.finalSelectionEnd,M=!(!k||!x||k[0]===x[0]&&k[1]===x[1]);M?k&&x&&(this._oldSelectionStart&&this._oldSelectionEnd&&k[0]===this._oldSelectionStart[0]&&k[1]===this._oldSelectionStart[1]&&x[0]===this._oldSelectionEnd[0]&&x[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(k,x,M)):this._oldHasSelection&&this._fireOnSelectionChange(k,x,M)}_fireOnSelectionChange(k,x,M){this._oldSelectionStart=k,this._oldSelectionEnd=x,this._oldHasSelection=M,this._onSelectionChange.fire()}_handleBufferActivate(k){this.clearSelection(),this._trimListener.dispose(),this._trimListener=k.activeBuffer.lines.onTrim(x=>this._handleTrim(x))}_convertViewportColToCharacterIndex(k,x){let M=x;for(let $=0;x>=$;$++){const B=k.loadCell($,this._workCell).getChars().length;this._workCell.getWidth()===0?M--:B>1&&x!==$&&(M+=B-1)}return M}setSelection(k,x,M){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[k,x],this._model.selectionStartLength=M,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(k){this._isClickInSelection(k)||(this._selectWordAtCursor(k,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(k,x,M=!0,$=!0){if(k[0]>=this._bufferService.cols)return;const B=this._bufferService.buffer,N=B.lines.get(k[1]);if(!N)return;const ee=B.translateBufferLineToString(k[1],!1);let ue=this._convertViewportColToCharacterIndex(N,k[0]),se=ue;const P=k[0]-ue;let F=0,j=0,q=0,te=0;if(ee.charAt(ue)===" "){for(;ue>0&&ee.charAt(ue-1)===" ";)ue--;for(;se<ee.length&&ee.charAt(se+1)===" ";)se++}else{let oe=k[0],pe=k[0];N.getWidth(oe)===0&&(F++,oe--),N.getWidth(pe)===2&&(j++,pe++);const z=N.getString(pe).length;for(z>1&&(te+=z-1,se+=z-1);oe>0&&ue>0&&!this._isCharWordSeparator(N.loadCell(oe-1,this._workCell));){N.loadCell(oe-1,this._workCell);const W=this._workCell.getChars().length;this._workCell.getWidth()===0?(F++,oe--):W>1&&(q+=W-1,ue-=W-1),ue--,oe--}for(;pe<N.length&&se+1<ee.length&&!this._isCharWordSeparator(N.loadCell(pe+1,this._workCell));){N.loadCell(pe+1,this._workCell);const W=this._workCell.getChars().length;this._workCell.getWidth()===2?(j++,pe++):W>1&&(te+=W-1,se+=W-1),se++,pe++}}se++;let ge=ue+P-F+q,me=Math.min(this._bufferService.cols,se-ue+F+j-q-te);if(x||ee.slice(ue,se).trim()!==""){if(M&&ge===0&&N.getCodePoint(0)!==32){const oe=B.lines.get(k[1]-1);if(oe&&N.isWrapped&&oe.getCodePoint(this._bufferService.cols-1)!==32){const pe=this._getWordAt([this._bufferService.cols-1,k[1]-1],!1,!0,!1);if(pe){const z=this._bufferService.cols-pe.start;ge-=z,me+=z}}}if($&&ge+me===this._bufferService.cols&&N.getCodePoint(this._bufferService.cols-1)!==32){const oe=B.lines.get(k[1]+1);if(oe!=null&&oe.isWrapped&&oe.getCodePoint(0)!==32){const pe=this._getWordAt([0,k[1]+1],!1,!1,!0);pe&&(me+=pe.length)}}return{start:ge,length:me}}}_selectWordAt(k,x){const M=this._getWordAt(k,x);if(M){for(;M.start<0;)M.start+=this._bufferService.cols,k[1]--;this._model.selectionStart=[M.start,k[1]],this._model.selectionStartLength=M.length}}_selectToWordAt(k){const x=this._getWordAt(k,!0);if(x){let M=k[1];for(;x.start<0;)x.start+=this._bufferService.cols,M--;if(!this._model.areSelectionValuesReversed())for(;x.start+x.length>this._bufferService.cols;)x.length-=this._bufferService.cols,M++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?x.start:x.start+x.length,M]}}_isCharWordSeparator(k){return k.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(k.getChars())>=0}_selectLineAt(k){const x=this._bufferService.buffer.getWrappedRangeForLine(k),M={start:{x:0,y:x.first},end:{x:this._bufferService.cols-1,y:x.last}};this._model.selectionStart=[0,x.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,T.getRangeLength)(M,this._bufferService.cols)}};l=c([d(3,h.IBufferService),d(4,h.ICoreService),d(5,S.IMouseService),d(6,h.IOptionsService),d(7,S.IRenderService),d(8,S.ICoreBrowserService)],l),s.SelectionService=l},4725:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.IThemeService=s.ICharacterJoinerService=s.ISelectionService=s.IRenderService=s.IMouseService=s.ICoreBrowserService=s.ICharSizeService=void 0;const c=o(8343);s.ICharSizeService=(0,c.createDecorator)("CharSizeService"),s.ICoreBrowserService=(0,c.createDecorator)("CoreBrowserService"),s.IMouseService=(0,c.createDecorator)("MouseService"),s.IRenderService=(0,c.createDecorator)("RenderService"),s.ISelectionService=(0,c.createDecorator)("SelectionService"),s.ICharacterJoinerService=(0,c.createDecorator)("CharacterJoinerService"),s.IThemeService=(0,c.createDecorator)("ThemeService")},6731:function(y,s,o){var c=this&&this.__decorate||function(l,k,x,M){var $,B=arguments.length,N=B<3?k:M===null?M=Object.getOwnPropertyDescriptor(k,x):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")N=Reflect.decorate(l,k,x,M);else for(var ee=l.length-1;ee>=0;ee--)($=l[ee])&&(N=(B<3?$(N):B>3?$(k,x,N):$(k,x))||N);return B>3&&N&&Object.defineProperty(k,x,N),N},d=this&&this.__param||function(l,k){return function(x,M){k(x,M,l)}};Object.defineProperty(s,"__esModule",{value:!0}),s.ThemeService=s.DEFAULT_ANSI_COLORS=void 0;const _=o(7239),v=o(8055),E=o(8460),C=o(844),S=o(2585),h=v.css.toColor("#ffffff"),p=v.css.toColor("#000000"),g=v.css.toColor("#ffffff"),m=v.css.toColor("#000000"),T={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};s.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const l=[v.css.toColor("#2e3436"),v.css.toColor("#cc0000"),v.css.toColor("#4e9a06"),v.css.toColor("#c4a000"),v.css.toColor("#3465a4"),v.css.toColor("#75507b"),v.css.toColor("#06989a"),v.css.toColor("#d3d7cf"),v.css.toColor("#555753"),v.css.toColor("#ef2929"),v.css.toColor("#8ae234"),v.css.toColor("#fce94f"),v.css.toColor("#729fcf"),v.css.toColor("#ad7fa8"),v.css.toColor("#34e2e2"),v.css.toColor("#eeeeec")],k=[0,95,135,175,215,255];for(let x=0;x<216;x++){const M=k[x/36%6|0],$=k[x/6%6|0],B=k[x%6];l.push({css:v.channels.toCss(M,$,B),rgba:v.channels.toRgba(M,$,B)})}for(let x=0;x<24;x++){const M=8+10*x;l.push({css:v.channels.toCss(M,M,M),rgba:v.channels.toRgba(M,M,M)})}return l})());let w=class extends C.Disposable{constructor(l){super(),this._optionsService=l,this._onChangeColors=this.register(new E.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._contrastCache=new _.ColorContrastCache,this._colors={foreground:h,background:p,cursor:g,cursorAccent:m,selectionForeground:void 0,selectionBackgroundTransparent:T,selectionBackgroundOpaque:v.color.blend(p,T),selectionInactiveBackgroundTransparent:T,selectionInactiveBackgroundOpaque:v.color.blend(p,T),ansi:s.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(l={}){const k=this._colors;if(k.foreground=R(l.foreground,h),k.background=R(l.background,p),k.cursor=R(l.cursor,g),k.cursorAccent=R(l.cursorAccent,m),k.selectionBackgroundTransparent=R(l.selectionBackground,T),k.selectionBackgroundOpaque=v.color.blend(k.background,k.selectionBackgroundTransparent),k.selectionInactiveBackgroundTransparent=R(l.selectionInactiveBackground,k.selectionBackgroundTransparent),k.selectionInactiveBackgroundOpaque=v.color.blend(k.background,k.selectionInactiveBackgroundTransparent),k.selectionForeground=l.selectionForeground?R(l.selectionForeground,v.NULL_COLOR):void 0,k.selectionForeground===v.NULL_COLOR&&(k.selectionForeground=void 0),v.color.isOpaque(k.selectionBackgroundTransparent)&&(k.selectionBackgroundTransparent=v.color.opacity(k.selectionBackgroundTransparent,.3)),v.color.isOpaque(k.selectionInactiveBackgroundTransparent)&&(k.selectionInactiveBackgroundTransparent=v.color.opacity(k.selectionInactiveBackgroundTransparent,.3)),k.ansi=s.DEFAULT_ANSI_COLORS.slice(),k.ansi[0]=R(l.black,s.DEFAULT_ANSI_COLORS[0]),k.ansi[1]=R(l.red,s.DEFAULT_ANSI_COLORS[1]),k.ansi[2]=R(l.green,s.DEFAULT_ANSI_COLORS[2]),k.ansi[3]=R(l.yellow,s.DEFAULT_ANSI_COLORS[3]),k.ansi[4]=R(l.blue,s.DEFAULT_ANSI_COLORS[4]),k.ansi[5]=R(l.magenta,s.DEFAULT_ANSI_COLORS[5]),k.ansi[6]=R(l.cyan,s.DEFAULT_ANSI_COLORS[6]),k.ansi[7]=R(l.white,s.DEFAULT_ANSI_COLORS[7]),k.ansi[8]=R(l.brightBlack,s.DEFAULT_ANSI_COLORS[8]),k.ansi[9]=R(l.brightRed,s.DEFAULT_ANSI_COLORS[9]),k.ansi[10]=R(l.brightGreen,s.DEFAULT_ANSI_COLORS[10]),k.ansi[11]=R(l.brightYellow,s.DEFAULT_ANSI_COLORS[11]),k.ansi[12]=R(l.brightBlue,s.DEFAULT_ANSI_COLORS[12]),k.ansi[13]=R(l.brightMagenta,s.DEFAULT_ANSI_COLORS[13]),k.ansi[14]=R(l.brightCyan,s.DEFAULT_ANSI_COLORS[14]),k.ansi[15]=R(l.brightWhite,s.DEFAULT_ANSI_COLORS[15]),l.extendedAnsi){const x=Math.min(k.ansi.length-16,l.extendedAnsi.length);for(let M=0;M<x;M++)k.ansi[M+16]=R(l.extendedAnsi[M],s.DEFAULT_ANSI_COLORS[M+16])}this._contrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(l){this._restoreColor(l),this._onChangeColors.fire(this.colors)}_restoreColor(l){if(l!==void 0)switch(l){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[l]=this._restoreColors.ansi[l]}else for(let k=0;k<this._restoreColors.ansi.length;++k)this._colors.ansi[k]=this._restoreColors.ansi[k]}modifyColors(l){l(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function R(l,k){if(l!==void 0)try{return v.css.toColor(l)}catch{}return k}w=c([d(0,S.IOptionsService)],w),s.ThemeService=w},6349:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CircularList=void 0;const c=o(8460),d=o(844);class _ extends d.Disposable{constructor(E){super(),this._maxLength=E,this.onDeleteEmitter=this.register(new c.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new c.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new c.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(E){if(this._maxLength===E)return;const C=new Array(E);for(let S=0;S<Math.min(E,this.length);S++)C[S]=this._array[this._getCyclicIndex(S)];this._array=C,this._maxLength=E,this._startIndex=0}get length(){return this._length}set length(E){if(E>this._length)for(let C=this._length;C<E;C++)this._array[C]=void 0;this._length=E}get(E){return this._array[this._getCyclicIndex(E)]}set(E,C){this._array[this._getCyclicIndex(E)]=C}push(E){this._array[this._getCyclicIndex(this._length)]=E,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(E,C,...S){if(C){for(let h=E;h<this._length-C;h++)this._array[this._getCyclicIndex(h)]=this._array[this._getCyclicIndex(h+C)];this._length-=C,this.onDeleteEmitter.fire({index:E,amount:C})}for(let h=this._length-1;h>=E;h--)this._array[this._getCyclicIndex(h+S.length)]=this._array[this._getCyclicIndex(h)];for(let h=0;h<S.length;h++)this._array[this._getCyclicIndex(E+h)]=S[h];if(S.length&&this.onInsertEmitter.fire({index:E,amount:S.length}),this._length+S.length>this._maxLength){const h=this._length+S.length-this._maxLength;this._startIndex+=h,this._length=this._maxLength,this.onTrimEmitter.fire(h)}else this._length+=S.length}trimStart(E){E>this._length&&(E=this._length),this._startIndex+=E,this._length-=E,this.onTrimEmitter.fire(E)}shiftElements(E,C,S){if(!(C<=0)){if(E<0||E>=this._length)throw new Error("start argument out of range");if(E+S<0)throw new Error("Cannot shift elements in list beyond index 0");if(S>0){for(let p=C-1;p>=0;p--)this.set(E+p+S,this.get(E+p));const h=E+C+S-this._length;if(h>0)for(this._length+=h;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let h=0;h<C;h++)this.set(E+h+S,this.get(E+h))}}_getCyclicIndex(E){return(this._startIndex+E)%this._maxLength}}s.CircularList=_},1439:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.clone=void 0,s.clone=function o(c,d=5){if(typeof c!="object")return c;const _=Array.isArray(c)?[]:{};for(const v in c)_[v]=d<=1?c[v]:c[v]&&o(c[v],d-1);return _}},8055:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.contrastRatio=s.toPaddedHex=s.rgba=s.rgb=s.css=s.color=s.channels=s.NULL_COLOR=void 0;const c=o(6114);let d=0,_=0,v=0,E=0;var C,S,h;function p(m){const T=m.toString(16);return T.length<2?"0"+T:T}function g(m,T){return m<T?(T+.05)/(m+.05):(m+.05)/(T+.05)}s.NULL_COLOR={css:"#00000000",rgba:0},function(m){m.toCss=function(T,w,R,l){return l!==void 0?`#${p(T)}${p(w)}${p(R)}${p(l)}`:`#${p(T)}${p(w)}${p(R)}`},m.toRgba=function(T,w,R,l=255){return(T<<24|w<<16|R<<8|l)>>>0}}(C=s.channels||(s.channels={})),function(m){function T(w,R){return E=Math.round(255*R),[d,_,v]=h.toChannels(w.rgba),{css:C.toCss(d,_,v,E),rgba:C.toRgba(d,_,v,E)}}m.blend=function(w,R){if(E=(255&R.rgba)/255,E===1)return{css:R.css,rgba:R.rgba};const l=R.rgba>>24&255,k=R.rgba>>16&255,x=R.rgba>>8&255,M=w.rgba>>24&255,$=w.rgba>>16&255,B=w.rgba>>8&255;return d=M+Math.round((l-M)*E),_=$+Math.round((k-$)*E),v=B+Math.round((x-B)*E),{css:C.toCss(d,_,v),rgba:C.toRgba(d,_,v)}},m.isOpaque=function(w){return(255&w.rgba)==255},m.ensureContrastRatio=function(w,R,l){const k=h.ensureContrastRatio(w.rgba,R.rgba,l);if(k)return h.toColor(k>>24&255,k>>16&255,k>>8&255)},m.opaque=function(w){const R=(255|w.rgba)>>>0;return[d,_,v]=h.toChannels(R),{css:C.toCss(d,_,v),rgba:R}},m.opacity=T,m.multiplyOpacity=function(w,R){return E=255&w.rgba,T(w,E*R/255)},m.toColorRGB=function(w){return[w.rgba>>24&255,w.rgba>>16&255,w.rgba>>8&255]}}(s.color||(s.color={})),function(m){let T,w;if(!c.isNode){const R=document.createElement("canvas");R.width=1,R.height=1;const l=R.getContext("2d",{willReadFrequently:!0});l&&(T=l,T.globalCompositeOperation="copy",w=T.createLinearGradient(0,0,1,1))}m.toColor=function(R){if(R.match(/#[\da-f]{3,8}/i))switch(R.length){case 4:return d=parseInt(R.slice(1,2).repeat(2),16),_=parseInt(R.slice(2,3).repeat(2),16),v=parseInt(R.slice(3,4).repeat(2),16),h.toColor(d,_,v);case 5:return d=parseInt(R.slice(1,2).repeat(2),16),_=parseInt(R.slice(2,3).repeat(2),16),v=parseInt(R.slice(3,4).repeat(2),16),E=parseInt(R.slice(4,5).repeat(2),16),h.toColor(d,_,v,E);case 7:return{css:R,rgba:(parseInt(R.slice(1),16)<<8|255)>>>0};case 9:return{css:R,rgba:parseInt(R.slice(1),16)>>>0}}const l=R.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(l)return d=parseInt(l[1]),_=parseInt(l[2]),v=parseInt(l[3]),E=Math.round(255*(l[5]===void 0?1:parseFloat(l[5]))),h.toColor(d,_,v,E);if(!T||!w)throw new Error("css.toColor: Unsupported css format");if(T.fillStyle=w,T.fillStyle=R,typeof T.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(T.fillRect(0,0,1,1),[d,_,v,E]=T.getImageData(0,0,1,1).data,E!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:C.toRgba(d,_,v,E),css:R}}}(s.css||(s.css={})),function(m){function T(w,R,l){const k=w/255,x=R/255,M=l/255;return .2126*(k<=.03928?k/12.92:Math.pow((k+.055)/1.055,2.4))+.7152*(x<=.03928?x/12.92:Math.pow((x+.055)/1.055,2.4))+.0722*(M<=.03928?M/12.92:Math.pow((M+.055)/1.055,2.4))}m.relativeLuminance=function(w){return T(w>>16&255,w>>8&255,255&w)},m.relativeLuminance2=T}(S=s.rgb||(s.rgb={})),function(m){function T(R,l,k){const x=R>>24&255,M=R>>16&255,$=R>>8&255;let B=l>>24&255,N=l>>16&255,ee=l>>8&255,ue=g(S.relativeLuminance2(B,N,ee),S.relativeLuminance2(x,M,$));for(;ue<k&&(B>0||N>0||ee>0);)B-=Math.max(0,Math.ceil(.1*B)),N-=Math.max(0,Math.ceil(.1*N)),ee-=Math.max(0,Math.ceil(.1*ee)),ue=g(S.relativeLuminance2(B,N,ee),S.relativeLuminance2(x,M,$));return(B<<24|N<<16|ee<<8|255)>>>0}function w(R,l,k){const x=R>>24&255,M=R>>16&255,$=R>>8&255;let B=l>>24&255,N=l>>16&255,ee=l>>8&255,ue=g(S.relativeLuminance2(B,N,ee),S.relativeLuminance2(x,M,$));for(;ue<k&&(B<255||N<255||ee<255);)B=Math.min(255,B+Math.ceil(.1*(255-B))),N=Math.min(255,N+Math.ceil(.1*(255-N))),ee=Math.min(255,ee+Math.ceil(.1*(255-ee))),ue=g(S.relativeLuminance2(B,N,ee),S.relativeLuminance2(x,M,$));return(B<<24|N<<16|ee<<8|255)>>>0}m.ensureContrastRatio=function(R,l,k){const x=S.relativeLuminance(R>>8),M=S.relativeLuminance(l>>8);if(g(x,M)<k){if(M<x){const N=T(R,l,k),ee=g(x,S.relativeLuminance(N>>8));if(ee<k){const ue=w(R,l,k);return ee>g(x,S.relativeLuminance(ue>>8))?N:ue}return N}const $=w(R,l,k),B=g(x,S.relativeLuminance($>>8));if(B<k){const N=T(R,l,k);return B>g(x,S.relativeLuminance(N>>8))?$:N}return $}},m.reduceLuminance=T,m.increaseLuminance=w,m.toChannels=function(R){return[R>>24&255,R>>16&255,R>>8&255,255&R]},m.toColor=function(R,l,k,x){return{css:C.toCss(R,l,k,x),rgba:C.toRgba(R,l,k,x)}}}(h=s.rgba||(s.rgba={})),s.toPaddedHex=p,s.contrastRatio=g},8969:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CoreTerminal=void 0;const c=o(844),d=o(2585),_=o(4348),v=o(7866),E=o(744),C=o(7302),S=o(6975),h=o(8460),p=o(1753),g=o(1480),m=o(7994),T=o(9282),w=o(5435),R=o(5981),l=o(2660);let k=!1;class x extends c.Disposable{constructor($){super(),this._onBinary=this.register(new h.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new h.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new h.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new h.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new h.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new h.EventEmitter),this._instantiationService=new _.InstantiationService,this.optionsService=this.register(new C.OptionsService($)),this._instantiationService.setService(d.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(E.BufferService)),this._instantiationService.setService(d.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(v.LogService)),this._instantiationService.setService(d.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(S.CoreService)),this._instantiationService.setService(d.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(p.CoreMouseService)),this._instantiationService.setService(d.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(g.UnicodeService)),this._instantiationService.setService(d.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(m.CharsetService),this._instantiationService.setService(d.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(l.OscLinkService),this._instantiationService.setService(d.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new w.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,h.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,h.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,h.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,h.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(B=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(B=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new R.WriteBuffer((B,N)=>this._inputHandler.parse(B,N))),this.register((0,h.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed)),this.register((0,c.toDisposable)(()=>{var B;(B=this._windowsWrappingHeuristics)===null||B===void 0||B.dispose(),this._windowsWrappingHeuristics=void 0}))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new h.EventEmitter),this._onScroll.event($=>{var B;(B=this._onScrollApi)===null||B===void 0||B.fire($.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options($){for(const B in $)this.optionsService.options[B]=$[B]}write($,B){this._writeBuffer.write($,B)}writeSync($,B){this._logService.logLevel<=d.LogLevelEnum.WARN&&!k&&(this._logService.warn("writeSync is unreliable and will be removed soon."),k=!0),this._writeBuffer.writeSync($,B)}resize($,B){isNaN($)||isNaN(B)||($=Math.max($,E.MINIMUM_COLS),B=Math.max(B,E.MINIMUM_ROWS),this._bufferService.resize($,B))}scroll($,B=!1){this._bufferService.scroll($,B)}scrollLines($,B,N){this._bufferService.scrollLines($,B,N)}scrollPages($){this._bufferService.scrollPages($)}scrollToTop(){this._bufferService.scrollToTop()}scrollToBottom(){this._bufferService.scrollToBottom()}scrollToLine($){this._bufferService.scrollToLine($)}registerEscHandler($,B){return this._inputHandler.registerEscHandler($,B)}registerDcsHandler($,B){return this._inputHandler.registerDcsHandler($,B)}registerCsiHandler($,B){return this._inputHandler.registerCsiHandler($,B)}registerOscHandler($,B){return this._inputHandler.registerOscHandler($,B)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){var $;let B=!1;const N=this.optionsService.rawOptions.windowsPty;N&&N.buildNumber!==void 0&&N.buildNumber!==void 0?B=N.backend==="conpty"&&N.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(B=!0),B?this._enableWindowsWrappingHeuristics():(($=this._windowsWrappingHeuristics)===null||$===void 0||$.dispose(),this._windowsWrappingHeuristics=void 0)}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics){const $=[];$.push(this.onLineFeed(T.updateWindowsModeWrappedState.bind(null,this._bufferService))),$.push(this.registerCsiHandler({final:"H"},()=>((0,T.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics=(0,c.toDisposable)(()=>{for(const B of $)B.dispose()})}}}s.CoreTerminal=x},8460:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.forwardEvent=s.EventEmitter=void 0,s.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=o=>(this._listeners.push(o),{dispose:()=>{if(!this._disposed){for(let c=0;c<this._listeners.length;c++)if(this._listeners[c]===o)return void this._listeners.splice(c,1)}}})),this._event}fire(o,c){const d=[];for(let _=0;_<this._listeners.length;_++)d.push(this._listeners[_]);for(let _=0;_<d.length;_++)d[_].call(void 0,o,c)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},s.forwardEvent=function(o,c){return o(d=>c.fire(d))}},5435:function(y,s,o){var c=this&&this.__decorate||function(se,P,F,j){var q,te=arguments.length,ge=te<3?P:j===null?j=Object.getOwnPropertyDescriptor(P,F):j;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")ge=Reflect.decorate(se,P,F,j);else for(var me=se.length-1;me>=0;me--)(q=se[me])&&(ge=(te<3?q(ge):te>3?q(P,F,ge):q(P,F))||ge);return te>3&&ge&&Object.defineProperty(P,F,ge),ge},d=this&&this.__param||function(se,P){return function(F,j){P(F,j,se)}};Object.defineProperty(s,"__esModule",{value:!0}),s.InputHandler=s.WindowsOptionsReportType=void 0;const _=o(2584),v=o(7116),E=o(2015),C=o(844),S=o(482),h=o(8437),p=o(8460),g=o(643),m=o(511),T=o(3734),w=o(2585),R=o(6242),l=o(6351),k=o(5941),x={"(":0,")":1,"*":2,"+":3,"-":1,".":2},M=131072;function $(se,P){if(se>24)return P.setWinLines||!1;switch(se){case 1:return!!P.restoreWin;case 2:return!!P.minimizeWin;case 3:return!!P.setWinPosition;case 4:return!!P.setWinSizePixels;case 5:return!!P.raiseWin;case 6:return!!P.lowerWin;case 7:return!!P.refreshWin;case 8:return!!P.setWinSizeChars;case 9:return!!P.maximizeWin;case 10:return!!P.fullscreenWin;case 11:return!!P.getWinState;case 13:return!!P.getWinPosition;case 14:return!!P.getWinSizePixels;case 15:return!!P.getScreenSizePixels;case 16:return!!P.getCellSizePixels;case 18:return!!P.getWinSizeChars;case 19:return!!P.getScreenSizeChars;case 20:return!!P.getIconTitle;case 21:return!!P.getWinTitle;case 22:return!!P.pushTitle;case 23:return!!P.popTitle;case 24:return!!P.setWinLines}return!1}var B;(function(se){se[se.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",se[se.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(B=s.WindowsOptionsReportType||(s.WindowsOptionsReportType={}));let N=0;class ee extends C.Disposable{constructor(P,F,j,q,te,ge,me,oe,pe=new E.EscapeSequenceParser){super(),this._bufferService=P,this._charsetService=F,this._coreService=j,this._logService=q,this._optionsService=te,this._oscLinkService=ge,this._coreMouseService=me,this._unicodeService=oe,this._parser=pe,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new S.StringToUtf32,this._utf8Decoder=new S.Utf8ToUtf32,this._workCell=new m.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=h.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=h.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new p.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new p.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new p.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new p.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new p.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new p.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new p.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new p.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new p.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new p.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new p.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new p.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new p.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new ue(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(z=>this._activeBuffer=z.activeBuffer)),this._parser.setCsiHandlerFallback((z,W)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(z),params:W.toArray()})}),this._parser.setEscHandlerFallback(z=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(z)})}),this._parser.setExecuteHandlerFallback(z=>{this._logService.debug("Unknown EXECUTE code: ",{code:z})}),this._parser.setOscHandlerFallback((z,W,Y)=>{this._logService.debug("Unknown OSC code: ",{identifier:z,action:W,data:Y})}),this._parser.setDcsHandlerFallback((z,W,Y)=>{W==="HOOK"&&(Y=Y.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(z),action:W,payload:Y})}),this._parser.setPrintHandler((z,W,Y)=>this.print(z,W,Y)),this._parser.registerCsiHandler({final:"@"},z=>this.insertChars(z)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},z=>this.scrollLeft(z)),this._parser.registerCsiHandler({final:"A"},z=>this.cursorUp(z)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},z=>this.scrollRight(z)),this._parser.registerCsiHandler({final:"B"},z=>this.cursorDown(z)),this._parser.registerCsiHandler({final:"C"},z=>this.cursorForward(z)),this._parser.registerCsiHandler({final:"D"},z=>this.cursorBackward(z)),this._parser.registerCsiHandler({final:"E"},z=>this.cursorNextLine(z)),this._parser.registerCsiHandler({final:"F"},z=>this.cursorPrecedingLine(z)),this._parser.registerCsiHandler({final:"G"},z=>this.cursorCharAbsolute(z)),this._parser.registerCsiHandler({final:"H"},z=>this.cursorPosition(z)),this._parser.registerCsiHandler({final:"I"},z=>this.cursorForwardTab(z)),this._parser.registerCsiHandler({final:"J"},z=>this.eraseInDisplay(z,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},z=>this.eraseInDisplay(z,!0)),this._parser.registerCsiHandler({final:"K"},z=>this.eraseInLine(z,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},z=>this.eraseInLine(z,!0)),this._parser.registerCsiHandler({final:"L"},z=>this.insertLines(z)),this._parser.registerCsiHandler({final:"M"},z=>this.deleteLines(z)),this._parser.registerCsiHandler({final:"P"},z=>this.deleteChars(z)),this._parser.registerCsiHandler({final:"S"},z=>this.scrollUp(z)),this._parser.registerCsiHandler({final:"T"},z=>this.scrollDown(z)),this._parser.registerCsiHandler({final:"X"},z=>this.eraseChars(z)),this._parser.registerCsiHandler({final:"Z"},z=>this.cursorBackwardTab(z)),this._parser.registerCsiHandler({final:"`"},z=>this.charPosAbsolute(z)),this._parser.registerCsiHandler({final:"a"},z=>this.hPositionRelative(z)),this._parser.registerCsiHandler({final:"b"},z=>this.repeatPrecedingCharacter(z)),this._parser.registerCsiHandler({final:"c"},z=>this.sendDeviceAttributesPrimary(z)),this._parser.registerCsiHandler({prefix:">",final:"c"},z=>this.sendDeviceAttributesSecondary(z)),this._parser.registerCsiHandler({final:"d"},z=>this.linePosAbsolute(z)),this._parser.registerCsiHandler({final:"e"},z=>this.vPositionRelative(z)),this._parser.registerCsiHandler({final:"f"},z=>this.hVPosition(z)),this._parser.registerCsiHandler({final:"g"},z=>this.tabClear(z)),this._parser.registerCsiHandler({final:"h"},z=>this.setMode(z)),this._parser.registerCsiHandler({prefix:"?",final:"h"},z=>this.setModePrivate(z)),this._parser.registerCsiHandler({final:"l"},z=>this.resetMode(z)),this._parser.registerCsiHandler({prefix:"?",final:"l"},z=>this.resetModePrivate(z)),this._parser.registerCsiHandler({final:"m"},z=>this.charAttributes(z)),this._parser.registerCsiHandler({final:"n"},z=>this.deviceStatus(z)),this._parser.registerCsiHandler({prefix:"?",final:"n"},z=>this.deviceStatusPrivate(z)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},z=>this.softReset(z)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},z=>this.setCursorStyle(z)),this._parser.registerCsiHandler({final:"r"},z=>this.setScrollRegion(z)),this._parser.registerCsiHandler({final:"s"},z=>this.saveCursor(z)),this._parser.registerCsiHandler({final:"t"},z=>this.windowOptions(z)),this._parser.registerCsiHandler({final:"u"},z=>this.restoreCursor(z)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},z=>this.insertColumns(z)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},z=>this.deleteColumns(z)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},z=>this.selectProtected(z)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},z=>this.requestMode(z,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},z=>this.requestMode(z,!1)),this._parser.setExecuteHandler(_.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(_.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(_.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(_.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(_.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(_.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(_.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(_.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(_.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(_.C1.IND,()=>this.index()),this._parser.setExecuteHandler(_.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(_.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new R.OscHandler(z=>(this.setTitle(z),this.setIconName(z),!0))),this._parser.registerOscHandler(1,new R.OscHandler(z=>this.setIconName(z))),this._parser.registerOscHandler(2,new R.OscHandler(z=>this.setTitle(z))),this._parser.registerOscHandler(4,new R.OscHandler(z=>this.setOrReportIndexedColor(z))),this._parser.registerOscHandler(8,new R.OscHandler(z=>this.setHyperlink(z))),this._parser.registerOscHandler(10,new R.OscHandler(z=>this.setOrReportFgColor(z))),this._parser.registerOscHandler(11,new R.OscHandler(z=>this.setOrReportBgColor(z))),this._parser.registerOscHandler(12,new R.OscHandler(z=>this.setOrReportCursorColor(z))),this._parser.registerOscHandler(104,new R.OscHandler(z=>this.restoreIndexedColor(z))),this._parser.registerOscHandler(110,new R.OscHandler(z=>this.restoreFgColor(z))),this._parser.registerOscHandler(111,new R.OscHandler(z=>this.restoreBgColor(z))),this._parser.registerOscHandler(112,new R.OscHandler(z=>this.restoreCursorColor(z))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const z in v.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:z},()=>this.selectCharset("("+z)),this._parser.registerEscHandler({intermediates:")",final:z},()=>this.selectCharset(")"+z)),this._parser.registerEscHandler({intermediates:"*",final:z},()=>this.selectCharset("*"+z)),this._parser.registerEscHandler({intermediates:"+",final:z},()=>this.selectCharset("+"+z)),this._parser.registerEscHandler({intermediates:"-",final:z},()=>this.selectCharset("-"+z)),this._parser.registerEscHandler({intermediates:".",final:z},()=>this.selectCharset("."+z)),this._parser.registerEscHandler({intermediates:"/",final:z},()=>this.selectCharset("/"+z));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(z=>(this._logService.error("Parsing error: ",z),z)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new l.DcsHandler((z,W)=>this.requestStatusString(z,W)))}getAttrData(){return this._curAttrData}_preserveStack(P,F,j,q){this._parseStack.paused=!0,this._parseStack.cursorStartX=P,this._parseStack.cursorStartY=F,this._parseStack.decodedLength=j,this._parseStack.position=q}_logSlowResolvingAsync(P){this._logService.logLevel<=w.LogLevelEnum.WARN&&Promise.race([P,new Promise((F,j)=>setTimeout(()=>j("#SLOW_TIMEOUT"),5e3))]).catch(F=>{if(F!=="#SLOW_TIMEOUT")throw F;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(P,F){let j,q=this._activeBuffer.x,te=this._activeBuffer.y,ge=0;const me=this._parseStack.paused;if(me){if(j=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,F))return this._logSlowResolvingAsync(j),j;q=this._parseStack.cursorStartX,te=this._parseStack.cursorStartY,this._parseStack.paused=!1,P.length>M&&(ge=this._parseStack.position+M)}if(this._logService.logLevel<=w.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof P=="string"?` "${P}"`:` "${Array.prototype.map.call(P,oe=>String.fromCharCode(oe)).join("")}"`),typeof P=="string"?P.split("").map(oe=>oe.charCodeAt(0)):P),this._parseBuffer.length<P.length&&this._parseBuffer.length<M&&(this._parseBuffer=new Uint32Array(Math.min(P.length,M))),me||this._dirtyRowTracker.clearRange(),P.length>M)for(let oe=ge;oe<P.length;oe+=M){const pe=oe+M<P.length?oe+M:P.length,z=typeof P=="string"?this._stringDecoder.decode(P.substring(oe,pe),this._parseBuffer):this._utf8Decoder.decode(P.subarray(oe,pe),this._parseBuffer);if(j=this._parser.parse(this._parseBuffer,z))return this._preserveStack(q,te,z,oe),this._logSlowResolvingAsync(j),j}else if(!me){const oe=typeof P=="string"?this._stringDecoder.decode(P,this._parseBuffer):this._utf8Decoder.decode(P,this._parseBuffer);if(j=this._parser.parse(this._parseBuffer,oe))return this._preserveStack(q,te,oe,0),this._logSlowResolvingAsync(j),j}this._activeBuffer.x===q&&this._activeBuffer.y===te||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(P,F,j){let q,te;const ge=this._charsetService.charset,me=this._optionsService.rawOptions.screenReaderMode,oe=this._bufferService.cols,pe=this._coreService.decPrivateModes.wraparound,z=this._coreService.modes.insertMode,W=this._curAttrData;let Y=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&j-F>0&&Y.getWidth(this._activeBuffer.x-1)===2&&Y.setCellFromCodePoint(this._activeBuffer.x-1,0,1,W.fg,W.bg,W.extended);for(let re=F;re<j;++re){if(q=P[re],te=this._unicodeService.wcwidth(q),q<127&&ge){const ae=ge[String.fromCharCode(q)];ae&&(q=ae.charCodeAt(0))}if(me&&this._onA11yChar.fire((0,S.stringFromCodePoint)(q)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),te||!this._activeBuffer.x){if(this._activeBuffer.x+te-1>=oe){if(pe){for(;this._activeBuffer.x<oe;)Y.setCellFromCodePoint(this._activeBuffer.x++,0,1,W.fg,W.bg,W.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),Y=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=oe-1,te===2)continue}if(z&&(Y.insertCells(this._activeBuffer.x,te,this._activeBuffer.getNullCell(W),W),Y.getWidth(oe-1)===2&&Y.setCellFromCodePoint(oe-1,g.NULL_CELL_CODE,g.NULL_CELL_WIDTH,W.fg,W.bg,W.extended)),Y.setCellFromCodePoint(this._activeBuffer.x++,q,te,W.fg,W.bg,W.extended),te>0)for(;--te;)Y.setCellFromCodePoint(this._activeBuffer.x++,0,0,W.fg,W.bg,W.extended)}else Y.getWidth(this._activeBuffer.x-1)?Y.addCodepointToCell(this._activeBuffer.x-1,q):Y.addCodepointToCell(this._activeBuffer.x-2,q)}j-F>0&&(Y.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<oe&&j-F>0&&Y.getWidth(this._activeBuffer.x)===0&&!Y.hasContent(this._activeBuffer.x)&&Y.setCellFromCodePoint(this._activeBuffer.x,0,1,W.fg,W.bg,W.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(P,F){return P.final!=="t"||P.prefix||P.intermediates?this._parser.registerCsiHandler(P,F):this._parser.registerCsiHandler(P,j=>!$(j.params[0],this._optionsService.rawOptions.windowOptions)||F(j))}registerDcsHandler(P,F){return this._parser.registerDcsHandler(P,new l.DcsHandler(F))}registerEscHandler(P,F){return this._parser.registerEscHandler(P,F)}registerOscHandler(P,F){return this._parser.registerOscHandler(P,new R.OscHandler(F))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var P;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((P=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||P===void 0)&&P.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);F.hasWidth(this._activeBuffer.x)&&!F.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const P=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-P),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(P=this._bufferService.cols-1){this._activeBuffer.x=Math.min(P,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(P,F){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=P,this._activeBuffer.y=this._activeBuffer.scrollTop+F):(this._activeBuffer.x=P,this._activeBuffer.y=F),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(P,F){this._restrictCursor(),this._setCursor(this._activeBuffer.x+P,this._activeBuffer.y+F)}cursorUp(P){const F=this._activeBuffer.y-this._activeBuffer.scrollTop;return F>=0?this._moveCursor(0,-Math.min(F,P.params[0]||1)):this._moveCursor(0,-(P.params[0]||1)),!0}cursorDown(P){const F=this._activeBuffer.scrollBottom-this._activeBuffer.y;return F>=0?this._moveCursor(0,Math.min(F,P.params[0]||1)):this._moveCursor(0,P.params[0]||1),!0}cursorForward(P){return this._moveCursor(P.params[0]||1,0),!0}cursorBackward(P){return this._moveCursor(-(P.params[0]||1),0),!0}cursorNextLine(P){return this.cursorDown(P),this._activeBuffer.x=0,!0}cursorPrecedingLine(P){return this.cursorUp(P),this._activeBuffer.x=0,!0}cursorCharAbsolute(P){return this._setCursor((P.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(P){return this._setCursor(P.length>=2?(P.params[1]||1)-1:0,(P.params[0]||1)-1),!0}charPosAbsolute(P){return this._setCursor((P.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(P){return this._moveCursor(P.params[0]||1,0),!0}linePosAbsolute(P){return this._setCursor(this._activeBuffer.x,(P.params[0]||1)-1),!0}vPositionRelative(P){return this._moveCursor(0,P.params[0]||1),!0}hVPosition(P){return this.cursorPosition(P),!0}tabClear(P){const F=P.params[0];return F===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:F===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(P){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let F=P.params[0]||1;for(;F--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(P){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let F=P.params[0]||1;for(;F--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(P){const F=P.params[0];return F===1&&(this._curAttrData.bg|=536870912),F!==2&&F!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(P,F,j,q=!1,te=!1){const ge=this._activeBuffer.lines.get(this._activeBuffer.ybase+P);ge.replaceCells(F,j,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),te),q&&(ge.isWrapped=!1)}_resetBufferLine(P,F=!1){const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+P);j&&(j.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),F),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+P),j.isWrapped=!1)}eraseInDisplay(P,F=!1){let j;switch(this._restrictCursor(this._bufferService.cols),P.params[0]){case 0:for(j=this._activeBuffer.y,this._dirtyRowTracker.markDirty(j),this._eraseInBufferLine(j++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,F);j<this._bufferService.rows;j++)this._resetBufferLine(j,F);this._dirtyRowTracker.markDirty(j);break;case 1:for(j=this._activeBuffer.y,this._dirtyRowTracker.markDirty(j),this._eraseInBufferLine(j,0,this._activeBuffer.x+1,!0,F),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(j+1).isWrapped=!1);j--;)this._resetBufferLine(j,F);this._dirtyRowTracker.markDirty(0);break;case 2:for(j=this._bufferService.rows,this._dirtyRowTracker.markDirty(j-1);j--;)this._resetBufferLine(j,F);this._dirtyRowTracker.markDirty(0);break;case 3:const q=this._activeBuffer.lines.length-this._bufferService.rows;q>0&&(this._activeBuffer.lines.trimStart(q),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-q,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-q,0),this._onScroll.fire(0))}return!0}eraseInLine(P,F=!1){switch(this._restrictCursor(this._bufferService.cols),P.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,F);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,F);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,F)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(P){this._restrictCursor();let F=P.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const j=this._activeBuffer.ybase+this._activeBuffer.y,q=this._bufferService.rows-1-this._activeBuffer.scrollBottom,te=this._bufferService.rows-1+this._activeBuffer.ybase-q+1;for(;F--;)this._activeBuffer.lines.splice(te-1,1),this._activeBuffer.lines.splice(j,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(P){this._restrictCursor();let F=P.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const j=this._activeBuffer.ybase+this._activeBuffer.y;let q;for(q=this._bufferService.rows-1-this._activeBuffer.scrollBottom,q=this._bufferService.rows-1+this._activeBuffer.ybase-q;F--;)this._activeBuffer.lines.splice(j,1),this._activeBuffer.lines.splice(q,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(P){this._restrictCursor();const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return F&&(F.insertCells(this._activeBuffer.x,P.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(P){this._restrictCursor();const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return F&&(F.deleteCells(this._activeBuffer.x,P.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(P){let F=P.params[0]||1;for(;F--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(P){let F=P.params[0]||1;for(;F--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(h.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(P){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const F=P.params[0]||1;for(let j=this._activeBuffer.scrollTop;j<=this._activeBuffer.scrollBottom;++j){const q=this._activeBuffer.lines.get(this._activeBuffer.ybase+j);q.deleteCells(0,F,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),q.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(P){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const F=P.params[0]||1;for(let j=this._activeBuffer.scrollTop;j<=this._activeBuffer.scrollBottom;++j){const q=this._activeBuffer.lines.get(this._activeBuffer.ybase+j);q.insertCells(0,F,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),q.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(P){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const F=P.params[0]||1;for(let j=this._activeBuffer.scrollTop;j<=this._activeBuffer.scrollBottom;++j){const q=this._activeBuffer.lines.get(this._activeBuffer.ybase+j);q.insertCells(this._activeBuffer.x,F,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),q.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(P){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const F=P.params[0]||1;for(let j=this._activeBuffer.scrollTop;j<=this._activeBuffer.scrollBottom;++j){const q=this._activeBuffer.lines.get(this._activeBuffer.ybase+j);q.deleteCells(this._activeBuffer.x,F,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),q.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(P){this._restrictCursor();const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return F&&(F.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(P.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(P){if(!this._parser.precedingCodepoint)return!0;const F=P.params[0]||1,j=new Uint32Array(F);for(let q=0;q<F;++q)j[q]=this._parser.precedingCodepoint;return this.print(j,0,j.length),!0}sendDeviceAttributesPrimary(P){return P.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(_.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(_.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(P){return P.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(_.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(_.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(P.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(_.C0.ESC+"[>83;40003;0c")),!0}_is(P){return(this._optionsService.rawOptions.termName+"").indexOf(P)===0}setMode(P){for(let F=0;F<P.length;F++)switch(P.params[F]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(P){for(let F=0;F<P.length;F++)switch(P.params[F]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,v.DEFAULT_CHARSET),this._charsetService.setgCharset(1,v.DEFAULT_CHARSET),this._charsetService.setgCharset(2,v.DEFAULT_CHARSET),this._charsetService.setgCharset(3,v.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(P){for(let F=0;F<P.length;F++)switch(P.params[F]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(P){for(let F=0;F<P.length;F++)switch(P.params[F]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),P.params[F]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(P,F){const j=this._coreService.decPrivateModes,{activeProtocol:q,activeEncoding:te}=this._coreMouseService,ge=this._coreService,{buffers:me,cols:oe}=this._bufferService,{active:pe,alt:z}=me,W=this._optionsService.rawOptions,Y=de=>de?1:2,re=P.params[0];return ae=re,Oe=F?re===2?4:re===4?Y(ge.modes.insertMode):re===12?3:re===20?Y(W.convertEol):0:re===1?Y(j.applicationCursorKeys):re===3?W.windowOptions.setWinLines?oe===80?2:oe===132?1:0:0:re===6?Y(j.origin):re===7?Y(j.wraparound):re===8?3:re===9?Y(q==="X10"):re===12?Y(W.cursorBlink):re===25?Y(!ge.isCursorHidden):re===45?Y(j.reverseWraparound):re===66?Y(j.applicationKeypad):re===67?4:re===1e3?Y(q==="VT200"):re===1002?Y(q==="DRAG"):re===1003?Y(q==="ANY"):re===1004?Y(j.sendFocus):re===1005?4:re===1006?Y(te==="SGR"):re===1015?4:re===1016?Y(te==="SGR_PIXELS"):re===1048?1:re===47||re===1047||re===1049?Y(pe===z):re===2004?Y(j.bracketedPasteMode):0,ge.triggerDataEvent(`${_.C0.ESC}[${F?"":"?"}${ae};${Oe}$y`),!0;var ae,Oe}_updateAttrColor(P,F,j,q,te){return F===2?(P|=50331648,P&=-16777216,P|=T.AttributeData.fromColorRGB([j,q,te])):F===5&&(P&=-50331904,P|=33554432|255&j),P}_extractColor(P,F,j){const q=[0,0,-1,0,0,0];let te=0,ge=0;do{if(q[ge+te]=P.params[F+ge],P.hasSubParams(F+ge)){const me=P.getSubParams(F+ge);let oe=0;do q[1]===5&&(te=1),q[ge+oe+1+te]=me[oe];while(++oe<me.length&&oe+ge+1+te<q.length);break}if(q[1]===5&&ge+te>=2||q[1]===2&&ge+te>=5)break;q[1]&&(te=1)}while(++ge+F<P.length&&ge+te<q.length);for(let me=2;me<q.length;++me)q[me]===-1&&(q[me]=0);switch(q[0]){case 38:j.fg=this._updateAttrColor(j.fg,q[1],q[3],q[4],q[5]);break;case 48:j.bg=this._updateAttrColor(j.bg,q[1],q[3],q[4],q[5]);break;case 58:j.extended=j.extended.clone(),j.extended.underlineColor=this._updateAttrColor(j.extended.underlineColor,q[1],q[3],q[4],q[5])}return ge}_processUnderline(P,F){F.extended=F.extended.clone(),(!~P||P>5)&&(P=1),F.extended.underlineStyle=P,F.fg|=268435456,P===0&&(F.fg&=-268435457),F.updateExtended()}_processSGR0(P){P.fg=h.DEFAULT_ATTR_DATA.fg,P.bg=h.DEFAULT_ATTR_DATA.bg,P.extended=P.extended.clone(),P.extended.underlineStyle=0,P.extended.underlineColor&=-67108864,P.updateExtended()}charAttributes(P){if(P.length===1&&P.params[0]===0)return this._processSGR0(this._curAttrData),!0;const F=P.length;let j;const q=this._curAttrData;for(let te=0;te<F;te++)j=P.params[te],j>=30&&j<=37?(q.fg&=-50331904,q.fg|=16777216|j-30):j>=40&&j<=47?(q.bg&=-50331904,q.bg|=16777216|j-40):j>=90&&j<=97?(q.fg&=-50331904,q.fg|=16777224|j-90):j>=100&&j<=107?(q.bg&=-50331904,q.bg|=16777224|j-100):j===0?this._processSGR0(q):j===1?q.fg|=134217728:j===3?q.bg|=67108864:j===4?(q.fg|=268435456,this._processUnderline(P.hasSubParams(te)?P.getSubParams(te)[0]:1,q)):j===5?q.fg|=536870912:j===7?q.fg|=67108864:j===8?q.fg|=1073741824:j===9?q.fg|=2147483648:j===2?q.bg|=134217728:j===21?this._processUnderline(2,q):j===22?(q.fg&=-134217729,q.bg&=-134217729):j===23?q.bg&=-67108865:j===24?(q.fg&=-268435457,this._processUnderline(0,q)):j===25?q.fg&=-536870913:j===27?q.fg&=-67108865:j===28?q.fg&=-1073741825:j===29?q.fg&=2147483647:j===39?(q.fg&=-67108864,q.fg|=16777215&h.DEFAULT_ATTR_DATA.fg):j===49?(q.bg&=-67108864,q.bg|=16777215&h.DEFAULT_ATTR_DATA.bg):j===38||j===48||j===58?te+=this._extractColor(P,te,q):j===53?q.bg|=1073741824:j===55?q.bg&=-1073741825:j===59?(q.extended=q.extended.clone(),q.extended.underlineColor=-1,q.updateExtended()):j===100?(q.fg&=-67108864,q.fg|=16777215&h.DEFAULT_ATTR_DATA.fg,q.bg&=-67108864,q.bg|=16777215&h.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",j);return!0}deviceStatus(P){switch(P.params[0]){case 5:this._coreService.triggerDataEvent(`${_.C0.ESC}[0n`);break;case 6:const F=this._activeBuffer.y+1,j=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${_.C0.ESC}[${F};${j}R`)}return!0}deviceStatusPrivate(P){if(P.params[0]===6){const F=this._activeBuffer.y+1,j=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${_.C0.ESC}[?${F};${j}R`)}return!0}softReset(P){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=h.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(P){const F=P.params[0]||1;switch(F){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const j=F%2==1;return this._optionsService.options.cursorBlink=j,!0}setScrollRegion(P){const F=P.params[0]||1;let j;return(P.length<2||(j=P.params[1])>this._bufferService.rows||j===0)&&(j=this._bufferService.rows),j>F&&(this._activeBuffer.scrollTop=F-1,this._activeBuffer.scrollBottom=j-1,this._setCursor(0,0)),!0}windowOptions(P){if(!$(P.params[0],this._optionsService.rawOptions.windowOptions))return!0;const F=P.length>1?P.params[1]:0;switch(P.params[0]){case 14:F!==2&&this._onRequestWindowsOptionsReport.fire(B.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(B.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${_.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:F!==0&&F!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),F!==0&&F!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:F!==0&&F!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),F!==0&&F!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(P){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(P){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(P){return this._windowTitle=P,this._onTitleChange.fire(P),!0}setIconName(P){return this._iconName=P,!0}setOrReportIndexedColor(P){const F=[],j=P.split(";");for(;j.length>1;){const q=j.shift(),te=j.shift();if(/^\d+$/.exec(q)){const ge=parseInt(q);if(0<=ge&&ge<256)if(te==="?")F.push({type:0,index:ge});else{const me=(0,k.parseColor)(te);me&&F.push({type:1,index:ge,color:me})}}}return F.length&&this._onColor.fire(F),!0}setHyperlink(P){const F=P.split(";");return!(F.length<2)&&(F[1]?this._createHyperlink(F[0],F[1]):!F[0]&&this._finishHyperlink())}_createHyperlink(P,F){this._getCurrentLinkId()&&this._finishHyperlink();const j=P.split(":");let q;const te=j.findIndex(ge=>ge.startsWith("id="));return te!==-1&&(q=j[te].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:q,uri:F}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(P,F){const j=P.split(";");for(let q=0;q<j.length&&!(F>=this._specialColors.length);++q,++F)if(j[q]==="?")this._onColor.fire([{type:0,index:this._specialColors[F]}]);else{const te=(0,k.parseColor)(j[q]);te&&this._onColor.fire([{type:1,index:this._specialColors[F],color:te}])}return!0}setOrReportFgColor(P){return this._setOrReportSpecialColor(P,0)}setOrReportBgColor(P){return this._setOrReportSpecialColor(P,1)}setOrReportCursorColor(P){return this._setOrReportSpecialColor(P,2)}restoreIndexedColor(P){if(!P)return this._onColor.fire([{type:2}]),!0;const F=[],j=P.split(";");for(let q=0;q<j.length;++q)if(/^\d+$/.exec(j[q])){const te=parseInt(j[q]);0<=te&&te<256&&F.push({type:2,index:te})}return F.length&&this._onColor.fire(F),!0}restoreFgColor(P){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(P){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(P){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,v.DEFAULT_CHARSET),!0}selectCharset(P){return P.length!==2?(this.selectDefaultCharset(),!0):(P[0]==="/"||this._charsetService.setgCharset(x[P[0]],v.CHARSETS[P[1]]||v.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const P=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,P,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=h.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=h.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(P){return this._charsetService.setgLevel(P),!0}screenAlignmentPattern(){const P=new m.CellData;P.content=4194304|"E".charCodeAt(0),P.fg=this._curAttrData.fg,P.bg=this._curAttrData.bg,this._setCursor(0,0);for(let F=0;F<this._bufferService.rows;++F){const j=this._activeBuffer.ybase+this._activeBuffer.y+F,q=this._activeBuffer.lines.get(j);q&&(q.fill(P),q.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(P,F){const j=this._bufferService.buffer,q=this._optionsService.rawOptions;return(te=>(this._coreService.triggerDataEvent(`${_.C0.ESC}${te}${_.C0.ESC}\\`),!0))(P==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:P==='"p'?'P1$r61;1"p':P==="r"?`P1$r${j.scrollTop+1};${j.scrollBottom+1}r`:P==="m"?"P1$r0m":P===" q"?`P1$r${{block:2,underline:4,bar:6}[q.cursorStyle]-(q.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(P,F){this._dirtyRowTracker.markRangeDirty(P,F)}}s.InputHandler=ee;let ue=class{constructor(se){this._bufferService=se,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(se){se<this.start?this.start=se:se>this.end&&(this.end=se)}markRangeDirty(se,P){se>P&&(N=se,se=P,P=N),se<this.start&&(this.start=se),P>this.end&&(this.end=P)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};ue=c([d(0,w.IBufferService)],ue)},844:(y,s)=>{function o(c){for(const d of c)d.dispose();c.length=0}Object.defineProperty(s,"__esModule",{value:!0}),s.getDisposeArrayDisposable=s.disposeArray=s.toDisposable=s.Disposable=void 0,s.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const c of this._disposables)c.dispose();this._disposables.length=0}register(c){return this._disposables.push(c),c}unregister(c){const d=this._disposables.indexOf(c);d!==-1&&this._disposables.splice(d,1)}},s.toDisposable=function(c){return{dispose:c}},s.disposeArray=o,s.getDisposeArrayDisposable=function(c){return{dispose:()=>o(c)}}},1505:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.FourKeyMap=s.TwoKeyMap=void 0;class o{constructor(){this._data={}}set(d,_,v){this._data[d]||(this._data[d]={}),this._data[d][_]=v}get(d,_){return this._data[d]?this._data[d][_]:void 0}clear(){this._data={}}}s.TwoKeyMap=o,s.FourKeyMap=class{constructor(){this._data=new o}set(c,d,_,v,E){this._data.get(c,d)||this._data.set(c,d,new o),this._data.get(c,d).set(_,v,E)}get(c,d,_,v){var E;return(E=this._data.get(c,d))===null||E===void 0?void 0:E.get(_,v)}clear(){this._data.clear()}}},6114:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.isChromeOS=s.isLinux=s.isWindows=s.isIphone=s.isIpad=s.isMac=s.getSafariVersion=s.isSafari=s.isLegacyEdge=s.isFirefox=s.isNode=void 0,s.isNode=typeof navigator>"u";const o=s.isNode?"node":navigator.userAgent,c=s.isNode?"node":navigator.platform;s.isFirefox=o.includes("Firefox"),s.isLegacyEdge=o.includes("Edge"),s.isSafari=/^((?!chrome|android).)*safari/i.test(o),s.getSafariVersion=function(){if(!s.isSafari)return 0;const d=o.match(/Version\/(\d+)/);return d===null||d.length<2?0:parseInt(d[1])},s.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(c),s.isIpad=c==="iPad",s.isIphone=c==="iPhone",s.isWindows=["Windows","Win16","Win32","WinCE"].includes(c),s.isLinux=c.indexOf("Linux")>=0,s.isChromeOS=/\bCrOS\b/.test(o)},6106:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SortedList=void 0;let o=0;s.SortedList=class{constructor(c){this._getKey=c,this._array=[]}clear(){this._array.length=0}insert(c){this._array.length!==0?(o=this._search(this._getKey(c),0,this._array.length-1),this._array.splice(o,0,c)):this._array.push(c)}delete(c){if(this._array.length===0)return!1;const d=this._getKey(c);if(d===void 0||(o=this._search(d,0,this._array.length-1),o===-1)||this._getKey(this._array[o])!==d)return!1;do if(this._array[o]===c)return this._array.splice(o,1),!0;while(++o<this._array.length&&this._getKey(this._array[o])===d);return!1}*getKeyIterator(c){if(this._array.length!==0&&(o=this._search(c,0,this._array.length-1),!(o<0||o>=this._array.length)&&this._getKey(this._array[o])===c))do yield this._array[o];while(++o<this._array.length&&this._getKey(this._array[o])===c)}forEachByKey(c,d){if(this._array.length!==0&&(o=this._search(c,0,this._array.length-1),!(o<0||o>=this._array.length)&&this._getKey(this._array[o])===c))do d(this._array[o]);while(++o<this._array.length&&this._getKey(this._array[o])===c)}values(){return this._array.values()}_search(c,d,_){if(_<d)return d;let v=Math.floor((d+_)/2);const E=this._getKey(this._array[v]);if(E>c)return this._search(c,d,v-1);if(E<c)return this._search(c,v+1,_);for(;v>0&&this._getKey(this._array[v-1])===c;)v--;return v}}},7226:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DebouncedIdleTask=s.IdleTaskQueue=s.PriorityTaskQueue=void 0;const c=o(6114);class d{constructor(){this._tasks=[],this._i=0}enqueue(E){this._tasks.push(E),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(E){this._idleCallback=void 0;let C=0,S=0,h=E.timeRemaining(),p=0;for(;this._i<this._tasks.length;){if(C=Date.now(),this._tasks[this._i]()||this._i++,C=Math.max(1,Date.now()-C),S=Math.max(C,S),p=E.timeRemaining(),1.5*S>p)return h-C<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(h-C))}ms`),void this._start();h=p}this.clear()}}class _ extends d{_requestCallback(E){return setTimeout(()=>E(this._createDeadline(16)))}_cancelCallback(E){clearTimeout(E)}_createDeadline(E){const C=Date.now()+E;return{timeRemaining:()=>Math.max(0,C-Date.now())}}}s.PriorityTaskQueue=_,s.IdleTaskQueue=!c.isNode&&"requestIdleCallback"in window?class extends d{_requestCallback(v){return requestIdleCallback(v)}_cancelCallback(v){cancelIdleCallback(v)}}:_,s.DebouncedIdleTask=class{constructor(){this._queue=new s.IdleTaskQueue}set(v){this._queue.clear(),this._queue.enqueue(v)}flush(){this._queue.flush()}}},9282:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.updateWindowsModeWrappedState=void 0;const c=o(643);s.updateWindowsModeWrappedState=function(d){const _=d.buffer.lines.get(d.buffer.ybase+d.buffer.y-1),v=_==null?void 0:_.get(d.cols-1),E=d.buffer.lines.get(d.buffer.ybase+d.buffer.y);E&&v&&(E.isWrapped=v[c.CHAR_DATA_CODE_INDEX]!==c.NULL_CELL_CODE&&v[c.CHAR_DATA_CODE_INDEX]!==c.WHITESPACE_CELL_CODE)}},3734:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ExtendedAttrs=s.AttributeData=void 0;class o{constructor(){this.fg=0,this.bg=0,this.extended=new c}static toColorRGB(_){return[_>>>16&255,_>>>8&255,255&_]}static fromColorRGB(_){return(255&_[0])<<16|(255&_[1])<<8|255&_[2]}clone(){const _=new o;return _.fg=this.fg,_.bg=this.bg,_.extended=this.extended.clone(),_}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}s.AttributeData=o;class c{constructor(_=0,v=0){this._ext=0,this._urlId=0,this._ext=_,this._urlId=v}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(_){this._ext=_}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(_){this._ext&=-469762049,this._ext|=_<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(_){this._ext&=-67108864,this._ext|=67108863&_}get urlId(){return this._urlId}set urlId(_){this._urlId=_}clone(){return new c(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}s.ExtendedAttrs=c},9092:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Buffer=s.MAX_BUFFER_SIZE=void 0;const c=o(6349),d=o(8437),_=o(511),v=o(643),E=o(4634),C=o(4863),S=o(7116),h=o(3734),p=o(7226);s.MAX_BUFFER_SIZE=4294967295,s.Buffer=class{constructor(g,m,T){this._hasScrollback=g,this._optionsService=m,this._bufferService=T,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=d.DEFAULT_ATTR_DATA.clone(),this.savedCharset=S.DEFAULT_CHARSET,this.markers=[],this._nullCell=_.CellData.fromCharData([0,v.NULL_CELL_CHAR,v.NULL_CELL_WIDTH,v.NULL_CELL_CODE]),this._whitespaceCell=_.CellData.fromCharData([0,v.WHITESPACE_CELL_CHAR,v.WHITESPACE_CELL_WIDTH,v.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new p.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(g){return g?(this._nullCell.fg=g.fg,this._nullCell.bg=g.bg,this._nullCell.extended=g.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new h.ExtendedAttrs),this._nullCell}getWhitespaceCell(g){return g?(this._whitespaceCell.fg=g.fg,this._whitespaceCell.bg=g.bg,this._whitespaceCell.extended=g.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new h.ExtendedAttrs),this._whitespaceCell}getBlankLine(g,m){return new d.BufferLine(this._bufferService.cols,this.getNullCell(g),m)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const g=this.ybase+this.y-this.ydisp;return g>=0&&g<this._rows}_getCorrectBufferLength(g){if(!this._hasScrollback)return g;const m=g+this._optionsService.rawOptions.scrollback;return m>s.MAX_BUFFER_SIZE?s.MAX_BUFFER_SIZE:m}fillViewportRows(g){if(this.lines.length===0){g===void 0&&(g=d.DEFAULT_ATTR_DATA);let m=this._rows;for(;m--;)this.lines.push(this.getBlankLine(g))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(g,m){const T=this.getNullCell(d.DEFAULT_ATTR_DATA);let w=0;const R=this._getCorrectBufferLength(m);if(R>this.lines.maxLength&&(this.lines.maxLength=R),this.lines.length>0){if(this._cols<g)for(let k=0;k<this.lines.length;k++)w+=+this.lines.get(k).resize(g,T);let l=0;if(this._rows<m)for(let k=this._rows;k<m;k++)this.lines.length<m+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new d.BufferLine(g,T)):this.ybase>0&&this.lines.length<=this.ybase+this.y+l+1?(this.ybase--,l++,this.ydisp>0&&this.ydisp--):this.lines.push(new d.BufferLine(g,T)));else for(let k=this._rows;k>m;k--)this.lines.length>m+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(R<this.lines.maxLength){const k=this.lines.length-R;k>0&&(this.lines.trimStart(k),this.ybase=Math.max(this.ybase-k,0),this.ydisp=Math.max(this.ydisp-k,0),this.savedY=Math.max(this.savedY-k,0)),this.lines.maxLength=R}this.x=Math.min(this.x,g-1),this.y=Math.min(this.y,m-1),l&&(this.y+=l),this.savedX=Math.min(this.savedX,g-1),this.scrollTop=0}if(this.scrollBottom=m-1,this._isReflowEnabled&&(this._reflow(g,m),this._cols>g))for(let l=0;l<this.lines.length;l++)w+=+this.lines.get(l).resize(g,T);this._cols=g,this._rows=m,this._memoryCleanupQueue.clear(),w>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let g=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,g=!1);let m=0;for(;this._memoryCleanupPosition<this.lines.length;)if(m+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),m>100)return!0;return g}get _isReflowEnabled(){const g=this._optionsService.rawOptions.windowsPty;return g&&g.buildNumber?this._hasScrollback&&g.backend==="conpty"&&g.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(g,m){this._cols!==g&&(g>this._cols?this._reflowLarger(g,m):this._reflowSmaller(g,m))}_reflowLarger(g,m){const T=(0,E.reflowLargerGetLinesToRemove)(this.lines,this._cols,g,this.ybase+this.y,this.getNullCell(d.DEFAULT_ATTR_DATA));if(T.length>0){const w=(0,E.reflowLargerCreateNewLayout)(this.lines,T);(0,E.reflowLargerApplyNewLayout)(this.lines,w.layout),this._reflowLargerAdjustViewport(g,m,w.countRemoved)}}_reflowLargerAdjustViewport(g,m,T){const w=this.getNullCell(d.DEFAULT_ATTR_DATA);let R=T;for(;R-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<m&&this.lines.push(new d.BufferLine(g,w))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-T,0)}_reflowSmaller(g,m){const T=this.getNullCell(d.DEFAULT_ATTR_DATA),w=[];let R=0;for(let l=this.lines.length-1;l>=0;l--){let k=this.lines.get(l);if(!k||!k.isWrapped&&k.getTrimmedLength()<=g)continue;const x=[k];for(;k.isWrapped&&l>0;)k=this.lines.get(--l),x.unshift(k);const M=this.ybase+this.y;if(M>=l&&M<l+x.length)continue;const $=x[x.length-1].getTrimmedLength(),B=(0,E.reflowSmallerGetNewLineLengths)(x,this._cols,g),N=B.length-x.length;let ee;ee=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+N):Math.max(0,this.lines.length-this.lines.maxLength+N);const ue=[];for(let te=0;te<N;te++){const ge=this.getBlankLine(d.DEFAULT_ATTR_DATA,!0);ue.push(ge)}ue.length>0&&(w.push({start:l+x.length+R,newLines:ue}),R+=ue.length),x.push(...ue);let se=B.length-1,P=B[se];P===0&&(se--,P=B[se]);let F=x.length-N-1,j=$;for(;F>=0;){const te=Math.min(j,P);if(x[se]===void 0)break;if(x[se].copyCellsFrom(x[F],j-te,P-te,te,!0),P-=te,P===0&&(se--,P=B[se]),j-=te,j===0){F--;const ge=Math.max(F,0);j=(0,E.getWrappedLineTrimmedLength)(x,ge,this._cols)}}for(let te=0;te<x.length;te++)B[te]<g&&x[te].setCell(B[te],T);let q=N-ee;for(;q-- >0;)this.ybase===0?this.y<m-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+R)-m&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+N,this.ybase+m-1)}if(w.length>0){const l=[],k=[];for(let se=0;se<this.lines.length;se++)k.push(this.lines.get(se));const x=this.lines.length;let M=x-1,$=0,B=w[$];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+R);let N=0;for(let se=Math.min(this.lines.maxLength-1,x+R-1);se>=0;se--)if(B&&B.start>M+N){for(let P=B.newLines.length-1;P>=0;P--)this.lines.set(se--,B.newLines[P]);se++,l.push({index:M+1,amount:B.newLines.length}),N+=B.newLines.length,B=w[++$]}else this.lines.set(se,k[M--]);let ee=0;for(let se=l.length-1;se>=0;se--)l[se].index+=ee,this.lines.onInsertEmitter.fire(l[se]),ee+=l[se].amount;const ue=Math.max(0,x+R-this.lines.maxLength);ue>0&&this.lines.onTrimEmitter.fire(ue)}}translateBufferLineToString(g,m,T=0,w){const R=this.lines.get(g);return R?R.translateToString(m,T,w):""}getWrappedRangeForLine(g){let m=g,T=g;for(;m>0&&this.lines.get(m).isWrapped;)m--;for(;T+1<this.lines.length&&this.lines.get(T+1).isWrapped;)T++;return{first:m,last:T}}setupTabStops(g){for(g!=null?this.tabs[g]||(g=this.prevStop(g)):(this.tabs={},g=0);g<this._cols;g+=this._optionsService.rawOptions.tabStopWidth)this.tabs[g]=!0}prevStop(g){for(g==null&&(g=this.x);!this.tabs[--g]&&g>0;);return g>=this._cols?this._cols-1:g<0?0:g}nextStop(g){for(g==null&&(g=this.x);!this.tabs[++g]&&g<this._cols;);return g>=this._cols?this._cols-1:g<0?0:g}clearMarkers(g){this._isClearing=!0;for(let m=0;m<this.markers.length;m++)this.markers[m].line===g&&(this.markers[m].dispose(),this.markers.splice(m--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let g=0;g<this.markers.length;g++)this.markers[g].dispose(),this.markers.splice(g--,1);this._isClearing=!1}addMarker(g){const m=new C.Marker(g);return this.markers.push(m),m.register(this.lines.onTrim(T=>{m.line-=T,m.line<0&&m.dispose()})),m.register(this.lines.onInsert(T=>{m.line>=T.index&&(m.line+=T.amount)})),m.register(this.lines.onDelete(T=>{m.line>=T.index&&m.line<T.index+T.amount&&m.dispose(),m.line>T.index&&(m.line-=T.amount)})),m.register(m.onDispose(()=>this._removeMarker(m))),m}_removeMarker(g){this._isClearing||this.markers.splice(this.markers.indexOf(g),1)}}},8437:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferLine=s.DEFAULT_ATTR_DATA=void 0;const c=o(482),d=o(643),_=o(511),v=o(3734);s.DEFAULT_ATTR_DATA=Object.freeze(new v.AttributeData);let E=0;class C{constructor(h,p,g=!1){this.isWrapped=g,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*h);const m=p||_.CellData.fromCharData([0,d.NULL_CELL_CHAR,d.NULL_CELL_WIDTH,d.NULL_CELL_CODE]);for(let T=0;T<h;++T)this.setCell(T,m);this.length=h}get(h){const p=this._data[3*h+0],g=2097151&p;return[this._data[3*h+1],2097152&p?this._combined[h]:g?(0,c.stringFromCodePoint)(g):"",p>>22,2097152&p?this._combined[h].charCodeAt(this._combined[h].length-1):g]}set(h,p){this._data[3*h+1]=p[d.CHAR_DATA_ATTR_INDEX],p[d.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[h]=p[1],this._data[3*h+0]=2097152|h|p[d.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*h+0]=p[d.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|p[d.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(h){return this._data[3*h+0]>>22}hasWidth(h){return 12582912&this._data[3*h+0]}getFg(h){return this._data[3*h+1]}getBg(h){return this._data[3*h+2]}hasContent(h){return 4194303&this._data[3*h+0]}getCodePoint(h){const p=this._data[3*h+0];return 2097152&p?this._combined[h].charCodeAt(this._combined[h].length-1):2097151&p}isCombined(h){return 2097152&this._data[3*h+0]}getString(h){const p=this._data[3*h+0];return 2097152&p?this._combined[h]:2097151&p?(0,c.stringFromCodePoint)(2097151&p):""}isProtected(h){return 536870912&this._data[3*h+2]}loadCell(h,p){return E=3*h,p.content=this._data[E+0],p.fg=this._data[E+1],p.bg=this._data[E+2],2097152&p.content&&(p.combinedData=this._combined[h]),268435456&p.bg&&(p.extended=this._extendedAttrs[h]),p}setCell(h,p){2097152&p.content&&(this._combined[h]=p.combinedData),268435456&p.bg&&(this._extendedAttrs[h]=p.extended),this._data[3*h+0]=p.content,this._data[3*h+1]=p.fg,this._data[3*h+2]=p.bg}setCellFromCodePoint(h,p,g,m,T,w){268435456&T&&(this._extendedAttrs[h]=w),this._data[3*h+0]=p|g<<22,this._data[3*h+1]=m,this._data[3*h+2]=T}addCodepointToCell(h,p){let g=this._data[3*h+0];2097152&g?this._combined[h]+=(0,c.stringFromCodePoint)(p):(2097151&g?(this._combined[h]=(0,c.stringFromCodePoint)(2097151&g)+(0,c.stringFromCodePoint)(p),g&=-2097152,g|=2097152):g=p|4194304,this._data[3*h+0]=g)}insertCells(h,p,g,m){if((h%=this.length)&&this.getWidth(h-1)===2&&this.setCellFromCodePoint(h-1,0,1,(m==null?void 0:m.fg)||0,(m==null?void 0:m.bg)||0,(m==null?void 0:m.extended)||new v.ExtendedAttrs),p<this.length-h){const T=new _.CellData;for(let w=this.length-h-p-1;w>=0;--w)this.setCell(h+p+w,this.loadCell(h+w,T));for(let w=0;w<p;++w)this.setCell(h+w,g)}else for(let T=h;T<this.length;++T)this.setCell(T,g);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(m==null?void 0:m.fg)||0,(m==null?void 0:m.bg)||0,(m==null?void 0:m.extended)||new v.ExtendedAttrs)}deleteCells(h,p,g,m){if(h%=this.length,p<this.length-h){const T=new _.CellData;for(let w=0;w<this.length-h-p;++w)this.setCell(h+w,this.loadCell(h+p+w,T));for(let w=this.length-p;w<this.length;++w)this.setCell(w,g)}else for(let T=h;T<this.length;++T)this.setCell(T,g);h&&this.getWidth(h-1)===2&&this.setCellFromCodePoint(h-1,0,1,(m==null?void 0:m.fg)||0,(m==null?void 0:m.bg)||0,(m==null?void 0:m.extended)||new v.ExtendedAttrs),this.getWidth(h)!==0||this.hasContent(h)||this.setCellFromCodePoint(h,0,1,(m==null?void 0:m.fg)||0,(m==null?void 0:m.bg)||0,(m==null?void 0:m.extended)||new v.ExtendedAttrs)}replaceCells(h,p,g,m,T=!1){if(T)for(h&&this.getWidth(h-1)===2&&!this.isProtected(h-1)&&this.setCellFromCodePoint(h-1,0,1,(m==null?void 0:m.fg)||0,(m==null?void 0:m.bg)||0,(m==null?void 0:m.extended)||new v.ExtendedAttrs),p<this.length&&this.getWidth(p-1)===2&&!this.isProtected(p)&&this.setCellFromCodePoint(p,0,1,(m==null?void 0:m.fg)||0,(m==null?void 0:m.bg)||0,(m==null?void 0:m.extended)||new v.ExtendedAttrs);h<p&&h<this.length;)this.isProtected(h)||this.setCell(h,g),h++;else for(h&&this.getWidth(h-1)===2&&this.setCellFromCodePoint(h-1,0,1,(m==null?void 0:m.fg)||0,(m==null?void 0:m.bg)||0,(m==null?void 0:m.extended)||new v.ExtendedAttrs),p<this.length&&this.getWidth(p-1)===2&&this.setCellFromCodePoint(p,0,1,(m==null?void 0:m.fg)||0,(m==null?void 0:m.bg)||0,(m==null?void 0:m.extended)||new v.ExtendedAttrs);h<p&&h<this.length;)this.setCell(h++,g)}resize(h,p){if(h===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const g=3*h;if(h>this.length){if(this._data.buffer.byteLength>=4*g)this._data=new Uint32Array(this._data.buffer,0,g);else{const m=new Uint32Array(g);m.set(this._data),this._data=m}for(let m=this.length;m<h;++m)this.setCell(m,p)}else{this._data=this._data.subarray(0,g);const m=Object.keys(this._combined);for(let w=0;w<m.length;w++){const R=parseInt(m[w],10);R>=h&&delete this._combined[R]}const T=Object.keys(this._extendedAttrs);for(let w=0;w<T.length;w++){const R=parseInt(T[w],10);R>=h&&delete this._extendedAttrs[R]}}return this.length=h,4*g*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const h=new Uint32Array(this._data.length);return h.set(this._data),this._data=h,1}return 0}fill(h,p=!1){if(p)for(let g=0;g<this.length;++g)this.isProtected(g)||this.setCell(g,h);else{this._combined={},this._extendedAttrs={};for(let g=0;g<this.length;++g)this.setCell(g,h)}}copyFrom(h){this.length!==h.length?this._data=new Uint32Array(h._data):this._data.set(h._data),this.length=h.length,this._combined={};for(const p in h._combined)this._combined[p]=h._combined[p];this._extendedAttrs={};for(const p in h._extendedAttrs)this._extendedAttrs[p]=h._extendedAttrs[p];this.isWrapped=h.isWrapped}clone(){const h=new C(0);h._data=new Uint32Array(this._data),h.length=this.length;for(const p in this._combined)h._combined[p]=this._combined[p];for(const p in this._extendedAttrs)h._extendedAttrs[p]=this._extendedAttrs[p];return h.isWrapped=this.isWrapped,h}getTrimmedLength(){for(let h=this.length-1;h>=0;--h)if(4194303&this._data[3*h+0])return h+(this._data[3*h+0]>>22);return 0}copyCellsFrom(h,p,g,m,T){const w=h._data;if(T)for(let l=m-1;l>=0;l--){for(let k=0;k<3;k++)this._data[3*(g+l)+k]=w[3*(p+l)+k];268435456&w[3*(p+l)+2]&&(this._extendedAttrs[g+l]=h._extendedAttrs[p+l])}else for(let l=0;l<m;l++){for(let k=0;k<3;k++)this._data[3*(g+l)+k]=w[3*(p+l)+k];268435456&w[3*(p+l)+2]&&(this._extendedAttrs[g+l]=h._extendedAttrs[p+l])}const R=Object.keys(h._combined);for(let l=0;l<R.length;l++){const k=parseInt(R[l],10);k>=p&&(this._combined[k-p+g]=h._combined[k])}}translateToString(h=!1,p=0,g=this.length){h&&(g=Math.min(g,this.getTrimmedLength()));let m="";for(;p<g;){const T=this._data[3*p+0],w=2097151&T;m+=2097152&T?this._combined[p]:w?(0,c.stringFromCodePoint)(w):d.WHITESPACE_CELL_CHAR,p+=T>>22||1}return m}}s.BufferLine=C},4841:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.getRangeLength=void 0,s.getRangeLength=function(o,c){if(o.start.y>o.end.y)throw new Error(`Buffer range end (${o.end.x}, ${o.end.y}) cannot be before start (${o.start.x}, ${o.start.y})`);return c*(o.end.y-o.start.y)+(o.end.x-o.start.x+1)}},4634:(y,s)=>{function o(c,d,_){if(d===c.length-1)return c[d].getTrimmedLength();const v=!c[d].hasContent(_-1)&&c[d].getWidth(_-1)===1,E=c[d+1].getWidth(0)===2;return v&&E?_-1:_}Object.defineProperty(s,"__esModule",{value:!0}),s.getWrappedLineTrimmedLength=s.reflowSmallerGetNewLineLengths=s.reflowLargerApplyNewLayout=s.reflowLargerCreateNewLayout=s.reflowLargerGetLinesToRemove=void 0,s.reflowLargerGetLinesToRemove=function(c,d,_,v,E){const C=[];for(let S=0;S<c.length-1;S++){let h=S,p=c.get(++h);if(!p.isWrapped)continue;const g=[c.get(S)];for(;h<c.length&&p.isWrapped;)g.push(p),p=c.get(++h);if(v>=S&&v<h){S+=g.length-1;continue}let m=0,T=o(g,m,d),w=1,R=0;for(;w<g.length;){const k=o(g,w,d),x=k-R,M=_-T,$=Math.min(x,M);g[m].copyCellsFrom(g[w],R,T,$,!1),T+=$,T===_&&(m++,T=0),R+=$,R===k&&(w++,R=0),T===0&&m!==0&&g[m-1].getWidth(_-1)===2&&(g[m].copyCellsFrom(g[m-1],_-1,T++,1,!1),g[m-1].setCell(_-1,E))}g[m].replaceCells(T,_,E);let l=0;for(let k=g.length-1;k>0&&(k>m||g[k].getTrimmedLength()===0);k--)l++;l>0&&(C.push(S+g.length-l),C.push(l)),S+=g.length-1}return C},s.reflowLargerCreateNewLayout=function(c,d){const _=[];let v=0,E=d[v],C=0;for(let S=0;S<c.length;S++)if(E===S){const h=d[++v];c.onDeleteEmitter.fire({index:S-C,amount:h}),S+=h-1,C+=h,E=d[++v]}else _.push(S);return{layout:_,countRemoved:C}},s.reflowLargerApplyNewLayout=function(c,d){const _=[];for(let v=0;v<d.length;v++)_.push(c.get(d[v]));for(let v=0;v<_.length;v++)c.set(v,_[v]);c.length=d.length},s.reflowSmallerGetNewLineLengths=function(c,d,_){const v=[],E=c.map((p,g)=>o(c,g,d)).reduce((p,g)=>p+g);let C=0,S=0,h=0;for(;h<E;){if(E-h<_){v.push(E-h);break}C+=_;const p=o(c,S,d);C>p&&(C-=p,S++);const g=c[S].getWidth(C-1)===2;g&&C--;const m=g?_-1:_;v.push(m),h+=m}return v},s.getWrappedLineTrimmedLength=o},5295:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferSet=void 0;const c=o(9092),d=o(8460),_=o(844);class v extends _.Disposable{constructor(C,S){super(),this._optionsService=C,this._bufferService=S,this._onBufferActivate=this.register(new d.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new c.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new c.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(C){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(C),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(C,S){this._normal.resize(C,S),this._alt.resize(C,S),this.setupTabStops(C)}setupTabStops(C){this._normal.setupTabStops(C),this._alt.setupTabStops(C)}}s.BufferSet=v},511:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CellData=void 0;const c=o(482),d=o(643),_=o(3734);class v extends _.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new _.ExtendedAttrs,this.combinedData=""}static fromCharData(C){const S=new v;return S.setFromCharData(C),S}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,c.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(C){this.fg=C[d.CHAR_DATA_ATTR_INDEX],this.bg=0;let S=!1;if(C[d.CHAR_DATA_CHAR_INDEX].length>2)S=!0;else if(C[d.CHAR_DATA_CHAR_INDEX].length===2){const h=C[d.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=h&&h<=56319){const p=C[d.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=p&&p<=57343?this.content=1024*(h-55296)+p-56320+65536|C[d.CHAR_DATA_WIDTH_INDEX]<<22:S=!0}else S=!0}else this.content=C[d.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|C[d.CHAR_DATA_WIDTH_INDEX]<<22;S&&(this.combinedData=C[d.CHAR_DATA_CHAR_INDEX],this.content=2097152|C[d.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}s.CellData=v},643:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WHITESPACE_CELL_CODE=s.WHITESPACE_CELL_WIDTH=s.WHITESPACE_CELL_CHAR=s.NULL_CELL_CODE=s.NULL_CELL_WIDTH=s.NULL_CELL_CHAR=s.CHAR_DATA_CODE_INDEX=s.CHAR_DATA_WIDTH_INDEX=s.CHAR_DATA_CHAR_INDEX=s.CHAR_DATA_ATTR_INDEX=s.DEFAULT_EXT=s.DEFAULT_ATTR=s.DEFAULT_COLOR=void 0,s.DEFAULT_COLOR=0,s.DEFAULT_ATTR=256|s.DEFAULT_COLOR<<9,s.DEFAULT_EXT=0,s.CHAR_DATA_ATTR_INDEX=0,s.CHAR_DATA_CHAR_INDEX=1,s.CHAR_DATA_WIDTH_INDEX=2,s.CHAR_DATA_CODE_INDEX=3,s.NULL_CELL_CHAR="",s.NULL_CELL_WIDTH=1,s.NULL_CELL_CODE=0,s.WHITESPACE_CELL_CHAR=" ",s.WHITESPACE_CELL_WIDTH=1,s.WHITESPACE_CELL_CODE=32},4863:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Marker=void 0;const c=o(8460),d=o(844);class _{constructor(E){this.line=E,this.isDisposed=!1,this._disposables=[],this._id=_._nextId++,this._onDispose=this.register(new c.EventEmitter),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,d.disposeArray)(this._disposables),this._disposables.length=0)}register(E){return this._disposables.push(E),E}}s.Marker=_,_._nextId=1},7116:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DEFAULT_CHARSET=s.CHARSETS=void 0,s.CHARSETS={},s.DEFAULT_CHARSET=s.CHARSETS.B,s.CHARSETS[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""},s.CHARSETS.A={"#":""},s.CHARSETS.B=void 0,s.CHARSETS[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""},s.CHARSETS.C=s.CHARSETS[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},s.CHARSETS.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},s.CHARSETS.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS.E=s.CHARSETS[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""},s.CHARSETS.H=s.CHARSETS[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""}},2584:(y,s)=>{var o,c;Object.defineProperty(s,"__esModule",{value:!0}),s.C1_ESCAPED=s.C1=s.C0=void 0,function(d){d.NUL="\0",d.SOH="",d.STX="",d.ETX="",d.EOT="",d.ENQ="",d.ACK="",d.BEL="\x07",d.BS="\b",d.HT="	",d.LF=`
`,d.VT="\v",d.FF="\f",d.CR="\r",d.SO="",d.SI="",d.DLE="",d.DC1="",d.DC2="",d.DC3="",d.DC4="",d.NAK="",d.SYN="",d.ETB="",d.CAN="",d.EM="",d.SUB="",d.ESC="\x1B",d.FS="",d.GS="",d.RS="",d.US="",d.SP=" ",d.DEL=""}(o=s.C0||(s.C0={})),(c=s.C1||(s.C1={})).PAD="",c.HOP="",c.BPH="",c.NBH="",c.IND="",c.NEL="",c.SSA="",c.ESA="",c.HTS="",c.HTJ="",c.VTS="",c.PLD="",c.PLU="",c.RI="",c.SS2="",c.SS3="",c.DCS="",c.PU1="",c.PU2="",c.STS="",c.CCH="",c.MW="",c.SPA="",c.EPA="",c.SOS="",c.SGCI="",c.SCI="",c.CSI="",c.ST="",c.OSC="",c.PM="",c.APC="",(s.C1_ESCAPED||(s.C1_ESCAPED={})).ST=`${o.ESC}\\`},7399:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.evaluateKeyboardEvent=void 0;const c=o(2584),d={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};s.evaluateKeyboardEvent=function(_,v,E,C){const S={type:0,cancel:!1,key:void 0},h=(_.shiftKey?1:0)|(_.altKey?2:0)|(_.ctrlKey?4:0)|(_.metaKey?8:0);switch(_.keyCode){case 0:_.key==="UIKeyInputUpArrow"?S.key=v?c.C0.ESC+"OA":c.C0.ESC+"[A":_.key==="UIKeyInputLeftArrow"?S.key=v?c.C0.ESC+"OD":c.C0.ESC+"[D":_.key==="UIKeyInputRightArrow"?S.key=v?c.C0.ESC+"OC":c.C0.ESC+"[C":_.key==="UIKeyInputDownArrow"&&(S.key=v?c.C0.ESC+"OB":c.C0.ESC+"[B");break;case 8:if(_.altKey){S.key=c.C0.ESC+c.C0.DEL;break}S.key=c.C0.DEL;break;case 9:if(_.shiftKey){S.key=c.C0.ESC+"[Z";break}S.key=c.C0.HT,S.cancel=!0;break;case 13:S.key=_.altKey?c.C0.ESC+c.C0.CR:c.C0.CR,S.cancel=!0;break;case 27:S.key=c.C0.ESC,_.altKey&&(S.key=c.C0.ESC+c.C0.ESC),S.cancel=!0;break;case 37:if(_.metaKey)break;h?(S.key=c.C0.ESC+"[1;"+(h+1)+"D",S.key===c.C0.ESC+"[1;3D"&&(S.key=c.C0.ESC+(E?"b":"[1;5D"))):S.key=v?c.C0.ESC+"OD":c.C0.ESC+"[D";break;case 39:if(_.metaKey)break;h?(S.key=c.C0.ESC+"[1;"+(h+1)+"C",S.key===c.C0.ESC+"[1;3C"&&(S.key=c.C0.ESC+(E?"f":"[1;5C"))):S.key=v?c.C0.ESC+"OC":c.C0.ESC+"[C";break;case 38:if(_.metaKey)break;h?(S.key=c.C0.ESC+"[1;"+(h+1)+"A",E||S.key!==c.C0.ESC+"[1;3A"||(S.key=c.C0.ESC+"[1;5A")):S.key=v?c.C0.ESC+"OA":c.C0.ESC+"[A";break;case 40:if(_.metaKey)break;h?(S.key=c.C0.ESC+"[1;"+(h+1)+"B",E||S.key!==c.C0.ESC+"[1;3B"||(S.key=c.C0.ESC+"[1;5B")):S.key=v?c.C0.ESC+"OB":c.C0.ESC+"[B";break;case 45:_.shiftKey||_.ctrlKey||(S.key=c.C0.ESC+"[2~");break;case 46:S.key=h?c.C0.ESC+"[3;"+(h+1)+"~":c.C0.ESC+"[3~";break;case 36:S.key=h?c.C0.ESC+"[1;"+(h+1)+"H":v?c.C0.ESC+"OH":c.C0.ESC+"[H";break;case 35:S.key=h?c.C0.ESC+"[1;"+(h+1)+"F":v?c.C0.ESC+"OF":c.C0.ESC+"[F";break;case 33:_.shiftKey?S.type=2:_.ctrlKey?S.key=c.C0.ESC+"[5;"+(h+1)+"~":S.key=c.C0.ESC+"[5~";break;case 34:_.shiftKey?S.type=3:_.ctrlKey?S.key=c.C0.ESC+"[6;"+(h+1)+"~":S.key=c.C0.ESC+"[6~";break;case 112:S.key=h?c.C0.ESC+"[1;"+(h+1)+"P":c.C0.ESC+"OP";break;case 113:S.key=h?c.C0.ESC+"[1;"+(h+1)+"Q":c.C0.ESC+"OQ";break;case 114:S.key=h?c.C0.ESC+"[1;"+(h+1)+"R":c.C0.ESC+"OR";break;case 115:S.key=h?c.C0.ESC+"[1;"+(h+1)+"S":c.C0.ESC+"OS";break;case 116:S.key=h?c.C0.ESC+"[15;"+(h+1)+"~":c.C0.ESC+"[15~";break;case 117:S.key=h?c.C0.ESC+"[17;"+(h+1)+"~":c.C0.ESC+"[17~";break;case 118:S.key=h?c.C0.ESC+"[18;"+(h+1)+"~":c.C0.ESC+"[18~";break;case 119:S.key=h?c.C0.ESC+"[19;"+(h+1)+"~":c.C0.ESC+"[19~";break;case 120:S.key=h?c.C0.ESC+"[20;"+(h+1)+"~":c.C0.ESC+"[20~";break;case 121:S.key=h?c.C0.ESC+"[21;"+(h+1)+"~":c.C0.ESC+"[21~";break;case 122:S.key=h?c.C0.ESC+"[23;"+(h+1)+"~":c.C0.ESC+"[23~";break;case 123:S.key=h?c.C0.ESC+"[24;"+(h+1)+"~":c.C0.ESC+"[24~";break;default:if(!_.ctrlKey||_.shiftKey||_.altKey||_.metaKey)if(E&&!C||!_.altKey||_.metaKey)!E||_.altKey||_.ctrlKey||_.shiftKey||!_.metaKey?_.key&&!_.ctrlKey&&!_.altKey&&!_.metaKey&&_.keyCode>=48&&_.key.length===1?S.key=_.key:_.key&&_.ctrlKey&&(_.key==="_"&&(S.key=c.C0.US),_.key==="@"&&(S.key=c.C0.NUL)):_.keyCode===65&&(S.type=1);else{const p=d[_.keyCode],g=p==null?void 0:p[_.shiftKey?1:0];if(g)S.key=c.C0.ESC+g;else if(_.keyCode>=65&&_.keyCode<=90){const m=_.ctrlKey?_.keyCode-64:_.keyCode+32;let T=String.fromCharCode(m);_.shiftKey&&(T=T.toUpperCase()),S.key=c.C0.ESC+T}else if(_.keyCode===32)S.key=c.C0.ESC+(_.ctrlKey?c.C0.NUL:" ");else if(_.key==="Dead"&&_.code.startsWith("Key")){let m=_.code.slice(3,4);_.shiftKey||(m=m.toLowerCase()),S.key=c.C0.ESC+m,S.cancel=!0}}else _.keyCode>=65&&_.keyCode<=90?S.key=String.fromCharCode(_.keyCode-64):_.keyCode===32?S.key=c.C0.NUL:_.keyCode>=51&&_.keyCode<=55?S.key=String.fromCharCode(_.keyCode-51+27):_.keyCode===56?S.key=c.C0.DEL:_.keyCode===219?S.key=c.C0.ESC:_.keyCode===220?S.key=c.C0.FS:_.keyCode===221&&(S.key=c.C0.GS)}return S}},482:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Utf8ToUtf32=s.StringToUtf32=s.utf32ToString=s.stringFromCodePoint=void 0,s.stringFromCodePoint=function(o){return o>65535?(o-=65536,String.fromCharCode(55296+(o>>10))+String.fromCharCode(o%1024+56320)):String.fromCharCode(o)},s.utf32ToString=function(o,c=0,d=o.length){let _="";for(let v=c;v<d;++v){let E=o[v];E>65535?(E-=65536,_+=String.fromCharCode(55296+(E>>10))+String.fromCharCode(E%1024+56320)):_+=String.fromCharCode(E)}return _},s.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(o,c){const d=o.length;if(!d)return 0;let _=0,v=0;if(this._interim){const E=o.charCodeAt(v++);56320<=E&&E<=57343?c[_++]=1024*(this._interim-55296)+E-56320+65536:(c[_++]=this._interim,c[_++]=E),this._interim=0}for(let E=v;E<d;++E){const C=o.charCodeAt(E);if(55296<=C&&C<=56319){if(++E>=d)return this._interim=C,_;const S=o.charCodeAt(E);56320<=S&&S<=57343?c[_++]=1024*(C-55296)+S-56320+65536:(c[_++]=C,c[_++]=S)}else C!==65279&&(c[_++]=C)}return _}},s.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(o,c){const d=o.length;if(!d)return 0;let _,v,E,C,S=0,h=0,p=0;if(this.interim[0]){let T=!1,w=this.interim[0];w&=(224&w)==192?31:(240&w)==224?15:7;let R,l=0;for(;(R=63&this.interim[++l])&&l<4;)w<<=6,w|=R;const k=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,x=k-l;for(;p<x;){if(p>=d)return 0;if(R=o[p++],(192&R)!=128){p--,T=!0;break}this.interim[l++]=R,w<<=6,w|=63&R}T||(k===2?w<128?p--:c[S++]=w:k===3?w<2048||w>=55296&&w<=57343||w===65279||(c[S++]=w):w<65536||w>1114111||(c[S++]=w)),this.interim.fill(0)}const g=d-4;let m=p;for(;m<d;){for(;!(!(m<g)||128&(_=o[m])||128&(v=o[m+1])||128&(E=o[m+2])||128&(C=o[m+3]));)c[S++]=_,c[S++]=v,c[S++]=E,c[S++]=C,m+=4;if(_=o[m++],_<128)c[S++]=_;else if((224&_)==192){if(m>=d)return this.interim[0]=_,S;if(v=o[m++],(192&v)!=128){m--;continue}if(h=(31&_)<<6|63&v,h<128){m--;continue}c[S++]=h}else if((240&_)==224){if(m>=d)return this.interim[0]=_,S;if(v=o[m++],(192&v)!=128){m--;continue}if(m>=d)return this.interim[0]=_,this.interim[1]=v,S;if(E=o[m++],(192&E)!=128){m--;continue}if(h=(15&_)<<12|(63&v)<<6|63&E,h<2048||h>=55296&&h<=57343||h===65279)continue;c[S++]=h}else if((248&_)==240){if(m>=d)return this.interim[0]=_,S;if(v=o[m++],(192&v)!=128){m--;continue}if(m>=d)return this.interim[0]=_,this.interim[1]=v,S;if(E=o[m++],(192&E)!=128){m--;continue}if(m>=d)return this.interim[0]=_,this.interim[1]=v,this.interim[2]=E,S;if(C=o[m++],(192&C)!=128){m--;continue}if(h=(7&_)<<18|(63&v)<<12|(63&E)<<6|63&C,h<65536||h>1114111)continue;c[S++]=h}}return S}}},225:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeV6=void 0;const o=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],c=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let d;s.UnicodeV6=class{constructor(){if(this.version="6",!d){d=new Uint8Array(65536),d.fill(1),d[0]=0,d.fill(0,1,32),d.fill(0,127,160),d.fill(2,4352,4448),d[9001]=2,d[9002]=2,d.fill(2,11904,42192),d[12351]=1,d.fill(2,44032,55204),d.fill(2,63744,64256),d.fill(2,65040,65050),d.fill(2,65072,65136),d.fill(2,65280,65377),d.fill(2,65504,65511);for(let _=0;_<o.length;++_)d.fill(0,o[_][0],o[_][1]+1)}}wcwidth(_){return _<32?0:_<127?1:_<65536?d[_]:function(v,E){let C,S=0,h=E.length-1;if(v<E[0][0]||v>E[h][1])return!1;for(;h>=S;)if(C=S+h>>1,v>E[C][1])S=C+1;else{if(!(v<E[C][0]))return!0;h=C-1}return!1}(_,c)?0:_>=131072&&_<=196605||_>=196608&&_<=262141?2:1}}},5981:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WriteBuffer=void 0;const c=o(8460),d=o(844);class _ extends d.Disposable{constructor(E){super(),this._action=E,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new c.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(E,C){if(C!==void 0&&this._syncCalls>C)return void(this._syncCalls=0);if(this._pendingData+=E.length,this._writeBuffer.push(E),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let S;for(this._isSyncWriting=!0;S=this._writeBuffer.shift();){this._action(S);const h=this._callbacks.shift();h&&h()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(E,C){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=E.length,this._writeBuffer.push(E),this._callbacks.push(C),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=E.length,this._writeBuffer.push(E),this._callbacks.push(C)}_innerWrite(E=0,C=!0){const S=E||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const h=this._writeBuffer[this._bufferOffset],p=this._action(h,C);if(p){const m=T=>Date.now()-S>=12?setTimeout(()=>this._innerWrite(0,T)):this._innerWrite(S,T);return void p.catch(T=>(queueMicrotask(()=>{throw T}),Promise.resolve(!1))).then(m)}const g=this._callbacks[this._bufferOffset];if(g&&g(),this._bufferOffset++,this._pendingData-=h.length,Date.now()-S>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}s.WriteBuffer=_},5941:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.toRgbString=s.parseColor=void 0;const o=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,c=/^[\da-f]+$/;function d(_,v){const E=_.toString(16),C=E.length<2?"0"+E:E;switch(v){case 4:return E[0];case 8:return C;case 12:return(C+C).slice(0,3);default:return C+C}}s.parseColor=function(_){if(!_)return;let v=_.toLowerCase();if(v.indexOf("rgb:")===0){v=v.slice(4);const E=o.exec(v);if(E){const C=E[1]?15:E[4]?255:E[7]?4095:65535;return[Math.round(parseInt(E[1]||E[4]||E[7]||E[10],16)/C*255),Math.round(parseInt(E[2]||E[5]||E[8]||E[11],16)/C*255),Math.round(parseInt(E[3]||E[6]||E[9]||E[12],16)/C*255)]}}else if(v.indexOf("#")===0&&(v=v.slice(1),c.exec(v)&&[3,6,9,12].includes(v.length))){const E=v.length/3,C=[0,0,0];for(let S=0;S<3;++S){const h=parseInt(v.slice(E*S,E*S+E),16);C[S]=E===1?h<<4:E===2?h:E===3?h>>4:h>>8}return C}},s.toRgbString=function(_,v=16){const[E,C,S]=_;return`rgb:${d(E,v)}/${d(C,v)}/${d(S,v)}`}},5770:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PAYLOAD_LIMIT=void 0,s.PAYLOAD_LIMIT=1e7},6351:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DcsHandler=s.DcsParser=void 0;const c=o(482),d=o(8742),_=o(5770),v=[];s.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=v,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=v}registerHandler(C,S){this._handlers[C]===void 0&&(this._handlers[C]=[]);const h=this._handlers[C];return h.push(S),{dispose:()=>{const p=h.indexOf(S);p!==-1&&h.splice(p,1)}}}clearHandler(C){this._handlers[C]&&delete this._handlers[C]}setHandlerFallback(C){this._handlerFb=C}reset(){if(this._active.length)for(let C=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;C>=0;--C)this._active[C].unhook(!1);this._stack.paused=!1,this._active=v,this._ident=0}hook(C,S){if(this.reset(),this._ident=C,this._active=this._handlers[C]||v,this._active.length)for(let h=this._active.length-1;h>=0;h--)this._active[h].hook(S);else this._handlerFb(this._ident,"HOOK",S)}put(C,S,h){if(this._active.length)for(let p=this._active.length-1;p>=0;p--)this._active[p].put(C,S,h);else this._handlerFb(this._ident,"PUT",(0,c.utf32ToString)(C,S,h))}unhook(C,S=!0){if(this._active.length){let h=!1,p=this._active.length-1,g=!1;if(this._stack.paused&&(p=this._stack.loopPosition-1,h=S,g=this._stack.fallThrough,this._stack.paused=!1),!g&&h===!1){for(;p>=0&&(h=this._active[p].unhook(C),h!==!0);p--)if(h instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=p,this._stack.fallThrough=!1,h;p--}for(;p>=0;p--)if(h=this._active[p].unhook(!1),h instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=p,this._stack.fallThrough=!0,h}else this._handlerFb(this._ident,"UNHOOK",C);this._active=v,this._ident=0}};const E=new d.Params;E.addParam(0),s.DcsHandler=class{constructor(C){this._handler=C,this._data="",this._params=E,this._hitLimit=!1}hook(C){this._params=C.length>1||C.params[0]?C.clone():E,this._data="",this._hitLimit=!1}put(C,S,h){this._hitLimit||(this._data+=(0,c.utf32ToString)(C,S,h),this._data.length>_.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(C){let S=!1;if(this._hitLimit)S=!1;else if(C&&(S=this._handler(this._data,this._params),S instanceof Promise))return S.then(h=>(this._params=E,this._data="",this._hitLimit=!1,h));return this._params=E,this._data="",this._hitLimit=!1,S}}},2015:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.EscapeSequenceParser=s.VT500_TRANSITION_TABLE=s.TransitionTable=void 0;const c=o(844),d=o(8742),_=o(6242),v=o(6351);class E{constructor(p){this.table=new Uint8Array(p)}setDefault(p,g){this.table.fill(p<<4|g)}add(p,g,m,T){this.table[g<<8|p]=m<<4|T}addMany(p,g,m,T){for(let w=0;w<p.length;w++)this.table[g<<8|p[w]]=m<<4|T}}s.TransitionTable=E;const C=160;s.VT500_TRANSITION_TABLE=function(){const h=new E(4095),p=Array.apply(null,Array(256)).map((l,k)=>k),g=(l,k)=>p.slice(l,k),m=g(32,127),T=g(0,24);T.push(25),T.push.apply(T,g(28,32));const w=g(0,14);let R;for(R in h.setDefault(1,0),h.addMany(m,0,2,0),w)h.addMany([24,26,153,154],R,3,0),h.addMany(g(128,144),R,3,0),h.addMany(g(144,152),R,3,0),h.add(156,R,0,0),h.add(27,R,11,1),h.add(157,R,4,8),h.addMany([152,158,159],R,0,7),h.add(155,R,11,3),h.add(144,R,11,9);return h.addMany(T,0,3,0),h.addMany(T,1,3,1),h.add(127,1,0,1),h.addMany(T,8,0,8),h.addMany(T,3,3,3),h.add(127,3,0,3),h.addMany(T,4,3,4),h.add(127,4,0,4),h.addMany(T,6,3,6),h.addMany(T,5,3,5),h.add(127,5,0,5),h.addMany(T,2,3,2),h.add(127,2,0,2),h.add(93,1,4,8),h.addMany(m,8,5,8),h.add(127,8,5,8),h.addMany([156,27,24,26,7],8,6,0),h.addMany(g(28,32),8,0,8),h.addMany([88,94,95],1,0,7),h.addMany(m,7,0,7),h.addMany(T,7,0,7),h.add(156,7,0,0),h.add(127,7,0,7),h.add(91,1,11,3),h.addMany(g(64,127),3,7,0),h.addMany(g(48,60),3,8,4),h.addMany([60,61,62,63],3,9,4),h.addMany(g(48,60),4,8,4),h.addMany(g(64,127),4,7,0),h.addMany([60,61,62,63],4,0,6),h.addMany(g(32,64),6,0,6),h.add(127,6,0,6),h.addMany(g(64,127),6,0,0),h.addMany(g(32,48),3,9,5),h.addMany(g(32,48),5,9,5),h.addMany(g(48,64),5,0,6),h.addMany(g(64,127),5,7,0),h.addMany(g(32,48),4,9,5),h.addMany(g(32,48),1,9,2),h.addMany(g(32,48),2,9,2),h.addMany(g(48,127),2,10,0),h.addMany(g(48,80),1,10,0),h.addMany(g(81,88),1,10,0),h.addMany([89,90,92],1,10,0),h.addMany(g(96,127),1,10,0),h.add(80,1,11,9),h.addMany(T,9,0,9),h.add(127,9,0,9),h.addMany(g(28,32),9,0,9),h.addMany(g(32,48),9,9,12),h.addMany(g(48,60),9,8,10),h.addMany([60,61,62,63],9,9,10),h.addMany(T,11,0,11),h.addMany(g(32,128),11,0,11),h.addMany(g(28,32),11,0,11),h.addMany(T,10,0,10),h.add(127,10,0,10),h.addMany(g(28,32),10,0,10),h.addMany(g(48,60),10,8,10),h.addMany([60,61,62,63],10,0,11),h.addMany(g(32,48),10,9,12),h.addMany(T,12,0,12),h.add(127,12,0,12),h.addMany(g(28,32),12,0,12),h.addMany(g(32,48),12,9,12),h.addMany(g(48,64),12,0,11),h.addMany(g(64,127),12,12,13),h.addMany(g(64,127),10,12,13),h.addMany(g(64,127),9,12,13),h.addMany(T,13,13,13),h.addMany(m,13,13,13),h.add(127,13,0,13),h.addMany([27,156,24,26],13,14,0),h.add(C,0,2,0),h.add(C,8,5,8),h.add(C,6,0,6),h.add(C,11,0,11),h.add(C,13,13,13),h}();class S extends c.Disposable{constructor(p=s.VT500_TRANSITION_TABLE){super(),this._transitions=p,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new d.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(g,m,T)=>{},this._executeHandlerFb=g=>{},this._csiHandlerFb=(g,m)=>{},this._escHandlerFb=g=>{},this._errorHandlerFb=g=>g,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,c.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new _.OscParser),this._dcsParser=this.register(new v.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(p,g=[64,126]){let m=0;if(p.prefix){if(p.prefix.length>1)throw new Error("only one byte as prefix supported");if(m=p.prefix.charCodeAt(0),m&&60>m||m>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(p.intermediates){if(p.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let w=0;w<p.intermediates.length;++w){const R=p.intermediates.charCodeAt(w);if(32>R||R>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");m<<=8,m|=R}}if(p.final.length!==1)throw new Error("final must be a single byte");const T=p.final.charCodeAt(0);if(g[0]>T||T>g[1])throw new Error(`final must be in range ${g[0]} .. ${g[1]}`);return m<<=8,m|=T,m}identToString(p){const g=[];for(;p;)g.push(String.fromCharCode(255&p)),p>>=8;return g.reverse().join("")}setPrintHandler(p){this._printHandler=p}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(p,g){const m=this._identifier(p,[48,126]);this._escHandlers[m]===void 0&&(this._escHandlers[m]=[]);const T=this._escHandlers[m];return T.push(g),{dispose:()=>{const w=T.indexOf(g);w!==-1&&T.splice(w,1)}}}clearEscHandler(p){this._escHandlers[this._identifier(p,[48,126])]&&delete this._escHandlers[this._identifier(p,[48,126])]}setEscHandlerFallback(p){this._escHandlerFb=p}setExecuteHandler(p,g){this._executeHandlers[p.charCodeAt(0)]=g}clearExecuteHandler(p){this._executeHandlers[p.charCodeAt(0)]&&delete this._executeHandlers[p.charCodeAt(0)]}setExecuteHandlerFallback(p){this._executeHandlerFb=p}registerCsiHandler(p,g){const m=this._identifier(p);this._csiHandlers[m]===void 0&&(this._csiHandlers[m]=[]);const T=this._csiHandlers[m];return T.push(g),{dispose:()=>{const w=T.indexOf(g);w!==-1&&T.splice(w,1)}}}clearCsiHandler(p){this._csiHandlers[this._identifier(p)]&&delete this._csiHandlers[this._identifier(p)]}setCsiHandlerFallback(p){this._csiHandlerFb=p}registerDcsHandler(p,g){return this._dcsParser.registerHandler(this._identifier(p),g)}clearDcsHandler(p){this._dcsParser.clearHandler(this._identifier(p))}setDcsHandlerFallback(p){this._dcsParser.setHandlerFallback(p)}registerOscHandler(p,g){return this._oscParser.registerHandler(p,g)}clearOscHandler(p){this._oscParser.clearHandler(p)}setOscHandlerFallback(p){this._oscParser.setHandlerFallback(p)}setErrorHandler(p){this._errorHandler=p}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(p,g,m,T,w){this._parseStack.state=p,this._parseStack.handlers=g,this._parseStack.handlerPos=m,this._parseStack.transition=T,this._parseStack.chunkPos=w}parse(p,g,m){let T,w=0,R=0,l=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,l=this._parseStack.chunkPos+1;else{if(m===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const k=this._parseStack.handlers;let x=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(m===!1&&x>-1){for(;x>=0&&(T=k[x](this._params),T!==!0);x--)if(T instanceof Promise)return this._parseStack.handlerPos=x,T}this._parseStack.handlers=[];break;case 4:if(m===!1&&x>-1){for(;x>=0&&(T=k[x](),T!==!0);x--)if(T instanceof Promise)return this._parseStack.handlerPos=x,T}this._parseStack.handlers=[];break;case 6:if(w=p[this._parseStack.chunkPos],T=this._dcsParser.unhook(w!==24&&w!==26,m),T)return T;w===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(w=p[this._parseStack.chunkPos],T=this._oscParser.end(w!==24&&w!==26,m),T)return T;w===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,l=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let k=l;k<g;++k){switch(w=p[k],R=this._transitions.table[this.currentState<<8|(w<160?w:C)],R>>4){case 2:for(let N=k+1;;++N){if(N>=g||(w=p[N])<32||w>126&&w<C){this._printHandler(p,k,N),k=N-1;break}if(++N>=g||(w=p[N])<32||w>126&&w<C){this._printHandler(p,k,N),k=N-1;break}if(++N>=g||(w=p[N])<32||w>126&&w<C){this._printHandler(p,k,N),k=N-1;break}if(++N>=g||(w=p[N])<32||w>126&&w<C){this._printHandler(p,k,N),k=N-1;break}}break;case 3:this._executeHandlers[w]?this._executeHandlers[w]():this._executeHandlerFb(w),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:k,code:w,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const x=this._csiHandlers[this._collect<<8|w];let M=x?x.length-1:-1;for(;M>=0&&(T=x[M](this._params),T!==!0);M--)if(T instanceof Promise)return this._preserveStack(3,x,M,R,k),T;M<0&&this._csiHandlerFb(this._collect<<8|w,this._params),this.precedingCodepoint=0;break;case 8:do switch(w){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(w-48)}while(++k<g&&(w=p[k])>47&&w<60);k--;break;case 9:this._collect<<=8,this._collect|=w;break;case 10:const $=this._escHandlers[this._collect<<8|w];let B=$?$.length-1:-1;for(;B>=0&&(T=$[B](),T!==!0);B--)if(T instanceof Promise)return this._preserveStack(4,$,B,R,k),T;B<0&&this._escHandlerFb(this._collect<<8|w),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|w,this._params);break;case 13:for(let N=k+1;;++N)if(N>=g||(w=p[N])===24||w===26||w===27||w>127&&w<C){this._dcsParser.put(p,k,N),k=N-1;break}break;case 14:if(T=this._dcsParser.unhook(w!==24&&w!==26),T)return this._preserveStack(6,[],0,R,k),T;w===27&&(R|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let N=k+1;;N++)if(N>=g||(w=p[N])<32||w>127&&w<C){this._oscParser.put(p,k,N),k=N-1;break}break;case 6:if(T=this._oscParser.end(w!==24&&w!==26),T)return this._preserveStack(5,[],0,R,k),T;w===27&&(R|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&R}}}s.EscapeSequenceParser=S},6242:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.OscHandler=s.OscParser=void 0;const c=o(5770),d=o(482),_=[];s.OscParser=class{constructor(){this._state=0,this._active=_,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(v,E){this._handlers[v]===void 0&&(this._handlers[v]=[]);const C=this._handlers[v];return C.push(E),{dispose:()=>{const S=C.indexOf(E);S!==-1&&C.splice(S,1)}}}clearHandler(v){this._handlers[v]&&delete this._handlers[v]}setHandlerFallback(v){this._handlerFb=v}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=_}reset(){if(this._state===2)for(let v=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;v>=0;--v)this._active[v].end(!1);this._stack.paused=!1,this._active=_,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||_,this._active.length)for(let v=this._active.length-1;v>=0;v--)this._active[v].start();else this._handlerFb(this._id,"START")}_put(v,E,C){if(this._active.length)for(let S=this._active.length-1;S>=0;S--)this._active[S].put(v,E,C);else this._handlerFb(this._id,"PUT",(0,d.utf32ToString)(v,E,C))}start(){this.reset(),this._state=1}put(v,E,C){if(this._state!==3){if(this._state===1)for(;E<C;){const S=v[E++];if(S===59){this._state=2,this._start();break}if(S<48||57<S)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+S-48}this._state===2&&C-E>0&&this._put(v,E,C)}}end(v,E=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let C=!1,S=this._active.length-1,h=!1;if(this._stack.paused&&(S=this._stack.loopPosition-1,C=E,h=this._stack.fallThrough,this._stack.paused=!1),!h&&C===!1){for(;S>=0&&(C=this._active[S].end(v),C!==!0);S--)if(C instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=S,this._stack.fallThrough=!1,C;S--}for(;S>=0;S--)if(C=this._active[S].end(!1),C instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=S,this._stack.fallThrough=!0,C}else this._handlerFb(this._id,"END",v);this._active=_,this._id=-1,this._state=0}}},s.OscHandler=class{constructor(v){this._handler=v,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(v,E,C){this._hitLimit||(this._data+=(0,d.utf32ToString)(v,E,C),this._data.length>c.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(v){let E=!1;if(this._hitLimit)E=!1;else if(v&&(E=this._handler(this._data),E instanceof Promise))return E.then(C=>(this._data="",this._hitLimit=!1,C));return this._data="",this._hitLimit=!1,E}}},8742:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Params=void 0;const o=2147483647;class c{constructor(_=32,v=32){if(this.maxLength=_,this.maxSubParamsLength=v,v>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(_),this.length=0,this._subParams=new Int32Array(v),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(_),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(_){const v=new c;if(!_.length)return v;for(let E=Array.isArray(_[0])?1:0;E<_.length;++E){const C=_[E];if(Array.isArray(C))for(let S=0;S<C.length;++S)v.addSubParam(C[S]);else v.addParam(C)}return v}clone(){const _=new c(this.maxLength,this.maxSubParamsLength);return _.params.set(this.params),_.length=this.length,_._subParams.set(this._subParams),_._subParamsLength=this._subParamsLength,_._subParamsIdx.set(this._subParamsIdx),_._rejectDigits=this._rejectDigits,_._rejectSubDigits=this._rejectSubDigits,_._digitIsSub=this._digitIsSub,_}toArray(){const _=[];for(let v=0;v<this.length;++v){_.push(this.params[v]);const E=this._subParamsIdx[v]>>8,C=255&this._subParamsIdx[v];C-E>0&&_.push(Array.prototype.slice.call(this._subParams,E,C))}return _}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(_){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(_<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=_>o?o:_}}addSubParam(_){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(_<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=_>o?o:_,this._subParamsIdx[this.length-1]++}}hasSubParams(_){return(255&this._subParamsIdx[_])-(this._subParamsIdx[_]>>8)>0}getSubParams(_){const v=this._subParamsIdx[_]>>8,E=255&this._subParamsIdx[_];return E-v>0?this._subParams.subarray(v,E):null}getSubParamsAll(){const _={};for(let v=0;v<this.length;++v){const E=this._subParamsIdx[v]>>8,C=255&this._subParamsIdx[v];C-E>0&&(_[v]=this._subParams.slice(E,C))}return _}addDigit(_){let v;if(this._rejectDigits||!(v=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const E=this._digitIsSub?this._subParams:this.params,C=E[v-1];E[v-1]=~C?Math.min(10*C+_,o):_}}s.Params=c},5741:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.AddonManager=void 0,s.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let o=this._addons.length-1;o>=0;o--)this._addons[o].instance.dispose()}loadAddon(o,c){const d={instance:c,dispose:c.dispose,isDisposed:!1};this._addons.push(d),c.dispose=()=>this._wrappedAddonDispose(d),c.activate(o)}_wrappedAddonDispose(o){if(o.isDisposed)return;let c=-1;for(let d=0;d<this._addons.length;d++)if(this._addons[d]===o){c=d;break}if(c===-1)throw new Error("Could not dispose an addon that has not been loaded");o.isDisposed=!0,o.dispose.apply(o.instance),this._addons.splice(c,1)}}},8771:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferApiView=void 0;const c=o(3785),d=o(511);s.BufferApiView=class{constructor(_,v){this._buffer=_,this.type=v}init(_){return this._buffer=_,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(_){const v=this._buffer.lines.get(_);if(v)return new c.BufferLineApiView(v)}getNullCell(){return new d.CellData}}},3785:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferLineApiView=void 0;const c=o(511);s.BufferLineApiView=class{constructor(d){this._line=d}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(d,_){if(!(d<0||d>=this._line.length))return _?(this._line.loadCell(d,_),_):this._line.loadCell(d,new c.CellData)}translateToString(d,_,v){return this._line.translateToString(d,_,v)}}},8285:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferNamespaceApi=void 0;const c=o(8771),d=o(8460);s.BufferNamespaceApi=class{constructor(_){this._core=_,this._onBufferChange=new d.EventEmitter,this.onBufferChange=this._onBufferChange.event,this._normal=new c.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new c.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}},7975:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ParserApi=void 0,s.ParserApi=class{constructor(o){this._core=o}registerCsiHandler(o,c){return this._core.registerCsiHandler(o,d=>c(d.toArray()))}addCsiHandler(o,c){return this.registerCsiHandler(o,c)}registerDcsHandler(o,c){return this._core.registerDcsHandler(o,(d,_)=>c(d,_.toArray()))}addDcsHandler(o,c){return this.registerDcsHandler(o,c)}registerEscHandler(o,c){return this._core.registerEscHandler(o,c)}addEscHandler(o,c){return this.registerEscHandler(o,c)}registerOscHandler(o,c){return this._core.registerOscHandler(o,c)}addOscHandler(o,c){return this.registerOscHandler(o,c)}}},7090:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeApi=void 0,s.UnicodeApi=class{constructor(o){this._core=o}register(o){this._core.unicodeService.register(o)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(o){this._core.unicodeService.activeVersion=o}}},744:function(y,s,o){var c=this&&this.__decorate||function(h,p,g,m){var T,w=arguments.length,R=w<3?p:m===null?m=Object.getOwnPropertyDescriptor(p,g):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(h,p,g,m);else for(var l=h.length-1;l>=0;l--)(T=h[l])&&(R=(w<3?T(R):w>3?T(p,g,R):T(p,g))||R);return w>3&&R&&Object.defineProperty(p,g,R),R},d=this&&this.__param||function(h,p){return function(g,m){p(g,m,h)}};Object.defineProperty(s,"__esModule",{value:!0}),s.BufferService=s.MINIMUM_ROWS=s.MINIMUM_COLS=void 0;const _=o(2585),v=o(5295),E=o(8460),C=o(844);s.MINIMUM_COLS=2,s.MINIMUM_ROWS=1;let S=class extends C.Disposable{constructor(h){super(),this.isUserScrolling=!1,this._onResize=this.register(new E.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new E.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(h.rawOptions.cols||0,s.MINIMUM_COLS),this.rows=Math.max(h.rawOptions.rows||0,s.MINIMUM_ROWS),this.buffers=this.register(new v.BufferSet(h,this))}get buffer(){return this.buffers.active}resize(h,p){this.cols=h,this.rows=p,this.buffers.resize(h,p),this._onResize.fire({cols:h,rows:p})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(h,p=!1){const g=this.buffer;let m;m=this._cachedBlankLine,m&&m.length===this.cols&&m.getFg(0)===h.fg&&m.getBg(0)===h.bg||(m=g.getBlankLine(h,p),this._cachedBlankLine=m),m.isWrapped=p;const T=g.ybase+g.scrollTop,w=g.ybase+g.scrollBottom;if(g.scrollTop===0){const R=g.lines.isFull;w===g.lines.length-1?R?g.lines.recycle().copyFrom(m):g.lines.push(m.clone()):g.lines.splice(w+1,0,m.clone()),R?this.isUserScrolling&&(g.ydisp=Math.max(g.ydisp-1,0)):(g.ybase++,this.isUserScrolling||g.ydisp++)}else{const R=w-T+1;g.lines.shiftElements(T+1,R-1,-1),g.lines.set(w,m.clone())}this.isUserScrolling||(g.ydisp=g.ybase),this._onScroll.fire(g.ydisp)}scrollLines(h,p,g){const m=this.buffer;if(h<0){if(m.ydisp===0)return;this.isUserScrolling=!0}else h+m.ydisp>=m.ybase&&(this.isUserScrolling=!1);const T=m.ydisp;m.ydisp=Math.max(Math.min(m.ydisp+h,m.ybase),0),T!==m.ydisp&&(p||this._onScroll.fire(m.ydisp))}scrollPages(h){this.scrollLines(h*(this.rows-1))}scrollToTop(){this.scrollLines(-this.buffer.ydisp)}scrollToBottom(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)}scrollToLine(h){const p=h-this.buffer.ydisp;p!==0&&this.scrollLines(p)}};S=c([d(0,_.IOptionsService)],S),s.BufferService=S},7994:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CharsetService=void 0,s.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(o){this.glevel=o,this.charset=this._charsets[o]}setgCharset(o,c){this._charsets[o]=c,this.glevel===o&&(this.charset=c)}}},1753:function(y,s,o){var c=this&&this.__decorate||function(m,T,w,R){var l,k=arguments.length,x=k<3?T:R===null?R=Object.getOwnPropertyDescriptor(T,w):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(m,T,w,R);else for(var M=m.length-1;M>=0;M--)(l=m[M])&&(x=(k<3?l(x):k>3?l(T,w,x):l(T,w))||x);return k>3&&x&&Object.defineProperty(T,w,x),x},d=this&&this.__param||function(m,T){return function(w,R){T(w,R,m)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CoreMouseService=void 0;const _=o(2585),v=o(8460),E=o(844),C={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:m=>m.button!==4&&m.action===1&&(m.ctrl=!1,m.alt=!1,m.shift=!1,!0)},VT200:{events:19,restrict:m=>m.action!==32},DRAG:{events:23,restrict:m=>m.action!==32||m.button!==3},ANY:{events:31,restrict:m=>!0}};function S(m,T){let w=(m.ctrl?16:0)|(m.shift?4:0)|(m.alt?8:0);return m.button===4?(w|=64,w|=m.action):(w|=3&m.button,4&m.button&&(w|=64),8&m.button&&(w|=128),m.action===32?w|=32:m.action!==0||T||(w|=3)),w}const h=String.fromCharCode,p={DEFAULT:m=>{const T=[S(m,!1)+32,m.col+32,m.row+32];return T[0]>255||T[1]>255||T[2]>255?"":`\x1B[M${h(T[0])}${h(T[1])}${h(T[2])}`},SGR:m=>{const T=m.action===0&&m.button!==4?"m":"M";return`\x1B[<${S(m,!0)};${m.col};${m.row}${T}`},SGR_PIXELS:m=>{const T=m.action===0&&m.button!==4?"m":"M";return`\x1B[<${S(m,!0)};${m.x};${m.y}${T}`}};let g=class extends E.Disposable{constructor(m,T){super(),this._bufferService=m,this._coreService=T,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new v.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const w of Object.keys(C))this.addProtocol(w,C[w]);for(const w of Object.keys(p))this.addEncoding(w,p[w]);this.reset()}addProtocol(m,T){this._protocols[m]=T}addEncoding(m,T){this._encodings[m]=T}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(m){if(!this._protocols[m])throw new Error(`unknown protocol "${m}"`);this._activeProtocol=m,this._onProtocolChange.fire(this._protocols[m].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(m){if(!this._encodings[m])throw new Error(`unknown encoding "${m}"`);this._activeEncoding=m}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(m){if(m.col<0||m.col>=this._bufferService.cols||m.row<0||m.row>=this._bufferService.rows||m.button===4&&m.action===32||m.button===3&&m.action!==32||m.button!==4&&(m.action===2||m.action===3)||(m.col++,m.row++,m.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,m,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(m))return!1;const T=this._encodings[this._activeEncoding](m);return T&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(T):this._coreService.triggerDataEvent(T,!0)),this._lastEvent=m,!0}explainEvents(m){return{down:!!(1&m),up:!!(2&m),drag:!!(4&m),move:!!(8&m),wheel:!!(16&m)}}_equalEvents(m,T,w){if(w){if(m.x!==T.x||m.y!==T.y)return!1}else if(m.col!==T.col||m.row!==T.row)return!1;return m.button===T.button&&m.action===T.action&&m.ctrl===T.ctrl&&m.alt===T.alt&&m.shift===T.shift}};g=c([d(0,_.IBufferService),d(1,_.ICoreService)],g),s.CoreMouseService=g},6975:function(y,s,o){var c=this&&this.__decorate||function(g,m,T,w){var R,l=arguments.length,k=l<3?m:w===null?w=Object.getOwnPropertyDescriptor(m,T):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(g,m,T,w);else for(var x=g.length-1;x>=0;x--)(R=g[x])&&(k=(l<3?R(k):l>3?R(m,T,k):R(m,T))||k);return l>3&&k&&Object.defineProperty(m,T,k),k},d=this&&this.__param||function(g,m){return function(T,w){m(T,w,g)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CoreService=void 0;const _=o(2585),v=o(8460),E=o(1439),C=o(844),S=Object.freeze({insertMode:!1}),h=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let p=class extends C.Disposable{constructor(g,m,T){super(),this._bufferService=g,this._logService=m,this._optionsService=T,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new v.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new v.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new v.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new v.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,E.clone)(S),this.decPrivateModes=(0,E.clone)(h)}reset(){this.modes=(0,E.clone)(S),this.decPrivateModes=(0,E.clone)(h)}triggerDataEvent(g,m=!1){if(this._optionsService.rawOptions.disableStdin)return;const T=this._bufferService.buffer;m&&this._optionsService.rawOptions.scrollOnUserInput&&T.ybase!==T.ydisp&&this._onRequestScrollToBottom.fire(),m&&this._onUserInput.fire(),this._logService.debug(`sending data "${g}"`,()=>g.split("").map(w=>w.charCodeAt(0))),this._onData.fire(g)}triggerBinaryEvent(g){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${g}"`,()=>g.split("").map(m=>m.charCodeAt(0))),this._onBinary.fire(g))}};p=c([d(0,_.IBufferService),d(1,_.ILogService),d(2,_.IOptionsService)],p),s.CoreService=p},9074:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DecorationService=void 0;const c=o(8055),d=o(8460),_=o(844),v=o(6106);let E=0,C=0;class S extends _.Disposable{constructor(){super(),this._decorations=new v.SortedList(g=>g==null?void 0:g.marker.line),this._onDecorationRegistered=this.register(new d.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new d.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,_.toDisposable)(()=>{for(const g of this._decorations.values())this._onDecorationRemoved.fire(g);this.reset()}))}get decorations(){return this._decorations.values()}registerDecoration(g){if(g.marker.isDisposed)return;const m=new h(g);if(m){const T=m.marker.onDispose(()=>m.dispose());m.onDispose(()=>{m&&(this._decorations.delete(m)&&this._onDecorationRemoved.fire(m),T.dispose())}),this._decorations.insert(m),this._onDecorationRegistered.fire(m)}return m}reset(){for(const g of this._decorations.values())g.dispose();this._decorations.clear()}*getDecorationsAtCell(g,m,T){var w,R,l;let k=0,x=0;for(const M of this._decorations.getKeyIterator(m))k=(w=M.options.x)!==null&&w!==void 0?w:0,x=k+((R=M.options.width)!==null&&R!==void 0?R:1),g>=k&&g<x&&(!T||((l=M.options.layer)!==null&&l!==void 0?l:"bottom")===T)&&(yield M)}forEachDecorationAtCell(g,m,T,w){this._decorations.forEachByKey(m,R=>{var l,k,x;E=(l=R.options.x)!==null&&l!==void 0?l:0,C=E+((k=R.options.width)!==null&&k!==void 0?k:1),g>=E&&g<C&&(!T||((x=R.options.layer)!==null&&x!==void 0?x:"bottom")===T)&&w(R)})}dispose(){for(const g of this._decorations.values())this._onDecorationRemoved.fire(g);this.reset()}}s.DecorationService=S;class h extends _.Disposable{constructor(g){super(),this.options=g,this.onRenderEmitter=this.register(new d.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new d.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=g.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=c.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=c.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.InstantiationService=s.ServiceCollection=void 0;const c=o(2585),d=o(8343);class _{constructor(...E){this._entries=new Map;for(const[C,S]of E)this.set(C,S)}set(E,C){const S=this._entries.get(E);return this._entries.set(E,C),S}forEach(E){for(const[C,S]of this._entries.entries())E(C,S)}has(E){return this._entries.has(E)}get(E){return this._entries.get(E)}}s.ServiceCollection=_,s.InstantiationService=class{constructor(){this._services=new _,this._services.set(c.IInstantiationService,this)}setService(v,E){this._services.set(v,E)}getService(v){return this._services.get(v)}createInstance(v,...E){const C=(0,d.getServiceDependencies)(v).sort((p,g)=>p.index-g.index),S=[];for(const p of C){const g=this._services.get(p.id);if(!g)throw new Error(`[createInstance] ${v.name} depends on UNKNOWN service ${p.id}.`);S.push(g)}const h=C.length>0?C[0].index:E.length;if(E.length!==h)throw new Error(`[createInstance] First service dependency of ${v.name} at position ${h+1} conflicts with ${E.length} static arguments`);return new v(...E,...S)}}},7866:function(y,s,o){var c=this&&this.__decorate||function(S,h,p,g){var m,T=arguments.length,w=T<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,p):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(S,h,p,g);else for(var R=S.length-1;R>=0;R--)(m=S[R])&&(w=(T<3?m(w):T>3?m(h,p,w):m(h,p))||w);return T>3&&w&&Object.defineProperty(h,p,w),w},d=this&&this.__param||function(S,h){return function(p,g){h(p,g,S)}};Object.defineProperty(s,"__esModule",{value:!0}),s.LogService=void 0;const _=o(844),v=o(2585),E={debug:v.LogLevelEnum.DEBUG,info:v.LogLevelEnum.INFO,warn:v.LogLevelEnum.WARN,error:v.LogLevelEnum.ERROR,off:v.LogLevelEnum.OFF};let C=class extends _.Disposable{constructor(S){super(),this._optionsService=S,this.logLevel=v.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}_updateLogLevel(){this.logLevel=E[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(S){for(let h=0;h<S.length;h++)typeof S[h]=="function"&&(S[h]=S[h]())}_log(S,h,p){this._evalLazyOptionalParams(p),S.call(console,"xterm.js: "+h,...p)}debug(S,...h){this.logLevel<=v.LogLevelEnum.DEBUG&&this._log(console.log,S,h)}info(S,...h){this.logLevel<=v.LogLevelEnum.INFO&&this._log(console.info,S,h)}warn(S,...h){this.logLevel<=v.LogLevelEnum.WARN&&this._log(console.warn,S,h)}error(S,...h){this.logLevel<=v.LogLevelEnum.ERROR&&this._log(console.error,S,h)}};C=c([d(0,v.IOptionsService)],C),s.LogService=C},7302:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.OptionsService=s.DEFAULT_OPTIONS=void 0;const c=o(8460),d=o(6114),_=o(844);s.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:d.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const v=["normal","bold","100","200","300","400","500","600","700","800","900"];class E extends _.Disposable{constructor(S){super(),this._onOptionChange=this.register(new c.EventEmitter),this.onOptionChange=this._onOptionChange.event;const h=Object.assign({},s.DEFAULT_OPTIONS);for(const p in S)if(p in h)try{const g=S[p];h[p]=this._sanitizeAndValidateOption(p,g)}catch(g){console.error(g)}this.rawOptions=h,this.options=Object.assign({},h),this._setupOptions()}onSpecificOptionChange(S,h){return this.onOptionChange(p=>{p===S&&h(this.rawOptions[S])})}onMultipleOptionChange(S,h){return this.onOptionChange(p=>{S.indexOf(p)!==-1&&h()})}_setupOptions(){const S=p=>{if(!(p in s.DEFAULT_OPTIONS))throw new Error(`No option with key "${p}"`);return this.rawOptions[p]},h=(p,g)=>{if(!(p in s.DEFAULT_OPTIONS))throw new Error(`No option with key "${p}"`);g=this._sanitizeAndValidateOption(p,g),this.rawOptions[p]!==g&&(this.rawOptions[p]=g,this._onOptionChange.fire(p))};for(const p in this.rawOptions){const g={get:S.bind(this,p),set:h.bind(this,p)};Object.defineProperty(this.options,p,g)}}_sanitizeAndValidateOption(S,h){switch(S){case"cursorStyle":if(h||(h=s.DEFAULT_OPTIONS[S]),!function(p){return p==="block"||p==="underline"||p==="bar"}(h))throw new Error(`"${h}" is not a valid value for ${S}`);break;case"wordSeparator":h||(h=s.DEFAULT_OPTIONS[S]);break;case"fontWeight":case"fontWeightBold":if(typeof h=="number"&&1<=h&&h<=1e3)break;h=v.includes(h)?h:s.DEFAULT_OPTIONS[S];break;case"cursorWidth":h=Math.floor(h);case"lineHeight":case"tabStopWidth":if(h<1)throw new Error(`${S} cannot be less than 1, value: ${h}`);break;case"minimumContrastRatio":h=Math.max(1,Math.min(21,Math.round(10*h)/10));break;case"scrollback":if((h=Math.min(h,4294967295))<0)throw new Error(`${S} cannot be less than 0, value: ${h}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(h<=0)throw new Error(`${S} cannot be less than or equal to 0, value: ${h}`);break;case"rows":case"cols":if(!h&&h!==0)throw new Error(`${S} must be numeric, value: ${h}`);break;case"windowsPty":h=h??{}}return h}}s.OptionsService=E},2660:function(y,s,o){var c=this&&this.__decorate||function(E,C,S,h){var p,g=arguments.length,m=g<3?C:h===null?h=Object.getOwnPropertyDescriptor(C,S):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(E,C,S,h);else for(var T=E.length-1;T>=0;T--)(p=E[T])&&(m=(g<3?p(m):g>3?p(C,S,m):p(C,S))||m);return g>3&&m&&Object.defineProperty(C,S,m),m},d=this&&this.__param||function(E,C){return function(S,h){C(S,h,E)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OscLinkService=void 0;const _=o(2585);let v=class{constructor(E){this._bufferService=E,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(E){const C=this._bufferService.buffer;if(E.id===void 0){const T=C.addMarker(C.ybase+C.y),w={data:E,id:this._nextId++,lines:[T]};return T.onDispose(()=>this._removeMarkerFromLink(w,T)),this._dataByLinkId.set(w.id,w),w.id}const S=E,h=this._getEntryIdKey(S),p=this._entriesWithId.get(h);if(p)return this.addLineToLink(p.id,C.ybase+C.y),p.id;const g=C.addMarker(C.ybase+C.y),m={id:this._nextId++,key:this._getEntryIdKey(S),data:S,lines:[g]};return g.onDispose(()=>this._removeMarkerFromLink(m,g)),this._entriesWithId.set(m.key,m),this._dataByLinkId.set(m.id,m),m.id}addLineToLink(E,C){const S=this._dataByLinkId.get(E);if(S&&S.lines.every(h=>h.line!==C)){const h=this._bufferService.buffer.addMarker(C);S.lines.push(h),h.onDispose(()=>this._removeMarkerFromLink(S,h))}}getLinkData(E){var C;return(C=this._dataByLinkId.get(E))===null||C===void 0?void 0:C.data}_getEntryIdKey(E){return`${E.id};;${E.uri}`}_removeMarkerFromLink(E,C){const S=E.lines.indexOf(C);S!==-1&&(E.lines.splice(S,1),E.lines.length===0&&(E.data.id!==void 0&&this._entriesWithId.delete(E.key),this._dataByLinkId.delete(E.id)))}};v=c([d(0,_.IBufferService)],v),s.OscLinkService=v},8343:(y,s)=>{function o(c,d,_){d.di$target===d?d.di$dependencies.push({id:c,index:_}):(d.di$dependencies=[{id:c,index:_}],d.di$target=d)}Object.defineProperty(s,"__esModule",{value:!0}),s.createDecorator=s.getServiceDependencies=s.serviceRegistry=void 0,s.serviceRegistry=new Map,s.getServiceDependencies=function(c){return c.di$dependencies||[]},s.createDecorator=function(c){if(s.serviceRegistry.has(c))return s.serviceRegistry.get(c);const d=function(_,v,E){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");o(d,_,E)};return d.toString=()=>c,s.serviceRegistry.set(c,d),d}},2585:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.IDecorationService=s.IUnicodeService=s.IOscLinkService=s.IOptionsService=s.ILogService=s.LogLevelEnum=s.IInstantiationService=s.ICharsetService=s.ICoreService=s.ICoreMouseService=s.IBufferService=void 0;const c=o(8343);var d;s.IBufferService=(0,c.createDecorator)("BufferService"),s.ICoreMouseService=(0,c.createDecorator)("CoreMouseService"),s.ICoreService=(0,c.createDecorator)("CoreService"),s.ICharsetService=(0,c.createDecorator)("CharsetService"),s.IInstantiationService=(0,c.createDecorator)("InstantiationService"),(d=s.LogLevelEnum||(s.LogLevelEnum={}))[d.DEBUG=0]="DEBUG",d[d.INFO=1]="INFO",d[d.WARN=2]="WARN",d[d.ERROR=3]="ERROR",d[d.OFF=4]="OFF",s.ILogService=(0,c.createDecorator)("LogService"),s.IOptionsService=(0,c.createDecorator)("OptionsService"),s.IOscLinkService=(0,c.createDecorator)("OscLinkService"),s.IUnicodeService=(0,c.createDecorator)("UnicodeService"),s.IDecorationService=(0,c.createDecorator)("DecorationService")},1480:(y,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeService=void 0;const c=o(8460),d=o(225);s.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new c.EventEmitter,this.onChange=this._onChange.event;const _=new d.UnicodeV6;this.register(_),this._active=_.version,this._activeProvider=_}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(_){if(!this._providers[_])throw new Error(`unknown Unicode version "${_}"`);this._active=_,this._activeProvider=this._providers[_],this._onChange.fire(_)}register(_){this._providers[_.version]=_}wcwidth(_){return this._activeProvider.wcwidth(_)}getStringCellWidth(_){let v=0;const E=_.length;for(let C=0;C<E;++C){let S=_.charCodeAt(C);if(55296<=S&&S<=56319){if(++C>=E)return v+this.wcwidth(S);const h=_.charCodeAt(C);56320<=h&&h<=57343?S=1024*(S-55296)+h-56320+65536:v+=this.wcwidth(h)}v+=this.wcwidth(S)}return v}}}},i={};function a(y){var s=i[y];if(s!==void 0)return s.exports;var o=i[y]={exports:{}};return r[y].call(o.exports,o,o.exports,a),o.exports}var f={};return(()=>{var y=f;Object.defineProperty(y,"__esModule",{value:!0}),y.Terminal=void 0;const s=a(3236),o=a(9042),c=a(7975),d=a(7090),_=a(5741),v=a(8285),E=["cols","rows"];y.Terminal=class{constructor(C){this._core=new s.Terminal(C),this._addonManager=new _.AddonManager,this._publicOptions=Object.assign({},this._core.options);const S=p=>this._core.options[p],h=(p,g)=>{this._checkReadonlyOptions(p),this._core.options[p]=g};for(const p in this._core.options){const g={get:S.bind(this,p),set:h.bind(this,p)};Object.defineProperty(this._publicOptions,p,g)}}_checkReadonlyOptions(C){if(E.includes(C))throw new Error(`Option "${C}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new c.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new d.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=new v.BufferNamespaceApi(this._core)),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const C=this._core.coreService.decPrivateModes;let S="none";switch(this._core.coreMouseService.activeProtocol){case"X10":S="x10";break;case"VT200":S="vt200";break;case"DRAG":S="drag";break;case"ANY":S="any"}return{applicationCursorKeysMode:C.applicationCursorKeys,applicationKeypadMode:C.applicationKeypad,bracketedPasteMode:C.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:S,originMode:C.origin,reverseWraparoundMode:C.reverseWraparound,sendFocusMode:C.sendFocus,wraparoundMode:C.wraparound}}get options(){return this._publicOptions}set options(C){for(const S in C)this._publicOptions[S]=C[S]}blur(){this._core.blur()}focus(){this._core.focus()}resize(C,S){this._verifyIntegers(C,S),this._core.resize(C,S)}open(C){this._core.open(C)}attachCustomKeyEventHandler(C){this._core.attachCustomKeyEventHandler(C)}registerLinkProvider(C){return this._core.registerLinkProvider(C)}registerCharacterJoiner(C){return this._checkProposedApi(),this._core.registerCharacterJoiner(C)}deregisterCharacterJoiner(C){this._checkProposedApi(),this._core.deregisterCharacterJoiner(C)}registerMarker(C=0){return this._verifyIntegers(C),this._core.addMarker(C)}registerDecoration(C){var S,h,p;return this._checkProposedApi(),this._verifyPositiveIntegers((S=C.x)!==null&&S!==void 0?S:0,(h=C.width)!==null&&h!==void 0?h:0,(p=C.height)!==null&&p!==void 0?p:0),this._core.registerDecoration(C)}hasSelection(){return this._core.hasSelection()}select(C,S,h){this._verifyIntegers(C,S,h),this._core.select(C,S,h)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(C,S){this._verifyIntegers(C,S),this._core.selectLines(C,S)}dispose(){this._addonManager.dispose(),this._core.dispose()}scrollLines(C){this._verifyIntegers(C),this._core.scrollLines(C)}scrollPages(C){this._verifyIntegers(C),this._core.scrollPages(C)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(C){this._verifyIntegers(C),this._core.scrollToLine(C)}clear(){this._core.clear()}write(C,S){this._core.write(C,S)}writeln(C,S){this._core.write(C),this._core.write(`\r
`,S)}paste(C){this._core.paste(C)}refresh(C,S){this._verifyIntegers(C,S),this._core.refresh(C,S)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(C){return this._addonManager.loadAddon(this,C)}static get strings(){return o}_verifyIntegers(...C){for(const S of C)if(S===1/0||isNaN(S)||S%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...C){for(const S of C)if(S&&(S===1/0||isNaN(S)||S%1!=0||S<0))throw new Error("This API only accepts positive integers")}}})(),f})())})(Gu);var Uy=Gu.exports;function Wy(t){let e=new Uy.Terminal;const r=new Fy.FitAddon,i=new jy.SearchAddon;return e.loadAddon(r),e.loadAddon(i),e.open(document.querySelector(t)),e.options.fontFamily="MesloLGS NF",e.options.fontSize=16,e.options.fontWeight=500,e.options.theme={black:"#000000",red:"#c13900",green:"#a4a900",yellow:"#caaf00",blue:"#bd6d00",magenta:"#fc5e00",cyan:"#f79500",white:"#ffc88a",brightBlack:"#6a4f2a",brightRed:"#ff8c68",brightGreen:"#f6ff40",brightYellow:"#ffe36e",brightBlue:"#ffbe55",brightMagenta:"#fc874f",brightCyan:"#c69752",brightWhite:"#fafaff",background:"#3a2f29",foreground:"#ffcb83",selectionBackground:"#c14020",cursor:"#fc531d"},e.onKey(({key:a})=>{console.log(a),e.hasSelection()&&a===""&&document.execCommand("copy")}),e.resize(100,18),r.fit(),e.onRender(()=>{r.fit()}),document.term=e,e}const lo=document.querySelector("input#hostPeerID"),Jo=document.querySelector("#chatInput"),zy=document.querySelector("#myPeerID"),fl=document.querySelector("#knownPeers"),Vy=document.querySelector("button#resetPeerID"),qy=document.querySelector("button#startButton"),Ky=document.querySelector("button#startAsyncButton"),Gy=document.querySelector("button#stopButton"),Yy=document.querySelector("button#connect"),Xy=document.querySelector("#sendMessageButton");var Yr=Wy("#terminal");/*! @license DOMPurify 3.0.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.0.5/LICENSE */const{entries:Xu,setPrototypeOf:dl,isFrozen:Jy,getPrototypeOf:Qy,getOwnPropertyDescriptor:Zy}=Object;let{freeze:gt,seal:Gt,create:e0}=Object,{apply:Qo,construct:Zo}=typeof Reflect<"u"&&Reflect;Qo||(Qo=function(e,r,i){return e.apply(r,i)});gt||(gt=function(e){return e});Gt||(Gt=function(e){return e});Zo||(Zo=function(e,r){return new e(...r)});const t0=Ft(Array.prototype.forEach),pl=Ft(Array.prototype.pop),Ki=Ft(Array.prototype.push),Gn=Ft(String.prototype.toLowerCase),ho=Ft(String.prototype.toString),r0=Ft(String.prototype.match),qt=Ft(String.prototype.replace),i0=Ft(String.prototype.indexOf),n0=Ft(String.prototype.trim),wt=Ft(RegExp.prototype.test),Gi=s0(TypeError);function Ft(t){return function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return Qo(t,e,i)}}function s0(t){return function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return Zo(t,r)}}function Le(t,e,r){var i;r=(i=r)!==null&&i!==void 0?i:Gn,dl&&dl(t,null);let a=e.length;for(;a--;){let f=e[a];if(typeof f=="string"){const y=r(f);y!==f&&(Jy(e)||(e[a]=y),f=y)}t[f]=!0}return t}function di(t){const e=e0(null);for(const[r,i]of Xu(t))e[r]=i;return e}function $n(t,e){for(;t!==null;){const i=Zy(t,e);if(i){if(i.get)return Ft(i.get);if(typeof i.value=="function")return Ft(i.value)}t=Qy(t)}function r(i){return console.warn("fallback value for",i),null}return r}const _l=gt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),uo=gt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),fo=gt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),o0=gt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),po=gt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),a0=gt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),gl=gt(["#text"]),ml=gt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),_o=gt(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),vl=gt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Fn=gt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),c0=Gt(/\{\{[\w\W]*|[\w\W]*\}\}/gm),l0=Gt(/<%[\w\W]*|[\w\W]*%>/gm),h0=Gt(/\${[\w\W]*}/gm),u0=Gt(/^data-[\-\w.\u00B7-\uFFFF]/),f0=Gt(/^aria-[\-\w]+$/),Ju=Gt(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),d0=Gt(/^(?:\w+script|data):/i),p0=Gt(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Qu=Gt(/^html$/i);var yl=Object.freeze({__proto__:null,MUSTACHE_EXPR:c0,ERB_EXPR:l0,TMPLIT_EXPR:h0,DATA_ATTR:u0,ARIA_ATTR:f0,IS_ALLOWED_URI:Ju,IS_SCRIPT_OR_DATA:d0,ATTR_WHITESPACE:p0,DOCTYPE_NAME:Qu});const _0=()=>typeof window>"u"?null:window,g0=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const a="data-tt-policy-suffix";r&&r.hasAttribute(a)&&(i=r.getAttribute(a));const f="dompurify"+(i?"#"+i:"");try{return e.createPolicy(f,{createHTML(y){return y},createScriptURL(y){return y}})}catch{return console.warn("TrustedTypes policy "+f+" could not be created."),null}};function Zu(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_0();const e=Ee=>Zu(Ee);if(e.version="3.0.5",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;const r=t.document,i=r.currentScript;let{document:a}=t;const{DocumentFragment:f,HTMLTemplateElement:y,Node:s,Element:o,NodeFilter:c,NamedNodeMap:d=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:_,DOMParser:v,trustedTypes:E}=t,C=o.prototype,S=$n(C,"cloneNode"),h=$n(C,"nextSibling"),p=$n(C,"childNodes"),g=$n(C,"parentNode");if(typeof y=="function"){const Ee=a.createElement("template");Ee.content&&Ee.content.ownerDocument&&(a=Ee.content.ownerDocument)}let m,T="";const{implementation:w,createNodeIterator:R,createDocumentFragment:l,getElementsByTagName:k}=a,{importNode:x}=r;let M={};e.isSupported=typeof Xu=="function"&&typeof g=="function"&&w&&w.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:$,ERB_EXPR:B,TMPLIT_EXPR:N,DATA_ATTR:ee,ARIA_ATTR:ue,IS_SCRIPT_OR_DATA:se,ATTR_WHITESPACE:P}=yl;let{IS_ALLOWED_URI:F}=yl,j=null;const q=Le({},[..._l,...uo,...fo,...po,...gl]);let te=null;const ge=Le({},[...ml,..._o,...vl,...Fn]);let me=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),oe=null,pe=null,z=!0,W=!0,Y=!1,re=!0,ae=!1,Oe=!1,de=!1,Fe=!1,Ue=!1,ze=!1,Pe=!1,xt=!0,mt=!1;const Li="user-content-";let Et=!0,Dt=!1,Je={},lt=null;const Lt=Le({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let be=null;const Qe=Le({},["audio","video","img","source","image","track"]);let br=null;const Hr=Le({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ei="http://www.w3.org/1998/Math/MathML",$r="http://www.w3.org/2000/svg",Ot="http://www.w3.org/1999/xhtml";let Pt=Ot,Tt=!1,Ut=null;const Cr=Le({},[ei,$r,Ot],ho);let lr;const ti=["application/xhtml+xml","text/html"],_n="text/html";let Ye,Er=null;const Tr=a.createElement("form"),wr=function(K){return K instanceof RegExp||K instanceof Function},ri=function(K){if(!(Er&&Er===K)){if((!K||typeof K!="object")&&(K={}),K=di(K),lr=ti.indexOf(K.PARSER_MEDIA_TYPE)===-1?lr=_n:lr=K.PARSER_MEDIA_TYPE,Ye=lr==="application/xhtml+xml"?ho:Gn,j="ALLOWED_TAGS"in K?Le({},K.ALLOWED_TAGS,Ye):q,te="ALLOWED_ATTR"in K?Le({},K.ALLOWED_ATTR,Ye):ge,Ut="ALLOWED_NAMESPACES"in K?Le({},K.ALLOWED_NAMESPACES,ho):Cr,br="ADD_URI_SAFE_ATTR"in K?Le(di(Hr),K.ADD_URI_SAFE_ATTR,Ye):Hr,be="ADD_DATA_URI_TAGS"in K?Le(di(Qe),K.ADD_DATA_URI_TAGS,Ye):Qe,lt="FORBID_CONTENTS"in K?Le({},K.FORBID_CONTENTS,Ye):Lt,oe="FORBID_TAGS"in K?Le({},K.FORBID_TAGS,Ye):{},pe="FORBID_ATTR"in K?Le({},K.FORBID_ATTR,Ye):{},Je="USE_PROFILES"in K?K.USE_PROFILES:!1,z=K.ALLOW_ARIA_ATTR!==!1,W=K.ALLOW_DATA_ATTR!==!1,Y=K.ALLOW_UNKNOWN_PROTOCOLS||!1,re=K.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ae=K.SAFE_FOR_TEMPLATES||!1,Oe=K.WHOLE_DOCUMENT||!1,Ue=K.RETURN_DOM||!1,ze=K.RETURN_DOM_FRAGMENT||!1,Pe=K.RETURN_TRUSTED_TYPE||!1,Fe=K.FORCE_BODY||!1,xt=K.SANITIZE_DOM!==!1,mt=K.SANITIZE_NAMED_PROPS||!1,Et=K.KEEP_CONTENT!==!1,Dt=K.IN_PLACE||!1,F=K.ALLOWED_URI_REGEXP||Ju,Pt=K.NAMESPACE||Ot,me=K.CUSTOM_ELEMENT_HANDLING||{},K.CUSTOM_ELEMENT_HANDLING&&wr(K.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(me.tagNameCheck=K.CUSTOM_ELEMENT_HANDLING.tagNameCheck),K.CUSTOM_ELEMENT_HANDLING&&wr(K.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(me.attributeNameCheck=K.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),K.CUSTOM_ELEMENT_HANDLING&&typeof K.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(me.allowCustomizedBuiltInElements=K.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ae&&(W=!1),ze&&(Ue=!0),Je&&(j=Le({},[...gl]),te=[],Je.html===!0&&(Le(j,_l),Le(te,ml)),Je.svg===!0&&(Le(j,uo),Le(te,_o),Le(te,Fn)),Je.svgFilters===!0&&(Le(j,fo),Le(te,_o),Le(te,Fn)),Je.mathMl===!0&&(Le(j,po),Le(te,vl),Le(te,Fn))),K.ADD_TAGS&&(j===q&&(j=di(j)),Le(j,K.ADD_TAGS,Ye)),K.ADD_ATTR&&(te===ge&&(te=di(te)),Le(te,K.ADD_ATTR,Ye)),K.ADD_URI_SAFE_ATTR&&Le(br,K.ADD_URI_SAFE_ATTR,Ye),K.FORBID_CONTENTS&&(lt===Lt&&(lt=di(lt)),Le(lt,K.FORBID_CONTENTS,Ye)),Et&&(j["#text"]=!0),Oe&&Le(j,["html","head","body"]),j.table&&(Le(j,["tbody"]),delete oe.tbody),K.TRUSTED_TYPES_POLICY){if(typeof K.TRUSTED_TYPES_POLICY.createHTML!="function")throw Gi('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof K.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Gi('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');m=K.TRUSTED_TYPES_POLICY,T=m.createHTML("")}else m===void 0&&(m=g0(E,i)),m!==null&&typeof T=="string"&&(T=m.createHTML(""));gt&&gt(K),Er=K}},Oi=Le({},["mi","mo","mn","ms","mtext"]),ht=Le({},["foreignobject","desc","title","annotation-xml"]),nt=Le({},["title","style","font","a","script"]),kr=Le({},uo);Le(kr,fo),Le(kr,o0);const Pi=Le({},po);Le(Pi,a0);const gn=function(K){let he=g(K);(!he||!he.tagName)&&(he={namespaceURI:Pt,tagName:"template"});const _e=Gn(K.tagName),$e=Gn(he.tagName);return Ut[K.namespaceURI]?K.namespaceURI===$r?he.namespaceURI===Ot?_e==="svg":he.namespaceURI===ei?_e==="svg"&&($e==="annotation-xml"||Oi[$e]):!!kr[_e]:K.namespaceURI===ei?he.namespaceURI===Ot?_e==="math":he.namespaceURI===$r?_e==="math"&&ht[$e]:!!Pi[_e]:K.namespaceURI===Ot?he.namespaceURI===$r&&!ht[$e]||he.namespaceURI===ei&&!Oi[$e]?!1:!Pi[_e]&&(nt[_e]||!kr[_e]):!!(lr==="application/xhtml+xml"&&Ut[K.namespaceURI]):!1},Xt=function(K){Ki(e.removed,{element:K});try{K.parentNode.removeChild(K)}catch{K.remove()}},Jt=function(K,he){try{Ki(e.removed,{attribute:he.getAttributeNode(K),from:he})}catch{Ki(e.removed,{attribute:null,from:he})}if(he.removeAttribute(K),K==="is"&&!te[K])if(Ue||ze)try{Xt(he)}catch{}else try{he.setAttribute(K,"")}catch{}},hr=function(K){let he,_e;if(Fe)K="<remove></remove>"+K;else{const ut=r0(K,/^[\r\n\t ]+/);_e=ut&&ut[0]}lr==="application/xhtml+xml"&&Pt===Ot&&(K='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+K+"</body></html>");const $e=m?m.createHTML(K):K;if(Pt===Ot)try{he=new v().parseFromString($e,lr)}catch{}if(!he||!he.documentElement){he=w.createDocument(Pt,"template",null);try{he.documentElement.innerHTML=Tt?T:$e}catch{}}const Ke=he.body||he.documentElement;return K&&_e&&Ke.insertBefore(a.createTextNode(_e),Ke.childNodes[0]||null),Pt===Ot?k.call(he,Oe?"html":"body")[0]:Oe?he.documentElement:Ke},ii=function(K){return R.call(K.ownerDocument||K,K,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},ni=function(K){return K instanceof _&&(typeof K.nodeName!="string"||typeof K.textContent!="string"||typeof K.removeChild!="function"||!(K.attributes instanceof d)||typeof K.removeAttribute!="function"||typeof K.setAttribute!="function"||typeof K.namespaceURI!="string"||typeof K.insertBefore!="function"||typeof K.hasChildNodes!="function")},si=function(K){return typeof s=="object"?K instanceof s:K&&typeof K=="object"&&typeof K.nodeType=="number"&&typeof K.nodeName=="string"},Wt=function(K,he,_e){M[K]&&t0(M[K],$e=>{$e.call(e,he,_e,Er)})},mn=function(K){let he;if(Wt("beforeSanitizeElements",K,null),ni(K))return Xt(K),!0;const _e=Ye(K.nodeName);if(Wt("uponSanitizeElement",K,{tagName:_e,allowedTags:j}),K.hasChildNodes()&&!si(K.firstElementChild)&&(!si(K.content)||!si(K.content.firstElementChild))&&wt(/<[/\w]/g,K.innerHTML)&&wt(/<[/\w]/g,K.textContent))return Xt(K),!0;if(!j[_e]||oe[_e]){if(!oe[_e]&&vn(_e)&&(me.tagNameCheck instanceof RegExp&&wt(me.tagNameCheck,_e)||me.tagNameCheck instanceof Function&&me.tagNameCheck(_e)))return!1;if(Et&&!lt[_e]){const $e=g(K)||K.parentNode,Ke=p(K)||K.childNodes;if(Ke&&$e){const ut=Ke.length;for(let qe=ut-1;qe>=0;--qe)$e.insertBefore(S(Ke[qe],!0),h(K))}}return Xt(K),!0}return K instanceof o&&!gn(K)||(_e==="noscript"||_e==="noembed"||_e==="noframes")&&wt(/<\/no(script|embed|frames)/i,K.innerHTML)?(Xt(K),!0):(ae&&K.nodeType===3&&(he=K.textContent,he=qt(he,$," "),he=qt(he,B," "),he=qt(he,N," "),K.textContent!==he&&(Ki(e.removed,{element:K.cloneNode()}),K.textContent=he)),Wt("afterSanitizeElements",K,null),!1)},Mi=function(K,he,_e){if(xt&&(he==="id"||he==="name")&&(_e in a||_e in Tr))return!1;if(!(W&&!pe[he]&&wt(ee,he))){if(!(z&&wt(ue,he))){if(!te[he]||pe[he]){if(!(vn(K)&&(me.tagNameCheck instanceof RegExp&&wt(me.tagNameCheck,K)||me.tagNameCheck instanceof Function&&me.tagNameCheck(K))&&(me.attributeNameCheck instanceof RegExp&&wt(me.attributeNameCheck,he)||me.attributeNameCheck instanceof Function&&me.attributeNameCheck(he))||he==="is"&&me.allowCustomizedBuiltInElements&&(me.tagNameCheck instanceof RegExp&&wt(me.tagNameCheck,_e)||me.tagNameCheck instanceof Function&&me.tagNameCheck(_e))))return!1}else if(!br[he]){if(!wt(F,qt(_e,P,""))){if(!((he==="src"||he==="xlink:href"||he==="href")&&K!=="script"&&i0(_e,"data:")===0&&be[K])){if(!(Y&&!wt(se,qt(_e,P,"")))){if(_e)return!1}}}}}}return!0},vn=function(K){return K.indexOf("-")>0},yn=function(K){let he,_e,$e,Ke;Wt("beforeSanitizeAttributes",K,null);const{attributes:ut}=K;if(!ut)return;const qe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:te};for(Ke=ut.length;Ke--;){he=ut[Ke];const{name:st,namespaceURI:oi}=he;if(_e=st==="value"?he.value:n0(he.value),$e=Ye(st),qe.attrName=$e,qe.attrValue=_e,qe.keepAttr=!0,qe.forceKeepAttr=void 0,Wt("uponSanitizeAttribute",K,qe),_e=qe.attrValue,qe.forceKeepAttr||(Jt(st,K),!qe.keepAttr))continue;if(!re&&wt(/\/>/i,_e)){Jt(st,K);continue}ae&&(_e=qt(_e,$," "),_e=qt(_e,B," "),_e=qt(_e,N," "));const Ii=Ye(K.nodeName);if(Mi(Ii,$e,_e)){if(mt&&($e==="id"||$e==="name")&&(Jt(st,K),_e=Li+_e),m&&typeof E=="object"&&typeof E.getAttributeType=="function"&&!oi)switch(E.getAttributeType(Ii,$e)){case"TrustedHTML":{_e=m.createHTML(_e);break}case"TrustedScriptURL":{_e=m.createScriptURL(_e);break}}try{oi?K.setAttributeNS(oi,st,_e):K.setAttribute(st,_e),pl(e.removed)}catch{}}}Wt("afterSanitizeAttributes",K,null)},Sn=function Ee(K){let he;const _e=ii(K);for(Wt("beforeSanitizeShadowDOM",K,null);he=_e.nextNode();)Wt("uponSanitizeShadowNode",he,null),!mn(he)&&(he.content instanceof f&&Ee(he.content),yn(he));Wt("afterSanitizeShadowDOM",K,null)};return e.sanitize=function(Ee){let K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},he,_e,$e,Ke;if(Tt=!Ee,Tt&&(Ee="<!-->"),typeof Ee!="string"&&!si(Ee))if(typeof Ee.toString=="function"){if(Ee=Ee.toString(),typeof Ee!="string")throw Gi("dirty is not a string, aborting")}else throw Gi("toString is not a function");if(!e.isSupported)return Ee;if(de||ri(K),e.removed=[],typeof Ee=="string"&&(Dt=!1),Dt){if(Ee.nodeName){const st=Ye(Ee.nodeName);if(!j[st]||oe[st])throw Gi("root node is forbidden and cannot be sanitized in-place")}}else if(Ee instanceof s)he=hr("<!---->"),_e=he.ownerDocument.importNode(Ee,!0),_e.nodeType===1&&_e.nodeName==="BODY"||_e.nodeName==="HTML"?he=_e:he.appendChild(_e);else{if(!Ue&&!ae&&!Oe&&Ee.indexOf("<")===-1)return m&&Pe?m.createHTML(Ee):Ee;if(he=hr(Ee),!he)return Ue?null:Pe?T:""}he&&Fe&&Xt(he.firstChild);const ut=ii(Dt?Ee:he);for(;$e=ut.nextNode();)mn($e)||($e.content instanceof f&&Sn($e.content),yn($e));if(Dt)return Ee;if(Ue){if(ze)for(Ke=l.call(he.ownerDocument);he.firstChild;)Ke.appendChild(he.firstChild);else Ke=he;return(te.shadowroot||te.shadowrootmode)&&(Ke=x.call(r,Ke,!0)),Ke}let qe=Oe?he.outerHTML:he.innerHTML;return Oe&&j["!doctype"]&&he.ownerDocument&&he.ownerDocument.doctype&&he.ownerDocument.doctype.name&&wt(Qu,he.ownerDocument.doctype.name)&&(qe="<!DOCTYPE "+he.ownerDocument.doctype.name+`>
`+qe),ae&&(qe=qt(qe,$," "),qe=qt(qe,B," "),qe=qt(qe,N," ")),m&&Pe?m.createHTML(qe):qe},e.setConfig=function(Ee){ri(Ee),de=!0},e.clearConfig=function(){Er=null,de=!1},e.isValidAttribute=function(Ee,K,he){Er||ri({});const _e=Ye(Ee),$e=Ye(K);return Mi(_e,$e,he)},e.addHook=function(Ee,K){typeof K=="function"&&(M[Ee]=M[Ee]||[],Ki(M[Ee],K))},e.removeHook=function(Ee){if(M[Ee])return pl(M[Ee])},e.removeHooks=function(Ee){M[Ee]&&(M[Ee]=[])},e.removeAllHooks=function(){M={}},e}var m0=Zu();function Sl(t){let e=Jo.value;Jo.value="",Yr.writeln(`Me: ${an(e)}`),t.broadcastMessage({chatMessage:e})}function v0(t,e){e&&Yr.writeln(`${an(t)}: ${an(e==null?void 0:e.chatMessage)}`)}function an(t){return m0.sanitize(t)}function y0(t,e){console.log(`Connected to: ${t}`),Yr.writeln(`Connected to: ${t}`),ef(e)}function S0(t,e){console.log(`Disconnected from: ${t}`),Yr.writeln(`Disconnected from: ${t}`),ef(e)}function ef(t){fl.innerHTML="",t.getPeers(!0).forEach((e,r)=>{fl.innerHTML+=`<li class="list-group-item ${e==t.peer.id?"list-group-item-light":""}"> <span style="user-select:none">${r}: </span><span>${an(e)} </span></li>`})}function b0(t,e){Vy.addEventListener("click",()=>{localStorage.removeItem("myPeerID"),t.close(),e()}),qy.addEventListener("click",()=>{t.runMPyCDemo(!1)}),Ky.addEventListener("click",()=>t.runMPyCDemo(!0)),Gy.addEventListener("click",e),Yy.addEventListener("click",()=>{localStorage.setItem("hostPeerID",lo.value),t.connectToPeer(lo.value)}),Xy.addEventListener("click",()=>{Sl(t)});var r=localStorage.getItem("hostPeerID");r&&(lo.value=r),$y("#myPeerID","button#copyPeerID"),Jo.addEventListener("keypress",function(a){let f=a;if(f.key==="Enter"&&!f.shiftKey)return f.preventDefault(),Sl(t)}),document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(a=>new yr(a))}var St=La();b0(St,La);function La(){return St&&St.close(),St=new Bp(localStorage.getItem("myPeerID"),"config.toml"),St.onPeerConnectedHook=y0,St.onPeerDisconnectedHook=S0,St.onPeerJSUserDataReceivedHook=v0,St.onPeerIDReadyHook=t=>{zy.value=an(t),localStorage.setItem("myPeerID",t),console.log("My peer ID is: "+t)},Yr.writeln("Loading PyScript runtime..."),St.onRuntimeReadyHook=()=>{Yr.writeln("PyScript runtime ready.")},St.onPyScriptDisplayHook=t=>{Yr.writeln(t)},document.mpyc=St,document.r=La,document.run=()=>St.runMPyCDemo(!1),document.runa=()=>St.runMPyCDemo(!0),St}
